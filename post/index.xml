<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on Cuterwrite's Blog</title><link>https://cuterwrite.top/post/</link><description>Recent content in Posts on Cuterwrite's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>cuterwrite</copyright><lastBuildDate>Fri, 05 Jul 2024 22:46:00 +0000</lastBuildDate><atom:link href="https://cuterwrite.top/post/index.xml" rel="self" type="application/rss+xml"/><item><title>LLM ç”Ÿæ€ä»‹ç»ï¼šä»æ¨¡å‹å¾®è°ƒåˆ°åº”ç”¨è½åœ°</title><link>https://cuterwrite.top/p/llm-ecosystem/</link><pubDate>Fri, 05 Jul 2024 22:46:00 +0000</pubDate><guid>https://cuterwrite.top/p/llm-ecosystem/</guid><description>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-29_119269220_p0_master1200.webp" alt="Featured image of post LLM ç”Ÿæ€ä»‹ç»ï¼šä»æ¨¡å‹å¾®è°ƒåˆ°åº”ç”¨è½åœ°" />&lt;h1 id="llm-ç”Ÿæ€ä»‹ç»ä»æ¨¡å‹å¾®è°ƒåˆ°åº”ç”¨è½åœ°">LLM ç”Ÿæ€ä»‹ç»ï¼šä»æ¨¡å‹å¾®è°ƒåˆ°åº”ç”¨è½åœ°&lt;/h1>
&lt;h2 id="æ¨¡å‹å¾®è°ƒ">æ¨¡å‹å¾®è°ƒ&lt;/h2>
&lt;p>é¢„è®­ç»ƒçš„ LLM é€šå¸¸å…·å¤‡å¹¿æ³›çš„çŸ¥è¯†ï¼Œä½†è¦ä½¿å…¶åœ¨ç‰¹å®šä»»åŠ¡ä¸Šè¡¨ç°å‡ºè‰²ï¼Œå¾®è°ƒæ˜¯å¿…ä¸å¯å°‘çš„ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ LLM å¾®è°ƒå·¥å…·ï¼š&lt;/p>
&lt;h3 id="axolotl">Axolotl&lt;/h3>
&lt;a href="https://github.com/OpenAccess-AI-Collective/axolotl" target="_blank" class="card-github fetch-waiting no-styling"
repo="OpenAccess-AI-Collective/axolotl" id="repo-WJPKStibSD7ClNJn-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-WJPKStibSD7ClNJn-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">OpenAccess-AI-Collective&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">axolotl&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-WJPKStibSD7ClNJn-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-WJPKStibSD7ClNJn-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-WJPKStibSD7ClNJn-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-WJPKStibSD7ClNJn-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-WJPKStibSD7ClNJn-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-WJPKStibSD7ClNJn-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/OpenAccess-AI-Collective\/axolotl', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-WJPKStibSD7ClNJn-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-WJPKStibSD7ClNJn-language').innerText = data.language;
document.getElementById('repo-WJPKStibSD7ClNJn-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-WJPKStibSD7ClNJn-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-WJPKStibSD7ClNJn-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-WJPKStibSD7ClNJn-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-WJPKStibSD7ClNJn-license').classList.add = "no-license"
};
document.getElementById('repo-WJPKStibSD7ClNJn-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for OpenAccess-AI-Collective\/axolotl.")
}).catch(err => {
const c = document.getElementById('repo-WJPKStibSD7ClNJn-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for OpenAccess-AI-Collective\/axolotl.")
})
&lt;/script>
&lt;p>Axolotl æ˜¯ä¸€æ¬¾æ—¨åœ¨ç®€åŒ–å„ç§äººå·¥æ™ºèƒ½æ¨¡å‹å¾®è°ƒçš„å·¥å…·ï¼Œæ”¯æŒå¤šç§é…ç½®å’Œæ¶æ„ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>è®­ç»ƒå„ç§ Huggingface æ¨¡å‹ï¼Œå¦‚ llamaã€pythiaã€falconã€mpt&lt;/li>
&lt;li>æ”¯æŒ fullfinetuneã€loraã€qloraã€relora å’Œ gptq&lt;/li>
&lt;li>ä½¿ç”¨ç®€å•çš„ yaml æ–‡ä»¶æˆ– CLI é‡å†™åŠŸèƒ½è‡ªå®šä¹‰é…ç½®&lt;/li>
&lt;li>åŠ è½½ä¸åŒçš„æ•°æ®é›†æ ¼å¼ï¼Œä½¿ç”¨è‡ªå®šä¹‰æ ¼å¼ï¼Œæˆ–è‡ªå¸¦æ ‡è®°åŒ–æ•°æ®é›†&lt;/li>
&lt;li>ä¸ xformerã€é—ªå­˜å…³æ³¨ã€ç»³ç´¢ç¼©æ”¾å’Œå¤šé‡åŒ…è£…é›†æˆ&lt;/li>
&lt;li>å¯é€šè¿‡ FSDP æˆ– Deepspeed ä¸å• GPU æˆ–å¤š GPU ååŒå·¥ä½œ&lt;/li>
&lt;li>ä½¿ç”¨ Docker åœ¨æœ¬åœ°æˆ–äº‘ç«¯è½»æ¾è¿è¡Œ&lt;/li>
&lt;li>å°†ç»“æœå’Œå¯é€‰çš„æ£€æŸ¥ç‚¹è®°å½•åˆ° wandb æˆ– mlflow ä¸­&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>å¿«é€Ÿå…¥é—¨ï¼š&lt;/strong>
è¦æ±‚ï¼š Python &amp;gt;=3.10 å’Œ Pytorch &amp;gt;=2.1.1&lt;/p>
&lt;pre>&lt;code class="language-bash">git clone https://github.com/OpenAccess-AI-Collective/axolotl
cd axolotl
pip3 install packaging ninja
pip3 install -e '.[flash-attn,deepspeed]'
&lt;/code>&lt;/pre>
&lt;p>&lt;strong>ä½¿ç”¨æ–¹æ³•ï¼š&lt;/strong>&lt;/p>
&lt;pre>&lt;code class="language-bash"># preprocess datasets - optional but recommended
CUDA_VISIBLE_DEVICES=&amp;quot;&amp;quot; python -m axolotl.cli.preprocess examples/openllama-3b/lora.yml
# finetune lora
accelerate launch -m axolotl.cli.train examples/openllama-3b/lora.yml
# inference
accelerate launch -m axolotl.cli.inference examples/openllama-3b/lora.yml \
--lora_model_dir=&amp;quot;./outputs/lora-out&amp;quot;
# gradio
accelerate launch -m axolotl.cli.inference examples/openllama-3b/lora.yml \
--lora_model_dir=&amp;quot;./outputs/lora-out&amp;quot; --gradio
# remote yaml files - the yaml config can be hosted on a public URL
# Note: the yaml config must directly link to the **raw** yaml
accelerate launch -m axolotl.cli.train https://raw.githubusercontent.com/OpenAccess-AI-Collective/axolotl/main/examples/openllama-3b/lora.yml
&lt;/code>&lt;/pre>
&lt;p>å…¶å®ƒè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/OpenAccess-AI-Collective/axolotl" target="_blank" rel="noopener" >Axolotl
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="llama-factory">Llama-Factory&lt;/h3>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-07-07_llama-factory-logo.webp"
alt="Llama Factory Logo" width="80%" loading="lazy">
&lt;/figure>
&lt;a href="https://github.com/hiyouga/LLaMA-Factory" target="_blank" class="card-github fetch-waiting no-styling"
repo="hiyouga/LLaMA-Factory" id="repo-7926ED3ZWAjUn27A-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-7926ED3ZWAjUn27A-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">hiyouga&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">LLaMA-Factory&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-7926ED3ZWAjUn27A-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-7926ED3ZWAjUn27A-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-7926ED3ZWAjUn27A-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-7926ED3ZWAjUn27A-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-7926ED3ZWAjUn27A-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-7926ED3ZWAjUn27A-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/hiyouga\/LLaMA-Factory', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-7926ED3ZWAjUn27A-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-7926ED3ZWAjUn27A-language').innerText = data.language;
document.getElementById('repo-7926ED3ZWAjUn27A-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-7926ED3ZWAjUn27A-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-7926ED3ZWAjUn27A-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-7926ED3ZWAjUn27A-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-7926ED3ZWAjUn27A-license').classList.add = "no-license"
};
document.getElementById('repo-7926ED3ZWAjUn27A-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for hiyouga\/LLaMA-Factory.")
}).catch(err => {
const c = document.getElementById('repo-7926ED3ZWAjUn27A-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for hiyouga\/LLaMA-Factory.")
})
&lt;/script>
&lt;p>Llama-Factory æ˜¯ Meta æ¨å‡ºçš„ï¼Œä¸“æ³¨äº Llama æ¨¡å‹å¾®è°ƒçš„æ¡†æ¶ã€‚å®ƒæ„å»ºäº PyTorch ç”Ÿæ€ä¹‹ä¸Šï¼Œå¹¶æä¾›é«˜æ•ˆçš„è®­ç»ƒå’Œè¯„ä¼°å·¥å…·ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å¤šç§æ¨¡å‹&lt;/strong>ï¼šLLaMAã€LLaVAã€Mistralã€Mixtral-MoEã€Qwenã€Yiã€Gemmaã€Baichuanã€ChatGLMã€Phi ç­‰ç­‰ã€‚&lt;/li>
&lt;li>&lt;strong>é›†æˆæ–¹æ³•&lt;/strong>ï¼šï¼ˆå¢é‡ï¼‰é¢„è®­ç»ƒã€ï¼ˆå¤šæ¨¡æ€ï¼‰æŒ‡ä»¤ç›‘ç£å¾®è°ƒã€å¥–åŠ±æ¨¡å‹è®­ç»ƒã€PPO è®­ç»ƒã€DPO è®­ç»ƒã€KTO è®­ç»ƒã€ORPO è®­ç»ƒç­‰ç­‰ã€‚&lt;/li>
&lt;li>&lt;strong>å¤šç§ç²¾åº¦&lt;/strong>ï¼š16 æ¯”ç‰¹å…¨å‚æ•°å¾®è°ƒã€å†»ç»“å¾®è°ƒã€LoRA å¾®è°ƒå’ŒåŸºäº AQLM/AWQ/GPTQ/LLM.int8/HQQ/EETQ çš„ 2/3/4/5/6/8 æ¯”ç‰¹ QLoRA å¾®è°ƒã€‚&lt;/li>
&lt;li>&lt;strong>å…ˆè¿›ç®—æ³•&lt;/strong>ï¼šGaLoreã€BAdamã€DoRAã€LongLoRAã€LLaMA Proã€Mixture-of-Depthsã€LoRA+ã€LoftQã€PiSSA å’Œ Agent å¾®è°ƒã€‚&lt;/li>
&lt;li>&lt;strong>å®ç”¨æŠ€å·§&lt;/strong>ï¼šFlashAttention-2ã€Unslothã€RoPE scalingã€NEFTune å’Œ rsLoRAã€‚&lt;/li>
&lt;li>&lt;strong>å®éªŒç›‘æ§&lt;/strong>ï¼šLlamaBoardã€TensorBoardã€Wandbã€MLflow ç­‰ç­‰ã€‚&lt;/li>
&lt;li>&lt;strong>æé€Ÿæ¨ç†&lt;/strong>ï¼šåŸºäº vLLM çš„ OpenAI é£æ ¼ APIã€æµè§ˆå™¨ç•Œé¢å’Œå‘½ä»¤è¡Œæ¥å£ã€‚&lt;/li>
&lt;/ul>
&lt;div class="video-wrapper">
&lt;video
controls
src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-07-07_309488092-ec36a9dd-37f4-4f72-81bd-d76c6d0a6594.mp4"
>
&lt;p>
Your browser doesn't support HTML5 video. Here is a
&lt;a href="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-07-07_309488092-ec36a9dd-37f4-4f72-81bd-d76c6d0a6594.mp4">link to the video&lt;/a> instead.
&lt;/p>
&lt;/video>
&lt;/div>
&lt;p>&lt;strong>æ€§èƒ½æŒ‡æ ‡&lt;/strong>&lt;/p>
&lt;p>ä¸ ChatGLM å®˜æ–¹çš„ &lt;a class="link" href="https://github.com/THUDM/ChatGLM2-6B/tree/main/ptuning" target="_blank" rel="noopener" >P-Tuning
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
å¾®è°ƒç›¸æ¯”ï¼ŒLLaMA Factory çš„ LoRA å¾®è°ƒæä¾›äº† &lt;strong>3.7 å€&lt;/strong>çš„åŠ é€Ÿæ¯”ï¼ŒåŒæ—¶åœ¨å¹¿å‘Šæ–‡æ¡ˆç”Ÿæˆä»»åŠ¡ä¸Šå–å¾—äº†æ›´é«˜çš„ Rouge åˆ†æ•°ã€‚ç»“åˆ 4 æ¯”ç‰¹é‡åŒ–æŠ€æœ¯ï¼ŒLLaMA Factory çš„ QLoRA å¾®è°ƒè¿›ä¸€æ­¥é™ä½äº† GPU æ˜¾å­˜æ¶ˆè€—ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-07-07_benchmark.webp"
alt="Performance" width="auto" loading="lazy">
&lt;/figure>
&lt;details>
&lt;summary>å˜é‡å®šä¹‰&lt;/summary>
&lt;ul>
&lt;li>&lt;strong>Training Speed&lt;/strong>: è®­ç»ƒé˜¶æ®µæ¯ç§’å¤„ç†çš„æ ·æœ¬æ•°é‡ã€‚ï¼ˆæ‰¹å¤„ç†å¤§å°=4ï¼Œæˆªæ–­é•¿åº¦=1024ï¼‰&lt;/li>
&lt;li>&lt;strong>Rouge Score&lt;/strong>: &lt;a class="link" href="https://aclanthology.org/D19-1321.pdf" target="_blank" rel="noopener" >å¹¿å‘Šæ–‡æ¡ˆç”Ÿæˆ
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ä»»åŠ¡éªŒè¯é›†ä¸Šçš„ Rouge-2 åˆ†æ•°ã€‚ï¼ˆæ‰¹å¤„ç†å¤§å°=4ï¼Œæˆªæ–­é•¿åº¦=1024ï¼‰&lt;/li>
&lt;li>&lt;strong>GPU Memory&lt;/strong>: 4 æ¯”ç‰¹é‡åŒ–è®­ç»ƒçš„ GPU æ˜¾å­˜å³°å€¼ã€‚ï¼ˆæ‰¹å¤„ç†å¤§å°=1ï¼Œæˆªæ–­é•¿åº¦=1024ï¼‰&lt;/li>
&lt;li>æˆ‘ä»¬åœ¨ ChatGLM çš„ P-Tuning ä¸­é‡‡ç”¨ &lt;code>pre_seq_len=128&lt;/code>ï¼Œåœ¨ LLaMA Factory çš„ LoRA å¾®è°ƒä¸­é‡‡ç”¨ &lt;code>lora_rank=32&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;/details>
&lt;p>&lt;strong>å¿«é€Ÿå…¥é—¨&lt;/strong>&lt;/p>
&lt;pre>&lt;code class="language-bash">git clone --depth 1 https://github.com/hiyouga/LLaMA-Factory.git
cd LLaMA-Factory
pip install -e &amp;quot;.[torch,metrics]&amp;quot;
&lt;/code>&lt;/pre>
&lt;p>å¯é€‰çš„é¢å¤–ä¾èµ–é¡¹ï¼štorchã€torch-npuã€metricsã€deepspeedã€bitsandbytesã€hqqã€eetqã€gptqã€awqã€aqlmã€vllmã€galoreã€badamã€qwenã€modelscopeã€quality&lt;/p>
&lt;div class="notice notice-tip" >
&lt;div class="notice-title">&lt;svg t="1705945832245" class="icon notice-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19409" width="200" height="200">&lt;path d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m238.933333 349.866666l-2.133333 2.133334-277.333333 277.333333c-10.666667 10.666667-29.866667 12.8-42.666667 2.133333L426.666667 704l-149.333334-149.333333c-12.8-12.8-12.8-32 0-44.8 10.666667-10.666667 29.866667-12.8 42.666667-2.133334l2.133333 2.133334 125.866667 125.866666 253.866667-253.866666c10.666667-10.666667 29.866667-12.8 42.666666-2.133334l2.133334 2.133334c12.8 12.8 12.8 32 4.266666 42.666666z" fill="#ffffff" p-id="19410">&lt;/path>&lt;/svg>&lt;/div>&lt;p>é‡åˆ°åŒ…å†²çªæ—¶ï¼Œå¯ä½¿ç”¨ pip install &amp;ndash;no-deps -e . è§£å†³ã€‚&lt;/p>&lt;/div>
&lt;details>
&lt;summary>Windows ç”¨æˆ·æŒ‡å—&lt;/summary>
&lt;p>å¦‚æœè¦åœ¨ Windows å¹³å°ä¸Šå¼€å¯é‡åŒ– LoRAï¼ˆQLoRAï¼‰ï¼Œéœ€è¦å®‰è£…é¢„ç¼–è¯‘çš„ &lt;code>bitsandbytes&lt;/code> åº“, æ”¯æŒ CUDA 11.1 åˆ° 12.2, è¯·æ ¹æ®æ‚¨çš„ CUDA ç‰ˆæœ¬æƒ…å†µé€‰æ‹©é€‚åˆçš„&lt;a class="link" href="https://github.com/jllllll/bitsandbytes-windows-webui/releases/tag/wheels" target="_blank" rel="noopener" >å‘å¸ƒç‰ˆæœ¬
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/p>
&lt;pre>&lt;code class="language-bash">pip install https://github.com/jllllll/bitsandbytes-windows-webui/releases/download/wheels/bitsandbytes-0.41.2.post2-py3-none-win_amd64.whl
&lt;/code>&lt;/pre>
&lt;p>å¦‚æœè¦åœ¨ Windows å¹³å°ä¸Šå¼€å¯ FlashAttention-2ï¼Œéœ€è¦å®‰è£…é¢„ç¼–è¯‘çš„ &lt;code>flash-attn&lt;/code> åº“ï¼Œæ”¯æŒ CUDA 12.1 åˆ° 12.2ï¼Œè¯·æ ¹æ®éœ€æ±‚åˆ° &lt;a class="link" href="https://github.com/bdashore3/flash-attention/releases" target="_blank" rel="noopener" >flash-attention
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ä¸‹è½½å¯¹åº”ç‰ˆæœ¬å®‰è£…ã€‚&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>æ˜‡è…¾ NPU ç”¨æˆ·æŒ‡å—&lt;/summary>
&lt;p>åœ¨æ˜‡è…¾ NPU è®¾å¤‡ä¸Šå®‰è£… LLaMA Factory æ—¶ï¼Œéœ€è¦æŒ‡å®šé¢å¤–ä¾èµ–é¡¹ï¼Œä½¿ç”¨ &lt;code>pip install -e &amp;quot;.[torch-npu,metrics]&amp;quot;&lt;/code> å‘½ä»¤å®‰è£…ã€‚æ­¤å¤–ï¼Œè¿˜éœ€è¦å®‰è£… &lt;strong>&lt;a class="link" href="https://www.hiascend.com/developer/download/community/result?module=cann" target="_blank" rel="noopener" >Ascend CANN Toolkit ä¸ Kernels
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/strong>ï¼Œå®‰è£…æ–¹æ³•è¯·å‚è€ƒ&lt;a class="link" href="https://www.hiascend.com/document/detail/zh/CANNCommunityEdition/80RC2alpha002/quickstart/quickstart/quickstart_18_0004.html" target="_blank" rel="noopener" >å®‰è£…æ•™ç¨‹
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æˆ–ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash"># è¯·æ›¿æ¢ URL ä¸º CANN ç‰ˆæœ¬å’Œè®¾å¤‡å‹å·å¯¹åº”çš„ URL
# å®‰è£… CANN Toolkit
wget https://ascend-repo.obs.cn-east-2.myhuaweicloud.com/Milan-ASL/Milan-ASL%20V100R001C17SPC701/Ascend-cann-toolkit_8.0.RC1.alpha001_linux-&amp;quot;$(uname -i)&amp;quot;.run
bash Ascend-cann-toolkit_8.0.RC1.alpha001_linux-&amp;quot;$(uname -i)&amp;quot;.run --install
# å®‰è£… CANN Kernels
wget https://ascend-repo.obs.cn-east-2.myhuaweicloud.com/Milan-ASL/Milan-ASL%20V100R001C17SPC701/Ascend-cann-kernels-910b_8.0.RC1.alpha001_linux.run
bash Ascend-cann-kernels-910b_8.0.RC1.alpha001_linux.run --install
# è®¾ç½®ç¯å¢ƒå˜é‡
source /usr/local/Ascend/ascend-toolkit/set_env.sh
&lt;/code>&lt;/pre>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>ä¾èµ–é¡¹&lt;/th>
&lt;th>è‡³å°‘&lt;/th>
&lt;th>æ¨è&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>CANN&lt;/td>
&lt;td>8.0.RC1&lt;/td>
&lt;td>8.0.RC1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>torch&lt;/td>
&lt;td>2.1.0&lt;/td>
&lt;td>2.1.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>torch-npu&lt;/td>
&lt;td>2.1.0&lt;/td>
&lt;td>2.1.0.post3&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>deepspeed&lt;/td>
&lt;td>0.13.2&lt;/td>
&lt;td>0.13.2&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>è¯·ä½¿ç”¨ &lt;code>ASCEND_RT_VISIBLE_DEVICES&lt;/code> è€Œé &lt;code>CUDA_VISIBLE_DEVICES&lt;/code> æ¥æŒ‡å®šè¿ç®—è®¾å¤‡ã€‚&lt;/p>
&lt;p>å¦‚æœé‡åˆ°æ— æ³•æ­£å¸¸æ¨ç†çš„æƒ…å†µï¼Œè¯·å°è¯•è®¾ç½® &lt;code>do_sample: false&lt;/code>ã€‚&lt;/p>
&lt;p>ä¸‹è½½é¢„æ„å»º Docker é•œåƒï¼š&lt;a class="link" href="http://mirrors.cn-central-221.ovaijisuan.com/detail/130.html" target="_blank" rel="noopener" >32GB
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
| &lt;a class="link" href="http://mirrors.cn-central-221.ovaijisuan.com/detail/131.html" target="_blank" rel="noopener" >64GB
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;/details>
&lt;p>ä¸‹é¢ä¸‰è¡Œå‘½ä»¤åˆ†åˆ«å¯¹ Llama3-8B-Instruct æ¨¡å‹è¿›è¡Œ LoRA å¾®è°ƒã€æ¨ç†å’Œåˆå¹¶ã€‚&lt;/p>
&lt;pre>&lt;code class="language-bash">llamafactory-cli train examples/train_lora/llama3_lora_sft.yaml
llamafactory-cli chat examples/inference/llama3_lora_sft.yaml
llamafactory-cli export examples/merge_lora/llama3_lora_sft.yaml
&lt;/code>&lt;/pre>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/hiyouga/LLaMA-Factory" target="_blank" rel="noopener" >Llama-Factory
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="firefly">Firefly&lt;/h3>
&lt;a href="https://github.com/yangjianxin1/Firefly" target="_blank" class="card-github fetch-waiting no-styling"
repo="yangjianxin1/Firefly" id="repo-aUMUYE2obEfWoMo9-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-aUMUYE2obEfWoMo9-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">yangjianxin1&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">Firefly&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-aUMUYE2obEfWoMo9-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-aUMUYE2obEfWoMo9-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-aUMUYE2obEfWoMo9-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-aUMUYE2obEfWoMo9-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-aUMUYE2obEfWoMo9-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-aUMUYE2obEfWoMo9-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/yangjianxin1\/Firefly', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-aUMUYE2obEfWoMo9-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-aUMUYE2obEfWoMo9-language').innerText = data.language;
document.getElementById('repo-aUMUYE2obEfWoMo9-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-aUMUYE2obEfWoMo9-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-aUMUYE2obEfWoMo9-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-aUMUYE2obEfWoMo9-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-aUMUYE2obEfWoMo9-license').classList.add = "no-license"
};
document.getElementById('repo-aUMUYE2obEfWoMo9-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for yangjianxin1\/Firefly.")
}).catch(err => {
const c = document.getElementById('repo-aUMUYE2obEfWoMo9-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for yangjianxin1\/Firefly.")
})
&lt;/script>
&lt;p>&lt;strong>Firefly&lt;/strong> æ˜¯ä¸€ä¸ªå¼€æºçš„å¤§æ¨¡å‹è®­ç»ƒé¡¹ç›®ï¼Œæ”¯æŒå¯¹ä¸»æµçš„å¤§æ¨¡å‹è¿›è¡Œé¢„è®­ç»ƒã€æŒ‡ä»¤å¾®è°ƒå’Œ DPOï¼ŒåŒ…æ‹¬ä½†ä¸é™äº Qwen2ã€Yi-1.5ã€Llama3ã€Gemmaã€Qwen1.5ã€MiniCPMã€Llamaã€InternLMã€Baichuanã€ChatGLMã€Yiã€Deepseekã€Qwenã€Orionã€Ziyaã€Xverseã€Mistralã€Mixtral-8x7Bã€Zephyrã€Vicunaã€Bloom ç­‰ã€‚
æœ¬é¡¹ç›®æ”¯æŒ&lt;strong>å…¨é‡å‚æ•°è®­ç»ƒã€LoRAã€QLoRA é«˜æ•ˆè®­ç»ƒ&lt;/strong>ï¼Œæ”¯æŒ&lt;strong>é¢„è®­ç»ƒã€SFTã€DPO&lt;/strong>ã€‚ å¦‚æœä½ çš„è®­ç»ƒèµ„æºæœ‰é™ï¼Œæˆ‘ä»¬æåŠ›æ¨èä½¿ç”¨ QLoRA è¿›è¡ŒæŒ‡ä»¤å¾®è°ƒï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ Open LLM Leaderboard ä¸ŠéªŒè¯äº†è¯¥æ–¹æ³•çš„æœ‰æ•ˆæ€§ï¼Œå¹¶ä¸”å–å¾—äº†éå¸¸ä¸é”™çš„æˆç»©ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>ğŸ“— æ”¯æŒé¢„è®­ç»ƒã€æŒ‡ä»¤å¾®è°ƒã€DPOï¼Œæ”¯æŒå…¨é‡å‚æ•°è®­ç»ƒã€LoRAã€QLoRA é«˜æ•ˆè®­ç»ƒã€‚é€šè¿‡é…ç½®æ–‡ä»¶çš„æ–¹å¼è®­ç»ƒä¸åŒçš„æ¨¡å‹ï¼Œå°ç™½äº¦å¯å¿«é€Ÿä¸Šæ‰‹è®­ç»ƒæ¨¡å‹ã€‚&lt;/li>
&lt;li>ğŸ“— æ”¯æŒä½¿ç”¨&lt;a class="link" href="https://github.com/yangjianxin1/unsloth" target="_blank" rel="noopener" >Unsloth
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
åŠ é€Ÿè®­ç»ƒï¼Œå¹¶ä¸”èŠ‚çœæ˜¾å­˜ã€‚&lt;/li>
&lt;li>ğŸ“— æ”¯æŒç»å¤§éƒ¨åˆ†ä¸»æµçš„å¼€æºå¤§æ¨¡å‹ï¼Œå¦‚ Llama3ã€Gemmaã€MiniCPMã€Llamaã€InternLMã€Baichuanã€ChatGLMã€Yiã€Deepseekã€Qwenã€Orionã€Ziyaã€Xverseã€Mistralã€Mixtral-8x7Bã€Zephyrã€Vicunaã€Bloomï¼Œè®­ç»ƒæ—¶ä¸å„ä¸ªå®˜æ–¹çš„ chat æ¨¡å‹çš„ template å¯¹é½ã€‚&lt;/li>
&lt;li>ğŸ“— æ•´ç†å¹¶å¼€æºæŒ‡ä»¤å¾®è°ƒæ•°æ®é›†ï¼šfirefly-train-1.1M ã€moss-003-sft-dataã€ultrachatã€ WizardLM_evol_instruct_V2_143kã€school_math_0.25Mã€‚&lt;/li>
&lt;li>ğŸ“— å¼€æº&lt;a class="link" href="https://huggingface.co/YeungNLP" target="_blank" rel="noopener" >Firefly ç³»åˆ—æŒ‡ä»¤å¾®è°ƒæ¨¡å‹æƒé‡
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/li>
&lt;li>ğŸ“— åœ¨ Open LLM Leaderboard ä¸ŠéªŒè¯äº† QLoRA è®­ç»ƒæµç¨‹çš„æœ‰æ•ˆæ€§ã€‚&lt;/li>
&lt;/ul>
&lt;p>è¯¥é¡¹ç›®çš„ README ä¸­åŒ…å«äº†è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜ï¼ŒåŒ…æ‹¬å¦‚ä½•å®‰è£…ã€å¦‚ä½•è®­ç»ƒã€å¦‚ä½•å¾®è°ƒã€å¦‚ä½•è¯„ä¼°ç­‰ã€‚è¯·è®¿é—® &lt;a class="link" href="https://github.com/yangjianxin1/Firefly" target="_blank" rel="noopener" >Firefly
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="xtuner">XTuner&lt;/h3>
&lt;a href="https://github.com/InternLM/xtuner" target="_blank" class="card-github fetch-waiting no-styling"
repo="InternLM/xtuner" id="repo-LIqjizpI44pmBvf4-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-LIqjizpI44pmBvf4-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">InternLM&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">xtuner&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-LIqjizpI44pmBvf4-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-LIqjizpI44pmBvf4-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-LIqjizpI44pmBvf4-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-LIqjizpI44pmBvf4-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-LIqjizpI44pmBvf4-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-LIqjizpI44pmBvf4-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/InternLM\/xtuner', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-LIqjizpI44pmBvf4-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-LIqjizpI44pmBvf4-language').innerText = data.language;
document.getElementById('repo-LIqjizpI44pmBvf4-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-LIqjizpI44pmBvf4-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-LIqjizpI44pmBvf4-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-LIqjizpI44pmBvf4-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-LIqjizpI44pmBvf4-license').classList.add = "no-license"
};
document.getElementById('repo-LIqjizpI44pmBvf4-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for InternLM\/xtuner.")
}).catch(err => {
const c = document.getElementById('repo-LIqjizpI44pmBvf4-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for InternLM\/xtuner.")
})
&lt;/script>
&lt;p>XTuner æ˜¯ä¸€ä¸ªé«˜æ•ˆã€çµæ´»ã€å…¨èƒ½çš„è½»é‡åŒ–å¤§æ¨¡å‹å¾®è°ƒå·¥å…·åº“ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>é«˜æ•ˆ&lt;/strong>
&lt;ul>
&lt;li>æ”¯æŒå¤§è¯­è¨€æ¨¡å‹ LLMã€å¤šæ¨¡æ€å›¾æ–‡æ¨¡å‹ VLM çš„é¢„è®­ç»ƒåŠè½»é‡çº§å¾®è°ƒã€‚XTuner æ”¯æŒåœ¨ 8GB æ˜¾å­˜ä¸‹å¾®è°ƒ 7B æ¨¡å‹ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒå¤šèŠ‚ç‚¹è·¨è®¾å¤‡å¾®è°ƒæ›´å¤§å°ºåº¦æ¨¡å‹ï¼ˆ70B+ï¼‰ã€‚&lt;/li>
&lt;li>è‡ªåŠ¨åˆ†å‘é«˜æ€§èƒ½ç®—å­ï¼ˆå¦‚ FlashAttentionã€Triton kernels ç­‰ï¼‰ä»¥åŠ é€Ÿè®­ç»ƒååã€‚&lt;/li>
&lt;li>å…¼å®¹ &lt;a class="link" href="https://github.com/microsoft/DeepSpeed" target="_blank" rel="noopener" >DeepSpeed
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ğŸš€ï¼Œè½»æ¾åº”ç”¨å„ç§ ZeRO è®­ç»ƒä¼˜åŒ–ç­–ç•¥ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>çµæ´»&lt;/strong>
&lt;ul>
&lt;li>æ”¯æŒå¤šç§å¤§è¯­è¨€æ¨¡å‹ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº &lt;a class="link" href="https://huggingface.co/internlm" target="_blank" rel="noopener" >InternLM
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="https://huggingface.co/mistralai" target="_blank" rel="noopener" >Mixtral-8x7B
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="https://huggingface.co/meta-llama" target="_blank" rel="noopener" >Llama 2
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="https://huggingface.co/THUDM" target="_blank" rel="noopener" >ChatGLM
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="https://huggingface.co/Qwen" target="_blank" rel="noopener" >Qwen
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="https://huggingface.co/baichuan-inc" target="_blank" rel="noopener" >Baichuan
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/li>
&lt;li>æ”¯æŒå¤šæ¨¡æ€å›¾æ–‡æ¨¡å‹ LLaVA çš„é¢„è®­ç»ƒä¸å¾®è°ƒã€‚åˆ©ç”¨ XTuner è®­å¾—æ¨¡å‹ &lt;a class="link" href="https://huggingface.co/xtuner/llava-internlm2-20b" target="_blank" rel="noopener" >LLaVA-InternLM2-20B
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
è¡¨ç°ä¼˜å¼‚ã€‚&lt;/li>
&lt;li>ç²¾å¿ƒè®¾è®¡çš„æ•°æ®ç®¡é“ï¼Œå…¼å®¹ä»»æ„æ•°æ®æ ¼å¼ï¼Œå¼€æºæ•°æ®æˆ–è‡ªå®šä¹‰æ•°æ®çš†å¯å¿«é€Ÿä¸Šæ‰‹ã€‚&lt;/li>
&lt;li>æ”¯æŒ &lt;a class="link" href="http://arxiv.org/abs/2305.14314" target="_blank" rel="noopener" >QLoRA
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="http://arxiv.org/abs/2106.09685" target="_blank" rel="noopener" >LoRA
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€å…¨é‡å‚æ•°å¾®è°ƒç­‰å¤šç§å¾®è°ƒç®—æ³•ï¼Œæ”¯æ’‘ç”¨æˆ·æ ¹æ®å…·ä½“éœ€æ±‚ä½œå‡ºæœ€ä¼˜é€‰æ‹©ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>å…¨èƒ½&lt;/strong>
&lt;ul>
&lt;li>æ”¯æŒå¢é‡é¢„è®­ç»ƒã€æŒ‡ä»¤å¾®è°ƒä¸ Agent å¾®è°ƒã€‚&lt;/li>
&lt;li>é¢„å®šä¹‰ä¼—å¤šå¼€æºå¯¹è¯æ¨¡ç‰ˆï¼Œæ”¯æŒä¸å¼€æºæˆ–è®­ç»ƒæ‰€å¾—æ¨¡å‹è¿›è¡Œå¯¹è¯ã€‚&lt;/li>
&lt;li>è®­ç»ƒæ‰€å¾—æ¨¡å‹å¯æ— ç¼æ¥å…¥éƒ¨ç½²å·¥å…·åº“ &lt;a class="link" href="https://github.com/InternLM/lmdeploy" target="_blank" rel="noopener" >LMDeploy
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€å¤§è§„æ¨¡è¯„æµ‹å·¥å…·åº“ &lt;a class="link" href="https://github.com/open-compass/opencompass" target="_blank" rel="noopener" >OpenCompass
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
åŠ &lt;a class="link" href="https://github.com/open-compass/VLMEvalKit" target="_blank" rel="noopener" >VLMEvalKit
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>å¿«é€Ÿä¸Šæ‰‹ï¼š&lt;/strong>
&lt;details>
&lt;summary>å®‰è£…&lt;/summary>
&lt;ul>
&lt;li>
&lt;p>æ¨èä½¿ç”¨ conda å…ˆæ„å»ºä¸€ä¸ª Python-3.10 çš„è™šæ‹Ÿç¯å¢ƒ&lt;/p>
&lt;pre>&lt;code class="language-bash">conda create --name xtuner-env python=3.10 -y
conda activate xtuner-env
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>é€šè¿‡ pip å®‰è£… XTunerï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">pip install -U xtuner
&lt;/code>&lt;/pre>
&lt;p>äº¦å¯é›†æˆ DeepSpeed å®‰è£…ï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">pip install -U 'xtuner[deepspeed]'
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>ä»æºç å®‰è£… XTunerï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">git clone https://github.com/InternLM/xtuner.git
cd xtuner
pip install -e '.[all]'
&lt;/code>&lt;/pre>
&lt;/li>
&lt;/ul>
&lt;/details>
&lt;/p>
&lt;details>
&lt;summary>å¾®è°ƒ&lt;/summary>
&lt;p>XTuner æ”¯æŒå¾®è°ƒå¤§è¯­è¨€æ¨¡å‹ã€‚æ•°æ®é›†é¢„å¤„ç†æŒ‡å—è¯·æŸ¥é˜…&lt;a class="link" href="./docs/zh_cn/user_guides/dataset_prepare.md" >æ–‡æ¡£
&lt;/a>
ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>æ­¥éª¤ 0&lt;/strong>ï¼Œå‡†å¤‡é…ç½®æ–‡ä»¶ã€‚XTuner æä¾›å¤šä¸ªå¼€ç®±å³ç”¨çš„é…ç½®æ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä¸‹åˆ—å‘½ä»¤æŸ¥çœ‹ï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">xtuner list-cfg
&lt;/code>&lt;/pre>
&lt;p>æˆ–è€…ï¼Œå¦‚æœæ‰€æä¾›çš„é…ç½®æ–‡ä»¶ä¸èƒ½æ»¡è¶³ä½¿ç”¨éœ€æ±‚ï¼Œè¯·å¯¼å‡ºæ‰€æä¾›çš„é…ç½®æ–‡ä»¶å¹¶è¿›è¡Œç›¸åº”æ›´æ”¹ï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">xtuner copy-cfg ${CONFIG_NAME} ${SAVE_PATH}
vi ${SAVE_PATH}/${CONFIG_NAME}_copy.py
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ­¥éª¤ 1&lt;/strong>ï¼Œå¼€å§‹å¾®è°ƒã€‚&lt;/p>
&lt;pre>&lt;code class="language-shell">xtuner train ${CONFIG_NAME_OR_PATH}
&lt;/code>&lt;/pre>
&lt;p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ QLoRA ç®—æ³•åœ¨ oasst1 æ•°æ®é›†ä¸Šå¾®è°ƒ InternLM2.5-Chat-7Bï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell"># å•å¡
xtuner train internlm2_5_chat_7b_qlora_oasst1_e3 --deepspeed deepspeed_zero2
# å¤šå¡
(DIST) NPROC_PER_NODE=${GPU_NUM} xtuner train internlm2_5_chat_7b_qlora_oasst1_e3 --deepspeed deepspeed_zero2
(SLURM) srun ${SRUN_ARGS} xtuner train internlm2_5_chat_7b_qlora_oasst1_e3 --launcher slurm --deepspeed deepspeed_zero2
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>
&lt;p>&lt;code>--deepspeed&lt;/code> è¡¨ç¤ºä½¿ç”¨ &lt;a class="link" href="https://github.com/microsoft/DeepSpeed" target="_blank" rel="noopener" >DeepSpeed
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ğŸš€ æ¥ä¼˜åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚XTuner å†…ç½®äº†å¤šç§ç­–ç•¥ï¼ŒåŒ…æ‹¬ ZeRO-1ã€ZeRO-2ã€ZeRO-3 ç­‰ã€‚å¦‚æœç”¨æˆ·æœŸæœ›å…³é—­æ­¤åŠŸèƒ½ï¼Œè¯·ç›´æ¥ç§»é™¤æ­¤å‚æ•°ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ›´å¤šç¤ºä¾‹ï¼Œè¯·æŸ¥é˜…&lt;a class="link" href="./docs/zh_cn/user_guides/finetune.md" >æ–‡æ¡£
&lt;/a>
ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ­¥éª¤ 2&lt;/strong>ï¼Œå°†ä¿å­˜çš„ PTH æ¨¡å‹ï¼ˆå¦‚æœä½¿ç”¨çš„ DeepSpeedï¼Œåˆ™å°†ä¼šæ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼‰è½¬æ¢ä¸º HuggingFace æ¨¡å‹ï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">xtuner convert pth_to_hf ${CONFIG_NAME_OR_PATH} ${PTH} ${SAVE_PATH}
&lt;/code>&lt;/pre>
&lt;/li>
&lt;/ul>
&lt;/details>
&lt;p>å…¶å®ƒè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/InternLM/xtuner" target="_blank" rel="noopener" >XTuner
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h2 id="æ¨¡å‹é‡åŒ–">æ¨¡å‹é‡åŒ–&lt;/h2>
&lt;p>LLM é€šå¸¸ä½“ç§¯åºå¤§ï¼Œå¯¹è®¡ç®—èµ„æºè¦æ±‚é«˜ã€‚æ¨¡å‹é‡åŒ–æŠ€æœ¯å¯ä»¥å‹ç¼©æ¨¡å‹å¤§å°ï¼Œæé«˜è¿è¡Œæ•ˆç‡ï¼Œä½¿å…¶æ›´æ˜“äºéƒ¨ç½²ï¼š&lt;/p>
&lt;h3 id="autogptq">AutoGPTQ&lt;/h3>
&lt;a href="https://github.com/PanQiWei/AutoGPTQ" target="_blank" class="card-github fetch-waiting no-styling"
repo="PanQiWei/AutoGPTQ" id="repo-pji7hZUYgldD5B1s-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-pji7hZUYgldD5B1s-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">PanQiWei&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">AutoGPTQ&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-pji7hZUYgldD5B1s-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-pji7hZUYgldD5B1s-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-pji7hZUYgldD5B1s-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-pji7hZUYgldD5B1s-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-pji7hZUYgldD5B1s-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-pji7hZUYgldD5B1s-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/PanQiWei\/AutoGPTQ', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-pji7hZUYgldD5B1s-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-pji7hZUYgldD5B1s-language').innerText = data.language;
document.getElementById('repo-pji7hZUYgldD5B1s-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-pji7hZUYgldD5B1s-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-pji7hZUYgldD5B1s-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-pji7hZUYgldD5B1s-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-pji7hZUYgldD5B1s-license').classList.add = "no-license"
};
document.getElementById('repo-pji7hZUYgldD5B1s-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for PanQiWei\/AutoGPTQ.")
}).catch(err => {
const c = document.getElementById('repo-pji7hZUYgldD5B1s-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for PanQiWei\/AutoGPTQ.")
})
&lt;/script>
&lt;p>AutoGPTQ ä¸€ä¸ªåŸºäº GPTQ ç®—æ³•ï¼Œç®€å•æ˜“ç”¨ä¸”æ‹¥æœ‰ç”¨æˆ·å‹å¥½å‹æ¥å£çš„å¤§è¯­è¨€æ¨¡å‹é‡åŒ–å·¥å…·åŒ…ã€‚&lt;/p>
&lt;p>&lt;strong>å¿«é€Ÿå®‰è£…&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>å¯¹äº CUDA 11.7ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-bash">pip install auto-gptq --extra-index-url https://huggingface.github.io/autogptq-index/whl/cu117/
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>å¯¹äº CUDA 11.8ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-bash">pip install auto-gptq --extra-index-url https://huggingface.github.io/autogptq-index/whl/cu118/
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>å¯¹äº RoCm 5.4.2ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-bash">pip install auto-gptq --extra-index-url https://huggingface.github.io/autogptq-index/whl/rocm542/
&lt;/code>&lt;/pre>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/AutoGPTQ/AutoGPTQ/" target="_blank" rel="noopener" >AutoGPTQ
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="autoawq">AutoAWQ&lt;/h3>
&lt;a href="https://github.com/casper-hansen/AutoAWQ" target="_blank" class="card-github fetch-waiting no-styling"
repo="casper-hansen/AutoAWQ" id="repo-oLz7sQQbl7bQLvYX-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-oLz7sQQbl7bQLvYX-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">casper-hansen&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">AutoAWQ&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-oLz7sQQbl7bQLvYX-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-oLz7sQQbl7bQLvYX-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-oLz7sQQbl7bQLvYX-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-oLz7sQQbl7bQLvYX-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-oLz7sQQbl7bQLvYX-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-oLz7sQQbl7bQLvYX-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/casper-hansen\/AutoAWQ', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-oLz7sQQbl7bQLvYX-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-oLz7sQQbl7bQLvYX-language').innerText = data.language;
document.getElementById('repo-oLz7sQQbl7bQLvYX-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-oLz7sQQbl7bQLvYX-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-oLz7sQQbl7bQLvYX-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-oLz7sQQbl7bQLvYX-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-oLz7sQQbl7bQLvYX-license').classList.add = "no-license"
};
document.getElementById('repo-oLz7sQQbl7bQLvYX-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for casper-hansen\/AutoAWQ.")
}).catch(err => {
const c = document.getElementById('repo-oLz7sQQbl7bQLvYX-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for casper-hansen\/AutoAWQ.")
})
&lt;/script>
&lt;p>AutoAWQ æ˜¯å¦ä¸€æ¬¾è‡ªåŠ¨åŒ–æ¨¡å‹é‡åŒ–å·¥å…·ï¼Œæ”¯æŒå¤šç§é‡åŒ–ç²¾åº¦ï¼Œå¹¶æä¾›çµæ´»çš„é…ç½®é€‰é¡¹ï¼Œå¯ä»¥æ ¹æ®ä¸åŒçš„ç¡¬ä»¶å¹³å°å’Œæ€§èƒ½éœ€æ±‚è¿›è¡Œè°ƒæ•´ã€‚&lt;/p>
&lt;p>AutoAWQ æ˜¯ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„ 4 ä½é‡åŒ–æ¨¡å‹è½¯ä»¶åŒ…ã€‚ä¸ FP16 ç›¸æ¯”ï¼ŒAutoAWQ å¯å°†æ¨¡å‹é€Ÿåº¦æé«˜ 3 å€ï¼Œå†…å­˜éœ€æ±‚å‡å°‘ 3 å€ã€‚AutoAWQ å®ç°äº†ç”¨äºé‡åŒ– LLMs çš„æ¿€æ´»æ„ŸçŸ¥æƒé‡é‡åŒ–ï¼ˆAWQï¼‰ç®—æ³•ã€‚AutoAWQ æ˜¯åœ¨ MIT çš„åŸå§‹å·¥ä½œ &lt;a class="link" href="https://github.com/mit-han-lab/llm-awq" target="_blank" rel="noopener" >AWQ
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
åŸºç¡€ä¸Šåˆ›å»ºå’Œæ”¹è¿›çš„ã€‚&lt;/p>
&lt;p>&lt;strong>å®‰è£…æ–¹æ³•ï¼š&lt;/strong>&lt;/p>
&lt;p>å®‰è£…å‰ï¼Œç¡®ä¿å®‰è£…äº† CUDA &amp;gt;= 12.1ï¼ˆæ³¨æ„ï¼šä»¥ä¸‹åªæ˜¯æœ€å¿«æ·çš„å®‰è£…æ–¹æ³•ï¼‰&lt;/p>
&lt;pre>&lt;code class="language-bash">pip install autoawq
&lt;/code>&lt;/pre>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯å’Œç¤ºä¾‹ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/casper-hansen/AutoAWQ" target="_blank" rel="noopener" >AutoAWQ
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="neural-compressor">Neural Compressor&lt;/h3>
&lt;a href="https://github.com/intel/neural-compressor" target="_blank" class="card-github fetch-waiting no-styling"
repo="intel/neural-compressor" id="repo-KAarREa1SQjMq9gx-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-KAarREa1SQjMq9gx-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">intel&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">neural-compressor&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-KAarREa1SQjMq9gx-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-KAarREa1SQjMq9gx-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-KAarREa1SQjMq9gx-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-KAarREa1SQjMq9gx-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-KAarREa1SQjMq9gx-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-KAarREa1SQjMq9gx-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/intel\/neural-compressor', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-KAarREa1SQjMq9gx-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-KAarREa1SQjMq9gx-language').innerText = data.language;
document.getElementById('repo-KAarREa1SQjMq9gx-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-KAarREa1SQjMq9gx-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-KAarREa1SQjMq9gx-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-KAarREa1SQjMq9gx-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-KAarREa1SQjMq9gx-license').classList.add = "no-license"
};
document.getElementById('repo-KAarREa1SQjMq9gx-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for intel\/neural-compressor.")
}).catch(err => {
const c = document.getElementById('repo-KAarREa1SQjMq9gx-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for intel\/neural-compressor.")
})
&lt;/script>
&lt;p>Neural Compressor æ˜¯è‹±ç‰¹å°”å¼€å‘çš„æ¨¡å‹å‹ç¼©å·¥å…·åŒ…ï¼Œæ”¯æŒæ‰€æœ‰ä¸»æµæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆTensorFlowã€PyTorchã€ONNX Runtime å’Œ MXNetï¼‰ä¸Šæµè¡Œçš„æ¨¡å‹å‹ç¼©æŠ€æœ¯ã€‚&lt;/p>
&lt;p>&lt;strong>å®‰è£…æ–¹æ³•ï¼š&lt;/strong>&lt;/p>
&lt;pre>&lt;code class="language-bash">pip install &amp;quot;neural-compressor&amp;gt;=2.3&amp;quot; &amp;quot;transformers&amp;gt;=4.34.0&amp;quot; torch torchvision
&lt;/code>&lt;/pre>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯å’Œç¤ºä¾‹ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/intel/neural-compressor" target="_blank" rel="noopener" >Neural Compressor
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h2 id="æ¨¡å‹éƒ¨ç½²">æ¨¡å‹éƒ¨ç½²&lt;/h2>
&lt;p>å°†è®­ç»ƒå¥½çš„ LLM éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒè‡³å…³é‡è¦ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ LLM éƒ¨ç½²å·¥å…·ï¼š&lt;/p>
&lt;h3 id="vllm">vLLM&lt;/h3>
&lt;a href="https://github.com/vllm-project/vllm" target="_blank" class="card-github fetch-waiting no-styling"
repo="vllm-project/vllm" id="repo-nJTPt7skFc6Vwdho-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-nJTPt7skFc6Vwdho-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">vllm-project&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">vllm&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-nJTPt7skFc6Vwdho-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-nJTPt7skFc6Vwdho-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-nJTPt7skFc6Vwdho-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-nJTPt7skFc6Vwdho-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-nJTPt7skFc6Vwdho-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-nJTPt7skFc6Vwdho-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/vllm-project\/vllm', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-nJTPt7skFc6Vwdho-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-nJTPt7skFc6Vwdho-language').innerText = data.language;
document.getElementById('repo-nJTPt7skFc6Vwdho-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-nJTPt7skFc6Vwdho-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-nJTPt7skFc6Vwdho-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-nJTPt7skFc6Vwdho-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-nJTPt7skFc6Vwdho-license').classList.add = "no-license"
};
document.getElementById('repo-nJTPt7skFc6Vwdho-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for vllm-project\/vllm.")
}).catch(err => {
const c = document.getElementById('repo-nJTPt7skFc6Vwdho-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for vllm-project\/vllm.")
})
&lt;/script>
&lt;p>vLLM æ˜¯ä¸€ä¸ªå¿«é€Ÿã€æ˜“ç”¨çš„ LLM æ¨ç†æœåŠ¡åº“ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å¿«é€Ÿ&lt;/strong>
&lt;ul>
&lt;li>SOTA æœåŠ¡ååé‡&lt;/li>
&lt;li>åˆ©ç”¨ PagedAttention é«˜æ•ˆç®¡ç†æ³¨æ„åŠ›é”®å€¼å†…å­˜&lt;/li>
&lt;li>æŒç»­æ‰¹é‡å¤„ç†æ”¶åˆ°çš„è¯·æ±‚&lt;/li>
&lt;li>åˆ©ç”¨ CUDA/HIP å›¾è¿›è¡ŒåŠ é€Ÿ&lt;/li>
&lt;li>é‡åŒ–ï¼šæ”¯æŒ GPTQã€AWQã€SqueezeLLMã€FP8 KV é«˜é€Ÿç¼“å­˜&lt;/li>
&lt;li>ä¼˜åŒ–çš„ CUDA å†…æ ¸&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>çµæ´»&lt;/strong>
&lt;ul>
&lt;li>ä¸æµè¡Œçš„ Hugging Face æ¨¡å‹æ— ç¼é›†æˆ&lt;/li>
&lt;li>åˆ©ç”¨å„ç§è§£ç ç®—æ³•ï¼ˆåŒ…æ‹¬å¹¶è¡Œé‡‡æ ·ã€æ³¢æŸæœç´¢ç­‰ï¼‰æä¾›é«˜ååé‡æœåŠ¡&lt;/li>
&lt;li>ä¸ºåˆ†å¸ƒå¼æ¨ç†æä¾›å¼ é‡å¹¶è¡Œæ”¯æŒ&lt;/li>
&lt;li>æµè¾“å‡º&lt;/li>
&lt;li>å…¼å®¹ OpenAI çš„åº”ç”¨ç¨‹åºæ¥å£æœåŠ¡å™¨&lt;/li>
&lt;li>æ”¯æŒ NVIDIA GPUã€AMD GPUã€Intel CPU å’Œ GPU
-ï¼ˆå®éªŒæ€§ï¼‰æ”¯æŒå‰ç¼€ç¼“å­˜
-ï¼ˆè¯•éªŒæ€§ï¼‰æ”¯æŒå¤šç§è¯­è¨€&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>æ— ç¼æ”¯æŒ&lt;/strong>
&lt;ul>
&lt;li>åŸºäº Transformer çš„æ¨¡å‹ï¼Œä¾‹å¦‚ Llama&lt;/li>
&lt;li>åŸºäº MoE çš„æ¨¡å‹ï¼Œä¾‹å¦‚ Mixtral&lt;/li>
&lt;li>å¤šæ¨¡æ€æ¨¡å‹ï¼Œä¾‹å¦‚ LLaVA&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>å¿«é€Ÿå®‰è£…ï¼š&lt;/strong>&lt;/p>
&lt;pre>&lt;code class="language-bash">pip install vllm
&lt;/code>&lt;/pre>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ &lt;a class="link" href="https://vllm.readthedocs.io/en/latest/" target="_blank" rel="noopener" >vLLM
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
å®˜æ–¹æ–‡æ¡£ã€‚&lt;/p>
&lt;h3 id="sgl">SGL&lt;/h3>
&lt;a href="https://github.com/sgl-project/sglang" target="_blank" class="card-github fetch-waiting no-styling"
repo="sgl-project/sglang" id="repo-XiS46NyNt1nHwhro-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-XiS46NyNt1nHwhro-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">sgl-project&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">sglang&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-XiS46NyNt1nHwhro-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-XiS46NyNt1nHwhro-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-XiS46NyNt1nHwhro-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-XiS46NyNt1nHwhro-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-XiS46NyNt1nHwhro-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-XiS46NyNt1nHwhro-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/sgl-project\/sglang', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-XiS46NyNt1nHwhro-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-XiS46NyNt1nHwhro-language').innerText = data.language;
document.getElementById('repo-XiS46NyNt1nHwhro-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-XiS46NyNt1nHwhro-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-XiS46NyNt1nHwhro-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-XiS46NyNt1nHwhro-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-XiS46NyNt1nHwhro-license').classList.add = "no-license"
};
document.getElementById('repo-XiS46NyNt1nHwhro-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for sgl-project\/sglang.")
}).catch(err => {
const c = document.getElementById('repo-XiS46NyNt1nHwhro-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for sgl-project\/sglang.")
})
&lt;/script>
&lt;p>SGLang æ˜¯ä¸€ç§ç»“æ„åŒ–ç”Ÿæˆè¯­è¨€ï¼Œä¸“ä¸ºå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰è€Œè®¾è®¡ã€‚å®ƒé€šè¿‡å…±åŒè®¾è®¡å‰ç«¯è¯­è¨€å’Œè¿è¡Œç³»ç»Ÿï¼Œä½¿ä½ ä¸ LLMs çš„äº¤äº’æ›´å¿«ã€æ›´å¯æ§ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>çµæ´»çš„å‰ç«¯è¯­è¨€&lt;/strong>ï¼šé€šè¿‡é“¾å¼ç”Ÿæˆè°ƒç”¨ã€é«˜çº§æç¤ºã€æ§åˆ¶æµã€å¤šç§æ¨¡å¼ã€å¹¶è¡Œæ€§å’Œå¤–éƒ¨äº¤äº’ï¼Œå¯è½»æ¾ç¼–å†™ LLM åº”ç”¨ç¨‹åºã€‚&lt;/li>
&lt;li>&lt;strong>é«˜æ€§èƒ½åç«¯è¿è¡Œæ—¶&lt;/strong>ï¼šå…·æœ‰ RadixAttention åŠŸèƒ½ï¼Œå¯é€šè¿‡åœ¨å¤šæ¬¡è°ƒç”¨ä¸­é‡å¤ä½¿ç”¨ KV ç¼“å­˜æ¥åŠ é€Ÿå¤æ‚çš„ LLM ç¨‹åºã€‚å®ƒè¿˜å¯ä»¥ä½œä¸ºç‹¬ç«‹çš„æ¨ç†å¼•æ“ï¼Œå®ç°æ‰€æœ‰å¸¸ç”¨æŠ€æœ¯ï¼ˆå¦‚è¿ç»­æ‰¹å¤„ç†å’Œå¼ é‡å¹¶è¡Œï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/sgl-project/" target="_blank" rel="noopener" >SGL
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="skypilot">SkyPilot&lt;/h3>
&lt;a href="https://github.com/skypilot-org/skypilot" target="_blank" class="card-github fetch-waiting no-styling"
repo="skypilot-org/skypilot" id="repo-ryTS0x49ntzTY4yW-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-ryTS0x49ntzTY4yW-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">skypilot-org&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">skypilot&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-ryTS0x49ntzTY4yW-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-ryTS0x49ntzTY4yW-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-ryTS0x49ntzTY4yW-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-ryTS0x49ntzTY4yW-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-ryTS0x49ntzTY4yW-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-ryTS0x49ntzTY4yW-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/skypilot-org\/skypilot', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-ryTS0x49ntzTY4yW-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-ryTS0x49ntzTY4yW-language').innerText = data.language;
document.getElementById('repo-ryTS0x49ntzTY4yW-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-ryTS0x49ntzTY4yW-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-ryTS0x49ntzTY4yW-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-ryTS0x49ntzTY4yW-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-ryTS0x49ntzTY4yW-license').classList.add = "no-license"
};
document.getElementById('repo-ryTS0x49ntzTY4yW-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for skypilot-org\/skypilot.")
}).catch(err => {
const c = document.getElementById('repo-ryTS0x49ntzTY4yW-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for skypilot-org\/skypilot.")
})
&lt;/script>
&lt;p>SkyPilot æ˜¯ UC Berkeley RISELab æ¨å‡ºçš„çµæ´»çš„äº‘ç«¯ LLM éƒ¨ç½²å·¥å…·ï¼Œæ”¯æŒå¤šç§äº‘å¹³å°å’Œç¡¬ä»¶åŠ é€Ÿå™¨ï¼Œå¯ä»¥è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜çš„éƒ¨ç½²æ–¹æ¡ˆï¼Œå¹¶æä¾›æˆæœ¬ä¼˜åŒ–åŠŸèƒ½ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å¤šäº‘æ”¯æŒ:&lt;/strong> æ”¯æŒ AWS, GCP, Azure ç­‰å¤šç§äº‘å¹³å°ï¼Œæ–¹ä¾¿ç”¨æˆ·é€‰æ‹©åˆé€‚çš„éƒ¨ç½²ç¯å¢ƒã€‚&lt;/li>
&lt;li>&lt;strong>è½»æ¾æ‰©å±•&lt;/strong>ï¼šæ’é˜Ÿå’Œè¿è¡Œå¤šä¸ªä½œä¸šï¼Œè‡ªåŠ¨ç®¡ç†&lt;/li>
&lt;li>&lt;strong>è½»æ¾æ¥å…¥å¯¹è±¡å­˜å‚¨&lt;/strong>ï¼šè½»æ¾è®¿é—®å¯¹è±¡å­˜å‚¨ï¼ˆS3ã€GCSã€R2ï¼‰&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/skypilot-org/skypilot" target="_blank" rel="noopener" >SkyPilot
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="tensorrt-llm">TensorRT-LLM&lt;/h3>
&lt;a href="https://github.com/NVIDIA/TensorRT-LLM" target="_blank" class="card-github fetch-waiting no-styling"
repo="NVIDIA/TensorRT-LLM" id="repo-qjwxbVbVPsELdWkR-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-qjwxbVbVPsELdWkR-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">NVIDIA&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">TensorRT-LLM&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-qjwxbVbVPsELdWkR-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-qjwxbVbVPsELdWkR-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-qjwxbVbVPsELdWkR-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-qjwxbVbVPsELdWkR-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-qjwxbVbVPsELdWkR-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-qjwxbVbVPsELdWkR-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/NVIDIA\/TensorRT-LLM', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-qjwxbVbVPsELdWkR-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-qjwxbVbVPsELdWkR-language').innerText = data.language;
document.getElementById('repo-qjwxbVbVPsELdWkR-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-qjwxbVbVPsELdWkR-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-qjwxbVbVPsELdWkR-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-qjwxbVbVPsELdWkR-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-qjwxbVbVPsELdWkR-license').classList.add = "no-license"
};
document.getElementById('repo-qjwxbVbVPsELdWkR-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for NVIDIA\/TensorRT-LLM.")
}).catch(err => {
const c = document.getElementById('repo-qjwxbVbVPsELdWkR-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for NVIDIA\/TensorRT-LLM.")
})
&lt;/script>
&lt;p>TensorRT-LLM æ˜¯ NVIDIA æ¨å‡ºçš„é«˜æ€§èƒ½ LLM æ¨ç†å¼•æ“ï¼Œèƒ½å¤Ÿå……åˆ†åˆ©ç”¨ GPU åŠ é€Ÿè®¡ç®—ï¼Œå¹¶é’ˆå¯¹ Transformer æ¨¡å‹ç»“æ„è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¤§å¹…æå‡æ¨ç†é€Ÿåº¦ã€‚&lt;/p>
&lt;p>TensorRT-LLM ä¸ºç”¨æˆ·æä¾›äº†æ˜“äºä½¿ç”¨çš„ Python APIï¼Œç”¨äºå®šä¹‰å¤§å‹è¯­è¨€æ¨¡å‹ (LLMs) å’Œæ„å»º TensorRT å¼•æ“ï¼Œè¿™äº›å¼•æ“åŒ…å«æœ€å…ˆè¿›çš„ä¼˜åŒ–æŠ€æœ¯ï¼Œå¯åœ¨è‹±ä¼Ÿè¾¾â„¢ï¼ˆNVIDIAÂ®ï¼‰å›¾å½¢å¤„ç†å™¨ä¸Šé«˜æ•ˆæ‰§è¡Œæ¨ç†ã€‚TensorRT-LLM è¿˜åŒ…å«ç”¨äºåˆ›å»ºæ‰§è¡Œè¿™äº› TensorRT å¼•æ“çš„ Python å’Œ C++ è¿è¡Œæ—¶çš„ç»„ä»¶ã€‚&lt;/p>
&lt;p>è¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/NVIDIA/TensorRT-LLM" target="_blank" rel="noopener" >TensorRT-LLM
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="openvino">OpenVino&lt;/h3>
&lt;a href="https://github.com/openvinotoolkit/openvino" target="_blank" class="card-github fetch-waiting no-styling"
repo="openvinotoolkit/openvino" id="repo-dguIcuUXdtdTe3tk-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-dguIcuUXdtdTe3tk-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">openvinotoolkit&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">openvino&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-dguIcuUXdtdTe3tk-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-dguIcuUXdtdTe3tk-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-dguIcuUXdtdTe3tk-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-dguIcuUXdtdTe3tk-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-dguIcuUXdtdTe3tk-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-dguIcuUXdtdTe3tk-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/openvinotoolkit\/openvino', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-dguIcuUXdtdTe3tk-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-dguIcuUXdtdTe3tk-language').innerText = data.language;
document.getElementById('repo-dguIcuUXdtdTe3tk-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-dguIcuUXdtdTe3tk-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-dguIcuUXdtdTe3tk-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-dguIcuUXdtdTe3tk-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-dguIcuUXdtdTe3tk-license').classList.add = "no-license"
};
document.getElementById('repo-dguIcuUXdtdTe3tk-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for openvinotoolkit\/openvino.")
}).catch(err => {
const c = document.getElementById('repo-dguIcuUXdtdTe3tk-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for openvinotoolkit\/openvino.")
})
&lt;/script>
&lt;p>OpenVINOâ„¢ æ˜¯ç”¨äºä¼˜åŒ–å’Œéƒ¨ç½²äººå·¥æ™ºèƒ½æ¨ç†çš„å¼€æºå·¥å…·åŒ…ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>æ¨ç†ä¼˜åŒ–&lt;/strong>ï¼šæå‡æ·±åº¦å­¦ä¹ åœ¨è®¡ç®—æœºè§†è§‰ã€è‡ªåŠ¨è¯­éŸ³è¯†åˆ«ã€ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ã€ä½¿ç”¨å¤§å‹å’Œå°å‹è¯­è¨€æ¨¡å‹çš„è‡ªç„¶è¯­è¨€å¤„ç†ä»¥åŠè®¸å¤šå…¶ä»–å¸¸è§ä»»åŠ¡ä¸­çš„æ€§èƒ½ã€‚&lt;/li>
&lt;li>&lt;strong>çµæ´»çš„æ¨¡å‹æ”¯æŒ&lt;/strong>ï¼šä½¿ç”¨ TensorFlowã€PyTorchã€ONNXã€Keras å’Œ PaddlePaddle ç­‰æµè¡Œæ¡†æ¶è®­ç»ƒçš„æ¨¡å‹ã€‚æ— éœ€åŸå§‹æ¡†æ¶å³å¯è½¬æ¢å’Œéƒ¨ç½²æ¨¡å‹ã€‚&lt;/li>
&lt;li>&lt;strong>å¹¿æ³›çš„å¹³å°å…¼å®¹æ€§&lt;/strong>ï¼šå‡å°‘èµ„æºéœ€æ±‚ï¼Œåœ¨ä»è¾¹ç¼˜åˆ°äº‘çš„ä¸€ç³»åˆ—å¹³å°ä¸Šé«˜æ•ˆéƒ¨ç½²ã€‚OpenVINOâ„¢ æ”¯æŒåœ¨ CPUï¼ˆx86ã€ARMï¼‰ã€GPUï¼ˆæ”¯æŒ OpenCL çš„é›†æˆå’Œç‹¬ç«‹ GPUï¼‰å’Œ AI åŠ é€Ÿå™¨ï¼ˆè‹±ç‰¹å°” NPUï¼‰ä¸Šè¿›è¡Œæ¨ç†ã€‚&lt;/li>
&lt;li>&lt;strong>ç¤¾åŒºå’Œç”Ÿæ€ç³»ç»Ÿ&lt;/strong>ï¼šåŠ å…¥ä¸€ä¸ªæ´»è·ƒçš„ç¤¾åŒºï¼Œä¸ºæé«˜å„ä¸ªé¢†åŸŸçš„æ·±åº¦å­¦ä¹ æ€§èƒ½åšå‡ºè´¡çŒ®ã€‚&lt;/li>
&lt;/ul>
&lt;p>è¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/openvinotoolkit/openvino" target="_blank" rel="noopener" >OpenVino
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="tgi">TGI&lt;/h3>
&lt;a href="https://github.com/huggingface/text-generation-inference" target="_blank" class="card-github fetch-waiting no-styling"
repo="huggingface/text-generation-inference" id="repo-g31CtAAjF8I3WHBi-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-g31CtAAjF8I3WHBi-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">huggingface&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">text-generation-inference&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-g31CtAAjF8I3WHBi-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-g31CtAAjF8I3WHBi-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-g31CtAAjF8I3WHBi-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-g31CtAAjF8I3WHBi-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-g31CtAAjF8I3WHBi-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-g31CtAAjF8I3WHBi-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/huggingface\/text-generation-inference', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-g31CtAAjF8I3WHBi-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-g31CtAAjF8I3WHBi-language').innerText = data.language;
document.getElementById('repo-g31CtAAjF8I3WHBi-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-g31CtAAjF8I3WHBi-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-g31CtAAjF8I3WHBi-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-g31CtAAjF8I3WHBi-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-g31CtAAjF8I3WHBi-license').classList.add = "no-license"
};
document.getElementById('repo-g31CtAAjF8I3WHBi-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for huggingface\/text-generation-inference.")
}).catch(err => {
const c = document.getElementById('repo-g31CtAAjF8I3WHBi-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for huggingface\/text-generation-inference.")
})
&lt;/script>
&lt;p>æ–‡æœ¬ç”Ÿæˆæ¨ç†ï¼ˆTGIï¼‰æ˜¯ä¸€ä¸ªç”¨äºéƒ¨ç½²å’ŒæœåŠ¡å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰çš„å·¥å…·åŒ…ã€‚TGI å¯ä¸ºæœ€æµè¡Œçš„å¼€æº LLMs å®ç°é«˜æ€§èƒ½æ–‡æœ¬ç”Ÿæˆï¼ŒåŒ…æ‹¬ Llamaã€Falconã€StarCoderã€BLOOMã€GPT-NeoX ç­‰ã€‚&lt;/p>
&lt;p>TGI å®ç°äº†è®¸å¤šåŠŸèƒ½ï¼Œå¯ä»¥åœ¨ &lt;a class="link" href="https://github.com/huggingface/text-generation-inference" target="_blank" rel="noopener" >TGI
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µä¸Šæ‰¾åˆ°è¯¦ç»†ä¿¡æ¯ã€‚&lt;/p>
&lt;h2 id="æœ¬åœ°è¿è¡Œ">æœ¬åœ°è¿è¡Œ&lt;/h2>
&lt;p>å¾—ç›Šäºæ¨¡å‹å‹ç¼©å’Œä¼˜åŒ–æŠ€æœ¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä¸ªäººè®¾å¤‡ä¸Šè¿è¡Œ LLMï¼š&lt;/p>
&lt;h3 id="mlx">MLX&lt;/h3>
&lt;a href="https://github.com/ml-explore/mlx" target="_blank" class="card-github fetch-waiting no-styling"
repo="ml-explore/mlx" id="repo-aBdOtvs36A8UEMUP-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-aBdOtvs36A8UEMUP-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">ml-explore&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">mlx&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-aBdOtvs36A8UEMUP-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-aBdOtvs36A8UEMUP-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-aBdOtvs36A8UEMUP-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-aBdOtvs36A8UEMUP-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-aBdOtvs36A8UEMUP-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-aBdOtvs36A8UEMUP-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/ml-explore\/mlx', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-aBdOtvs36A8UEMUP-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-aBdOtvs36A8UEMUP-language').innerText = data.language;
document.getElementById('repo-aBdOtvs36A8UEMUP-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-aBdOtvs36A8UEMUP-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-aBdOtvs36A8UEMUP-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-aBdOtvs36A8UEMUP-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-aBdOtvs36A8UEMUP-license').classList.add = "no-license"
};
document.getElementById('repo-aBdOtvs36A8UEMUP-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for ml-explore\/mlx.")
}).catch(err => {
const c = document.getElementById('repo-aBdOtvs36A8UEMUP-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for ml-explore\/mlx.")
})
&lt;/script>
&lt;p>MLX æ˜¯ä¸€ä¸ªä¸“é—¨æ”¯æŒåœ¨ Apple è®¾å¤‡ä¸Šè¿è¡Œ LLM çš„æ¡†æ¶ï¼Œå……åˆ†åˆ©ç”¨ Metal åŠ é€Ÿè®¡ç®—ï¼Œå¹¶æä¾›ç®€å•æ˜“ç”¨çš„ APIï¼Œæ–¹ä¾¿å¼€å‘è€…å°† LLM é›†æˆåˆ° iOS åº”ç”¨ä¸­.&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ç›¸ä¼¼çš„åº”ç”¨ç¨‹åºæ¥å£&lt;/strong>ï¼šMLX çš„ Python API ä¸ NumPy éå¸¸ç›¸ä¼¼ã€‚MLX è¿˜æ‹¥æœ‰åŠŸèƒ½é½å…¨çš„ C++ã€C å’Œ Swift APIï¼Œè¿™äº› API ä¸ Python API éå¸¸ç›¸ä¼¼ã€‚MLX æ‹¥æœ‰æ›´é«˜çº§åˆ«çš„è½¯ä»¶åŒ…ï¼Œå¦‚ &lt;code>mlx.nn&lt;/code> å’Œ &lt;code>mlx.optimizers&lt;/code> ï¼Œå…¶ API ä¸ PyTorch éå¸¸æ¥è¿‘ï¼Œå¯ç®€åŒ–æ›´å¤æ‚æ¨¡å‹çš„æ„å»ºã€‚&lt;/li>
&lt;li>&lt;strong>å¯ç»„åˆå‡½æ•°å˜æ¢&lt;/strong>ï¼šMLX æ”¯æŒç”¨äºè‡ªåŠ¨å¾®åˆ†ã€è‡ªåŠ¨çŸ¢é‡åŒ–å’Œè®¡ç®—å›¾ä¼˜åŒ–çš„å¯ç»„åˆå‡½æ•°å˜æ¢ã€‚&lt;/li>
&lt;li>&lt;strong>æ‡’è®¡ç®—&lt;/strong>ï¼šMLX ä¸­çš„è®¡ç®—åªæœ‰åœ¨éœ€è¦æ—¶æ‰å°†æ•°ç»„å®ä½“åŒ–ã€‚&lt;/li>
&lt;li>&lt;strong>åŠ¨æ€å›¾æ„å»º&lt;/strong>ï¼šMLX ä¸­çš„è®¡ç®—å›¾å½¢æ˜¯åŠ¨æ€æ„å»ºçš„ã€‚æ”¹å˜å‡½æ•°å‚æ•°çš„å½¢çŠ¶ä¸ä¼šå¯¼è‡´ç¼–è¯‘é€Ÿåº¦å˜æ…¢ï¼Œè€Œä¸”è°ƒè¯•ç®€å•ç›´è§‚ã€‚&lt;/li>
&lt;li>&lt;strong>å¤šè®¾å¤‡&lt;/strong>ï¼šæ“ä½œå¯åœ¨ä»»ä½•æ”¯æŒçš„è®¾å¤‡ï¼ˆç›®å‰æ˜¯ CPU å’Œ GPUï¼‰ä¸Šè¿è¡Œã€‚&lt;/li>
&lt;li>&lt;strong>ç»Ÿä¸€å†…å­˜&lt;/strong>ï¼šç»Ÿä¸€å†…å­˜æ¨¡å‹æ˜¯ MLX ä¸å…¶ä»–æ¡†æ¶çš„ä¸€ä¸ªæ˜¾è‘—åŒºåˆ«ã€‚MLX ä¸­çš„é˜µåˆ—ä½äºå…±äº«å†…å­˜ä¸­ã€‚å¯¹ MLX æ•°ç»„çš„æ“ä½œå¯åœ¨ä»»ä½•æ”¯æŒçš„è®¾å¤‡ç±»å‹ä¸Šæ‰§è¡Œï¼Œè€Œæ— éœ€ä¼ è¾“æ•°æ®ã€‚&lt;/li>
&lt;/ul>
&lt;p>MLX æ˜¯æœºå™¨å­¦ä¹ ç ”ç©¶äººå‘˜ä¸ºæœºå™¨å­¦ä¹ ç ”ç©¶äººå‘˜è®¾è®¡çš„ã€‚è¯¥æ¡†æ¶æ—¨åœ¨æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œä½†ä»èƒ½é«˜æ•ˆåœ°è®­ç»ƒå’Œéƒ¨ç½²æ¨¡å‹ã€‚æ¡†æ¶æœ¬èº«çš„è®¾è®¡æ¦‚å¿µä¹Ÿå¾ˆç®€å•ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®©ç ”ç©¶äººå‘˜èƒ½å¤Ÿè½»æ¾æ‰©å±•å’Œæ”¹è¿› MLXï¼Œä»è€Œå¿«é€Ÿæ¢ç´¢æ–°æ€è·¯ã€‚æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/ml-explore/mlx" target="_blank" rel="noopener" >MLX
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="llamacpp">Llama.cpp&lt;/h3>
&lt;p>Llama.cpp æ˜¯ä½¿ç”¨ C++ å®ç°çš„ Llama æ¨¡å‹æ¨ç†å¼•æ“ï¼Œå¯ä»¥åœ¨ CPU ä¸Šé«˜æ•ˆè¿è¡Œï¼Œå¹¶æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶å¹³å°ï¼Œæ–¹ä¾¿å¼€å‘è€…åœ¨èµ„æºå—é™çš„è®¾å¤‡ä¸Šè¿è¡Œ LLMã€‚&lt;/p>
&lt;a href="https://github.com/ggerganov/llama.cpp" target="_blank" class="card-github fetch-waiting no-styling"
repo="ggerganov/llama.cpp" id="repo-nxuCVpVeb4Nv0H4c-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-nxuCVpVeb4Nv0H4c-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">ggerganov&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">llama.cpp&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-nxuCVpVeb4Nv0H4c-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-nxuCVpVeb4Nv0H4c-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-nxuCVpVeb4Nv0H4c-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-nxuCVpVeb4Nv0H4c-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-nxuCVpVeb4Nv0H4c-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-nxuCVpVeb4Nv0H4c-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/ggerganov\/llama.cpp', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-nxuCVpVeb4Nv0H4c-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-nxuCVpVeb4Nv0H4c-language').innerText = data.language;
document.getElementById('repo-nxuCVpVeb4Nv0H4c-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-nxuCVpVeb4Nv0H4c-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-nxuCVpVeb4Nv0H4c-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-nxuCVpVeb4Nv0H4c-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-nxuCVpVeb4Nv0H4c-license').classList.add = "no-license"
};
document.getElementById('repo-nxuCVpVeb4Nv0H4c-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for ggerganov\/llama.cpp.")
}).catch(err => {
const c = document.getElementById('repo-nxuCVpVeb4Nv0H4c-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for ggerganov\/llama.cpp.")
})
&lt;/script>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>CPU æ¨ç†:&lt;/strong> é’ˆå¯¹ CPU å¹³å°è¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥åœ¨æ²¡æœ‰ GPU çš„è®¾å¤‡ä¸Šè¿è¡Œ LLMã€‚&lt;/li>
&lt;li>&lt;strong>è·¨å¹³å°æ”¯æŒ:&lt;/strong> æ”¯æŒ Linux, macOS, Windows ç­‰å¤šç§æ“ä½œç³»ç»Ÿï¼Œæ–¹ä¾¿ç”¨æˆ·åœ¨ä¸åŒå¹³å°ä¸Šä½¿ç”¨ã€‚&lt;/li>
&lt;li>&lt;strong>è½»é‡çº§éƒ¨ç½²:&lt;/strong> ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶ä½“ç§¯å°ï¼Œæ–¹ä¾¿ç”¨æˆ·éƒ¨ç½²å’Œä½¿ç”¨.&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/ggerganov/llama.cpp" target="_blank" rel="noopener" >Llama.cpp
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="ollama">Ollama&lt;/h3>
&lt;a href="https://github.com/ollama/ollama" target="_blank" class="card-github fetch-waiting no-styling"
repo="ollama/ollama" id="repo-ENWJWceuuaRFLRyT-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-ENWJWceuuaRFLRyT-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">ollama&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">ollama&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-ENWJWceuuaRFLRyT-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-ENWJWceuuaRFLRyT-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-ENWJWceuuaRFLRyT-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-ENWJWceuuaRFLRyT-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-ENWJWceuuaRFLRyT-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-ENWJWceuuaRFLRyT-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/ollama\/ollama', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-ENWJWceuuaRFLRyT-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-ENWJWceuuaRFLRyT-language').innerText = data.language;
document.getElementById('repo-ENWJWceuuaRFLRyT-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-ENWJWceuuaRFLRyT-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-ENWJWceuuaRFLRyT-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-ENWJWceuuaRFLRyT-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-ENWJWceuuaRFLRyT-license').classList.add = "no-license"
};
document.getElementById('repo-ENWJWceuuaRFLRyT-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for ollama\/ollama.")
}).catch(err => {
const c = document.getElementById('repo-ENWJWceuuaRFLRyT-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for ollama\/ollama.")
})
&lt;/script>
&lt;p>åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/ollama/" >ã€Ollamaï¼šä»å…¥é—¨åˆ°è¿›é˜¶ã€‘
&lt;/a>
ä¸€æ–‡ä¸­ä»‹ç»è¿‡ï¼ŒOllama æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºå¤§å‹è¯­è¨€æ¨¡å‹åº”ç”¨çš„å·¥å…·ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç®€æ´æ˜“ç”¨çš„å‘½ä»¤è¡Œç•Œé¢å’ŒæœåŠ¡å™¨ï¼Œè®©ä½ èƒ½å¤Ÿè½»æ¾ä¸‹è½½ã€è¿è¡Œå’Œç®¡ç†å„ç§å¼€æº LLMã€‚ä¸éœ€è¦å¤æ‚é…ç½®å’Œå¼ºå¤§ç¡¬ä»¶çš„ä¼ ç»Ÿ LLM ä¸åŒï¼ŒOllama è®©ä½ èƒ½å¤Ÿæ–¹ä¾¿åœ°åƒä½¿ç”¨æ‰‹æœº App ä¸€æ ·ä½“éªŒ LLM çš„å¼ºå¤§åŠŸèƒ½ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ç®€å•æ˜“ç”¨&lt;/strong>ï¼šOllama æä¾›äº†ä¸€ä¸ªç®€æ´æ˜“ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ–¹ä¾¿ç”¨æˆ·ä¸‹è½½ã€è¿è¡Œå’Œç®¡ç† LLMã€‚&lt;/li>
&lt;li>&lt;strong>å¤šç§æ¨¡å‹&lt;/strong>ï¼šOllama æ”¯æŒå¤šç§å¼€æº LLMï¼ŒåŒ…æ‹¬ Qwen2ã€Llama3ã€Mistral ç­‰ã€‚&lt;/li>
&lt;li>&lt;strong>å…¼å®¹ OpenAI æ¥å£&lt;/strong>ï¼šOllama æ”¯æŒ OpenAI API æ¥å£ï¼Œä¾¿äºåˆ‡æ¢åŸæœ‰åº”ç”¨åˆ° Ollama ä¸Šã€‚&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/ollama/ollama" target="_blank" rel="noopener" >Ollama
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h2 id="agent-åŠ-rag-æ¡†æ¶">Agent åŠ RAG æ¡†æ¶&lt;/h2>
&lt;p>å°† LLM ä¸å¤–éƒ¨æ•°æ®å’Œå·¥å…·ç»“åˆï¼Œå¯ä»¥æ„å»ºæ›´å¼ºå¤§çš„åº”ç”¨ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ Agent åŠ RAG æ¡†æ¶ï¼š&lt;/p>
&lt;h3 id="llamaindex">LlamaIndex&lt;/h3>
&lt;a href="https://github.com/run-llama/llama_index" target="_blank" class="card-github fetch-waiting no-styling"
repo="run-llama/llama_index" id="repo-PC9mgYiikqIPmX4n-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-PC9mgYiikqIPmX4n-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">run-llama&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">llama_index&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-PC9mgYiikqIPmX4n-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-PC9mgYiikqIPmX4n-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-PC9mgYiikqIPmX4n-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-PC9mgYiikqIPmX4n-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-PC9mgYiikqIPmX4n-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-PC9mgYiikqIPmX4n-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/run-llama\/llama_index', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-PC9mgYiikqIPmX4n-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-PC9mgYiikqIPmX4n-language').innerText = data.language;
document.getElementById('repo-PC9mgYiikqIPmX4n-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-PC9mgYiikqIPmX4n-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-PC9mgYiikqIPmX4n-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-PC9mgYiikqIPmX4n-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-PC9mgYiikqIPmX4n-license').classList.add = "no-license"
};
document.getElementById('repo-PC9mgYiikqIPmX4n-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for run-llama\/llama_index.")
}).catch(err => {
const c = document.getElementById('repo-PC9mgYiikqIPmX4n-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for run-llama\/llama_index.")
})
&lt;/script>
&lt;p>LlamaIndexï¼ˆGPT ç´¢å¼•ï¼‰æ˜¯ç”¨äº LLM åº”ç”¨ç¨‹åºçš„æ•°æ®æ¡†æ¶ã€‚ä½¿ç”¨ LlamaIndex æ„å»ºåº”ç”¨ç¨‹åºé€šå¸¸éœ€è¦ä½¿ç”¨ LlamaIndex æ ¸å¿ƒå’Œä¸€ç»„é€‰å®šçš„é›†æˆï¼ˆæˆ–æ’ä»¶ï¼‰ã€‚åœ¨ Python ä¸­ä½¿ç”¨ LlamaIndex æ„å»ºåº”ç”¨ç¨‹åºæœ‰ä¸¤ç§æ–¹æ³•ï¼š&lt;/p>
&lt;ul>
&lt;li>å¯åŠ¨å™¨ï¼š &lt;code>llama-index&lt;/code> ( &lt;a class="link" href="https://pypi.org/project/llama-index/" target="_blank" rel="noopener" >https://pypi.org/project/llama-index/
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
)ã€‚Python å…¥é—¨åŒ…ï¼ŒåŒ…æ‹¬æ ¸å¿ƒ LlamaIndex ä»¥åŠéƒ¨åˆ†é›†æˆã€‚&lt;/li>
&lt;li>å®šåˆ¶åŒ–ï¼š&lt;code>llama-index-core&lt;/code> ( &lt;a class="link" href="https://pypi.org/project/llama-index-core/" target="_blank" rel="noopener" >https://pypi.org/project/llama-index-core/
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
)ã€‚å®‰è£…æ ¸å¿ƒ LlamaIndexï¼Œå¹¶åœ¨ LlamaHub ä¸Šæ·»åŠ åº”ç”¨ç¨‹åºæ‰€éœ€çš„ LlamaIndex é›†æˆåŒ…ã€‚ç›®å‰æœ‰ 300 å¤šä¸ª LlamaIndex é›†æˆåŒ…å¯ä¸æ ¸å¿ƒæ— ç¼åä½œï¼Œè®©ä½ å¯ä»¥ä½¿ç”¨è‡ªå·±å–œæ¬¢çš„ LLMã€åµŒå…¥å’Œå‘é‡å­˜å‚¨æ•°æ®åº“è¿›è¡Œæ„å»º&lt;/li>
&lt;/ul>
&lt;p>LlamaIndex Python åº“æ˜¯ä»¥åå­—å‘½åçš„ï¼Œå› æ­¤åŒ…å« &lt;code>core&lt;/code> çš„å¯¼å…¥è¯­å¥æ„å‘³ç€ä½¿ç”¨çš„æ˜¯æ ¸å¿ƒåŒ…ã€‚ç›¸åï¼Œé‚£äº›ä¸å« &lt;code>core&lt;/code> çš„è¯­å¥åˆ™æ„å‘³ç€ä½¿ç”¨çš„æ˜¯é›†æˆåŒ…ã€‚&lt;/p>
&lt;pre>&lt;code class="language-python"># typical pattern
from llama_index.core.xxx import ClassABC # core submodule xxx
from llama_index.xxx.yyy import (
SubclassABC,
) # integration yyy for submodule xxx
# concrete example
from llama_index.core.llms import LLM
from llama_index.llms.openai import OpenAI
&lt;/code>&lt;/pre>
&lt;h3 id="crewai">CrewAI&lt;/h3>
&lt;a href="https://github.com/joaomdmoura/crewAI" target="_blank" class="card-github fetch-waiting no-styling"
repo="joaomdmoura/crewAI" id="repo-trtBEg2PjAxKCIPc-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-trtBEg2PjAxKCIPc-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">joaomdmoura&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">crewAI&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-trtBEg2PjAxKCIPc-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-trtBEg2PjAxKCIPc-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-trtBEg2PjAxKCIPc-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-trtBEg2PjAxKCIPc-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-trtBEg2PjAxKCIPc-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-trtBEg2PjAxKCIPc-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/joaomdmoura\/crewAI', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-trtBEg2PjAxKCIPc-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-trtBEg2PjAxKCIPc-language').innerText = data.language;
document.getElementById('repo-trtBEg2PjAxKCIPc-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-trtBEg2PjAxKCIPc-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-trtBEg2PjAxKCIPc-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-trtBEg2PjAxKCIPc-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-trtBEg2PjAxKCIPc-license').classList.add = "no-license"
};
document.getElementById('repo-trtBEg2PjAxKCIPc-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for joaomdmoura\/crewAI.")
}).catch(err => {
const c = document.getElementById('repo-trtBEg2PjAxKCIPc-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for joaomdmoura\/crewAI.")
})
&lt;/script>
&lt;p>CrewAI æ˜¯ä¸€ä¸ªæ„å»º AI Agent çš„æ¡†æ¶ï¼Œå¯ä»¥å°† LLM ä¸å…¶ä»–å·¥å…·å’Œ API é›†æˆï¼Œå®ç°æ›´å¤æ‚çš„ä»»åŠ¡ï¼Œä¾‹å¦‚è‡ªåŠ¨æ‰§è¡Œç½‘é¡µæ“ä½œã€ç”Ÿæˆä»£ç ç­‰ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>åŸºäºè§’è‰²çš„æ™ºèƒ½ä½“è®¾è®¡&lt;/strong>ï¼šä½ å¯ä»¥ä½¿ç”¨ç‰¹å®šçš„è§’è‰²ã€ç›®æ ‡å’Œå·¥å…·æ¥è‡ªå®šä¹‰æ™ºèƒ½ä½“ã€‚&lt;/li>
&lt;li>&lt;strong>è‡ªä¸»æ™ºèƒ½ä½“é—´å§”æ‰˜&lt;/strong>ï¼šæ™ºèƒ½ä½“å¯ä»¥è‡ªä¸»åœ°å°†ä»»åŠ¡å§”æ‰˜ç»™å…¶ä»–æ™ºèƒ½ä½“ï¼Œå¹¶ç›¸äº’æŸ¥è¯¢ä¿¡æ¯ï¼Œä»è€Œæé«˜è§£å†³é—®é¢˜çš„æ•ˆç‡ã€‚&lt;/li>
&lt;li>&lt;strong>çµæ´»çš„ä»»åŠ¡ç®¡ç†&lt;/strong>ï¼šå¯ä»¥ä½¿ç”¨å¯å®šåˆ¶çš„å·¥å…·æ¥å®šä¹‰ä»»åŠ¡ï¼Œå¹¶åŠ¨æ€åœ°å°†ä»»åŠ¡åˆ†é…ç»™æ™ºèƒ½ä½“ã€‚&lt;/li>
&lt;li>&lt;strong>æµç¨‹é©±åŠ¨&lt;/strong>ï¼šè¯¥ç³»ç»Ÿä»¥æµç¨‹ä¸ºä¸­å¿ƒï¼Œç›®å‰æ”¯æŒæŒ‰é¡ºåºæ‰§è¡Œä»»åŠ¡å’Œåˆ†å±‚æµç¨‹ã€‚æœªæ¥è¿˜ä¼šæ”¯æŒæ›´å¤æ‚çš„æµç¨‹ï¼Œä¾‹å¦‚åå•†å’Œè‡ªä¸»æµç¨‹ã€‚&lt;/li>
&lt;li>&lt;strong>ä¿å­˜è¾“å‡ºä¸ºæ–‡ä»¶&lt;/strong>ï¼šå¯ä»¥å°†å•ä¸ªä»»åŠ¡çš„è¾“å‡ºä¿å­˜ä¸ºæ–‡ä»¶ï¼Œä»¥ä¾¿ä»¥åä½¿ç”¨ã€‚&lt;/li>
&lt;li>&lt;strong>å°†è¾“å‡ºè§£æä¸º Pydantic æˆ– Json&lt;/strong>ï¼šå¯ä»¥å°†å•ä¸ªä»»åŠ¡çš„è¾“å‡ºè§£æä¸º Pydantic æ¨¡å‹æˆ– Json æ ¼å¼ï¼Œä»¥ä¾¿äºåç»­å¤„ç†å’Œåˆ†æã€‚&lt;/li>
&lt;li>&lt;strong>æ”¯æŒå¼€æºæ¨¡å‹&lt;/strong>ï¼šå¯ä»¥ä½¿ç”¨ OpenAI æˆ–å…¶ä»–å¼€æºæ¨¡å‹æ¥è¿è¡Œæ‚¨çš„æ™ºèƒ½ä½“å›¢é˜Ÿã€‚æ›´å¤šå…³äºé…ç½®æ™ºèƒ½ä½“ä¸æ¨¡å‹è¿æ¥çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¦‚ä½•è¿æ¥åˆ°æœ¬åœ°è¿è¡Œçš„æ¨¡å‹ï¼Œè¯·å‚é˜…&lt;a class="link" href="https://docs.crewai.com/how-to/LLM-Connections/" target="_blank" rel="noopener" >å°† crewAI è¿æ¥åˆ°å¤§å‹è¯­è¨€æ¨¡å‹
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/joaomdmoura/crewAI" target="_blank" rel="noopener" >CrewAI
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="opendevin">OpenDevin&lt;/h3>
&lt;a href="https://github.com/opendevin/opendevin" target="_blank" class="card-github fetch-waiting no-styling"
repo="opendevin/opendevin" id="repo-5GGGYdG5RLhGtGsB-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-5GGGYdG5RLhGtGsB-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">opendevin&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">opendevin&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-5GGGYdG5RLhGtGsB-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-5GGGYdG5RLhGtGsB-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-5GGGYdG5RLhGtGsB-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-5GGGYdG5RLhGtGsB-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-5GGGYdG5RLhGtGsB-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-5GGGYdG5RLhGtGsB-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/opendevin\/opendevin', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-5GGGYdG5RLhGtGsB-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-5GGGYdG5RLhGtGsB-language').innerText = data.language;
document.getElementById('repo-5GGGYdG5RLhGtGsB-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-5GGGYdG5RLhGtGsB-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-5GGGYdG5RLhGtGsB-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-5GGGYdG5RLhGtGsB-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-5GGGYdG5RLhGtGsB-license').classList.add = "no-license"
};
document.getElementById('repo-5GGGYdG5RLhGtGsB-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for opendevin\/opendevin.")
}).catch(err => {
const c = document.getElementById('repo-5GGGYdG5RLhGtGsB-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for opendevin\/opendevin.")
})
&lt;/script>
&lt;p>OpenDevin æ˜¯ä¸€ä¸ªç”±äººå·¥æ™ºèƒ½å’Œ LLMs é©±åŠ¨çš„è‡ªä¸»è½¯ä»¶å·¥ç¨‹å¸ˆå¹³å°ã€‚&lt;/p>
&lt;p>OpenDevin æ™ºèƒ½ä½“ä¸äººç±»å¼€å‘äººå‘˜åˆä½œç¼–å†™ä»£ç ã€ä¿®å¤é”™è¯¯å’Œå‘å¸ƒåŠŸèƒ½ã€‚&lt;/p>
&lt;p>è¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/opendevin/opendevin" target="_blank" rel="noopener" >OpenDevin
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h2 id="æ¨¡å‹è¯„æµ‹">æ¨¡å‹è¯„æµ‹&lt;/h2>
&lt;p>ä¸ºäº†é€‰æ‹©åˆé€‚çš„ LLM å¹¶è¯„ä¼°å…¶æ€§èƒ½ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ¨¡å‹è¯„æµ‹ï¼š&lt;/p>
&lt;h3 id="lmsys">LMSys&lt;/h3>
&lt;p>LMSys Org æ˜¯ç”±åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡çš„å­¦ç”Ÿå’Œæ•™å¸ˆä¸åŠ å·å¤§å­¦åœ£åœ°äºšå“¥åˆ†æ ¡ä»¥åŠå¡å†…åŸºæ¢…éš†å¤§å­¦åˆä½œæˆç«‹çš„å¼€æ”¾å¼ç ”ç©¶ç»„ç»‡ã€‚&lt;/p>
&lt;p>ç›®æ ‡æ˜¯é€šè¿‡å…±åŒå¼€å‘å¼€æ”¾æ¨¡å‹ã€æ•°æ®é›†ã€ç³»ç»Ÿå’Œè¯„ä¼°å·¥å…·ï¼Œä½¿å¤§å‹æ¨¡å‹å¯¹æ¯ä¸ªäººéƒ½å¯è®¿é—®ã€‚è®­ç»ƒå¤§å‹è¯­è¨€æ¨¡å‹å¹¶å¹¿æ³›æä¾›å®ƒä»¬çš„åº”ç”¨ï¼ŒåŒæ—¶ä¹Ÿåœ¨å¼€å‘åˆ†å¸ƒå¼ç³»ç»Ÿä»¥åŠ é€Ÿå®ƒä»¬çš„è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹ã€‚&lt;/p>
&lt;p>ç›®å‰ï¼ŒLMSys Chatbot Area æ˜¯æœ€è¢«è®¤å¯çš„å¤§æ¨¡å‹æ’è¡Œæ¦œä¹‹ä¸€ï¼Œå—å¤šå®¶å…¬å¸å’Œç ”ç©¶æœºæ„çš„è®¤å¯ã€‚&lt;/p>
&lt;p>æ’è¡Œæ¦œåœ°å€ï¼š&lt;a class="link" href="https://arena.lmsys.org/" target="_blank" rel="noopener" >https://arena.lmsys.org/
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;h3 id="opencompass">OpenCompass&lt;/h3>
&lt;p>OpenCompass æ˜¯ä¸€ä¸ª LLM è¯„ä¼°å¹³å°ï¼Œæ”¯æŒ 100 å¤šä¸ªæ•°æ®é›†ä¸Šçš„å„ç§æ¨¡å‹ï¼ˆLlama3ã€Mistralã€InternLM2ã€GPT-4ã€LLaMa2ã€Qwenã€GLMã€Claude ç­‰ï¼‰ã€‚&lt;/p>
&lt;a href="https://github.com/open-compass/opencompass" target="_blank" class="card-github fetch-waiting no-styling"
repo="open-compass/opencompass" id="repo-FWR4G6AugDRExSh1-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-FWR4G6AugDRExSh1-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">open-compass&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">opencompass&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-FWR4G6AugDRExSh1-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-FWR4G6AugDRExSh1-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-FWR4G6AugDRExSh1-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-FWR4G6AugDRExSh1-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-FWR4G6AugDRExSh1-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-FWR4G6AugDRExSh1-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/open-compass\/opencompass', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-FWR4G6AugDRExSh1-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-FWR4G6AugDRExSh1-language').innerText = data.language;
document.getElementById('repo-FWR4G6AugDRExSh1-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-FWR4G6AugDRExSh1-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-FWR4G6AugDRExSh1-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-FWR4G6AugDRExSh1-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-FWR4G6AugDRExSh1-license').classList.add = "no-license"
};
document.getElementById('repo-FWR4G6AugDRExSh1-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for open-compass\/opencompass.")
}).catch(err => {
const c = document.getElementById('repo-FWR4G6AugDRExSh1-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for open-compass\/opencompass.")
})
&lt;/script>
&lt;h3 id="open-llm-leaderboard">Open LLM Leaderboard&lt;/h3>
&lt;p>Open LLM Leaderboard æ˜¯ä¸€ä¸ªæŒç»­æ›´æ–°çš„ LLM æ’è¡Œæ¦œï¼Œæ ¹æ®å¤šä¸ªè¯„æµ‹æŒ‡æ ‡å¯¹ä¸åŒæ¨¡å‹è¿›è¡Œæ’åï¼Œæ–¹ä¾¿å¼€å‘è€…äº†è§£æœ€æ–°çš„æ¨¡å‹æ€§èƒ½å’Œå‘å±•è¶‹åŠ¿ã€‚&lt;/p>
&lt;p>æ’è¡Œæ¦œåœ°å€ï¼š&lt;a class="link" href="https://huggingface.co/spaces/open-llm-leaderboard/open_llm_leaderboard" target="_blank" rel="noopener" >https://huggingface.co/spaces/open-llm-leaderboard/open_llm_leaderboard
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;p>LLM ç”Ÿæ€æ­£åœ¨è“¬å‹ƒå‘å±•ï¼Œæ¶µç›–äº†ä»æ¨¡å‹è®­ç»ƒåˆ°åº”ç”¨è½åœ°çš„å„ä¸ªç¯èŠ‚ã€‚ç›¸ä¿¡éšç€æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥ï¼ŒLLM å°†ä¼šåœ¨æ›´å¤šé¢†åŸŸå‘æŒ¥é‡è¦ä½œç”¨ï¼Œä¸ºæˆ‘ä»¬å¸¦æ¥æ›´åŠ æ™ºèƒ½çš„åº”ç”¨ä½“éªŒã€‚&lt;/p></description></item><item><title>RDMA ä¹‹ Memory Window</title><link>https://cuterwrite.top/p/rdma-memory-window/</link><pubDate>Wed, 26 Jun 2024 23:55:00 +0000</pubDate><guid>https://cuterwrite.top/p/rdma-memory-window/</guid><description>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-16_116373724_p0_master1200.webp" alt="Featured image of post RDMA ä¹‹ Memory Window" />&lt;h1 id="rdma-ä¹‹-memory-window">RDMA ä¹‹ Memory Window&lt;/h1>
&lt;p>&lt;strong>æœ¬æ–‡æ¬¢è¿éå•†ä¸šè½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>å£°æ˜ï¼šä»…ç”¨äºæ”¶è—ï¼Œä¾¿äºé˜…è¯»&lt;/p>&lt;span class="cite">&lt;span>â€• &lt;/span>&lt;span>Savir, &lt;/span>&lt;a href="https://zhuanlan.zhihu.com/p/353590347">&lt;cite>çŸ¥ä¹ä¸“æ ï¼š14. RDMA ä¹‹ Memory Window&lt;/cite>&lt;/a>&lt;/span>&lt;/blockquote>
&lt;p>&lt;strong>æœ¬æ–‡æ˜¯â€œRDMA æ‚è°ˆâ€ä¸“æ æ–‡ç« çš„ç¬¬ 14 ç¯‡ï¼Œæ¬¢è¿è½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„&lt;/strong>&lt;/p>
&lt;p>æˆ‘ä»¬åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-mr/" >ã€RDMA ä¹‹ Memory Regionã€‘
&lt;/a>
ä¸€æ–‡ä¸­ä»‹ç»è¿‡ Memory Regionï¼Œå®ƒæ˜¯ä¸€ç‰‡ç”±ç”¨æˆ·æ³¨å†Œçš„ç‰¹æ®Šçš„å†…å­˜åŒºåŸŸï¼šä¸€æ–¹é¢å…¶ä¸­çš„å†…å®¹ä¸ä¼šè¢«æ¢é¡µåˆ°ç¡¬ç›˜ä¸­ï¼Œå¦ä¸€æ–¹é¢ RDMA ç½‘å¡ä¸­è®°å½•äº†å®ƒçš„åœ°å€è½¬æ¢å…³ç³»ï¼Œä½¿å¾—ç¡¬ä»¶æ‹¿åˆ°ç”¨æˆ·æŒ‡å®šåœ¨ WR ä¸­çš„è™šæ‹Ÿåœ°å€ä¹‹åæ‰¾åˆ°å¯¹åº”çš„ç‰©ç†åœ°å€ã€‚&lt;/p>
&lt;p>æœ¬æ–‡æˆ‘ä»¬æ¥è®²è§£ Memory Window çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº Memory Region çš„ã€æ›´çµæ´»çš„å†…å­˜ç®¡ç†å•å…ƒã€‚é™¤äº† MW çš„æ¦‚å¿µä¹‹å¤–ï¼Œæœ¬æ–‡ä¹Ÿä¼šæ›´è¯¦ç»†çš„ä»‹ç»ä¸€äº› RDMA é¢†åŸŸçš„å†…å­˜ç›¸å…³æ¦‚å¿µï¼Œæ¯”å¦‚ L_Key/R_Key ç­‰ã€‚æœ¬æ–‡é…åˆ &lt;a class="link" href="https://cuterwrite.top/p/rdma-mr/" >ã€RDMA ä¹‹ Memory Regionã€‘
&lt;/a>
é˜…è¯»æ•ˆæœæ›´ä½³ï¼Œå»ºè®®å…ˆè¯»è€…æ¸©ä¹ ä¸€ä¸‹ã€‚&lt;/p>
&lt;h2 id="memory-window-æ˜¯ä»€ä¹ˆ">Memory Window æ˜¯ä»€ä¹ˆ&lt;/h2>
&lt;p>Memory Window ç®€ç§° MWï¼Œä¸­æ–‡å°±ç¿»è¯‘æˆå†…å­˜çª—å£å§ã€‚æ˜¯ä¸€ç§ç”±ç”¨æˆ·ç”³è¯·çš„ï¼Œç”¨äºè®©è¿œç«¯èŠ‚ç‚¹è®¿é—®æœ¬ç«¯å†…å­˜åŒºåŸŸçš„ RDMA èµ„æºã€‚æ¯ä¸ª MW éƒ½ä¼šç»‘å®šï¼ˆç§°ä¸º bindï¼‰åœ¨ä¸€ä¸ªå·²ç»æ³¨å†Œçš„ MR ä¸Šï¼Œä½†æ˜¯å®ƒç›¸æ¯”äº MR å¯ä»¥æä¾›æ›´çµæ´»çš„æƒé™æ§åˆ¶ã€‚MW å¯ä»¥ç²—ç•¥ç†è§£ä¸ºæ˜¯ MR çš„å­é›†ï¼Œä¸€ä¸ª MR ä¸Šå¯ä»¥åˆ’åˆ†å‡ºå¾ˆå¤š MWï¼Œæ¯ä¸ª MW éƒ½å¯ä»¥è®¾ç½®è‡ªå·±çš„æƒé™ã€‚MW å’Œ MR çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_12_1.webp"
alt="2024-06-28_12_1" width="30%" loading="lazy">&lt;figcaption>
&lt;h4>MR ä¸ MW çš„å…³ç³»&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="å†…å­˜çš„è®¿é—®æƒé™æ§åˆ¶">å†…å­˜çš„è®¿é—®æƒé™æ§åˆ¶&lt;/h2>
&lt;p>ä¸ºäº†åæ–‡è¯´æ˜ä¸ºä½•è®¾è®¡ MWï¼Œæˆ‘ä»¬å…ˆæ¥æŠŠ MR å’Œ MW éƒ½æ¶‰åŠçš„æƒé™æ§åˆ¶è®²è§£ä¸€ä¸‹ã€‚&lt;/p>
&lt;h3 id="mrmw-çš„æƒé™é…ç½®">MR/MW çš„æƒé™é…ç½®&lt;/h3>
&lt;p>è¿™é‡Œçš„æƒé™ï¼ŒæŒ‡çš„æ˜¯æœ¬ç«¯/å¯¹ç«¯èŠ‚ç‚¹ï¼Œå¯¹äºæœ¬ç«¯å†…å­˜çš„è¯»/å†™æƒé™ï¼Œå®ƒä»¬ä¸¤ä¸¤ç»„åˆå½¢æˆäº†å››ç§æƒé™ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;/th>
&lt;th>æœ¬ç«¯&lt;/th>
&lt;th>å¯¹ç«¯&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>è¯»&lt;/td>
&lt;td>Local Read&lt;/td>
&lt;td>Remote Read&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>å†™&lt;/td>
&lt;td>Local Write&lt;/td>
&lt;td>Remote Write&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>é™¤äº†è¿™å››ç§æƒé™ä¹‹å¤–ï¼Œè¿˜æœ‰ Atomic æƒé™ç­‰ï¼Œä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´å†…ã€‚&lt;/p>
&lt;p>ä¸Šè¡¨ä¸­è¿™å››ç§æƒé™ä¸­æœ€ä½çš„æ˜¯æœ¬åœ°è¯»ï¼ˆLocal Readï¼‰ï¼Œæ˜¯ç”¨æˆ·å¿…é¡»èµ‹äºˆ MR/MW çš„æƒé™ï¼Œå› ä¸ºå¦‚æœä¸€å—å†…å­˜æœ¬åœ°çš„ç”¨æˆ·éƒ½æ— æ³•è®¿é—®çš„è¯ï¼Œé‚£å°±å¤±å»æ„ä¹‰äº†ï¼›å¦å¤–è¿˜æœ‰ä¸ªé™åˆ¶ï¼Œå¦‚æœæŸä¸ª MR éœ€è¦é…ç½®è¿œç«¯å†™ï¼ˆRemote Writeï¼‰æˆ–è€…è¿˜æ²¡ä»‹ç»çš„è¿œç«¯åŸå­æ“ä½œæƒé™ï¼ˆRemote Atomicï¼‰ï¼Œé‚£ä¹ˆä¹Ÿä¸€å®šè¦é…ç½®æœ¬åœ°å†™ï¼ˆLocal Writeï¼‰æƒé™ã€‚åœ¨æ­¤çº¦æŸä¹‹ä¸‹ï¼Œæ¯ä¸ª MR æˆ–è€… MW éƒ½å¯ä»¥æŒ‰éœ€é…ç½®æƒé™ï¼Œæ¯”å¦‚æˆ‘ä»¬æ³¨å†Œçš„ä¸€ä¸ª MR éœ€è¦å…è®¸è¿œç«¯èŠ‚ç‚¹å†™å…¥æ•°æ®ï¼Œè€Œä¸å…è®¸è¯»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ‰“å¼€ Remote Write æƒé™ï¼Œå…³é—­ Remote Read æƒé™ã€‚è¿™æ · HCAï¼ˆç½‘å¡ï¼‰æ”¶åˆ°å¯¹ç«¯å‘èµ·çš„å¯¹è¿™ä¸ª MR èŒƒå›´å†…çš„æŸä¸ªåœ°å€çš„ WRITE è¯·æ±‚ä¹‹åï¼Œå°±å¯ä»¥äºˆä»¥æ”¾è¡Œï¼›è€Œ HCA æ”¶åˆ°å¯¹ç«¯å¯¹è¿™ä¸ª MR çš„ READ æ“ä½œæ—¶ï¼Œå°±ä¼šæ‹’ç»è¿™ä¸ªè¯·æ±‚ï¼Œå¹¶è¿”å›é”™è¯¯ä¿¡æ¯ç»™å¯¹ç«¯ã€‚&lt;/p>
&lt;h3 id="memory-key">Memory Key&lt;/h3>
&lt;p>ä¸Šè¿°çš„è®¿é—®æƒé™é…ç½®ï¼Œå¹¶ä¸èƒ½æœç»æ¶æ„ç”¨æˆ·å¯¹äºæœ¬åœ°æˆ–è€…è¿œç«¯å†…å­˜çš„è®¿é—®ã€‚æ¯”å¦‚æŸä¸ªèŠ‚ç‚¹ç»™äº†ä¸€å—å†…å­˜åŒºåŸŸçš„ Remote Write æƒé™ï¼Œé‚£ä¹ˆå²‚ä¸æ˜¯ä»»æ„è¿œç«¯èŠ‚ç‚¹ï¼ˆè¿›ç¨‹ï¼‰åªè¦ä¼ å…¥äº†åˆæ³•çš„åœ°å€ä¿¡æ¯ï¼Œéƒ½å¯ä»¥å¯¹è¿™ç‰‡åŒºåŸŸè¿›è¡Œå†™å…¥äº†ï¼Ÿå› æ­¤ï¼ŒIB è§„èŒƒè®¾è®¡äº† Memory Keyï¼Œç®€å•ç†è§£å®ƒå°±æ˜¯è®¿é—® MR çš„é’¥åŒ™æœºåˆ¶ï¼Œåªæœ‰æŒæœ‰æ­£ç¡®çš„é’¥åŒ™ï¼Œæ‰èƒ½æ‰“å¼€ MR/MW çš„å¤§é—¨ã€‚&lt;/p>
&lt;p>Key æ˜¯ä¸€ä¸²æ•°å­—ï¼Œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š24bit çš„ Index ä»¥åŠ 8bit çš„ Keyï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_12_2.webp"
alt="2024-06-28_12_2" width="60%" loading="lazy">&lt;figcaption>
&lt;h4>L_Key/R_Key çš„ç»„æˆ&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å…¶ä¸­ï¼ŒIndex ç”¨äº HCA å¿«é€Ÿç´¢å¼•åˆ°æœ¬åœ°çš„è™šæ‹Ÿ-ç‰©ç†åœ°å€è½¬æ¢è¡¨ç­‰ MR ç›¸å…³çš„ä¿¡æ¯ï¼Œè€Œ Key ç”¨äºæ ¡éªŒæ•´ä¸ªå­—æ®µçš„åˆæ³•æ€§ï¼Œä»¥é˜²æ­¢æœªæˆæƒçš„ç”¨æˆ·ä»»æ„ä¼ é€’ Indexã€‚&lt;/p>
&lt;p>Memory Key æŒ‰ç…§ç”¨é€”åˆ†ä¸ºä¸¤ç§ï¼ŒLocal Key å’Œ Remote Keyï¼š&lt;/p>
&lt;h4 id="l_key">L_Key&lt;/h4>
&lt;p>å³ Local Keyï¼Œå…³è”åˆ°ä¸€ä¸ª MR ä¸Šï¼Œç”¨äº HCA è®¿é—®æœ¬ç«¯å†…å­˜ã€‚å½“æœ¬ç«¯çš„æŸä¸ªè¿›ç¨‹è¯•å›¾ä½¿ç”¨ä¸€ä¸ªå·²ç»æ³¨å†Œçš„ MR çš„å†…å­˜æ—¶ï¼ŒHCA ä¼šæ ¡éªŒå…¶ä¼ é€’çš„ L_Keyã€‚å¹¶ä¸”åˆ©ç”¨ L_Key ä¸­çš„ç´¢å¼•æŸ¥æ‰¾åœ°å€è½¬æ¢è¡¨ï¼ŒæŠŠè™šæ‹Ÿåœ°å€ç¿»è¯‘æˆç‰©ç†åœ°å€ç„¶åè®¿é—®å†…å­˜ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-shared-receive-queue/" >ã€RDMA ä¹‹ Shared Receive Queueã€‘
&lt;/a>
ä¸€æ–‡ä¸­æè¿°è¿‡ sgeï¼Œsge ç”±èµ·å§‹åœ°å€ã€é•¿åº¦å’Œç§˜é’¥ç»„æˆã€‚ç”¨æˆ·åœ¨å¡«å†™ WR æ—¶ï¼Œå¦‚æœéœ€è¦ HCA è®¿é—®æœ¬ç«¯å†…å­˜ï¼Œé‚£ä¹ˆå°±éœ€è¦é€šè¿‡ä¸€ä¸ª sge çš„é“¾è¡¨ï¼ˆsglï¼‰æ¥æè¿°å†…å­˜å—ï¼Œè¿™é‡Œ sge çš„ç§˜é’¥å¡«çš„å°±æ˜¯ L_Keyï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾ä¸­çš„ key1 å’Œ key3ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ MR1 çš„ L_Key å’Œ MR2 çš„ L_Keyã€‚å¦‚æœæ²¡æœ‰ L_Keyï¼Œé‚£ä¹ˆä»»ä½•ä¸€ä¸ªæœ¬åœ°ç”¨æˆ·è¿›ç¨‹éƒ½å¯ä»¥æŒ‡æŒ¥ç¡¬ä»¶è®¿é—®å…¶ä»–æœ¬åœ°ç”¨æˆ·æ³¨å†Œçš„ MR çš„å†…å®¹ï¼Œç¡¬ä»¶ä¹Ÿéš¾ä»¥é«˜æ•ˆçš„å°†è™šæ‹Ÿåœ°å€ç¿»è¯‘æˆç‰©ç†åœ°å€ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_12_3.webp"
alt="2024-06-28_12_3" width="50%" loading="lazy">&lt;figcaption>
&lt;h4>L_Key çš„ä½œç”¨&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h4 id="r_key">R_Key&lt;/h4>
&lt;p>å³ Remote Keyï¼Œå…³è”åˆ°ä¸€ä¸ª MR æˆ–è€… MW ä¸Šï¼Œç”¨äºè¿œç«¯èŠ‚ç‚¹è®¿é—®æœ¬ç«¯å†…å­˜ã€‚å½“è¿œç«¯èŠ‚ç‚¹è¯•å›¾è®¿é—®æœ¬ç«¯çš„å†…å­˜æ—¶ï¼Œä¸€æ–¹é¢æœ¬ç«¯çš„ HCA ä¼šæ ¡éªŒ R_Key æ˜¯å¦åˆæ³•ï¼Œå¦ä¸€æ–¹é¢ä¼šåˆ©ç”¨ R_Key ä¸­çš„ç´¢å¼•æŸ¥åœ°å€è½¬æ¢è¡¨ï¼ŒæŠŠè™šæ‹Ÿåœ°å€ç¿»è¯‘æˆç‰©ç†åœ°å€ç„¶åè®¿é—®å†…å­˜ã€‚&lt;/p>
&lt;p>å‡¡æ˜¯ RDMA æ“ä½œï¼ˆå³ Write/Read/Atomicï¼‰ï¼Œç”¨æˆ·éƒ½è¦åœ¨ WR ä¸­æºå¸¦è¿œç«¯å†…å­˜åŒºåŸŸçš„ R_Keyã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_12_4.webp"
alt="2024-06-28_12_4" width="70%" loading="lazy">&lt;figcaption>
&lt;h4>R_Key çš„ä½œç”¨&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>IB è§„èŒƒé€šè¿‡ä¸Šè¿°ä¸¤ç§æœºåˆ¶ï¼Œæ¥ç¡®ä¿ MR å¯ä»¥æŒ‰ç…§ç”¨æˆ·çš„æœŸæœ›è¢«æ­£ç¡®ä¸”å®‰å…¨çš„è®¿é—®ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªæ¯”å–»æ¥æ€»ç»“ä¸‹ MR/MW æƒé™æ§åˆ¶ç›¸å…³çš„å†…å®¹ï¼š&lt;/p>
&lt;p>A ç»™è‡ªå·±çš„æˆ¿é—´ï¼ˆMRï¼‰é…äº†ä¸¤æŠŠé’¥åŒ™ï¼ˆMemory Keyï¼‰ï¼Œä¸€æŠŠç•™ä½œè‡ªç”¨ï¼ˆL_Keyï¼‰ï¼Œå¦ä¸€æŠŠé’¥åŒ™ï¼ˆR_Keyï¼‰é‚®å¯„ï¼ˆå¯ä»¥æ˜¯ä»»ä½•é€šä¿¡æ–¹å¼ï¼‰ç»™äº† Bã€‚B å¯ä»¥åœ¨ A ä¸åœ¨å®¶çš„æ—¶å€™ï¼ˆæœ¬ç«¯ CPU ä¸æ„ŸçŸ¥è¿œç«¯èŠ‚ç‚¹å¯¹æœ¬åœ°å†…å­˜çš„ RDMA æ“ä½œï¼‰ï¼Œé€šè¿‡é’¥åŒ™ï¼ˆR_Keyï¼‰æ‰“å¼€é—¨ã€‚æ‰“å¼€é—¨ä¹‹åï¼Œå¯èƒ½ B åªèƒ½éš”ç€ç»ç’ƒæŸ¥çœ‹æˆ¿é—´çš„æ‘†è®¾ï¼ˆA åªç»™äº†è¿™ä¸ª MR è¿œç¨‹è¯»æƒé™ï¼‰ï¼Œæˆ–è€…è¿›å…¥æˆ¿é—´å†…å‘ç°æ¼†é»‘ä¸€ç‰‡ä»€ä¹ˆä¹Ÿçœ‹ä¸åˆ°ï¼Œä½†æ˜¯å¯ä»¥å‘æˆ¿é—´é‡Œæ”¾ç‰©å“ï¼ˆA åªç»™äº†è¿™ä¸ª MR è¿œç¨‹å†™æƒé™ï¼‰ï¼Œå½“ç„¶ä¹Ÿæœ‰å¯èƒ½æ²¡æœ‰ç»ç’ƒä¹Ÿå¼€äº†ç¯ï¼ˆåŒæ—¶ç»™äº†è¿œç¨‹è¯»å†™æƒé™ï¼‰ã€‚&lt;/p>
&lt;h2 id="ä¸ºä»€ä¹ˆè¦æœ‰-mw">ä¸ºä»€ä¹ˆè¦æœ‰ MW&lt;/h2>
&lt;p>ç®€è€Œè¨€ä¹‹ï¼Œè®¾è®¡ MW çš„ç›®çš„å°±æ˜¯æƒ³æ›´çµæ´»çš„æ§åˆ¶å†…å­˜çš„è¿œç¨‹è®¿é—®æƒé™ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://cuterwrite.top/p/rdma-mr/" >ã€RDMA ä¹‹ Memory Regionã€‘
&lt;/a>
ä¸€æ–‡ä¸­æˆ‘ä»¬ä»‹ç»è¿‡ç”¨æˆ·æ³¨å†Œ MR çš„è¿‡ç¨‹ï¼Œéœ€è¦ä»ç”¨æˆ·æ€é™·å…¥å†…æ ¸æ€ï¼Œè°ƒç”¨å†…æ ¸æä¾›çš„å‡½æ•° pin ä½å†…å­˜ï¼ˆé˜²æ­¢æ¢é¡µï¼‰ï¼Œç„¶ååˆ¶ä½œè™šæ‹Ÿ-ç‰©ç†åœ°å€æ˜ å°„è¡¨å¹¶ä¸‹å‘ç»™ç¡¬ä»¶ã€‚&lt;/p>
&lt;p>å› ä¸º MR æ˜¯ç”±å†…æ ¸ç®¡ç†çš„ï¼Œå¦‚æœç”¨æˆ·æƒ³ä¿®æ”¹ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ MR çš„ä¿¡æ¯ï¼Œæ¯”å¦‚æˆ‘æƒ³æ”¶å›æŸä¸ª MR çš„è¿œç«¯å†™æƒé™ï¼Œåªä¿ç•™è¿œç«¯è¯»æƒé™ï¼›æˆ–è€…æƒ³è¦ä½¿ä¸€ä¸ªä¹‹å‰å·²ç»æˆæƒç»™è¿œç«¯èŠ‚ç‚¹çš„ R_Key å¤±æ•ˆï¼Œé‚£ä¹ˆç”¨æˆ·éœ€è¦é€šè¿‡é‡æ³¨å†Œ MRï¼ˆReregister MRï¼‰æ¥å£æ¥è¿›è¡Œä¿®æ”¹ï¼Œè¯¥æ¥å£ç­‰ä»·äºå…ˆå–æ¶ˆæ³¨å†Œ MRï¼ˆDeregister MRï¼‰ï¼Œç„¶åæ³¨å†Œ MRï¼ˆRegister MRï¼‰ã€‚&lt;strong>ä¸Šè¿°æµç¨‹éœ€è¦é™·å…¥å†…æ ¸æ€æ¥å®Œæˆï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹æ˜¯è€—æ—¶è¾ƒé•¿çš„&lt;/strong>ã€‚&lt;/p>
&lt;p>ä¸åŒäºéœ€è¦é€šè¿‡æ§åˆ¶è·¯å¾„ä¿®æ”¹æƒé™çš„ MRï¼Œ&lt;strong>MW åœ¨åˆ›å»ºå¥½ä¹‹åï¼Œå¯ä»¥é€šè¿‡æ•°æ®è·¯å¾„ï¼ˆå³é€šè¿‡ç”¨æˆ·æ€ç›´æ¥ä¸‹å‘ WR åˆ°ç¡¬ä»¶çš„æ–¹å¼ï¼‰åŠ¨æ€çš„ç»‘å®šåˆ°ä¸€ä¸ªå·²ç»æ³¨å†Œçš„ MR ä¸Šï¼Œå¹¶åŒæ—¶è®¾ç½®æˆ–è€…æ›´æ”¹å…¶è®¿é—®æƒé™ï¼Œè¿™ä¸ªè¿‡ç¨‹çš„é€Ÿåº¦è¿œè¿œè¶…è¿‡é‡æ–°æ³¨å†Œ MR çš„è¿‡ç¨‹&lt;/strong>ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆç°åœ¨ä¸ºäº†ä½¿ä¸€ç‰‡å†…å­˜èƒ½å¤Ÿè¢«è¿œç«¯èŠ‚ç‚¹è¿›è¡Œ RDMA WRITE/READ æ“ä½œï¼Œæˆ‘ä»¬å°±æ‹¥æœ‰äº†æ³¨å†Œ MR ä»¥åŠæ³¨å†Œ MW ç„¶åç»‘å®šåˆ°ä¸€ä¸ªå·²æ³¨å†Œçš„ MR ä¸¤ç§æ–¹å¼ï¼Œå®ƒä»¬éƒ½ä¼šäº§ç”Ÿä¸€ä¸ª R_Key æ¥æä¾›ç»™è¿œç«¯èŠ‚ç‚¹ã€‚å‰ä¸€ç§æ–¹å¼å‡†å¤‡é˜¶æ®µçš„æ­¥éª¤ç®€å•ï¼Œä½†æ˜¯ä¸å¤Ÿçµæ´»ï¼Œä¸€æ—¦æ³¨å†Œä¹‹åä¿®æ”¹èµ·æ¥ä¼šæ¯”è¾ƒéº»çƒ¦ï¼›åä¸€ç§æ–¹å¼ç›¸æ¯”å‰ä¸€ç§å¤šäº†æ³¨å†Œ MW å’Œç»‘å®š MW åˆ° MR ä¸¤ç§æ“ä½œï¼Œä½†æ˜¯å¯ä»¥æ–¹ä¾¿è¿…é€Ÿçš„æ§åˆ¶è¿œç«¯è®¿é—®æƒé™ã€‚&lt;/p>
&lt;h2 id="mw-å’Œ-mr-æƒé™çš„å…³ç³»">MW å’Œ MR æƒé™çš„å…³ç³»&lt;/h2>
&lt;p>ä¹Ÿè®¸æœ‰çš„è¯»è€…ä¼šæƒ³åˆ°ï¼ŒMR ç”³è¯·æ—¶é…ç½®äº†è‡ªå·±çš„æƒé™ï¼ŒMW ç»‘å®šåˆ° MR æ—¶ä¹Ÿä¼šé…ç½®è‡ªå·±çš„æƒé™ï¼Œè¿™ä¸¤è€…çš„æƒé™æ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼ŸIB è§„èŒƒåœ¨ 10.6.7.2.2 èŠ‚æœ‰ä¸“é—¨ä»‹ç»ï¼š&lt;/p>
&lt;blockquote>
&lt;p>When binding a Memory Window, a Consumer can request any combination of remote access rights for the Window. However, if the associated Region does not have local write access enabled and the Consumer requests remote write or remote atomic access for the Window, the Channel Interface must return an error either at bind time or access time.&lt;/p>
&lt;/blockquote>
&lt;p>æ€»ç»“æ¥è¯´ï¼Œ&lt;strong>å¦‚æœæƒ³è¦ç»™ MW é…ç½®è¿œç¨‹å†™æˆ–è€…è¿œç¨‹åŸå­æ“ä½œï¼ˆAtomicï¼‰æƒé™ï¼Œé‚£ä¹ˆå®ƒç»‘å®šåˆ°çš„ MR å¿…é¡»æœ‰æœ¬åœ°å†™æƒé™ï¼Œå…¶ä»–æƒ…å†µä¸‹ä¸¤è€…æƒé™äº’ä¸å¹²æ‰°&lt;/strong>ï¼šè¿œç«¯ç”¨æˆ·ç”¨ MWï¼Œå°±è¦éµå¾ª MW çš„æƒé™é…ç½®ï¼›è¿œç«¯ç”¨æˆ·ç”¨ MRï¼Œå°±è¦éµå¾ª MR çš„æƒé™é…ç½®ã€‚&lt;/p>
&lt;h2 id="ç”¨æˆ·æ¥å£">ç”¨æˆ·æ¥å£&lt;/h2>
&lt;p>è€æ ·å­ï¼Œç”¨æˆ·æ¥å£æ—¶æˆ‘ä»¬æŒ‰ç…§æ§åˆ¶è·¯å¾„å’Œæ•°æ®è·¯å¾„æ¥åˆ†ç±»ï¼š&lt;/p>
&lt;h3 id="æ§åˆ¶è·¯å¾„">æ§åˆ¶è·¯å¾„&lt;/h3>
&lt;p>MW æ”¯æŒå¢ã€åˆ å’ŒæŸ¥ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼š&lt;/p>
&lt;h4 id="åˆ›å»ºallocate-mw">åˆ›å»ºâ€”â€”Allocate MW&lt;/h4>
&lt;p>ç”³è¯· MWï¼Œä¸»è¦æ˜¯åˆ›å»º MW ç›¸å…³çš„è½¯ä»¶ç»“æ„å’Œè®©ç¡¬ä»¶åšå¥½å‡†å¤‡ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šåæ–‡ä¸­ä»‹ç»çš„ MW çš„ç±»å‹ã€‚è¿™ä¸ªæ¥å£ä¼šäº§ç”Ÿä¸€ä¸ª Memory Window çš„å¥æŸ„ï¼Œç”¨æˆ·ä»¥åå¯ä»¥ç”¨è¿™ä¸ªå¥æŸ„æŒ‡ä»£è¿™ä¸ª MWã€‚&lt;/p>
&lt;p>æ³¨æ„æ­¤æ—¶ MW æ²¡æœ‰ç»‘å®šåˆ° MR ä¸Šï¼Œå¤„äºä¸å¯ä»è¿œç«¯è®¿é—®çš„çŠ¶æ€ã€‚&lt;/p>
&lt;h4 id="åˆ é™¤deallocate-mw">åˆ é™¤â€”â€”Deallocate MW&lt;/h4>
&lt;p>å–æ¶ˆæ³¨å†Œ MWã€‚å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯é”€æ¯ç›¸å…³èµ„æºã€‚&lt;/p>
&lt;h4 id="æŸ¥è¯¢query-mw">æŸ¥è¯¢â€”â€”Query MW&lt;/h4>
&lt;p>æŸ¥è¯¢ MW çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ R_Key åŠå…¶çŠ¶æ€ã€MW ç±»å‹ä»¥åŠ PD ç­‰ã€‚&lt;/p>
&lt;p>éœ€è¦å†æ¬¡å¼ºè°ƒçš„æ˜¯ï¼Œè™½ç„¶è¿™ä¸ª Verbs åœ¨ IB è§„èŒƒä¸­æœ‰æè¿°ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰åœ¨ RDMA è½¯ä»¶æ ˆä¸­å®ç°ç›¸å…³çš„ APIã€‚ç±»ä¼¼æƒ…å†µçš„ Verbs æ¥å£è¿˜æœ‰ä¸å°‘ï¼ŒRDMA è½¯ä»¶æ ˆä»¥å®ç”¨ä¸ºåŸåˆ™ï¼Œæ²¡æœ‰ç”¨æˆ·éœ€æ±‚çš„æ¥å£ä¸€èˆ¬éƒ½æ²¡æœ‰å®ç°ã€‚&lt;/p>
&lt;h3 id="æ•°æ®è·¯å¾„">æ•°æ®è·¯å¾„&lt;/h3>
&lt;p>MW åœ¨æ•°æ®è·¯å¾„æœ‰ä¸€å¥—ç‹¬ç‰¹çš„æ¥å£ï¼Œåˆ†ä¸º Bind å’Œ Invalidate ä¸¤ç±»ï¼š&lt;/p>
&lt;h4 id="ç»‘å®šbind">ç»‘å®šâ€”â€”Bind&lt;/h4>
&lt;p>Bind(ing)æ„ä¸ºâ€œç»‘å®šâ€ï¼ŒæŒ‡çš„æ˜¯å°†ä¸€ä¸ª MWâ€œå…³è”â€åˆ°ä¸€ä¸ªå·²ç»æ³¨å†Œçš„ MR çš„æŒ‡å®šèŒƒå›´ä¸Šï¼Œå¹¶é…ç½®ä¸€å®šçš„è¯»å†™æƒé™ã€‚ç»‘å®šçš„ç»“æœä¼šäº§ç”Ÿä¸€ä¸ª R_keyï¼Œç”¨æˆ·å¯ä»¥æŠŠè¿™ä¸ª R_Key ä¼ é€’ç»™è¿œç«¯èŠ‚ç‚¹ç”¨äºè¿œç¨‹è®¿é—®ã€‚æ³¨æ„ä¸€ä¸ª MW å¯ä»¥è¢«å¤šæ¬¡ç»‘å®šï¼Œä¸€ä¸ª MR ä¸Šä¹Ÿå¯ä»¥ç»‘å®šå¤šä¸ª MWã€‚å¦‚æœä¸€ä¸ª MR è¿˜æœ‰è¢«ç»‘å®šçš„ MWï¼Œé‚£ä¹ˆè¿™ä¸ª MR æ˜¯ä¸èƒ½è¢«å–æ¶ˆæ³¨å†Œçš„ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_12_5.webp"
alt="2024-06-28_12_5" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>Bind çš„è½¯ç¡¬ä»¶äº¤äº’&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>Bind æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯è°ƒç”¨ Post Send æ¥å£ä¸‹å‘ Bind MW WRï¼Œä¸€ç§æ˜¯è°ƒç”¨ Bind MW æ¥å£ã€‚&lt;/p>
&lt;ul>
&lt;li>Post Send Bind MW WR&lt;/li>
&lt;/ul>
&lt;p>å‰æ–‡æˆ‘ä»¬è®²è¿‡ï¼Œç›¸æ¯”äº MRï¼ŒMW æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥ä»æ•°æ®è·¯å¾„å¿«é€Ÿçš„é…ç½®æƒé™ã€‚Post Send Bind MW WR æ“ä½œï¼ŒæŒ‡çš„å°±æ˜¯ç”¨æˆ·é€šè¿‡ post send æ¥å£ï¼ˆæ¯”å¦‚ ibv_post_send()ï¼‰ä¸‹å‘ä¸€ä¸ª WR åˆ° SQ ä¸­ï¼Œè¿™ä¸ª WR çš„æ“ä½œç±»å‹ï¼ˆæ¯”å¦‚ SEND/RDMA WRITE/RDMA READï¼‰è¢«æŒ‡å®šä¸º BIND MWï¼Œæ­¤å¤– WR ä¸­è¿˜æºå¸¦æœ‰æƒé™å’Œè¦ç»‘å®šåˆ°çš„ MR çš„èŒƒå›´ä¿¡æ¯ã€‚ä¸å…¶ä»– WR ä¸åŒï¼Œä¸‹å‘ Bind MW çš„ WR ä¹‹åï¼Œç¡¬ä»¶å¹¶ä¸ä¼šå‘é€ä»»ä½•æ•°æ®åŒ…ï¼Œè€Œæ˜¯å°† MW ç»‘å®šåˆ°äº†æŒ‡å®š MR ä¸Šã€‚&lt;/p>
&lt;p>è¿™ç§æ–¹å¼ä»…é€‚ç”¨äºåæ–‡ä»‹ç»çš„ Type 2 çš„ MWã€‚&lt;/p>
&lt;ul>
&lt;li>Bind MW&lt;/li>
&lt;/ul>
&lt;p>è™½ç„¶è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¥å£ï¼Œä½†æ˜¯å®é™…æ˜¯åœ¨ Post Send Bind MW WR å¤–é¢åˆå°è£…äº†ä¸€å±‚ã€‚ç”¨æˆ·ä¼ å…¥ MW ç»‘å®šçš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬æƒé™åŠè¦ç»‘å®šçš„ MR çš„ä¿¡æ¯ï¼Œé©±åŠ¨ç¨‹åºè´Ÿè´£ç»„è£…å’Œä¸‹å‘ WR åˆ°ç¡¬ä»¶ä¸­ã€‚è¯¥æ¥å£æˆåŠŸåï¼Œä¼šå°†æ–°ç”Ÿæˆçš„ R_Key è¿”å›ç»™ç”¨æˆ·ã€‚&lt;/p>
&lt;p>è¿™ç§æ–¹å¼ä»…é€‚ç”¨äºåæ–‡ä»‹ç»çš„ Type 1 çš„ MWã€‚&lt;/p>
&lt;p>ä¸Šè¿°ä¸¤ç§æ“ä½œçš„å…³ç³»æ˜¯è¿™æ ·çš„ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_12_6.webp"
alt="2024-06-28_12_6" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>ä¸¤ç§ Bind æ“ä½œçš„å…³ç³»&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h4 id="æ— æ•ˆåŒ–invalidate">æ— æ•ˆåŒ–â€”â€”Invalidate&lt;/h4>
&lt;p>Invalidate æ„ä¸ºæ— æ•ˆåŒ–ï¼ŒæŒ‡çš„æ˜¯ç”¨æˆ·é€šè¿‡ä¸‹å‘ä¸€ä¸ªå¸¦æœ‰ Invalidate æ“ä½œç çš„ WR åˆ°ç¡¬ä»¶è€Œä½¿ä¸€ä¸ª R_Key æ— æ•ˆçš„æ“ä½œã€‚&lt;/p>
&lt;p>&lt;strong>éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼ŒInvalidate æ“ä½œçš„å¯¹è±¡æ˜¯ R_Key è€Œä¸æ˜¯ MW æœ¬èº«ï¼Œå³ Invalidate ä¹‹åçš„æ•ˆæœæ˜¯ï¼šè¿œç«¯ç”¨æˆ·æ— æ³•å†ä½¿ç”¨è¿™ä¸ª R_Key è®¿é—®å¯¹åº”çš„ MWï¼Œè€Œ MW èµ„æºä»ç„¶å­˜åœ¨ï¼Œä»¥åä»ç„¶å¯ä»¥ç”Ÿæˆæ–°çš„ R_Key ç»™è¿œç«¯ä½¿ç”¨ã€‚&lt;/strong>&lt;/p>
&lt;p>Invalidate æ“ä½œåªèƒ½ç”¨äºä¸‹æ–‡ä»‹ç»çš„ Type 2 çš„ MWã€‚&lt;/p>
&lt;p>æŒ‰ç…§ Invalidate æ“ä½œçš„å‘èµ·æ–¹ä¸åŒï¼Œåˆå¯ä»¥è¿›ä¸€æ­¥åˆ†æˆä¸¤ç§ï¼š&lt;/p>
&lt;ul>
&lt;li>Local Invalidate&lt;/li>
&lt;/ul>
&lt;p>æœ¬åœ°æ— æ•ˆæ“ä½œã€‚ä¸Šå±‚ç”¨æˆ·å¦‚æœæƒ³åœ¨ä¸å›æ”¶ MW èµ„æºçš„æƒ…å†µä¸‹ï¼Œæ”¶å›æŸä¸ªè¿œç«¯çš„ç”¨æˆ·çš„ R_Key çš„æƒé™ã€‚é‚£ä¹ˆå°±å¯ä»¥ä¸‹å‘ä¸€ä¸ª Local Invalidate æ“ä½œåˆ° SQ ä¸­ï¼Œç¡¬ä»¶æ”¶åˆ°ä¹‹åä¼šå¯¹ç›¸åº”çš„ MR çš„é…ç½®è¿›è¡Œä¿®æ”¹ã€‚æˆåŠŸæ‰§è¡Œä¹‹åï¼Œå¦‚æœæŒæœ‰è¿™ä¸ª R_Key çš„è¿œç«¯ç”¨æˆ·æƒ³è¦å¯¹ MW è¿›è¡Œ RDMA æ“ä½œï¼Œå°†ä¼šè¢«æœ¬åœ°çš„ç¡¬ä»¶æ‹’ç»å¹¶è¿”å›é”™è¯¯ã€‚&lt;/p>
&lt;p>å› ä¸ºæ˜¯æœ¬åœ°æ“ä½œï¼Œæ‰€ä»¥ç¡¬ä»¶æ”¶åˆ°è¿™ä¸ª WR ä¹‹åä¹Ÿä¸ä¼šå‘é€æ¶ˆæ¯åˆ°é“¾è·¯ä¸Šã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_12_7.webp"
alt="2024-06-28_12_7" width="60%" loading="lazy">&lt;figcaption>
&lt;h4>Local Invalidate æ“ä½œçš„è½¯ç¡¬ä»¶äº¤äº’&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;ul>
&lt;li>Remote Invalidate&lt;/li>
&lt;/ul>
&lt;p>è¿œç«¯æ— æ•ˆæ“ä½œã€‚å½“ä¸€ä¸ªè¿œç«¯ç”¨æˆ·ä¸å†ä½¿ç”¨ä¸€ä¸ª R_Key ä¹‹åï¼Œå¯ä»¥ä¸»åŠ¨å‘é€æ¶ˆæ¯ï¼Œè®©æœ¬ç«¯å›æ”¶è¿™ä¸ª R_Keyã€‚è¿œç«¯ç”¨æˆ·ä¸‹å‘ä¸€ä¸ªå¸¦æœ‰æ­¤æ“ä½œç çš„ WR åˆ° SQ ä¸­ï¼Œå…¶ç¡¬ä»¶æ”¶åˆ°åï¼Œå°†ä¼šç»„è£…ä¸€ä¸ªæŠ¥æ–‡å¹¶å‘é€åˆ°æœ¬ç«¯ã€‚æœ¬ç«¯ç¡¬ä»¶æ”¶åˆ°è¿œç«¯çš„ Remote Invalidate æ“ä½œä¹‹åï¼Œå°†ä¼šæŠŠå¯¹åº”çš„ R_Key ç½®ä¸ºä¸å¯ç”¨çŠ¶æ€ã€‚åŒ Local Invalidate ä¸€æ ·ï¼Œæ­¤åå¯¹ç«¯å°†æ— æ³•ä½¿ç”¨è¿™ä¸ª R_Key å¯¹å¯¹åº”çš„ MW è¿›è¡Œ RDMA æ“ä½œã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_12_8.webp"
alt="2024-06-28_12_8" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>Remote Invalidate æ“ä½œçš„è½¯ç¡¬ä»¶äº¤äº’&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="mw-çš„ç±»å‹">MW çš„ç±»å‹&lt;/h2>
&lt;p>æ ¹æ®å®ç°å’Œåº”ç”¨åœºæ™¯çš„ä¸åŒï¼ŒIB è§„èŒƒå¯¹ MW è¿›è¡Œäº†åˆ†ç±»ï¼š&lt;/p>
&lt;h3 id="type-1">Type 1&lt;/h3>
&lt;p>Type 1 çš„ MW é€šè¿‡ PD å’Œä¸€ä¸ª QP å…³è”ï¼Œä¸ä¼šç»‘å®šåˆ°ä¸€ä¸ª QP ä¸Šï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šå½±å“é”€æ¯åŒä¸€ä¸ª PD ä¸‹çš„ QPã€‚&lt;/p>
&lt;p>Type 1 çš„ MW çš„ R_Key çš„ key åŸŸæ®µç”±é©±åŠ¨å’Œç¡¬ä»¶æŒæ¡ï¼Œè¿™é‡Œâ€œæŒæ¡â€çš„æ„æ€æ˜¯ï¼Œç”±é©±åŠ¨å’Œç¡¬ä»¶åˆ†é… keyï¼Œè€Œä¸æ˜¯ä¸Šå±‚ç”¨æˆ·ã€‚è¿™ä¹Ÿæ˜¯å‰æ–‡ä¸­è¯´ Type 1 çš„ MW ä¸èƒ½è¢«æ‰§è¡Œ Invalidate æ“ä½œçš„åŸå› ã€‚å¦‚æœ Type 1 MW çš„ç”¨æˆ·æƒ³è¦ä½¿ä¸€ä¸ª R_Key å¤±æ•ˆï¼Œé‚£ä¹ˆé‡æ–°é€šè¿‡ Bind MW æ¥å£ç»‘å®šä¸€æ¬¡è¿™ä¸ª MWï¼Œç¡¬ä»¶æˆ–è€…é©±åŠ¨å°±å›è‡ªåŠ¨åˆ†é…ä¸€ä¸ªæ–°çš„ R_Key çš„ key åŸŸæ®µï¼ŒåŸæœ‰çš„ R_Key ä¹Ÿå°±å¤±æ•ˆäº†ã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼Œå¦‚æœç”¨æˆ·æš‚æ—¶æƒ³è¦ä½¿ä¸€ä¸ª MW ä¸å†ç»‘å®šåˆ°ä»»ä½• MRï¼Œä½†æ˜¯åˆæƒ³ä¿ç•™ç›¸å…³çš„èµ„æºè€Œä¸æ˜¯é”€æ¯è¿™ä¸ª MWï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡è°ƒç”¨ Bind MW æ¥å£ï¼Œå¹¶å°† MW é•¿åº¦è®¾ç½®ä¸º 0 æ¥å®ç°ã€‚&lt;/p>
&lt;p>IB è§„èŒƒå…è®¸å¤šä¸ª Type 1 MW ç»‘å®šåˆ°åŒä¸€ä¸ª MR ä¸Šï¼ŒèŒƒå›´å¯ä»¥ç›¸äº’è¦†ç›–ã€‚&lt;/p>
&lt;h3 id="type-2">Type 2&lt;/h3>
&lt;p>Type 2 çš„ MW èµ‹äºˆäº†ç”¨æˆ·æ›´å¤§çš„è‡ªç”±åº¦ï¼Œå…¶ R_Key çš„ key åŸŸæ®µç”±ç”¨æˆ·æŒæ¡ï¼Œå³ç”¨æˆ·æƒ³æ€ä¹ˆåˆ†é…å°±æ€ä¹ˆåˆ†é…ã€‚å‰æ–‡å·²ç»è®²è¿‡ï¼Œç”¨æˆ·é€šè¿‡ Post Send Bind MW WR æ“ä½œæ¥è¿›è¡Œç»‘å®šï¼Œè¿™ä¸ªè¿‡ç¨‹å¹¶ä¸ä¼šè¿”å› R_Keyã€‚ç”¨æˆ·å¿…é¡»è®°ä½ Allocate MW æ—¶çš„ indexï¼Œå¹¶ä¸”å’Œå…¶é€‰æ‹©çš„ 8 bit key ç»„æˆ R_Key å¹¶å‘é€ç»™å¯¹ç«¯ã€‚&lt;/p>
&lt;p>ç”¨æˆ·å¯ä»¥é€šè¿‡å‰æ–‡ä»‹ç»è¿‡çš„ Invalidate æ“ä½œæ¥ä½¿ä¸€ä¸ª R_Key æ— æ•ˆï¼Œå¦‚æœæƒ³è¦åˆ†é…ä¸€ä¸ªæ–°çš„ R_Key åˆ° MW ä¸Šï¼Œå¿…é¡»å…ˆé€šè¿‡ Invalidate æ“ä½œæ— æ•ˆä¹‹å‰çš„ R_Keyã€‚&lt;/p>
&lt;p>ä¸ Type 1 ä¸åŒï¼ŒType 2 çš„ MW ä¸æ”¯æŒ 0 é•¿åº¦çš„ç»‘å®šã€‚&lt;/p>
&lt;p>IB è§„èŒƒåŒæ ·ä¹Ÿå…è®¸å¤šä¸ª Type 2 ç»‘å®šåˆ°åŒä¸€ä¸ª MR ä¸Šï¼ŒèŒƒå›´å¯ä»¥ç›¸äº’è¦†ç›–ã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼Œæ ¹æ®ç»‘å®šå…³ç³»ä¸åŒï¼ŒType 2 è¿˜å¯ä»¥åˆ†ä¸ºä¸¤ç§å®ç°æ–¹å¼ï¼Œå®ƒä»¬çš„å·®å¼‚ä»…åœ¨äºå’Œ QP çš„ç»‘å®šå…³ç³»ä¸Šã€‚&lt;/p>
&lt;h4 id="type-2a">Type 2A&lt;/h4>
&lt;p>é€šè¿‡ QPN å’Œä¸€ä¸ª QP å…³è”ï¼Œä¹Ÿå°±æ˜¯è¯´è¿œç«¯è®¿é—®è¿™ä¸ª MW èŒƒå›´å†…çš„å†…å­˜æ—¶å€™ï¼Œé™¤äº† R_Key ä¹‹å¤–ï¼Œè¿˜å¿…é¡»æŒ‡å®šæ­£ç¡®çš„ QPNã€‚å¦‚æœä¸€ä¸ª QP ä¸Šè¿˜æœ‰ç»‘å®šçš„ Type 2A çš„ MWï¼Œé‚£ä¹ˆè¿™ä¸ª QP ä¸å¯ä»¥è¢«é”€æ¯ã€‚&lt;/p>
&lt;h4 id="type-2b">Type 2B&lt;/h4>
&lt;p>é€šè¿‡ QPN å’Œ PD ä¸ä¸€ä¸ª QP å…³è”ï¼Œæ¯” Type 2A å¤šäº†ä¸ª PD çš„æ ¡éªŒï¼Œå³è¿œç«¯é€šè¿‡ RDMA æ“ä½œè®¿é—® MW çš„å†…å­˜æ—¶ï¼Œé™¤äº† QPN è¦æ­£ç¡®ä¹‹å¤–ï¼Œå…¶æŒ‡å®šçš„æœ¬ç«¯ QP çš„ PD è¦ä¸ç»‘å®šè¿™ä¸ª MW æ—¶çš„ PD ç›¸åŒã€‚å¦å¤–ï¼Œä¸ Type 2A ä¸åŒï¼ŒQP å¦‚æœè¿˜æœ‰ Type 2B MW ç»‘å®šå…³ç³»æ—¶æ˜¯å¯ä»¥è¢«é”€æ¯çš„ã€‚&lt;/p>
&lt;p>è¿™é‡Œ IB è§„èŒƒä¸­åŸæœ‰çš„ä»‹ç»å°±æ¯”è¾ƒåˆ†æ•£ï¼Œæˆ‘ä»¬æ¥ç®€å•æ€»ç»“ä¸€ä¸‹å‡ ç§ MW çš„å¼‚åŒï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;/th>
&lt;th>Type 1&lt;/th>
&lt;th>Type 2A&lt;/th>
&lt;th>Type 2B&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>å…³è”å…³ç³»&lt;/td>
&lt;td>PD&lt;/td>
&lt;td>QP&lt;/td>
&lt;td>PD + QP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>R_Key çš„ key åŸŸå½’å±&lt;/td>
&lt;td>é©±åŠ¨+ç¡¬ä»¶&lt;/td>
&lt;td>ç”¨æˆ·&lt;/td>
&lt;td>ç”¨æˆ·&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ç»‘å®šæ–¹å¼&lt;/td>
&lt;td>Bind MW ç»‘å®šåä¹‹å‰çš„ R_Key è‡ªåŠ¨å¤±æ•ˆ&lt;/td>
&lt;td>Post Send Bind MWWR ç»‘å®šå‰éœ€è¦å…ˆä½¿ä¹‹å‰çš„ R_Key æ— æ•ˆåŒ–&lt;/td>
&lt;td>Post Send Bind MWWR ç»‘å®šå‰éœ€è¦å…ˆä½¿ä¹‹å‰çš„ R_Key æ— æ•ˆåŒ–&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æ˜¯å¦æ”¯æŒé›¶é•¿åº¦&lt;/td>
&lt;td>æ˜¯&lt;/td>
&lt;td>å¦&lt;/td>
&lt;td>å¦&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æ˜¯å¦æ”¯æŒ Invalidate&lt;/td>
&lt;td>å¦&lt;/td>
&lt;td>æ˜¯&lt;/td>
&lt;td>æ˜¯&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>å…³è”çš„ QP æ˜¯å¦å¯ä»¥è¢«é”€æ¯&lt;/td>
&lt;td>-&lt;/td>
&lt;td>å¦&lt;/td>
&lt;td>æ˜¯&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>æ­¤å¤–ï¼ŒIB è§„èŒƒä¸­å¯¹ä¸Šè¿°å‡ ç§ç±»å‹è¿˜æœ‰å¦‚ä¸‹æè¿°ï¼šHCA å¿…é¡»å®ç° Type 1 çš„ MWï¼Œå¦å¤–å¯ä»¥ä»…é€‰æ‹©å®ç° Type 2A å’Œ 2B ä¸­çš„ä¸€ç§ã€‚Type 1 å’Œ Type 2 çš„ MW å¯ä»¥åŒæ—¶å…³è”åˆ°åŒä¸€ä¸ª MR ä¸Šã€‚å› ä¸ºæˆ‘äº†è§£åˆ°çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ MW çš„æƒ…å†µä¸å¤šï¼Œæ‰€ä»¥å…·ä½“åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹åº”è¯¥ä½¿ç”¨å“ªç§ MW ä¹Ÿè¯´ä¸å‡ºæ‰€ä»¥ç„¶æ¥ï¼Œå¦‚æœè¯»è€…æœ‰å¯¹è¿™æ–¹é¢çš„äº†è§£æ¬¢è¿ä¸€èµ·äº¤æµã€‚&lt;/p>
&lt;p>å¥½äº†ï¼ŒMW å°±è®²åˆ°è¿™é‡Œï¼Œåˆ°æ­¤ä¸ºæ­¢ RDMA æŠ€æœ¯ä¸­å¸¸è§çš„èµ„æºå°±éƒ½ä»‹ç»å®Œäº†ã€‚&lt;/p>
&lt;p>é‰´äºä¸€èˆ¬æ”¯æŒ RDMA çš„è®¾å¤‡éƒ½æ¯”è¾ƒæ˜‚è´µï¼Œä¸‹ä¸€ç¯‡æˆ‘å°†ä»‹ç»å¦‚ä½•é€šè¿‡è½¯ä»¶æ¨¡æ‹Ÿè®¾å¤‡çš„æ–¹å¼â€”â€”å³ Soft-RoCE è¿›è¡Œä¸€äº›ç¼–ç¨‹å®éªŒã€‚&lt;/p>
&lt;h2 id="ib-è§„èŒƒç›¸å…³ç« èŠ‚">IB è§„èŒƒç›¸å…³ç« èŠ‚&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>3.5.3 Memory Keys ä»‹ç»&lt;/p>
&lt;/li>
&lt;li>
&lt;p>9.4.1.1 Invalidate æ“ä½œ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.6.7 æƒé™ç®¡ç†&lt;/p>
&lt;/li>
&lt;li>
&lt;p>11.2.10.9~12 ç›¸å…³ Verbs ä»‹ç»&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£&lt;/h2>
&lt;p>[1] IB Specification Vol 1-Release-1.4&lt;/p>
&lt;p>[2] Linux Kernel Networking - Implementation and Theory. Chapter 13&lt;/p></description></item><item><title>RDMA ä¹‹ Shared Receive Queue</title><link>https://cuterwrite.top/p/rdma-shared-receive-queue/</link><pubDate>Wed, 26 Jun 2024 23:34:00 +0000</pubDate><guid>https://cuterwrite.top/p/rdma-shared-receive-queue/</guid><description>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-16_116373922_p0_master1200.webp" alt="Featured image of post RDMA ä¹‹ Shared Receive Queue" />&lt;h1 id="rdma-ä¹‹-shared-receive-queue">RDMA ä¹‹ Shared Receive Queue&lt;/h1>
&lt;p>&lt;strong>æœ¬æ–‡æ¬¢è¿éå•†ä¸šè½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>å£°æ˜ï¼šä»…ç”¨äºæ”¶è—ï¼Œä¾¿äºé˜…è¯»&lt;/p>&lt;span class="cite">&lt;span>â€• &lt;/span>&lt;span>Savir, &lt;/span>&lt;a href="https://zhuanlan.zhihu.com/p/279904125">&lt;cite>çŸ¥ä¹ä¸“æ ï¼š11. RDMA ä¹‹ Shared Receive Queue&lt;/cite>&lt;/a>&lt;/span>&lt;/blockquote>
&lt;p>æˆ‘ä»¬æ›¾åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-element/" >ã€3. RDMA åŸºæœ¬å…ƒç´ ã€‘
&lt;/a>
ä¸­ç®€å•ä»‹ç»äº† SRQ çš„æ¦‚å¿µï¼Œæœ¬æ–‡å°†å¸¦å¤§å®¶äº†è§£æ›´å¤šå…³äº SRQ çš„ç»†èŠ‚ã€‚&lt;/p>
&lt;h2 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ&lt;/h2>
&lt;h3 id="ä»€ä¹ˆæ˜¯-srq">ä»€ä¹ˆæ˜¯ SRQ&lt;/h3>
&lt;p>å…¨ç§°ä¸º Shared Receive Queueï¼Œç›´è¯‘ä¸ºå…±äº«æ¥æ”¶é˜Ÿåˆ—ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒRDMA é€šä¿¡çš„åŸºæœ¬å•ä½æ˜¯ QPï¼Œæ¯ä¸ª QP éƒ½ç”±ä¸€ä¸ªå‘é€é˜Ÿåˆ— SQ å’Œæ¥æ”¶é˜Ÿåˆ— RQ ç»„æˆã€‚&lt;/p>
&lt;p>SRQ æ˜¯ IB åè®®ä¸ºäº†ç»™æ¥æ”¶ç«¯èŠ‚çœèµ„æºè€Œè®¾è®¡çš„ã€‚æˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ª RQ å…±äº«ç»™æ‰€æœ‰å…³è”çš„ QP ä½¿ç”¨ï¼Œè¿™ä¸ªå…¬ç”¨çš„ RQ å°±ç§°ä¸º SRQã€‚å½“ä¸å…¶å…³è”çš„ QP æƒ³è¦ä¸‹å‘æ¥æ”¶ WQE æ—¶ï¼Œéƒ½å¡«å†™åˆ°è¿™ä¸ª SRQ ä¸­ã€‚ç„¶åæ¯å½“ç¡¬ä»¶æ¥æ”¶åˆ°æ•°æ®åï¼Œå°±æ ¹æ® SRQ ä¸­çš„ä¸‹ä¸€ä¸ª WQE çš„å†…å®¹æŠŠæ•°æ®å­˜æ”¾åˆ°æŒ‡å®šä½ç½®ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_11_1.webp"
alt="2024-06-28_11_1" width="80%" loading="lazy">
&lt;/figure>
&lt;h3 id="ä¸ºä»€ä¹ˆè¦ç”¨-srq">ä¸ºä»€ä¹ˆè¦ç”¨ SRQ&lt;/h3>
&lt;p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å‘ SQ ä¸­ä¸‹ä»»åŠ¡çš„æ•°é‡è¦è¿œè¿œè¶…è¿‡å‘ RQ ä¸­ä¸‹å‘ä»»åŠ¡çš„æ•°é‡ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¯·å…ˆå›å¿†ä¸€ä¸‹å“ªäº›æ“ä½œç±»å‹ä¼šç”¨åˆ° SQï¼Œå“ªäº›åˆä¼šç”¨åˆ° RQã€‚&lt;/p>
&lt;p>SEND/WRITE/READ éƒ½éœ€è¦é€šä¿¡å‘èµ·æ–¹å‘ SQ ä¸­ä¸‹å‘ä¸€ä¸ª WRï¼Œè€Œåªæœ‰å’Œ SEND é…åˆçš„ RECV æ“ä½œæ‰éœ€è¦é€šä¿¡å“åº”æ–¹ä¸‹å‘ WR åˆ° RQ ä¸­ï¼ˆå¸¦ç«‹å³æ•°çš„ Write æ“ä½œä¹Ÿä¼šæ¶ˆè€— Receive WRï¼Œæˆ‘ä»¬è¿˜æ²¡è®²åˆ°ï¼‰ã€‚è€Œæˆ‘ä»¬åˆçŸ¥é“ï¼ŒSEND-RECV è¿™ä¸€å¯¹æ“ä½œé€šå¸¸éƒ½æ˜¯ç”¨äºä¼ é€’æ§åˆ¶ä¿¡æ¯ï¼ŒWRITE å’Œ READ æ‰æ˜¯è¿›è¡Œå¤§é‡è¿œç«¯å†…å­˜è¯»å†™æ“ä½œæ—¶çš„ä¸»è§’ï¼Œæ‰€ä»¥è‡ªç„¶ SQ çš„ä½¿ç”¨ç‡æ˜¯è¿œè¿œé«˜äº RQ çš„ã€‚&lt;/p>
&lt;p>æ¯ä¸ªé˜Ÿåˆ—éƒ½æ˜¯æœ‰å®ä½“çš„ï¼Œå ç”¨ç€å†…å­˜ä»¥åŠç½‘å¡çš„ç‰‡ä¸Šå­˜å‚¨ç©ºé—´ã€‚åœ¨å•†ç”¨åœºæ™¯ä¸‹ï¼ŒQP çš„æ•°é‡æ˜¯å¯èƒ½è¾¾åˆ°åä¸‡çº§ç”šè‡³æ›´é«˜çš„ï¼Œå¯¹å†…å­˜å®¹é‡æå‡ºäº†å¾ˆé«˜çš„è¦æ±‚ï¼Œå†…å­˜éƒ½æ˜¯ç™½èŠ±èŠ±çš„é“¶å­ä¹°çš„ï¼ŒSRQ å°±æ˜¯ IB åè®®ä¸ºäº†èŠ‚çœç”¨æˆ·çš„å†…å­˜è€Œè®¾è®¡çš„ä¸€ç§æœºåˆ¶ã€‚&lt;/p>
&lt;p>æ¥çœ‹ä¸€ä¸‹åè®®ä¸­å¯¹ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ SRQ çš„å®˜æ–¹è§£é‡Šï¼ˆ10.2.9.1 ç« èŠ‚ï¼‰ï¼š&lt;/p>
&lt;blockquote>
&lt;p>Without SRQ, an RC, UC or UD Consumer must post the number of receive WRs necessary to handle incoming receives on a given QP. If the Consumer cannot predict the incoming rate on a given QP, because, for example, the connection has a bursty nature, the Consumer must either: post a sufficient number of RQ WRs to handle the highest incoming rate for each connection, or, for RC, let message flow control cause the remote sender to back off until local Consumer posts more WRs.&lt;/p>
&lt;p>â€¢ Posting sufficient WRs on each QP to hold the possible incoming rate, wastes WQEs, and the associated Data Segments, when the Receive Queue is inactive. Furthermore, the HCA doesnâ€™t provide a way of reclaiming these WQEs for use on other connections.&lt;/p>
&lt;p>â€¢ Letting the RC message flow control cause the remote sender to back off can add unnecessary latencies, specially if the local Consumer is unaware that the RQ is starving.&lt;/p>
&lt;/blockquote>
&lt;p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ²¡æœ‰ SRQ çš„æƒ…å†µä¸‹ï¼Œå› ä¸º RC/UC/UD çš„æ¥æ”¶æ–¹ä¸çŸ¥é“å¯¹ç«¯ä»€ä¹ˆæ—¶å€™ä¼šå‘é€è¿‡æ¥å¤šå°‘æ•°æ®ï¼Œæ‰€ä»¥å¿…é¡»åšå¥½æœ€åçš„æ‰“ç®—ï¼Œåšå¥½çªå‘æ€§æ”¶åˆ°å¤§é‡æ•°æ®çš„å‡†å¤‡ï¼Œä¹Ÿå°±æ˜¯å‘ RQ ä¸­ä¸‹å‘è¶³é‡çš„æ¥æ”¶ WQEï¼›å¦å¤– RC æœåŠ¡ç±»å‹å¯ä»¥åˆ©ç”¨æµæ§æœºåˆ¶æ¥åå‹å‘é€æ–¹ï¼Œä¹Ÿå°±æ˜¯å‘Šè¯‰å¯¹ç«¯â€æˆ‘è¿™è¾¹ RQ WQE ä¸å¤Ÿäº†â€œï¼Œè¿™æ ·å‘é€ç«¯å°±ä¼šæš‚æ—¶æ”¾ç¼“æˆ–åœæ­¢å‘é€æ•°æ®ã€‚&lt;/p>
&lt;p>ä½†æ˜¯æ­£å¦‚æˆ‘ä»¬å‰æ–‡æ‰€è¯´ï¼Œç¬¬ä¸€ç§æ–¹æ³•ç”±äºæ˜¯ä¸ºæœ€åæƒ…å†µå‡†å¤‡çš„ï¼Œå¤§éƒ¨åˆ†æ—¶å€™æœ‰å¤§é‡çš„ RQ WQE å¤„äºç©ºé—²çŠ¶æ€æœªè¢«ä½¿ç”¨ï¼Œè¿™å¯¹å†…å­˜æ˜¯ä¸€ç§æå¤§åœ°æµªè´¹ï¼›ç¬¬äºŒç§æ–¹æ³•è™½ç„¶ä¸ç”¨ä¸‹å‘é‚£ä¹ˆå¤š RQ WQE äº†ï¼Œä½†æ˜¯æµæ§æ˜¯æœ‰ä»£ä»·çš„ï¼Œå³ä¼šå¢åŠ é€šä¿¡æ—¶å»¶ã€‚&lt;/p>
&lt;p>è€Œ SRQ é€šè¿‡å…è®¸å¾ˆå¤š QP å…±äº«æ¥æ”¶ WQEï¼ˆä»¥åŠç”¨äºå­˜æ”¾æ•°æ®çš„å†…å­˜ç©ºé—´ï¼‰æ¥è§£å†³äº†ä¸Šé¢çš„é—®é¢˜ã€‚å½“ä»»ä½•ä¸€ä¸ª QP æ”¶åˆ°æ¶ˆæ¯åï¼Œç¡¬ä»¶ä¼šä» SRQ ä¸­å–å‡ºä¸€ä¸ª WQEï¼Œæ ¹æ®å…¶å†…å®¹å­˜æ”¾æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œç„¶åç¡¬ä»¶é€šè¿‡ Completion Queue æ¥è¿”å›æ¥æ”¶ä»»åŠ¡çš„å®Œæˆä¿¡æ¯ç»™å¯¹åº”çš„ä¸Šå±‚ç”¨æˆ·ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä½¿ç”¨ SRQ æ¯”ä½¿ç”¨æ™®é€šçš„ RQ å¯ä»¥èŠ‚çœå¤šå°‘å†…å­˜&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>ï¼š&lt;/p>
&lt;p>å‡è®¾æ¥å—æ•°æ®çš„èŠ‚ç‚¹ä¸Šæœ‰ N å¯¹ QPï¼Œå¹¶ä¸”æ¯ä¸ª QP éƒ½å¯èƒ½åœ¨éšæœºçš„æ—¶é—´æ”¶åˆ°è¿ç»­çš„ M ä¸ªæ¶ˆæ¯ï¼ˆæ¯ä¸ªæ¶ˆæ¯éƒ½éœ€è¦æ¶ˆè€—ä¸€ä¸ª RQ ä¸­çš„ WQEï¼‰ï¼Œ&lt;/p>
&lt;ul>
&lt;li>å¦‚æœä¸ä½¿ç”¨ SRQ çš„è¯ï¼Œç”¨æˆ·ä¸€å…±éœ€è¦ä¸‹å‘ N * M ä¸ª RQ WQEã€‚&lt;/li>
&lt;li>å¦‚æœä½¿ç”¨ SRQ çš„è¯ï¼Œç”¨æˆ·åªéœ€è¦ä¸‹å‘ K * M ä¸ª RQ WQEï¼Œè€Œ K è¿œå°äº Nã€‚&lt;/li>
&lt;/ul>
&lt;p>è¿™ä¸ª K æ˜¯å¯ä»¥ç”±ç”¨æˆ·æ ¹æ®ä¸šåŠ¡æ¥é…ç½®çš„ï¼Œå¦‚æœå­˜åœ¨å¤§é‡çš„å¹¶å‘æ¥æ”¶çš„æƒ…å†µï¼Œé‚£ä¹ˆå°±æŠŠ K è®¾ç½®å¤§ä¸€ç‚¹ï¼Œå¦åˆ™ K è®¾ç½®æˆä¸ªä½æ•°å°±è¶³å¤Ÿåº”ä»˜ä¸€èˆ¬çš„æƒ…å†µäº†ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬ä¸€å…±èŠ‚çœäº† (N - K) * M ä¸ª RQ WQEï¼ŒRQ WQE æœ¬èº«å…¶å®ä¸æ˜¯å¾ˆå¤§ï¼Œå¤§çº¦åœ¨å‡ ä¸ª KB çš„æ ·å­ï¼Œçœ‹èµ·æ¥å¥½åƒå ä¸äº†å¤šå°‘å†…å­˜ã€‚ä½†æ˜¯å¦‚å‰æ–‡æ‰€è¯´ï¼Œå®é™…ä¸ŠèŠ‚çœçš„è¿˜æœ‰ç”¨äº&lt;strong>å­˜æ”¾æ•°æ®çš„å†…å­˜ç©ºé—´&lt;/strong>ï¼Œè¿™å¯æ˜¯å¾ˆå¤§ä¸€å—å†…å­˜äº†ï¼Œæˆ‘ä»¬ç”¨å›¾æ¥è¯´æ˜ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_11_2.webp"
alt="2024-06-28_11_2" width="80%" loading="lazy">
&lt;/figure>
&lt;p>ä¸Šå›¾ä¸­çš„ SRQ ä¸­æœ‰ä¸¤ä¸ª RQ WQEï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ RQ WQE çš„å†…å®¹ï¼Œå®ƒä»¬æ˜¯ç”±æ•°ä¸ª sgeï¼ˆScatter/Gather Elementï¼‰ç»„æˆçš„ï¼Œæ¯ä¸ª sge ç”±ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œé•¿åº¦å’Œç§˜é’¥ç»„æˆã€‚æœ‰äº†èµ·å§‹åœ°å€å’Œé•¿åº¦ï¼Œsge å°±å¯ä»¥æŒ‡å‘ä¸€å—è¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œé‚£ä¹ˆå¤šä¸ª sge å°±å¯ä»¥è¡¨ç¤ºå¤šä¸ªå½¼æ­¤ç¦»æ•£çš„è¿ç»­å†…å­˜å—ï¼Œæˆ‘ä»¬ç§°å¤šä¸ª sge ä¸º sglï¼ˆScatter/Gather Listï¼‰ã€‚sge åœ¨ IB è½¯ä»¶åè®®æ ˆä¸­éšå¤„å¯è§ï¼ˆå…¶å®åœ¨æ•´ä¸ª Linux éƒ½å¾ˆå¸¸è§ï¼‰ï¼Œå¯ä»¥ç”¨éå¸¸å°‘çš„ç©ºé—´è¡¨ç¤ºéå¸¸å¤§çš„å†…å­˜åŒºåŸŸï¼ŒIB çš„ç”¨æˆ·éƒ½ä½¿ç”¨ sge æ¥æŒ‡å®šå‘é€å’Œæ¥æ”¶åŒºåŸŸçš„ã€‚&lt;/p>
&lt;p>å¯ä»¥ç®€å•ä¼°ç®—ä¸‹æ¯ä¸ª sge å¯ä»¥æŒ‡å‘å¤šå¤§çš„å†…å­˜åŒºåŸŸï¼Œlength æ˜¯ä¸€ä¸ª 32bit çš„æ— ç¬¦å·æ•´å‹ï¼Œå¯ä»¥è¡¨ç¤º 4GB çš„ç©ºé—´ã€‚å‡è®¾ä¸€ä¸ª RQ WQE æœ€å¤§å¯ä»¥å­˜æ”¾ 256 ä¸ª sgeï¼Œé‚£ä¹ˆä¸€ä¸ª RQ WQE ä¸€å…±å°±æ˜¯ 1TBã€‚å½“ç„¶å®é™…ä¸Šä¸å¯èƒ½è¿™ä¹ˆå¤§ï¼Œè¿™é‡Œåªæ˜¯æƒ³ç›´è§‚çš„å‘Šè¯‰è¯»è€… RQ WQE èƒŒåå¯èƒ½å ç”¨ç€å¤šå¤§çš„å†…å­˜ç©ºé—´ã€‚&lt;/p>
&lt;h3 id="srqc">SRQC&lt;/h3>
&lt;p>å³ SRQ Contextã€‚åŒ QPC ä¸€æ ·ï¼ŒSRQC æ˜¯ç”¨æ¥å‘ŠçŸ¥ç¡¬ä»¶è·Ÿ SRQ æœ‰å…³çš„å±æ€§çš„ï¼ŒåŒ…æ‹¬æ·±åº¦ã€WQE å¤§å°ç­‰ä¿¡æ¯ï¼Œæœ¬æ–‡ä¸å†èµ˜è¿°äº†ã€‚&lt;/p>
&lt;h3 id="srqn">SRQN&lt;/h3>
&lt;p>å³ SRQ Numberã€‚åŒ QP ä¸€æ ·ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸­å¯èƒ½å­˜åœ¨å¤šä¸ª SRQï¼Œä¸ºäº†æ ‡è¯†å’ŒåŒºåˆ†è¿™äº› SRQï¼Œæ¯ä¸ª SRQ éƒ½æœ‰ä¸€ä¸ªåºå·ï¼Œç§°ä¸º SRQNã€‚&lt;/p>
&lt;h3 id="srq-çš„-pd">SRQ çš„ PD&lt;/h3>
&lt;p>æˆ‘ä»¬åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-protection-domain/" >ã€7. RDMA ä¹‹ Protection Domainã€‘
&lt;/a>
ä¸­ä»‹ç»è¿‡ Protection Domain çš„æ¦‚å¿µï¼Œå®ƒç”¨æ¥éš”ç¦»ä¸åŒçš„ RDMA èµ„æºã€‚æ¯ä¸ª SRQ éƒ½å¿…é¡»æŒ‡å®šä¸€ä¸ªè‡ªå·±çš„ PDï¼Œå¯ä»¥è·Ÿè‡ªå·±å…³è”çš„ QP çš„ PD ç›¸åŒï¼Œä¹Ÿå¯ä»¥ä¸åŒï¼›SRQ ä¹‹é—´ä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸åŒçš„ PDã€‚&lt;/p>
&lt;p>å¦‚æœåœ¨ä½¿ç”¨ SRQ çš„æ—¶å€™ï¼Œæ”¶åˆ°äº†æ•°æ®åŒ…ï¼Œé‚£ä¹ˆåªæœ‰åœ¨è¦è®¿é—®çš„ MR å’Œ SRQ å¤„äºåŒä¸€ä¸ª PD ä¸‹ï¼Œæ‰ä¼šæ­£å¸¸æ¥æ”¶è¿™ä¸ªæ•°æ®åŒ…ï¼Œå¦åˆ™ä¼šäº§ç”Ÿç«‹å³é”™è¯¯ã€‚&lt;/p>
&lt;h2 id="å¼‚æ­¥äº‹ä»¶">å¼‚æ­¥äº‹ä»¶&lt;/h2>
&lt;p>æˆ‘ä»¬åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-completion-queue/" >ã€10. RDMA ä¹‹ Completion Queueã€‘
&lt;/a>
ä¸€æ–‡ä¸­ä»‹ç»è¿‡ï¼ŒIB åè®®æ ¹æ®é”™è¯¯çš„ä¸ŠæŠ¥æ–¹å¼å°†é”™è¯¯ç±»å‹åˆ†ä¸ºç«‹å³é”™è¯¯ï¼Œå®Œæˆé”™è¯¯å’Œå¼‚æ­¥é”™è¯¯ã€‚å…¶ä¸­çš„å¼‚æ­¥é”™è¯¯ç±»ä¼¼äºä¸­æ–­/äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰æ—¶å€™ä¹Ÿç§°å…¶ä¸ºå¼‚æ­¥äº‹ä»¶ã€‚æ¯ä¸ª HCA éƒ½ä¼šæ³¨å†Œä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ä¸“é—¨ç”¨æ¥å¤„ç†å¼‚æ­¥äº‹ä»¶ï¼Œæ”¶åˆ°å¼‚æ­¥äº‹ä»¶åï¼Œé©±åŠ¨ç¨‹åºä¼šå¯¹å…¶è¿›è¡Œå¿…è¦çš„å¤„ç†å’Œè¿›ä¸€æ­¥ä¸ŠæŠ¥ç»™ç”¨æˆ·ã€‚&lt;/p>
&lt;p>å…³äº SRQ æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å¼‚æ­¥äº‹ä»¶ï¼Œç”¨æ¥åŠæ—¶é€šçŸ¥ä¸Šå±‚ç”¨æˆ· SRQ çš„çŠ¶æ€ï¼Œå³ SRQ Limit Reached äº‹ä»¶ã€‚&lt;/p>
&lt;h3 id="srq-limit">SRQ Limit&lt;/h3>
&lt;p>SRQ å¯ä»¥è®¾ç½®ä¸€ä¸ªæ°´çº¿/é˜ˆå€¼ï¼Œå½“é˜Ÿåˆ—ä¸­å‰©ä½™çš„ WQE æ•°é‡å°äºæ°´çº¿æ—¶ï¼Œè¿™ä¸ª SRQ ä¼šå°±ä¸ŠæŠ¥ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶ã€‚æé†’ç”¨æˆ·â€œé˜Ÿåˆ—ä¸­çš„ WQE å¿«ç”¨å®Œäº†ï¼Œè¯·ä¸‹å‘æ›´å¤š WQE ä»¥é˜²æ²¡æœ‰åœ°æ–¹æ¥æ”¶æ–°çš„æ•°æ®â€ã€‚è¿™ä¸ªæ°´çº¿/é˜ˆå€¼å°±è¢«ç§°ä¸º SRQ Limitï¼Œè¿™ä¸ªä¸ŠæŠ¥çš„äº‹ä»¶å°±è¢«ç§°ä¸º SRQ Limit Reachedã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_11_3.webp"
alt="2024-06-28_11_3" width="30%" loading="lazy">
&lt;/figure>
&lt;p>å› ä¸º SRQ æ˜¯å¤šä¸ª QP å…±äº«çš„ï¼Œæ‰€ä»¥å¦‚æœæ·±åº¦æ¯”è¾ƒå°çš„æƒ…å†µä¸‹ï¼Œå¾ˆæœ‰å¯èƒ½çªç„¶é‡Œé¢çš„ WQE å°±ç”¨å®Œäº†ã€‚æ‰€ä»¥åè®®è®¾è®¡äº†è¿™ç§æœºåˆ¶ï¼Œæ¥ä¿è¯ç”¨æˆ·èƒ½å¤ŸåŠæ—¶å¹²é¢„ WQE ä¸å¤Ÿçš„æƒ…å†µã€‚&lt;/p>
&lt;p>ä¸ŠæŠ¥å¼‚æ­¥äº‹ä»¶ä¹‹åï¼ŒSRQ Limit çš„å€¼ä¼šè¢«ç¡¬ä»¶é‡æ–°è®¾ç½®ä¸º 0ï¼ˆåº”è¯¥æ˜¯ä¸ºäº†é˜²æ­¢ä¸€ç›´ä¸ŠæŠ¥å¼‚æ­¥äº‹ä»¶ç»™ä¸Šå±‚ï¼‰ã€‚å½“ç„¶ç”¨æˆ·å¯ä»¥ä¸ä½¿ç”¨è¿™ä¸ªæœºåˆ¶ï¼Œåªéœ€è¦å°† SRQ Limit çš„å€¼è®¾ä¸º 0 å³å¯ã€‚&lt;/p>
&lt;h2 id="ç”¨æˆ·æ¥å£">ç”¨æˆ·æ¥å£&lt;/h2>
&lt;h3 id="æ§åˆ¶é¢">æ§åˆ¶é¢&lt;/h3>
&lt;p>è¿˜æ˜¯è€å››æ ·â€”â€”â€œå¢ã€åˆ ã€æ”¹ã€æŸ¥â€ï¼š&lt;/p>
&lt;ul>
&lt;li>åˆ›å»ºâ€”â€”Create SRQ&lt;/li>
&lt;/ul>
&lt;p>åˆ›å»º SRQ çš„æ—¶å€™ï¼Œè·Ÿ QP ä¸€æ ·ä¼šç”³è¯·æ‰€æœ‰ SRQ ç›¸å…³çš„è½¯ç¡¬ä»¶èµ„æºï¼Œæ¯”å¦‚é©±åŠ¨ç¨‹åºä¼šç”³è¯· SRQNï¼Œç”³è¯· SRQC çš„ç©ºé—´å¹¶å‘å…¶ä¸­å¡«å†™é…ç½®ã€‚åˆ›å»º SRQ æ—¶è¿˜å¿…é¡»æŒ‡å®šæ¯ä¸ª SRQ çš„æ·±åº¦ï¼ˆèƒ½å­˜æ”¾å¤šå°‘ WQEï¼‰ä»¥åŠæ¯ä¸ª WQE çš„æœ€å¤§ sge æ•°é‡ã€‚&lt;/p>
&lt;ul>
&lt;li>é”€æ¯â€”â€”Destroy SRQ&lt;/li>
&lt;/ul>
&lt;p>é”€æ¯ SRQ çš„æ‰€æœ‰ç›¸å…³è½¯ç¡¬ä»¶èµ„æºã€‚&lt;/p>
&lt;ul>
&lt;li>ä¿®æ”¹â€”â€”Modify SRQ&lt;/li>
&lt;/ul>
&lt;p>é™¤äº† SRQ æ·±åº¦ç­‰å±æ€§å¤–ï¼ŒSRQ Limit çš„å€¼ä¹Ÿæ˜¯é€šè¿‡è¿™ä¸ªæ¥å£è®¾ç½®çš„ã€‚å› ä¸ºæ¯æ¬¡äº§ç”Ÿ SRQ Limit Reached äº‹ä»¶ä¹‹åï¼Œæ°´çº¿çš„å€¼éƒ½ä¼šè¢«æ¸…é›¶ï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½éœ€è¦ç”¨æˆ·è°ƒç”¨ Modify SRQ é‡æ–°è®¾ç½®æ°´çº¿ã€‚&lt;/p>
&lt;ul>
&lt;li>æŸ¥è¯¢â€”â€”Query SRQ&lt;/li>
&lt;/ul>
&lt;p>é€šå¸¸æ˜¯ç”¨æ¥æŸ¥è¯¢æ°´çº¿çš„é…ç½®çš„ã€‚&lt;/p>
&lt;h3 id="æ•°æ®é¢">æ•°æ®é¢&lt;/h3>
&lt;h3 id="post-srq-receive">Post SRQ Receive&lt;/h3>
&lt;p>è·Ÿ Post Receive ä¸€æ ·ï¼Œå°±æ˜¯å‘ SRQ ä¸­ä¸‹å‘æ¥æ”¶ WQEï¼Œé‡Œé¢åŒ…å«äº†ä½œä¸ºæ¥æ”¶ç¼“å†²åŒºçš„å†…å­˜å—çš„ä¿¡æ¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ&lt;strong>ä¸»è¯­æ˜¯ SRQï¼Œä¸ QP æ²¡æœ‰ä»»ä½•å…³ç³»&lt;/strong>ï¼Œç°åœ¨ç”¨æˆ·æ˜¯ä¸å…³å¿ƒè¿™ä¸ª SRQ è¢«å“ªäº› QP å…³è”çš„ã€‚&lt;/p>
&lt;h2 id="srq-å’Œ-rq-çš„åŒºåˆ«">SRQ å’Œ RQ çš„åŒºåˆ«&lt;/h2>
&lt;p>ä»åŠŸèƒ½ä¸Šæ¥è¯´ï¼ŒSRQ å’Œ RQ ä¸€æ ·éƒ½æ˜¯ç”¨æ¥å‚¨å­˜æ¥æ”¶ä»»åŠ¡ä¹¦çš„ï¼Œä½†æ˜¯ç”±äº SRQ çš„å…±äº«æ€§ï¼Œæ‰€ä»¥å…¶å’Œ RQ æœ‰ä¸€äº›å·®å¼‚ã€‚&lt;/p>
&lt;h3 id="çŠ¶æ€æœº">çŠ¶æ€æœº&lt;/h3>
&lt;p>æˆ‘ä»¬åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-queue-pair/" >ã€9. RDMA ä¹‹ Queue Pairã€‘
&lt;/a>
ä¸­ä»‹ç»è¿‡ï¼ŒQP æœ‰ç€å¤æ‚çš„çŠ¶æ€æœºï¼Œä¸åŒçš„çŠ¶æ€ä¸‹ QP çš„æ”¶å‘èƒ½åŠ›å­˜åœ¨å·®å¼‚ã€‚è€Œ SRQ åªæœ‰éé”™è¯¯å’Œé”™è¯¯ä¸¤ç§çŠ¶æ€ï¼š&lt;/p>
&lt;p>æ— è®ºæ˜¯å“ªç§çŠ¶æ€ä¸‹ï¼Œç”¨æˆ·éƒ½å¯ä»¥å‘ SRQ ä¸­ä¸‹å‘ WQEï¼Œä½†æ˜¯åœ¨é”™è¯¯çŠ¶æ€ä¸‹ï¼Œç›¸å…³è”çš„ QP ä¸èƒ½ä»è¿™ä¸ª SRQ ä¸­è·å¾—æ”¶åˆ°çš„æ•°æ®ã€‚å¦å¤–åœ¨é”™è¯¯çŠ¶æ€ä¸‹ï¼Œç”¨æˆ·ä¹Ÿæ— æ³•æŸ¥è¯¢å’Œä¿®æ”¹ SRQ çš„å±æ€§ã€‚&lt;/p>
&lt;p>QP å¤„äºé”™è¯¯çŠ¶æ€æ—¶ï¼Œå¯ä»¥é€šè¿‡ Modify QP æ¥ä½¿å…¶å›åˆ° RESET çŠ¶æ€ï¼Œä½†æ˜¯å¯¹ SRQ æ¥è¯´ï¼Œåªèƒ½é€šè¿‡é”€æ¯å®ƒæ¥é€€å‡ºé”™è¯¯çŠ¶æ€ã€‚&lt;/p>
&lt;h3 id="æ¥æ”¶æµç¨‹">æ¥æ”¶æµç¨‹&lt;/h3>
&lt;p>å¯¹äºä¸€ä¸ª QP æ¥è¯´ï¼ŒRQ å’Œ SRQ ä¸èƒ½åŒæ—¶ä½¿ç”¨ï¼Œä¸¤è€…éœ€é€‰å…¶ä¸€ï¼Œå¦‚æœå¯¹ä¸€ä¸ªå·²ç»å…³è” SRQ çš„ QP çš„ RQ ä¸‹å‘ WQEï¼Œé‚£ä¹ˆä¼šè¿”å›ä¸€ä¸ªç«‹å³é”™è¯¯ã€‚&lt;/p>
&lt;p>ä¸‹é¢æˆ‘ä»¬æ¥å¯¹æ¯”çœ‹ä¸€ä¸‹ SRQ å’Œ RQ çš„æ¥æ”¶æµç¨‹ã€‚æœ¬å°ç»“çš„å†…å®¹æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œç›¸ä¿¡è¯»è€…çœ‹è¿‡ä¹‹åï¼Œå°±å¯¹ SRQ çš„æœºåˆ¶æœ‰æ¯”è¾ƒå®Œæ•´çš„äº†è§£äº†ã€‚&lt;/p>
&lt;h3 id="rq-çš„æ¥æ”¶æµç¨‹">RQ çš„æ¥æ”¶æµç¨‹&lt;/h3>
&lt;p>é¦–å…ˆï¼Œæˆ‘ä»¬é‡æ¸©ä¸€ä¸‹æ™®é€š RQ çš„æ¥æ”¶æµç¨‹ï¼ˆç»“åˆå‘é€ç«¯çš„å®Œæ•´æµç¨‹è¯·é˜…è¯» &lt;a class="link" href="https://cuterwrite.top/p/rdma-op/" >ã€4. RDMA æ“ä½œç±»å‹ã€‘
&lt;/a>
ï¼‰ä¸€æ–‡ï¼‰ï¼š&lt;/p>
&lt;ol start="0">
&lt;li>
&lt;p>åˆ›å»º QPã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é€šè¿‡ Post Recv æ¥å£ï¼Œç”¨æˆ·åˆ†åˆ«å‘ QP2 å’Œ QP3 çš„ RQ ä¸‹å‘æ¥æ”¶ WQEï¼ŒWQE ä¸­åŒ…å«æ¥æ”¶åˆ°æ•°æ®åæ”¾åˆ°å“ªå—å†…å­˜åŒºåŸŸçš„ä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶æ”¶åˆ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç°æ˜¯å‘ç»™ QP3 çš„ï¼Œé‚£ä¹ˆä» QP3 çš„ RQ ä¸­å–å‡º WQE1ï¼Œå°†æ¥æ”¶åˆ°çš„æ•°æ®æ”¾åˆ° WQE1 æŒ‡å®šçš„å†…å­˜åŒºåŸŸã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å®Œæˆæ•°æ®å­˜æ”¾åï¼Œå‘ QP3 çš„ RQ å…³è”çš„ CQ3 äº§ç”Ÿä¸€ä¸ª CQEï¼Œä¸ŠæŠ¥ä»»åŠ¡å®Œæˆä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”¨æˆ·ä» CQ3 ä¸­å–å‡º WCï¼ˆCQEï¼‰ï¼Œç„¶åä»æŒ‡å®šå†…å­˜åŒºåŸŸå–èµ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶æ”¶åˆ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç°æ˜¯å‘é€ç»™ QP2 çš„ï¼Œé‚£ä¹ˆä» QP2 çš„ RQ ä¸­å–å‡º WQE1ï¼Œå°†æ¥æ”¶åˆ°çš„æ•°æ®æ”¾åˆ° WQE1 æŒ‡å®šçš„å†…å­˜åŒºåŸŸã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å®Œæˆæ•°æ®å­˜æ”¾åï¼Œå‘ QP2 çš„ RQ å…³è”çš„ CQ2 äº§ç”Ÿä¸€ä¸ª CQEï¼Œä¸ŠæŠ¥ä»»åŠ¡å®Œæˆä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”¨æˆ·ä» CQ2 ä¸­å–å‡º WCï¼ˆCQEï¼‰ï¼Œç„¶åä»æŒ‡å®šå†…å­˜åŒºåŸŸå–èµ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_11_4.webp"
alt="2024-06-28_11_4" width="90%" loading="lazy">
&lt;/figure>
&lt;h3 id="srq-çš„æ¥æ”¶æµç¨‹">SRQ çš„æ¥æ”¶æµç¨‹&lt;/h3>
&lt;p>è€Œ SRQ çš„æ¥æ”¶æµç¨‹æœ‰ä¸€äº›åŒºåˆ«ï¼š&lt;/p>
&lt;ol start="0">
&lt;li>
&lt;p>åˆ›å»º SRQ1ï¼Œå¹¶åˆ›å»º QP2 å’Œ QP3ï¼Œéƒ½å…³è”åˆ° SRQ1 ä¸Šã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é€šè¿‡ Post SRQ Recv æ¥å£ï¼Œç”¨æˆ·å‘ SRQ1 ä¸­ä¸‹å‘ä¸¤ä¸ªæ¥æ”¶ WQEï¼ŒWQE ä¸­åŒ…å«æ¥æ”¶åˆ°æ•°æ®åæ”¾åˆ°å“ªå—å†…å­˜åŒºåŸŸçš„ä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶æ”¶åˆ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç°æ˜¯å‘ç»™ QP3 çš„ï¼Œä» SRQ1 ä¸­å–å‡ºç¬¬ä¸€ä¸ª WQEï¼ˆç°åœ¨æ˜¯ WQE1ï¼‰ï¼Œæ ¹æ® WQE å†…å®¹å­˜æ”¾æ”¶åˆ°çš„æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>SRQ ä¸­çš„æ¯ä¸ª WQE æ˜¯â€œæ— ä¸»çš„â€œï¼Œä¸å…³è”åˆ°ä»»ä½•ä¸€ä¸ª QPï¼Œç¡¬ä»¶æŒ‰é˜Ÿåˆ—é¡ºåºä¾æ¬¡å–å‡º WQE å°±æŠŠæ•°æ®æ”¾åˆ°é‡Œé¢äº†ã€‚&lt;/p>
&lt;/blockquote>
&lt;ol start="4">
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç° QP3 çš„ RQ å…³è”çš„ CQ æ˜¯ CQ3ï¼Œæ‰€ä»¥å‘å…¶ä¸­äº§ç”Ÿä¸€ä¸ª CQEã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”¨æˆ·ä» CQ3 ä¸­å–å‡º CQEï¼Œä»æŒ‡å®šå†…å­˜åŒºåŸŸå–èµ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>ç»†å¿ƒåœ°è¯»è€…å¯èƒ½ä¼šé—®ï¼Œç”¨æˆ·ä¸‹å‘ WR æ—¶ï¼Œæ¯ä¸ª WR éƒ½æŒ‡å®šäº†ä¸€äº›æœªæ¥ç”¨æ¥å­˜æ”¾æ•°æ®çš„å†…å­˜åŒºåŸŸã€‚ä½†æ˜¯ SRQ æ˜¯ä¸€ä¸ªæ± å­ï¼Œé‡Œé¢æ¯ä¸ª WQE éƒ½æŒ‡å‘äº†ä¸åŒçš„è‹¥å¹²æ®µå†…å­˜åŒºåŸŸã€‚ç”¨æˆ·æ”¶åˆ°æŸä¸ª QP å¯¹åº”çš„ CQ ä¸­çš„ WC åå¦‚ä½•çŸ¥é“æ¥æ”¶åˆ°çš„æ•°æ®å­˜æ”¾åˆ°å“ªé‡Œäº†å‘¢ï¼Ÿ&lt;/p>
&lt;p>WC ä¸­å…¶å®æœ‰ wr_id ä¿¡æ¯ï¼Œå‘ŠçŸ¥ç”¨æˆ·æ•°æ®æ”¾åˆ°å“ªä¸ª WRï¼ˆWQEï¼‰æŒ‡å®šçš„å†…å­˜åŒºåŸŸäº†ï¼Œæ—¢ç„¶ WR æ˜¯ç”¨æˆ·ä¸‹å‘çš„ï¼Œç”¨æˆ·è‡ªç„¶çŸ¥é“å…¶æŒ‡å‘çš„å…·ä½“ä½ç½®ã€‚&lt;/p>
&lt;/blockquote>
&lt;ol start="6">
&lt;li>
&lt;p>ç¡¬ä»¶æ”¶åˆ°æ•°æ®&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç°æ˜¯å‘ç»™ QP2 çš„ï¼Œä» SRQ1 ä¸­å–å‡ºç¬¬ä¸€ä¸ª WQEï¼ˆç°åœ¨æ˜¯ WQE2ï¼‰ï¼Œæ ¹æ® WQE å†…å®¹å­˜æ”¾æ”¶åˆ°çš„æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç° QP2 çš„ RQ å…³è”çš„ CQ æ˜¯ CQ2ï¼Œæ‰€ä»¥å‘å…¶ä¸­äº§ç”Ÿä¸€ä¸ª CQEã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”¨æˆ·ä» CQ2 ä¸­å–å‡º CQEï¼Œä»æŒ‡å®šå†…å­˜åŒºåŸŸå–èµ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-28_11_5.webp"
alt="2024-06-28_11_5" width="90%" loading="lazy">
&lt;/figure>
&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;p>æœ¬æ–‡é¦–å…ˆä»‹ç»äº† SRQ çš„åŸºæœ¬æ¦‚å¿µï¼Œç„¶åæ˜¯å…¶è®¾è®¡åˆè¡·ã€ç›¸å…³æœºåˆ¶å’Œç”¨æˆ·æ¥å£ï¼Œæœ€åå¯¹æ¯” RQ æè¿°äº† SRQ çš„æ¥æ”¶æµç¨‹ã€‚åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼ŒSRQ çš„ä½¿ç”¨ç‡è¿˜æ˜¯è›®é«˜çš„ï¼Œå¸Œæœ›è¯»è€…èƒ½å¤Ÿæ·±å…¥ç†è§£ã€‚&lt;/p>
&lt;p>å°±å†™åˆ°è¿™é‡Œå§ï¼Œæ„Ÿè°¢é˜…è¯»ã€‚ä¸‹ä¸€ç¯‡æˆ‘å°†ç»™å¤§å®¶ä»‹ç»ä¸‹ Memeory Windowã€‚&lt;/p>
&lt;h2 id="åè®®ç›¸å…³ç« èŠ‚">åè®®ç›¸å…³ç« èŠ‚&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>10.2.9 SRQ çš„è®¾è®¡æ€æƒ³ä»¥åŠç›¸å…³æ“ä½œ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.2.3 SRQ å’Œ QP çš„ PD&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.8.2 å…³è” SRQ çš„ QP å’Œä¸ä½¿ç”¨ SRQ çš„ QP çš„å…³ç³»&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.8.5 SRQ ç›¸å…³çš„è¿”å› WC&lt;/p>
&lt;/li>
&lt;li>
&lt;p>11.5.2.4 å¼‚æ­¥äº‹ä»¶&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="å…¶ä»–å‚è€ƒèµ„æ–™">å…¶ä»–å‚è€ƒèµ„æ–™&lt;/h2>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Linux Kernel Networking - Implement and Theory. Chapter 13. Shared Receive Queue&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>RDMA ä¹‹ Completion Queue</title><link>https://cuterwrite.top/p/rdma-completion-queue/</link><pubDate>Wed, 26 Jun 2024 23:11:00 +0000</pubDate><guid>https://cuterwrite.top/p/rdma-completion-queue/</guid><description>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-16_116903369_p0_master1200.webp" alt="Featured image of post RDMA ä¹‹ Completion Queue" />&lt;h1 id="rdma-ä¹‹-completion-queue">RDMA ä¹‹ Completion Queue&lt;/h1>
&lt;p>&lt;strong>æœ¬æ–‡æ¬¢è¿éå•†ä¸šè½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>å£°æ˜ï¼šä»…ç”¨äºæ”¶è—ï¼Œä¾¿äºé˜…è¯»&lt;/p>&lt;span class="cite">&lt;span>â€• &lt;/span>&lt;span>Savir, &lt;/span>&lt;a href="https://zhuanlan.zhihu.com/p/259650980">&lt;cite>çŸ¥ä¹ä¸“æ ï¼š10. RDMA ä¹‹ Completion Queue&lt;/cite>&lt;/a>&lt;/span>&lt;/blockquote>
&lt;p>æˆ‘ä»¬æ›¾ç»åœ¨å‰é¢çš„æ–‡ç« ä¸­ç®€å•ä»‹ç»è¿‡ CQï¼Œæœ¬æ–‡å°†æ›´æ·±å…¥çš„è®²è§£å…³äºå®ƒçš„ä¸€äº›ç»†èŠ‚ã€‚é˜…è¯»æœ¬æ–‡å‰ï¼Œè¯»è€…å¯ä»¥å…ˆæ¸©ä¹ ä¸€ä¸‹è¿™ç¯‡æ–‡ç« ï¼š &lt;a class="link" href="https://cuterwrite.top/p/rdma-element/" >ã€â€œ3. RDMA åŸºæœ¬å…ƒç´ â€ã€‘
&lt;/a>
ã€‚&lt;/p>
&lt;h2 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ&lt;/h2>
&lt;p>æˆ‘ä»¬å…ˆå›é¡¾ä¸‹ CQ çš„ä½œç”¨ã€‚CQ æ„ä¸ºå®Œæˆé˜Ÿåˆ—ï¼Œå®ƒçš„ä½œç”¨å’Œ WQï¼ˆSQ å’Œ RQï¼‰ç›¸åï¼Œç¡¬ä»¶é€šè¿‡ CQ ä¸­çš„ CQE/WC æ¥å‘Šè¯‰è½¯ä»¶æŸä¸ª WQE/WR çš„å®Œæˆæƒ…å†µã€‚å†æ¬¡æé†’è¯»è€…ï¼Œå¯¹äºä¸Šå±‚ç”¨æˆ·æ¥è¯´ä¸€èˆ¬ç”¨ WCï¼Œå¯¹äºé©±åŠ¨ç¨‹åºæ¥è¯´ï¼Œä¸€èˆ¬ç§°ä¸º CQEï¼Œæœ¬æ–‡ä¸å¯¹ä¸¤è€…è¿›è¡ŒåŒºåˆ†ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-27_10_1.webp"
alt="2024-06-27_10_1" width="80%" loading="lazy">
&lt;/figure>
&lt;p>CQE å¯ä»¥çœ‹ä½œä¸€ä»½â€œæŠ¥å‘Šâ€ï¼Œå…¶ä¸­å†™æ˜äº†æŸä¸ªä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>æœ¬æ¬¡å®Œæˆäº†å“ªä¸ª QP çš„å“ªä¸€ä¸ª WQE æŒ‡å®šçš„ä»»åŠ¡ï¼ˆQP Number å’Œ WR IDï¼‰&lt;/li>
&lt;li>æœ¬æ¬¡ä»»åŠ¡æ‰§è¡Œäº†ä»€ä¹ˆæ“ä½œï¼ˆOpcode æ“ä½œç±»å‹ï¼‰&lt;/li>
&lt;li>æœ¬æ¬¡ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ/å¤±è´¥ï¼Œå¤±è´¥åŸå› æ˜¯ XXXï¼ˆStatus çŠ¶æ€å’Œé”™è¯¯ç ï¼‰&lt;/li>
&lt;li>&amp;hellip;&lt;/li>
&lt;/ul>
&lt;p>æ¯å½“ç¡¬ä»¶å¤„ç†å®Œä¸€ä¸ª WQE ä¹‹åï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ª CQE æ”¾åœ¨ CQ é˜Ÿåˆ—ä¸­ã€‚å¦‚æœä¸€ä¸ª WQE å¯¹åº”çš„ CQE æ²¡æœ‰äº§ç”Ÿï¼Œé‚£ä¹ˆè¿™ä¸ª WQE å°±ä¼šä¸€ç›´è¢«è®¤ä¸ºè¿˜æœªå¤„ç†å®Œï¼Œè¿™æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p>
&lt;ul>
&lt;li>æ¶‰åŠä»å†…å­˜ä¸­å–æ•°æ®çš„æ“ä½œï¼ˆSEND å’Œ WRITEï¼‰&lt;/li>
&lt;/ul>
&lt;p>åœ¨äº§ç”Ÿ CQE ä¹‹å‰ï¼Œç¡¬ä»¶å¯èƒ½è¿˜æœªå‘é€æ¶ˆæ¯ï¼Œå¯èƒ½æ­£åœ¨å‘é€æ¶ˆæ¯ï¼Œå¯èƒ½å¯¹ç«¯æœ‰æ¥æ”¶åˆ°æ­£ç¡®çš„æ¶ˆæ¯ã€‚ç”±äºå†…å­˜åŒºåŸŸæ˜¯åœ¨å‘é€å‰ç”³è¯·å¥½çš„ï¼Œæ‰€ä»¥ä¸Šå±‚è½¯ä»¶æ”¶åˆ°å¯¹åº”çš„ CQE ä¹‹å‰ï¼Œå…¶å¿…é¡»è®¤ä¸ºè¿™ç‰‡å†…å­˜åŒºåŸŸä»åœ¨ä½¿ç”¨ä¸­ï¼Œä¸èƒ½å°†æ‰€æœ‰ç›¸å…³çš„å†…å­˜èµ„æºè¿›è¡Œé‡Šæ”¾ã€‚&lt;/p>
&lt;ul>
&lt;li>æ¶‰åŠå‘å†…å­˜ä¸­å­˜æ”¾æ•°æ®çš„æ“ä½œï¼ˆRECV å’Œ READï¼‰&lt;/li>
&lt;/ul>
&lt;p>åœ¨äº§ç”Ÿ CQE ä¹‹å‰ï¼Œæœ‰å¯èƒ½ç¡¬ä»¶è¿˜æ²¡æœ‰å¼€å§‹å†™å…¥æ•°æ®ï¼Œæœ‰å¯èƒ½æ•°æ®æ‰å†™äº†ä¸€åŠï¼Œä¹Ÿæœ‰å¯èƒ½æ•°æ®æ ¡éªŒå‡ºé”™ã€‚æ‰€ä»¥ä¸Šå±‚è½¯ä»¶åœ¨è·å¾— CQE ä¹‹å‰ï¼Œè¿™æ®µç”¨äºå­˜æ”¾æ¥æ”¶æ•°æ®çš„å†…å­˜åŒºåŸŸä¸­çš„å†…å®¹æ˜¯ä¸å¯ä¿¡çš„ã€‚&lt;/p>
&lt;p>æ€»ä¹‹ï¼Œç”¨æˆ·å¿…é¡»è·å–åˆ° CQE å¹¶ç¡®è®¤å…¶å†…å®¹ä¹‹åæ‰èƒ½è®¤ä¸ºæ¶ˆæ¯æ”¶å‘ä»»åŠ¡å·²ç»å®Œæˆã€‚&lt;/p>
&lt;h3 id="ä½•æ—¶äº§ç”Ÿ">ä½•æ—¶äº§ç”Ÿ&lt;/h3>
&lt;p>æˆ‘ä»¬å°†æŒ‰ç…§æœåŠ¡ç±»å‹ï¼ˆæœ¬ç¯‡åªè®² RC å’Œ UDï¼‰å’Œæ“ä½œç±»å‹æ¥åˆ†åˆ«è¯´æ˜ï¼Œå› ä¸ºä¸åŒçš„æƒ…å†µäº§ç”Ÿ CQE çš„æ—¶æœºå’Œå«ä¹‰éƒ½ä¸åŒï¼Œå»ºè®®è¯»è€…å›é¡¾ç¬¬ 4 ç¯‡&lt;a class="link" href="https://cuterwrite.top/p/rdma-op/" >ã€â€œ4. RDMA åŸºæœ¬æ“ä½œâ€ã€‘
&lt;/a>
å’Œç¬¬ 5 ç¯‡&lt;a class="link" href="https://cuterwrite.top/p/rdma-service-types/" >ã€â€œ5. RDMA åŸºæœ¬æœåŠ¡ç±»å‹â€ã€‘
&lt;/a>
ã€‚&lt;/p>
&lt;ul>
&lt;li>å¯é æœåŠ¡ç±»å‹ï¼ˆRCï¼‰&lt;/li>
&lt;/ul>
&lt;p>å‰é¢çš„æ–‡ç« è¯´è¿‡ï¼Œ&lt;strong>å¯é æ„å‘³ç€æœ¬ç«¯å…³å¿ƒå‘å‡ºçš„æ¶ˆæ¯èƒ½å¤Ÿè¢«å¯¹ç«¯å‡†ç¡®çš„æ¥æ”¶&lt;/strong>ï¼Œè¿™æ˜¯é€šè¿‡ ACKã€æ ¡éªŒå’Œé‡ä¼ ç­‰æœºåˆ¶ä¿è¯çš„ã€‚&lt;/p>
&lt;ul>
&lt;li>SEND&lt;/li>
&lt;/ul>
&lt;p>SEND æ“ä½œéœ€è¦ç¡¬ä»¶ä»å†…å­˜ä¸­è·å–æ•°æ®ï¼Œç„¶åç»„è£…æˆæ•°æ®åŒ…é€šè¿‡ç‰©ç†é“¾è·¯å‘é€åˆ°å¯¹ç«¯ã€‚å¯¹ SEND æ¥è¯´ï¼ŒClient ç«¯äº§ç”Ÿ CQE è¡¨ç¤º&lt;strong>å¯¹ç«¯å·²å‡†ç¡®æ— è¯¯çš„æ”¶åˆ°æ•°æ®&lt;/strong>ï¼Œå¯¹ç«¯ç¡¬ä»¶æ”¶åˆ°æ•°æ®å¹¶æ ¡éªŒä¹‹åï¼Œä¼šå›å¤ ACK åŒ…ç»™å‘é€æ–¹ã€‚å‘é€æ–¹æ”¶åˆ°è¿™ ACK ä¹‹åæ‰ä¼šäº§ç”Ÿ CQEï¼Œä»è€Œå‘Šè¯‰ç”¨æˆ·è¿™ä¸ªä»»åŠ¡æˆåŠŸæ‰§è¡Œäº†ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œå·¦ä¾§ Client ç«¯åœ¨çº¢ç‚¹çš„ä½ç½®äº§ç”Ÿäº†æœ¬æ¬¡ä»»åŠ¡çš„ CQEã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-27_10_2.webp"
alt="2024-06-27_10_2" width="50%" loading="lazy">
&lt;/figure>
&lt;ul>
&lt;li>RECV&lt;/li>
&lt;/ul>
&lt;p>RECV æ“ä½œéœ€è¦ç¡¬ä»¶å°†æ”¶åˆ°çš„æ•°æ®æ”¾åˆ°ç”¨æˆ· WQE ä¸­æŒ‡å®šçš„å†…å­˜åŒºåŸŸï¼Œå®Œæˆæ ¡éªŒå’Œæ•°æ®å­˜æ”¾åŠ¨ä½œåï¼Œç¡¬ä»¶å°±ä¼šäº§ç”Ÿ CQEã€‚å¦‚ä¸Šå›¾å³ä¾§ Server ç«¯æ‰€ç¤ºã€‚&lt;/p>
&lt;ul>
&lt;li>WRITE&lt;/li>
&lt;/ul>
&lt;p>å¯¹äº Client ç«¯æ¥è¯´ï¼ŒWRITE æ“ä½œå’Œ SEND æ“ä½œæ˜¯ä¸€æ ·çš„ï¼Œç¡¬ä»¶ä¼šä»å†…å­˜ä¸­å–å‡ºæ•°æ®ï¼Œå¹¶ç­‰å¾…å¯¹ç«¯å›å¤ ACK åï¼Œæ‰ä¼šäº§ç”Ÿ CQEã€‚å·®åˆ«åœ¨äºï¼Œå› ä¸º WRITE æ˜¯ RDMA æ“ä½œï¼Œå¯¹ç«¯ CPU ä¸æ„ŸçŸ¥ï¼Œè‡ªç„¶ç”¨æˆ·ä¹Ÿä¸æ„ŸçŸ¥ï¼Œæ‰€ä»¥ä¸Šé¢çš„å›¾å˜æˆäº†è¿™æ ·ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-27_10_3.webp"
alt="2024-06-27_10_3" width="50%" loading="lazy">
&lt;/figure>
&lt;ul>
&lt;li>READ&lt;/li>
&lt;/ul>
&lt;p>READ å’Œ RECV æœ‰ç‚¹åƒï¼ŒClient ç«¯å‘èµ· READ æ“ä½œåï¼Œå¯¹ç«¯ä¼šå›å¤æˆ‘ä»¬æƒ³è¯»å–çš„æ•°æ®ï¼Œç„¶åæœ¬ç«¯æ ¡éªŒæ²¡é—®é¢˜åï¼Œä¼šæŠŠæ•°æ®æ”¾åˆ° WQE ä¸­æŒ‡å®šçš„ä½ç½®ã€‚å®Œæˆä¸Šè¿°åŠ¨ä½œåï¼Œæœ¬ç«¯ä¼šäº§ç”Ÿ CQEã€‚READ åŒæ ·æ˜¯ RDMA æ“ä½œï¼Œå¯¹ç«¯ç”¨æˆ·ä¸æ„ŸçŸ¥ï¼Œè‡ªç„¶ä¹Ÿæ²¡æœ‰ CQE äº§ç”Ÿã€‚è¿™ç§æƒ…å†µä¸Šå›¾å˜æˆäº†è¿™æ ·ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-27_10_4.webp"
alt="2024-06-27_10_4" width="50%" loading="lazy">
&lt;/figure>
&lt;ul>
&lt;li>ä¸å¯é æœåŠ¡ç±»å‹ï¼ˆUDï¼‰&lt;/li>
&lt;/ul>
&lt;p>å› ä¸ºä¸å¯é çš„æœåŠ¡ç±»å‹æ²¡æœ‰é‡ä¼ å’Œç¡®è®¤æœºåˆ¶ï¼Œæ‰€ä»¥äº§ç”Ÿ CQE è¡¨ç¤ºç¡¬ä»¶&lt;strong>å·²ç»å°†å¯¹åº” WQE æŒ‡å®šçš„æ•°æ®å‘é€å‡ºå»äº†&lt;/strong>ã€‚ä»¥å‰è¯´è¿‡ UD åªæ”¯æŒ SEND-RECV æ“ä½œï¼Œä¸æ”¯æŒ RDMA æ“ä½œã€‚æ‰€ä»¥å¯¹äº UD æœåŠ¡çš„ä¸¤ç«¯ï¼ŒCQE äº§ç”Ÿæ—¶æœºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-27_10_5.webp"
alt="2024-06-27_10_5" width="50%" loading="lazy">
&lt;/figure>
&lt;h3 id="wq-å’Œ-cq-çš„å¯¹åº”å…³ç³»">WQ å’Œ CQ çš„å¯¹åº”å…³ç³»&lt;/h3>
&lt;p>&lt;strong>æ¯ä¸ª WQ éƒ½å¿…é¡»å…³è”ä¸€ä¸ª CQï¼Œè€Œæ¯ä¸ª CQ å¯ä»¥å…³è”å¤šä¸ª SQ å’Œ RQã€‚&lt;/strong>&lt;/p>
&lt;p>è¿™é‡Œçš„æ‰€è°“â€œå…³è”â€ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ª WQ çš„æ‰€æœ‰ WQE å¯¹åº”çš„ CQEï¼Œéƒ½ä¼šè¢«ç¡¬ä»¶æ”¾åˆ°ç»‘å®šçš„ CQ ä¸­ï¼Œéœ€è¦æ³¨æ„åŒå±äºä¸€ä¸ª QP çš„ SQ å’Œ RQ å¯ä»¥å„è‡ªå…³è”ä¸åŒçš„ CQã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒQP1 çš„ SQ å’Œ RQ éƒ½å…³è”äº† CQ1ï¼ŒQP2 çš„ RQ å…³è”åˆ°äº† CQ1ã€SQ å…³è”åˆ°äº† CQ2ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-27_10_6.webp"
alt="2024-06-27_10_6" width="auto" loading="lazy">
&lt;/figure>
&lt;p>å› ä¸ºæ¯ä¸ª WQ å¿…é¡»å…³è”ä¸€ä¸ª CQï¼Œæ‰€ä»¥ç”¨æˆ·åˆ›å»º QP å‰éœ€è¦æå‰åˆ›å»ºå¥½ CQï¼Œç„¶ååˆ†åˆ«æŒ‡å®š SQ å’Œ RQ å°†ä¼šä½¿ç”¨çš„ CQã€‚&lt;/p>
&lt;p>&lt;strong>åŒä¸€ä¸ª WQ ä¸­çš„ WQEï¼Œå…¶å¯¹åº”çš„ CQE é—´æ˜¯ä¿åºçš„&lt;/strong>&lt;/p>
&lt;p>ç¡¬ä»¶æ˜¯æŒ‰ç…§â€œå…ˆè¿›å…ˆå‡ºâ€çš„ FIFO é¡ºåºä»æŸä¸€ä¸ª WQï¼ˆSQ æˆ–è€… RQï¼‰ä¸­å–å‡º WQE å¹¶è¿›è¡Œå¤„ç†çš„ï¼Œè€Œå‘ WR å…³è”çš„ CQ ä¸­å­˜æ”¾ CQE æ—¶ï¼Œä¹Ÿæ˜¯éµä»è¿™äº› WQE è¢«æ”¾åˆ° WQ ä¸­çš„é¡ºåºçš„ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è°å…ˆè¢«æ”¾åˆ°é˜Ÿåˆ—é‡Œï¼Œè°å°±å…ˆè¢«å®Œæˆã€‚è¯¥è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-27_10_7.webp"
alt="2024-06-27_10_7" width="auto" loading="lazy">
&lt;/figure>
&lt;p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ SRQ çš„æƒ…å†µä»¥åŠ RD æœåŠ¡ç±»å‹çš„ RQ è¿™ä¸¤ç§æƒ…å†µæ˜¯ä¸ä¿åºçš„ï¼Œæœ¬æ–‡ä¸­ä¸å±•å¼€è®¨è®ºã€‚&lt;/p>
&lt;p>&lt;strong>ä¸åŒ WQ ä¸­çš„ WQEï¼Œå…¶å¯¹åº”çš„ CQE é—´æ˜¯ä¸ä¿åºçš„&lt;/strong>&lt;/p>
&lt;p>å‰æ–‡ä¸­æˆ‘ä»¬è¯´è¿‡ï¼Œä¸€ä¸ª CQ å¯èƒ½ä¼šè¢«å¤šä¸ª WQ å…±äº«ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯ä¸èƒ½ä¿è¯è¿™äº› WQE å¯¹åº”çš„ CQE çš„äº§ç”Ÿé¡ºåºçš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆWQE ç¼–å·è¡¨ç¤ºä¸‹å‘çš„æ¬¡åºï¼Œå³ 1 æœ€å…ˆè¢«ä¸‹å‘ï¼Œ6 æœ€åè¢«ä¸‹å‘ï¼‰ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-27_10_8.webp"
alt="2024-06-27_10_8" width="auto" loading="lazy">
&lt;/figure>
&lt;p>ä¸Šé¢çš„æè¿°å…¶å®è¿˜åŒ…å«äº†â€œåŒä¸€ä¸ª QP çš„ SQ å’Œ RQ ä¸­çš„ WQEï¼Œå…¶å¯¹åº”çš„ CQE é—´æ˜¯ä¸ä¿åºçš„â€çš„æƒ…å†µï¼Œè¿™ä¸€ç‚¹å…¶å®æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼ŒSQ å’Œ RQï¼Œä¸€ä¸ªè´Ÿè´£ä¸»åŠ¨å‘èµ·çš„ä»»åŠ¡ï¼Œä¸€ä¸ªè´Ÿè´£è¢«åŠ¨æ¥æ”¶çš„ä»»åŠ¡ï¼Œå®ƒä»¬æœ¬æ¥å°±å¯ä»¥æ˜¯è®¤ä¸ºæ˜¯ä¸¤æ¡ä¸åŒæ–¹å‘çš„é€šé“ï¼Œè‡ªç„¶ä¸åº”è¯¥ç›¸äº’å½±å“ã€‚å‡è®¾ç”¨æˆ·å¯¹åŒä¸€ä¸ª QP å…ˆä¸‹å‘äº†ä¸€ä¸ª Receive WQEï¼Œåˆä¸‹å‘ä¸€ä¸ª Send WQEï¼Œæ€»ä¸èƒ½å¯¹ç«¯ä¸ç»™æœ¬ç«¯å‘é€æ¶ˆæ¯ï¼Œæœ¬ç«¯å°±ä¸èƒ½å‘é€æ¶ˆæ¯ç»™å¯¹ç«¯äº†å§ï¼Ÿ&lt;/p>
&lt;p>æ—¢ç„¶è¿™ç§æƒ…å†µä¸‹ CQE äº§ç”Ÿçš„é¡ºåºå’Œè·å– WQE çš„é¡ºåºæ˜¯ä¸ç›¸å…³çš„ï¼Œé‚£ä¹ˆä¸Šå±‚åº”ç”¨å’Œé©±åŠ¨æ˜¯å¦‚ä½•çŸ¥é“æ”¶åˆ°çš„ CQE å…³è”çš„æ˜¯å“ªä¸ª WQE å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œ&lt;strong>CQE ä¸­æŒ‡æ˜å®ƒæ‰€å¯¹åº”çš„ WQE çš„ç¼–å·&lt;/strong>å°±å¯ä»¥äº†ã€‚&lt;/p>
&lt;p>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿åœ¨å¤šä¸ª WQ å…±ç”¨ä¸€ä¸ª CQ çš„æƒ…å†µä¸‹ï¼Œâ€œåŒä¸€ä¸ª WQ ä¸­çš„ WQEï¼Œå…¶å¯¹åº”çš„ CQE é—´æ˜¯ä¿åºçš„â€è¿™ä¸€ç‚¹ä¹Ÿæ˜¯ä¸€å®šèƒ½å¤Ÿä¿è¯çš„ï¼Œå³ä¸Šå›¾ä¸­çš„å±äº WQ1 çš„ WQE 1ã€3ã€4 å¯¹åº”çš„ CQE ä¸€å®šæ˜¯æŒ‰ç…§é¡ºåºäº§ç”Ÿçš„ï¼Œå¯¹äºå±äº WQ2 çš„ WQE 2ã€5ã€6 ä¹Ÿæ˜¯å¦‚æ­¤ã€‚&lt;/p>
&lt;h3 id="cqc">CQC&lt;/h3>
&lt;p>åŒ QP ä¸€æ ·ï¼ŒCQ åªæ˜¯ä¸€æ®µå­˜æ”¾ CQE çš„é˜Ÿåˆ—å†…å­˜ç©ºé—´ã€‚ç¡¬ä»¶é™¤äº†çŸ¥é“é¦–åœ°å€ä»¥å¤–ï¼Œå¯¹äºè¿™ç‰‡åŒºåŸŸå¯ä»¥è¯´æ˜¯ä¸€æ— æ‰€çŸ¥ã€‚æ‰€ä»¥éœ€è¦æå‰è·Ÿè½¯ä»¶çº¦å®šå¥½æ ¼å¼ï¼Œç„¶åé©±åŠ¨å°†ç”³è¯·å†…å­˜ï¼Œå¹¶æŒ‰ç…§æ ¼å¼æŠŠ CQ çš„åŸºæœ¬ä¿¡æ¯å¡«å†™åˆ°è¿™ç‰‡å†…å­˜ä¸­ä¾›ç¡¬ä»¶è¯»å–ï¼Œè¿™ç‰‡å†…å­˜å°±æ˜¯ CQCã€‚CQC ä¸­åŒ…å«äº† CQ çš„å®¹é‡å¤§å°ï¼Œå½“å‰å¤„ç†çš„ CQE çš„åºå·ç­‰ç­‰ä¿¡æ¯ã€‚æ‰€ä»¥æŠŠ QPC çš„å›¾ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼Œå°±èƒ½è¡¨ç¤ºå‡º CQC å’Œ CQ çš„å…³ç³»ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-27_10_9.webp"
alt="2024-06-27_10_9" width="auto" loading="lazy">
&lt;/figure>
&lt;h3 id="cqn">CQN&lt;/h3>
&lt;p>CQ Numberï¼Œå°±æ˜¯ CQ çš„ç¼–å·ï¼Œç”¨æ¥åŒºåˆ«ä¸åŒçš„ CQã€‚CQ æ²¡æœ‰åƒ QP0 å’Œ QP1 ä¸€æ ·çš„ç‰¹æ®Šä¿ç•™ç¼–å·ï¼Œæœ¬æ–‡ä¸­ä¸å†èµ˜è¿°äº†ã€‚&lt;/p>
&lt;h2 id="å®Œæˆé”™è¯¯">å®Œæˆé”™è¯¯&lt;/h2>
&lt;p>IB åè®®ä¸­æœ‰ä¸‰ç§é”™è¯¯ç±»å‹ï¼Œç«‹å³é”™è¯¯ï¼ˆimmediate errorï¼‰ã€å®Œæˆé”™è¯¯ï¼ˆCompletion Errorï¼‰ä»¥åŠå¼‚æ­¥é”™è¯¯ï¼ˆAsynchronous Errors)ã€‚&lt;/p>
&lt;p>ç«‹å³é”™è¯¯çš„æ˜¯â€œç«‹å³åœæ­¢å½“å‰æ“ä½œï¼Œå¹¶è¿”å›é”™è¯¯ç»™ä¸Šå±‚ç”¨æˆ·â€ï¼›å®Œæˆé”™è¯¯æŒ‡çš„æ˜¯â€œé€šè¿‡ CQE å°†é”™è¯¯ä¿¡æ¯è¿”å›ç»™ä¸Šå±‚ç”¨æˆ·â€ï¼›è€Œå¼‚æ­¥é”™è¯¯æŒ‡çš„æ˜¯â€œé€šè¿‡ä¸­æ–­äº‹ä»¶çš„æ–¹å¼ä¸ŠæŠ¥ç»™ä¸Šå±‚ç”¨æˆ·â€ã€‚å¯èƒ½è¿˜æ˜¯æœ‰ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­è¯´æ˜è¿™ä¸¤ç§é”™è¯¯éƒ½ä¼šåœ¨ä»€ä¹ˆæƒ…å†µä¸‹äº§ç”Ÿï¼š&lt;/p>
&lt;ul>
&lt;li>ç”¨æˆ·åœ¨ Post Send æ—¶ä¼ å…¥äº†éæ³•çš„æ“ä½œç ï¼Œæ¯”å¦‚æƒ³åœ¨ UD çš„æ—¶å€™ä½¿ç”¨ RDMA WRITE æ“ä½œã€‚&lt;/li>
&lt;/ul>
&lt;p>ç»“æœï¼šäº§ç”Ÿç«‹å³é”™è¯¯ï¼ˆæœ‰çš„å‚å•†åœ¨è¿™ç§æƒ…å†µä¼šäº§ç”Ÿå®Œæˆé”™è¯¯ï¼‰&lt;/p>
&lt;p>ä¸€èˆ¬è¿™ç§æƒ…å†µä¸‹ï¼Œé©±åŠ¨ç¨‹åºä¼šç›´æ¥é€€å‡º post send æµç¨‹ï¼Œå¹¶è¿”å›é”™è¯¯ç ç»™ä¸Šå±‚ç”¨æˆ·ã€‚æ³¨æ„æ­¤æ—¶ WQE è¿˜æ²¡æœ‰ä¸‹å‘åˆ°ç¡¬ä»¶å°±è¿”å›äº†ã€‚&lt;/p>
&lt;ul>
&lt;li>ç”¨æˆ·ä¸‹å‘äº†ä¸€ä¸ª WQEï¼Œæ“ä½œç±»å‹ä¸º SENDï¼Œä½†æ˜¯é•¿æ—¶é—´æ²¡æœ‰å—åˆ°å¯¹æ–¹çš„ ACKã€‚&lt;/li>
&lt;/ul>
&lt;p>ç»“æœï¼šäº§ç”Ÿå®Œæˆé”™è¯¯&lt;/p>
&lt;p>å› ä¸º WQE å·²ç»åˆ°è¾¾äº†ç¡¬ä»¶ï¼Œæ‰€ä»¥ç¡¬ä»¶ä¼šäº§ç”Ÿå¯¹åº”çš„ CQEï¼ŒCQE ä¸­åŒ…å«è¶…æ—¶æœªå“åº”çš„é”™è¯¯è¯¦æƒ…ã€‚&lt;/p>
&lt;ul>
&lt;li>ç”¨æˆ·æ€ä¸‹å‘äº†å¤šä¸ª WQEï¼Œæ‰€ä»¥ç¡¬ä»¶ä¼šäº§ç”Ÿå¤šä¸ª CQEï¼Œä½†æ˜¯è½¯ä»¶ä¸€ç›´æ²¡æœ‰ä» CQ ä¸­å–èµ° CQEï¼Œå¯¼è‡´ CQ æº¢å‡ºã€‚
ç»“æœï¼šäº§ç”Ÿå¼‚æ­¥é”™è¯¯&lt;/li>
&lt;/ul>
&lt;p>å› ä¸ºè½¯ä»¶ä¸€ç›´æ²¡å– CQEï¼Œæ‰€ä»¥è‡ªç„¶ä¸ä¼šä» CQE ä¸­å¾—åˆ°ä¿¡æ¯ã€‚æ­¤æ—¶ IB æ¡†æ¶ä¼šè°ƒç”¨è½¯ä»¶æ³¨å†Œçš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œæ¥é€šçŸ¥ç”¨æˆ·å¤„ç†å½“å‰çš„é”™è¯¯ã€‚&lt;/p>
&lt;p>ç”±æ­¤å¯è§ï¼Œå®ƒä»¬éƒ½æ˜¯åº•å±‚å‘ä¸Šå±‚ç”¨æˆ·æŠ¥å‘Šé”™è¯¯çš„æ–¹å¼ï¼Œåªæ˜¯äº§ç”Ÿçš„æ—¶æœºä¸ä¸€æ ·è€Œå·²ã€‚IB åè®®ä¸­å¯¹ä¸åŒæƒ…å†µçš„é”™è¯¯åº”è¯¥ä»¥å“ªç§æ–¹å¼ä¸ŠæŠ¥åšäº†è§„å®šï¼Œæ¯”å¦‚ä¸‹å›¾ä¸­ï¼Œå¯¹äº Modify QP è¿‡ç¨‹ä¸­ä¿®æ”¹éæ³•çš„å‚æ•°ï¼Œåº”è¯¥è¿”å›ç«‹å³é”™è¯¯ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-27_10_10.webp"
alt="2024-06-27_10_10" width="auto" loading="lazy">
&lt;/figure>
&lt;p>æœ¬æ–‡çš„é‡ç‚¹åœ¨äº CQï¼Œæ‰€ä»¥ä»‹ç»å®Œé”™è¯¯ç±»å‹ä¹‹åï¼Œæˆ‘ä»¬ç€é‡æ¥çœ‹ä¸€ä¸‹å®Œæˆé”™è¯¯ã€‚å®Œæˆé”™è¯¯æ˜¯ç¡¬ä»¶é€šè¿‡åœ¨ CQE ä¸­å¡«å†™é”™è¯¯ç æ¥å®ç°ä¸ŠæŠ¥çš„ï¼Œä¸€æ¬¡é€šä¿¡è¿‡ç¨‹éœ€è¦å‘èµ·ç«¯ï¼ˆRequesterï¼‰å’Œå“åº”ç«¯ï¼ˆResponderï¼‰å‚ä¸ï¼Œå…·ä½“çš„é”™è¯¯åŸå› ä¹Ÿåˆ†ä¸ºæœ¬ç«¯å’Œå¯¹ç«¯ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹é”™è¯¯æ£€æµ‹æ˜¯åœ¨ä»€ä¹ˆé˜¶æ®µè¿›è¡Œçš„ï¼ˆä¸‹å›¾å¯¹ IB åè®®ä¸­ Figure 118 è¿›è¡Œäº†é‡ç”»ï¼‰ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-27_10_11.webp"
alt="2024-06-27_10_11" width="auto" loading="lazy">
&lt;/figure>
&lt;p>Requester çš„é”™è¯¯æ£€æµ‹ç‚¹æœ‰ä¸¤ä¸ªï¼š&lt;/p>
&lt;ol>
&lt;li>æœ¬åœ°é”™è¯¯æ£€æµ‹&lt;/li>
&lt;/ol>
&lt;p>å³å¯¹ SQ ä¸­çš„ WQE è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœæ£€æµ‹åˆ°é”™è¯¯ï¼Œå°±ä»æœ¬åœ°é”™è¯¯æ£€æŸ¥æ¨¡å—ç›´æ¥äº§ç”Ÿ CQE åˆ° CQï¼Œä¸ä¼šå‘é€æ•°æ®åˆ°å“åº”ç«¯äº†ï¼›å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œåˆ™å‘é€æ•°æ®åˆ°å¯¹ç«¯ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>è¿œç«¯é”™è¯¯æ£€æµ‹&lt;/li>
&lt;/ol>
&lt;p>å³æ£€æµ‹å“åº”ç«¯çš„ ACK æ˜¯å¦å¼‚å¸¸ï¼ŒACK/NAK æ˜¯ç”±å¯¹ç«¯çš„æœ¬åœ°é”™è¯¯æ£€æµ‹æ¨¡å—æ£€æµ‹åäº§ç”Ÿçš„ï¼Œé‡Œé¢åŒ…å«äº†å“åº”ç«¯æ˜¯å¦æœ‰é”™è¯¯ï¼Œä»¥åŠå…·ä½“çš„é”™è¯¯ç±»å‹ã€‚æ— è®ºè¿œç«¯é”™è¯¯æ£€æµ‹çš„ç»“æœæ˜¯å¦æœ‰é—®é¢˜ï¼Œéƒ½ä¼šäº§ç”Ÿ CQE åˆ° CQ ä¸­ã€‚&lt;/p>
&lt;p>Responder çš„é”™è¯¯æ£€æµ‹ç‚¹åªæœ‰ä¸€ä¸ªï¼š&lt;/p>
&lt;ol>
&lt;li>æœ¬åœ°é”™è¯¯æ£€æµ‹&lt;/li>
&lt;/ol>
&lt;p>å®é™…ä¸Šæ£€æµ‹çš„æ˜¯å¯¹ç«¯æŠ¥æ–‡æ˜¯å¦æœ‰é—®é¢˜ï¼ŒIB åè®®ä¹Ÿå°†å…¶ç§°ä¸ºâ€œæœ¬åœ°â€é”™è¯¯æ£€æµ‹ã€‚å¦‚æœæ£€æµ‹åˆ°é”™è¯¯ï¼Œåˆ™ä¼šä½“ç°åœ¨ ACK/NAK æŠ¥æ–‡ä¸­å›å¤ç»™å¯¹ç«¯ï¼Œä»¥åŠåœ¨æœ¬åœ°äº§ç”Ÿä¸€ä¸ª CQEã€‚&lt;/p>
&lt;p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°çš„äº§ç”Ÿ ACK å’Œè¿œç«¯é”™è¯¯æ£€æµ‹åªå¯¹é¢å‘è¿æ¥çš„æœåŠ¡ç±»å‹æœ‰æ•ˆï¼Œæ— è¿æ¥çš„æœåŠ¡ç±»å‹ã€‚æ¯”å¦‚ UD ç±»å‹å¹¶ä¸å…³å¿ƒå¯¹ç«¯æ˜¯å¦æ”¶åˆ°ï¼Œæ¥æ”¶ç«¯ä¹Ÿä¸ä¼šäº§ç”Ÿ ACKï¼Œæ‰€ä»¥åœ¨ Requester çš„æœ¬åœ°é”™è¯¯æ£€æµ‹ä¹‹åå°±ä¸€å®šä¼šäº§ç”Ÿ CQEï¼Œæ— è®ºæ˜¯å¦æœ‰è¿œç«¯é”™è¯¯ã€‚&lt;/p>
&lt;p>ç„¶åæˆ‘ä»¬ç®€å•ä»‹ç»ä¸‹å‡ ç§å¸¸è§çš„å®Œæˆé”™è¯¯ï¼š&lt;/p>
&lt;ul>
&lt;li>RC æœåŠ¡ç±»å‹çš„ SQ å®Œæˆé”™è¯¯&lt;/li>
&lt;li>Local Protection Error
&lt;ul>
&lt;li>æœ¬åœ°ä¿æŠ¤åŸŸé”™è¯¯ã€‚æœ¬åœ° WQE ä¸­æŒ‡å®šçš„æ•°æ®å†…å­˜åœ°å€çš„ MR ä¸åˆæ³•ï¼Œå³ç”¨æˆ·è¯•å›¾ä½¿ç”¨ä¸€ç‰‡æœªæ³¨å†Œçš„å†…å­˜ä¸­çš„æ•°æ®ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Remote Access Error
&lt;ul>
&lt;li>è¿œç«¯æƒé™é”™è¯¯ã€‚æœ¬ç«¯æ²¡æœ‰æƒé™è¯»/å†™æŒ‡å®šçš„å¯¹ç«¯å†…å­˜åœ°å€ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Transport Retry Counter Exceeded Error
&lt;ul>
&lt;li>é‡ä¼ è¶…æ¬¡é”™è¯¯ã€‚å¯¹ç«¯ä¸€ç›´æœªå›å¤æ­£ç¡®çš„ ACKï¼Œå¯¼è‡´æœ¬ç«¯å¤šæ¬¡é‡ä¼ ï¼Œè¶…è¿‡äº†é¢„è®¾çš„æ¬¡æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>RC æœåŠ¡ç±»å‹çš„ RQ å®Œæˆé”™è¯¯&lt;/li>
&lt;li>Local Access Error
&lt;ul>
&lt;li>æœ¬åœ°è®¿é—®é”™è¯¯ã€‚è¯´æ˜å¯¹ç«¯è¯•å›¾å†™å…¥å…¶æ²¡æœ‰æƒé™å†™å…¥çš„å†…å­˜åŒºåŸŸã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Local Length Error
&lt;ul>
&lt;li>æœ¬åœ°é•¿åº¦é”™è¯¯ã€‚æœ¬åœ° RQ æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥æ¥æ”¶å¯¹ç«¯å‘é€çš„æ•°æ®ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å®Œæ•´çš„å®Œæˆé”™è¯¯ç±»å‹åˆ—è¡¨è¯·å‚è€ƒ IB åè®®çš„ 10.10.3 èŠ‚ã€‚&lt;/p>
&lt;h2 id="ç”¨æˆ·æ¥å£">ç”¨æˆ·æ¥å£&lt;/h2>
&lt;p>åŒ QP ä¸€æ ·ï¼Œæˆ‘ä»¬ä¾ç„¶ä»é€šä¿¡å‡†å¤‡é˜¶æ®µï¼ˆæ§åˆ¶é¢ï¼‰å’Œé€šä¿¡è¿›è¡Œé˜¶æ®µï¼ˆæ•°æ®é¢ï¼‰æ¥ä»‹ç» IB åè®®å¯¹ä¸Šå±‚æä¾›çš„å…³äº CQ çš„æ¥å£ã€‚&lt;/p>
&lt;h3 id="æ§åˆ¶é¢">æ§åˆ¶é¢&lt;/h3>
&lt;p>åŒ QP ä¸€æ ·ï¼Œè¿˜æ˜¯â€œå¢åˆ æ”¹æŸ¥â€å››ç§ï¼Œä½†æ˜¯å¯èƒ½å› ä¸ºå¯¹äº CQ æ¥è¯´ï¼Œä¸Šå±‚ç”¨æˆ·æ˜¯èµ„æºä½¿ç”¨è€…è€Œä¸æ˜¯ç®¡ç†è€…ï¼Œåªèƒ½ä» CQ ä¸­è¯»æ•°æ®è€Œä¸èƒ½å†™æ•°æ®ï¼Œæ‰€ä»¥å¯¹ç”¨æˆ·å¼€æ”¾çš„å¯é…çš„å‚æ•°å°±åªæœ‰â€œCQ è§„æ ¼â€ä¸€ç§ã€‚&lt;/p>
&lt;ul>
&lt;li>åˆ›å»ºâ€”â€”Create CQ&lt;/li>
&lt;/ul>
&lt;p>åˆ›å»ºçš„æ—¶å€™ç”¨æˆ·å¿…é¡»æŒ‡å®š CQ çš„è§„æ ¼ï¼Œå³èƒ½å¤Ÿå‚¨å­˜å¤šå°‘ä¸ª CQEï¼Œå¦å¤–ç”¨æˆ·è¿˜å¯ä»¥å¡«å†™ä¸€ä¸ª CQE äº§ç”Ÿåçš„å›è°ƒå‡½æ•°æŒ‡é’ˆï¼ˆä¸‹æ–‡ä¼šæ¶‰åŠï¼‰ã€‚å†…æ ¸æ€é©±åŠ¨ä¼šå°†å…¶ä»–ç›¸å…³çš„å‚æ•°é…ç½®å¥½ï¼Œå¡«å†™åˆ°è·Ÿç¡¬ä»¶çº¦å®šå¥½çš„ CQC ä¸­å‘ŠçŸ¥ç¡¬ä»¶ã€‚&lt;/p>
&lt;ul>
&lt;li>é”€æ¯â€”â€”Destroy CQ&lt;/li>
&lt;/ul>
&lt;p>é‡Šæ”¾ä¸€ä¸ª CQ è½¯ç¡¬ä»¶èµ„æºï¼ŒåŒ…å« CQ æœ¬èº«åŠ CQCï¼Œå¦å¤– CQN è‡ªç„¶ä¹Ÿå°†å¤±æ•ˆã€‚&lt;/p>
&lt;ul>
&lt;li>ä¿®æ”¹â€”â€”Resize CQ&lt;/li>
&lt;/ul>
&lt;p>è¿™é‡Œåå­—ç¨å¾®æœ‰ç‚¹åŒºåˆ«ï¼Œå› ä¸º CQ åªå…è®¸ç”¨æˆ·ä¿®æ”¹è§„æ ¼å¤§å°ï¼Œæ‰€ä»¥å°±ç”¨çš„ Resize è€Œä¸æ˜¯ Modifyã€‚&lt;/p>
&lt;ul>
&lt;li>æŸ¥è¯¢â€”â€”Query CQ&lt;/li>
&lt;/ul>
&lt;p>æŸ¥è¯¢ CQ çš„å½“å‰è§„æ ¼ï¼Œä»¥åŠç”¨äºé€šçŸ¥çš„å›è°ƒå‡½æ•°æŒ‡é’ˆã€‚&lt;/p>
&lt;blockquote>
&lt;p>é€šè¿‡å¯¹æ¯” RDMA è§„èŒƒå’Œè½¯ä»¶åè®®æ ˆï¼Œå¯ä»¥å‘ç°å¾ˆå¤š verbs æ¥å£å¹¶ä¸æ˜¯æŒ‰ç…§è§„èŒƒå®ç°çš„ã€‚æ‰€ä»¥è¯»è€…å¦‚æœå‘ç°è½¯ä»¶ API å’Œåè®®æœ‰å·®å¼‚æ—¶ä¹Ÿæ— é¡»æ„Ÿåˆ°ç–‘æƒ‘ï¼ŒRDMA æŠ€æœ¯æœ¬èº«ä¸€ç›´è¿˜åœ¨æ¼”è¿›ï¼Œè½¯ä»¶æ¡†æ¶ä¹Ÿå¤„äºæ´»è·ƒæ›´æ–°çš„çŠ¶æ€ã€‚å¦‚æœæ›´å…³å¿ƒç¼–ç¨‹å®ç°ï¼Œé‚£ä¹ˆè¯·ä»¥è½¯ä»¶åè®®æ ˆçš„ API æ–‡æ¡£ä¸ºå‡†ï¼›å¦‚æœæ›´å…³å¿ƒå­¦æœ¯ä¸Šçš„ç ”ç©¶ï¼Œé‚£ä¹ˆè¯·ä»¥ RDMA è§„èŒƒä¸ºå‡†ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="æ•°æ®é¢">æ•°æ®é¢&lt;/h3>
&lt;p>CQE æ˜¯ç¡¬ä»¶å°†ä¿¡æ¯ä¼ é€’ç»™è½¯ä»¶çš„åª’ä»‹ï¼Œè™½ç„¶è½¯ä»¶çŸ¥é“åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šäº§ç”Ÿ CQEï¼Œä½†æ˜¯è½¯ä»¶å¹¶ä¸çŸ¥é“å…·ä½“ä»€ä¹ˆæ—¶å€™ç¡¬ä»¶ä¼šæŠŠ CQE æ”¾åˆ° CQ ä¸­ã€‚åœ¨é€šä¿¡å’Œè®¡ç®—æœºé¢†åŸŸï¼Œæˆ‘ä»¬æŠŠè¿™ç§æ¥æ”¶æ–¹ä¸çŸ¥é“å‘é€æ–¹ä»€ä¹ˆæ—¶å€™å‘é€çš„æ¨¡å¼ç§°ä¸ºâ€œå¼‚æ­¥â€ã€‚æˆ‘ä»¬å…ˆæ¥ä¸¾ä¸€ä¸ªç½‘å¡çš„ä¾‹å­ï¼Œå†æ¥è¯´æ˜ç”¨æˆ·å¦‚ä½•é€šè¿‡æ•°æ®é¢æ¥å£è·å– CQEï¼ˆWCï¼‰ã€‚&lt;/p>
&lt;p>ç½‘å¡æ”¶åˆ°æ•°æ®åŒ…åå¦‚ä½•è®© CPU çŸ¥é“è¿™ä»¶äº‹ï¼Œå¹¶è¿›è¡Œæ•°æ®åŒ…å¤„ç†ï¼Œæœ‰ä¸¤ç§å¸¸è§çš„æ¨¡å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸­æ–­æ¨¡å¼&lt;/li>
&lt;/ul>
&lt;p>å½“æ•°æ®é‡è¾ƒå°‘ï¼Œæˆ–è€…è¯´å¶å‘çš„æ•°æ®äº¤æ¢è¾ƒå¤šæ—¶ï¼Œé€‚åˆé‡‡ç”¨ä¸­æ–­æ¨¡å¼â€”â€”å³ CPU å¹³å¸¸åœ¨åšå…¶ä»–äº‹æƒ…ï¼Œå½“ç½‘å¡æ”¶åˆ°æ•°æ®åŒ…æ—¶ï¼Œä¼šä¸ŠæŠ¥ä¸­æ–­æ‰“æ–­ CPU å½“å‰çš„ä»»åŠ¡ï¼ŒCPU è½¬è€Œæ¥å¤„ç†æ•°æ®åŒ…ï¼ˆæ¯”å¦‚ TCP/IP åè®®æ ˆçš„å„å±‚è§£æï¼‰ã€‚å¤„ç†å®Œæ•°æ®ä¹‹åï¼ŒCPU è·³å›åˆ°ä¸­æ–­å‰çš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œã€‚&lt;/p>
&lt;p>æ¯æ¬¡ä¸­æ–­éƒ½éœ€è¦ä¿æŠ¤ç°åœºï¼Œä¹Ÿå°±æ˜¯æŠŠå½“å‰å„ä¸ªå¯„å­˜å™¨çš„å€¼ã€å±€éƒ¨å˜é‡çš„å€¼ç­‰ç­‰ä¿å­˜åˆ°æ ˆä¸­ï¼Œå›æ¥ä¹‹åå†æ¢å¤ç°åœºï¼ˆå‡ºæ ˆï¼‰ï¼Œè¿™æœ¬èº«æ˜¯æœ‰å¼€é”€çš„ã€‚å¦‚æœä¸šåŠ¡è´Ÿè½½è¾ƒé‡ï¼Œç½‘å¡ä¸€ç›´éƒ½åœ¨æ¥æ”¶æ•°æ®åŒ…ï¼Œé‚£ä¹ˆ CPU å°±ä¼šä¸€ç›´æ”¶åˆ°ä¸­æ–­ï¼ŒCPU å°†ä¸€ç›´å¿™äºä¸­æ–­åˆ‡æ¢ï¼Œå¯¼è‡´å…¶ä»–ä»»åŠ¡å¾—ä¸åˆ°è°ƒåº¦ã€‚&lt;/p>
&lt;ul>
&lt;li>è½®è¯¢æ¨¡å¼&lt;/li>
&lt;/ul>
&lt;p>æ‰€ä»¥é™¤äº†ä¸­æ–­æ¨¡å¼ä¹‹å¤–ï¼Œç½‘å¡è¿˜æœ‰ä¸€ç§è½®è¯¢æ¨¡å¼ï¼Œå³æ”¶åˆ°æ•°æ®åŒ…åéƒ½å…ˆæ”¾åˆ°ç¼“å†²åŒºé‡Œï¼ŒCPU æ¯éš”ä¸€æ®µæ—¶é—´ä¼šå»æ£€æŸ¥ç½‘å¡æ˜¯å¦å—åˆ°æ•°æ®ã€‚å¦‚æœæœ‰æ•°æ®ï¼Œå°±æŠŠç¼“å†²åŒºé‡Œçš„æ•°æ®ä¸€æ³¢å¸¦èµ°è¿›è¡Œå¤„ç†ï¼Œæ²¡æœ‰çš„è¯å°±æ¥ç€å¤„ç†åˆ«çš„ä»»åŠ¡ã€‚&lt;/p>
&lt;p>é€šè¿‡å¯¹æ¯”ä¸­æ–­æ¨¡å¼æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè½®è¯¢æ¨¡å¼è™½ç„¶æ¯éš”ä¸€æ®µæ—¶é—´éœ€è¦ CPU æ£€æŸ¥ä¸€æ¬¡ï¼Œå¸¦æ¥äº†ä¸€å®šçš„å¼€é”€ï¼Œä½†æ˜¯å½“ä¸šåŠ¡ç¹å¿™çš„æ—¶å€™é‡‡ç”¨è½®è¯¢æ¨¡å¼èƒ½å¤Ÿæå¤§çš„å‡å°‘ä¸­æ–­ä¸Šä¸‹æ–‡çš„åˆ‡æ¢æ¬¡æ•°ï¼Œåè€Œå‡è½»äº† CPU çš„è´Ÿæ‹…ã€‚&lt;/p>
&lt;p>ç°åœ¨çš„ç½‘å¡ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸­æ–­+è½®è¯¢çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®ä¸šåŠ¡è´Ÿè½½åŠ¨æ€åˆ‡æ¢ã€‚&lt;/p>
&lt;p>åœ¨ RDMA åè®®ä¸­ï¼ŒCQE å°±ç›¸å½“äºæ˜¯ç½‘å¡æ”¶åˆ°çš„æ•°æ®åŒ…ï¼ŒRDMA ç¡¬ä»¶æŠŠå®ƒä¼ é€’ç»™ CPU å»å¤„ç†ã€‚RDMA æ¡†æ¶å®šä¹‰äº†ä¸¤ç§å¯¹ä¸Šå±‚çš„æ¥å£ï¼Œåˆ†åˆ«æ˜¯ poll å’Œ notifyï¼Œå¯¹åº”ç€è½®è¯¢å’Œä¸­æ–­æ¨¡å¼ã€‚&lt;/p>
&lt;h3 id="poll-completion-queue">Poll completion queue&lt;/h3>
&lt;p>å¾ˆç›´ç™½ï¼Œpoll å°±æ˜¯è½®è¯¢çš„æ„æ€ã€‚ç”¨æˆ·è°ƒç”¨è¿™ä¸ªæ¥å£ä¹‹åï¼ŒCPU å°±ä¼šå®šæœŸå»æ£€æŸ¥ CQ é‡Œé¢æ˜¯å¦æœ‰æ–°é²œçš„ CQEï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå°±å–å‡ºè¿™ä¸ª CQEï¼ˆæ³¨æ„å–å‡ºä¹‹å CQE å°±è¢«â€œæ¶ˆè€—â€æ‰äº†ï¼‰ï¼Œè§£æå…¶ä¸­çš„ä¿¡æ¯å¹¶è¿”å›ç»™ä¸Šå±‚ç”¨æˆ·ã€‚&lt;/p>
&lt;h3 id="request-completion-notification">Request completion notification&lt;/h3>
&lt;p>ç›´è¯‘è¿‡æ¥æ˜¯è¯·æ±‚å®Œæˆé€šçŸ¥ï¼Œç”¨æˆ·è°ƒç”¨è¿™ä¸ªæ¥å£ä¹‹åï¼Œç›¸å½“äºå‘ç³»ç»Ÿæ³¨å†Œäº†ä¸€ä¸ªä¸­æ–­ã€‚è¿™æ ·å½“ç¡¬ä»¶å°† CQE æ”¾åˆ° CQ ä¸­åï¼Œä¼šç«‹å³è§¦å‘ä¸€ä¸ªä¸­æ–­ç»™ CPUï¼ŒCPU è¿›è€Œå°±ä¼šåœæ­¢æ‰‹ä¸Šçš„å·¥ä½œå–å‡º CQEï¼Œå¤„ç†åè¿”å›ç»™ç”¨æˆ·ã€‚&lt;/p>
&lt;p>åŒæ ·çš„ï¼Œè¿™ä¸¤ç§æ¥å£ä½¿ç”¨å“ªç§ï¼Œå–å†³äºç”¨æˆ·å¯¹äºå®æ—¶æ€§çš„è¦æ±‚ï¼Œä»¥åŠå®é™…ä¸šåŠ¡çš„ç¹å¿™ç¨‹åº¦ã€‚&lt;/p>
&lt;p>æ„Ÿè°¢é˜…è¯»ï¼ŒCQ å°±ä»‹ç»åˆ°è¿™é‡Œï¼Œä¸‹ç¯‡æ‰“ç®—è¯¦ç»†è®²è®² SRQã€‚&lt;/p>
&lt;h2 id="åè®®ç›¸å…³ç« èŠ‚">åè®®ç›¸å…³ç« èŠ‚&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>9.9 CQ é”™è¯¯æ£€æµ‹å’Œæ¢å¤&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.2.6 CQ å’Œ WQ çš„å…³ç³»&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.10 é”™è¯¯ç±»å‹åŠå…¶å¤„ç†&lt;/p>
&lt;/li>
&lt;li>
&lt;p>11.2.8 CQ ç›¸å…³æ§åˆ¶é¢æ¥å£&lt;/p>
&lt;/li>
&lt;li>
&lt;p>11.4.2 CQ ç›¸å…³æ•°æ®é¢æ¥å£&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="å…¶ä»–å‚è€ƒèµ„æ–™">å…¶ä»–å‚è€ƒèµ„æ–™&lt;/h2>
&lt;p>[1] Linux Kernel Networking - Implement and Theory. Chapter 13. Completion Queue&lt;/p></description></item><item><title>RDMA ä¹‹ Queue Pair</title><link>https://cuterwrite.top/p/rdma-queue-pair/</link><pubDate>Tue, 25 Jun 2024 02:21:00 +0000</pubDate><guid>https://cuterwrite.top/p/rdma-queue-pair/</guid><description>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-16_116342820_p0_master1200.webp" alt="Featured image of post RDMA ä¹‹ Queue Pair" />&lt;h1 id="rdma-ä¹‹-queue-pair">RDMA ä¹‹ Queue Pair&lt;/h1>
&lt;p>&lt;strong>æœ¬æ–‡æ¬¢è¿éå•†ä¸šè½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>å£°æ˜ï¼šä»…ç”¨äºæ”¶è—ï¼Œä¾¿äºé˜…è¯»&lt;/p>&lt;span class="cite">&lt;span>â€• &lt;/span>&lt;span>Savir, &lt;/span>&lt;a href="https://zhuanlan.zhihu.com/p/195757767">&lt;cite>çŸ¥ä¹ä¸“æ ï¼š9. RDMA åŸºæœ¬æœåŠ¡ç±»å‹&lt;/cite>&lt;/a>&lt;/span>&lt;/blockquote>
&lt;h2 id="queue-pair">Queue Pair&lt;/h2>
&lt;p>æˆ‘ä»¬æ›¾ç»åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-element/" >ã€â€œ3. RDMA åŸºæœ¬å…ƒç´ â€ã€‘
&lt;/a>
ä¸€æ–‡ä¸­ç®€å•çš„ä»‹ç»äº† QP çš„æ¦‚å¿µï¼Œæœ¬æ–‡å°†æ›´æ·±å…¥çš„è®²è§£ä¸€äº›å…³äº QP çš„ç»†èŠ‚ã€‚&lt;/p>
&lt;h2 id="åŸºæœ¬æ¦‚å¿µå›é¡¾">åŸºæœ¬æ¦‚å¿µå›é¡¾&lt;/h2>
&lt;p>é¦–å…ˆæˆ‘ä»¬æ¥ç®€å•å›é¡¾ä¸‹å…³äº QP çš„åŸºç¡€çŸ¥è¯†ï¼š&lt;/p>
&lt;p>æ ¹æ® IB åè®®ä¸­çš„æè¿°ï¼ŒQP æ˜¯ç¡¬ä»¶å’Œè½¯ä»¶ä¹‹é—´çš„ä¸€ä¸ªè™šæ‹Ÿæ¥å£ã€‚QP æ˜¯é˜Ÿåˆ—ç»“æ„ï¼ŒæŒ‰é¡ºåºå­˜å‚¨ç€è½¯ä»¶ç»™ç¡¬ä»¶ä¸‹å‘çš„ä»»åŠ¡ï¼ˆWQEï¼‰ï¼ŒWQE ä¸­åŒ…å«ä»å“ªé‡Œå–å‡ºå¤šé•¿çš„æ•°æ®ï¼Œå¹¶ä¸”å‘é€ç»™å“ªä¸ªç›®çš„åœ°ç­‰ç­‰ä¿¡æ¯ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-26_9_1.webp"
alt="2024-06-26_9_1" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>QP çš„æ¦‚å¿µ&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>æ¯ä¸ª QP é—´éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå½¼æ­¤é€šè¿‡ PD éš”ç¦»ï¼Œå› æ­¤ä¸€ä¸ª QP å¯ä»¥è¢«è§†ä¸ºæŸä¸ªç”¨æˆ·ç‹¬å çš„ä¸€ç§èµ„æºï¼Œä¸€ä¸ªç”¨æˆ·ä¹Ÿå¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ª QPã€‚&lt;/p>
&lt;p>QP æœ‰å¾ˆå¤šç§æœåŠ¡ç±»å‹ï¼ŒåŒ…æ‹¬ RCã€UDã€RD å’Œ UC ç­‰ï¼Œæ‰€æœ‰çš„æº QP å’Œç›®çš„ QP å¿…é¡»ä¸ºåŒä¸€ç§ç±»å‹æ‰èƒ½è¿›è¡Œæ•°æ®äº¤äº’ã€‚&lt;/p>
&lt;p>è™½ç„¶ IB åè®®å°† QP ç§°ä¸ºâ€œè™šæ‹Ÿæ¥å£â€ï¼Œä½†æ˜¯å®ƒæ˜¯æœ‰å®ä½“çš„ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ç¡¬ä»¶ä¸Šï¼ŒQP æ˜¯ä¸€æ®µåŒ…å«ç€è‹¥å¹²ä¸ª WQE çš„å­˜å‚¨ç©ºé—´ï¼ŒIB ç½‘å¡ä¼šä»è¿™æ®µç©ºé—´ä¸­è¯»å– WQE çš„å†…å®¹ï¼Œå¹¶æŒ‰ç…§ç”¨æˆ·çš„æœŸæœ›å»å†…å­˜ä¸­å­˜å–æ•°æ®ã€‚è‡³äºè¿™ä¸ªå­˜å‚¨ç©ºé—´æ˜¯å†…å­˜ç©ºé—´è¿˜æ˜¯ IB ç½‘å¡çš„ç‰‡å†…å­˜å‚¨ç©ºé—´ï¼ŒIB åè®®å¹¶æœªåšå‡ºé™åˆ¶ï¼Œæ¯ä¸ªå‚å•†æœ‰å„è‡ªçš„å®ç°&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è½¯ä»¶ä¸Šï¼ŒQP æ˜¯ä¸€ä¸ªç”± IB ç½‘å¡çš„é©±åŠ¨ç¨‹åºæ‰€ç»´æŠ¤çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­åŒ…å« QP çš„åœ°å€æŒ‡é’ˆä»¥åŠä¸€äº›ç›¸å…³çš„è½¯ä»¶å±æ€§ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="qpc">QPC&lt;/h3>
&lt;p>&lt;a class="link" href="https://cuterwrite.top/p/rdma-service-types/" >ã€â€œ5. RDMA åŸºæœ¬æœåŠ¡ç±»å‹â€ã€‘
&lt;/a>
ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬æ›¾ç»æåˆ°è¿‡ QPC å…¨ç§°æ˜¯ Queue Pair Contextï¼Œç”¨äºå­˜å‚¨ QP ç›¸å…³å±æ€§ã€‚é©±åŠ¨ç¨‹åºé‡Œé¢æ˜¯æœ‰å‚¨å­˜ QP çš„è½¯ä»¶å±æ€§çš„ï¼Œæ—¢ç„¶æˆ‘ä»¬å¯ä»¥åœ¨è½¯ä»¶é‡Œå‚¨å­˜ QP çš„å±æ€§ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨ä½¿ç”¨ QPC å‘¢ï¼Ÿ&lt;/p>
&lt;p>è¿™æ˜¯å› ä¸º&lt;strong>QPC ä¸»è¦æ˜¯ç»™ç¡¬ä»¶çœ‹çš„ï¼Œä¹Ÿä¼šç”¨æ¥åœ¨è½¯ç¡¬ä»¶ä¹‹é—´åŒæ­¥ QP çš„ä¿¡æ¯ã€‚&lt;/strong>&lt;/p>
&lt;p>æˆ‘ä»¬è¯´è¿‡ QP åœ¨ç¡¬ä»¶ä¸Šçš„å®ä½“åªæ˜¯ä¸€æ®µå­˜å‚¨ç©ºé—´è€Œå·²ï¼Œç¡¬ä»¶é™¤äº†çŸ¥é“è¿™æ®µç©ºé—´çš„èµ·å§‹åœ°å€å’Œå¤§å°ä¹‹å¤–ä¸€æ— æ‰€çŸ¥ï¼Œç”šè‡³è¿è¿™ä¸ª QP æœåŠ¡ç±»å‹éƒ½ä¸çŸ¥é“ã€‚è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„é‡è¦ä¿¡æ¯ï¼Œæ¯”å¦‚æŸä¸ª QP ä¸­åŒ…å«äº†è‹¥å¹²ä¸ª WQEï¼Œç¡¬ä»¶æ€ä¹ˆçŸ¥é“æœ‰å¤šå°‘ä¸ªï¼Œå½“å‰åº”è¯¥å¤„ç†ç¬¬å‡ ä¸ªå‘¢ï¼Ÿ&lt;/p>
&lt;p>æ‰€æœ‰ä¸Šè¿°çš„è¿™äº›ä¿¡æ¯ï¼Œè½¯ä»¶æ˜¯å¯ä»¥è®¾è®¡ä¸€å®šçš„æ•°æ®ç»“æ„å¹¶ä¸ºå…¶ç”³è¯·å†…å­˜ç©ºé—´çš„ï¼Œä½†æ˜¯è½¯ä»¶çœ‹åˆ°çš„éƒ½æ˜¯è™šæ‹Ÿåœ°å€ï¼Œè¿™äº›å†…å­˜ç©ºé—´åœ¨ç‰©ç†ä¸Šæ˜¯ç¦»æ•£çš„ï¼Œç¡¬ä»¶å¹¶ä¸çŸ¥é“è¿™äº›æ•°æ®å­˜æ”¾åˆ°äº†å“ªé‡Œã€‚æ‰€ä»¥å°±éœ€è¦è½¯ä»¶é€šè¿‡æ“ä½œç³»ç»Ÿæå‰ç”³è¯·å¥½ä¸€å¤§ç‰‡è¿ç»­çš„ç©ºé—´ï¼Œå³ QPC æ¥æ‰¿è½½è¿™äº›ä¿¡æ¯ç»™ç¡¬ä»¶çœ‹ã€‚ç½‘å¡åŠå…¶é…å¥—çš„é©±åŠ¨ç¨‹åºæå‰çº¦å®šå¥½äº† QPC ä¸­éƒ½æœ‰å“ªäº›å†…å®¹ï¼Œè¿™äº›å†…å®¹åˆ†åˆ«å æ®å¤šå°‘ç©ºé—´ï¼ŒæŒ‰ç…§ä»€ä¹ˆé¡ºåºå­˜æ”¾ã€‚è¿™æ ·é©±åŠ¨å’Œç¡¬ä»¶å°±å¯ä»¥é€šè¿‡é€šè¿‡ QPC è¿™æ®µç©ºé—´æ¥è¯»å†™ QP çš„çŠ¶æ€ç­‰ç­‰ä¿¡æ¯ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-26_9_2_QPC.webp"
alt="2024-06-26_9_2" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>QPC çš„æ¦‚å¿µ&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¡¬ä»¶å…¶å®åªéœ€è¦çŸ¥é“ QPC çš„åœ°å€ 0x12350000 å°±å¯ä»¥äº†ï¼Œå› ä¸ºå®ƒå¯ä»¥è§£æ QPC çš„å†…å®¹ï¼Œä»è€Œå¾—çŸ¥ QP çš„ä½ç½®ï¼ŒQP åºå·ï¼ŒQP å¤§å°ç­‰ç­‰ä¿¡æ¯ã€‚è¿›è€Œå°±èƒ½æ‰¾åˆ° QPï¼ŒçŸ¥é“åº”è¯¥å–ç¬¬å‡ ä¸ª WQE å»å¤„ç†ã€‚ä¸åŒçš„å‚å•†å¯èƒ½å®ç°æœ‰äº›å·®å¼‚ï¼Œä½†æ˜¯å¤§è‡´çš„åŸç†å°±æ˜¯è¿™æ ·ã€‚&lt;/p>
&lt;p>IB è½¯ä»¶æ ˆä¸­è¿˜æœ‰å¾ˆå¤š Context çš„æ¦‚å¿µï¼Œé™¤äº† QPC ä¹‹å¤–ï¼Œè¿˜æœ‰ Device Contextï¼ŒSRQCï¼ŒCQCï¼ŒEQCï¼ˆEvent Queue Contextï¼Œäº‹ä»¶é˜Ÿåˆ—ä¸Šä¸‹æ–‡ï¼‰ç­‰ï¼Œå®ƒä»¬çš„ä½œç”¨ä¸ QPC ç±»ä¼¼ï¼Œéƒ½æ˜¯ç”¨æ¥åœ¨è®°å½•å’ŒåŒæ­¥æŸç§èµ„æºçš„ç›¸å…³å±æ€§ã€‚&lt;/p>
&lt;h3 id="qp-number">QP Number&lt;/h3>
&lt;p>ç®€ç§°ä¸º QPNï¼Œå°±æ˜¯æ¯ä¸ª QP çš„ç¼–å·ã€‚IB åè®®ä¸­è§„å®šç”¨ $2^{24}$ ä¸ª bit æ¥è¡¨ç¤º QPNï¼Œå³æ¯ä¸ªèŠ‚ç‚¹æœ€å¤§å¯ä»¥åŒæ—¶ä½¿ç”¨ $2^{24}$ ä¸ª QPï¼Œè¿™å·²ç»æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°é‡äº†ï¼Œå‡ ä¹ä¸å¯èƒ½ç”¨å®Œã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½å„è‡ªç»´æŠ¤ç€ QPN çš„é›†åˆï¼Œç›¸äº’ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼Œå³ä¸åŒçš„èŠ‚ç‚¹ä¸Šå¯ä»¥å­˜åœ¨ç¼–å·ç›¸åŒçš„ QPã€‚&lt;/p>
&lt;p>QPN çš„æ¦‚å¿µæœ¬èº«éå¸¸ç®€å•ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„ä¿ç•™ç¼–å·éœ€è¦é¢å¤–æ³¨æ„ä¸€ä¸‹ï¼š&lt;/p>
&lt;h4 id="qp0">QP0&lt;/h4>
&lt;p>ç¼–å·ä¸º 0 çš„ QP ç”¨äºå­ç½‘ç®¡ç†æ¥å£ SMIï¼ˆSubnet Management Interfaceï¼‰ï¼Œç”¨äºç®¡ç†å­ç½‘ä¸­çš„å…¨éƒ¨èŠ‚ç‚¹ï¼Œè¯´å®è¯æˆ‘ä¹Ÿè¿˜æ²¡ææ¸…æ¥šè¿™ä¸ªæ¥å£çš„ä½œç”¨ï¼Œæš‚ä¸”æŒ‰ä¸‹ä¸è¡¨ã€‚&lt;/p>
&lt;h4 id="qp1">QP1&lt;/h4>
&lt;p>ç¼–å·ä¸º 1 çš„ QP ç”¨äºé€šç”¨æœåŠ¡æ¥å£ GSIï¼ˆGeneral Service Interfaceï¼‰ï¼ŒGSI æ˜¯ä¸€ç»„ç®¡ç†æœåŠ¡ï¼Œå…¶ä¸­æœ€å‡ºåçš„å°±æ˜¯ CMï¼ˆCommunication Managementï¼‰ï¼Œæ˜¯ä¸€ç§åœ¨é€šä¿¡åŒæ–¹èŠ‚ç‚¹æ­£å¼å»ºç«‹è¿æ¥ä¹‹å‰ç”¨æ¥äº¤æ¢å¿…é¡»ä¿¡æ¯çš„ä¸€ç§æ–¹å¼ã€‚å…¶ç»†èŠ‚å°†åœ¨åé¢çš„æ–‡ç« ä¸­ä¸“é—¨å±•å¼€ä»‹ç»ã€‚&lt;/p>
&lt;p>è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰çš„æ–‡ç« ç”»çš„å…³äº QP çš„å›¾ä¸­ï¼Œæ²¡æœ‰å‡ºç°è¿‡ QP0 å’Œ QP1 çš„åŸå› äº†ã€‚è¿™ä¸¤ä¸ª QP ä¹‹å¤–çš„å…¶ä»– QP å°±éƒ½æ˜¯æ™®é€š QP äº†ã€‚ç”¨æˆ·åœ¨åˆ›å»º QP çš„æ—¶å€™ï¼Œé©±åŠ¨æˆ–è€…ç¡¬ä»¶ä¼šç»™è¿™ä¸ªæ–° QP åˆ†é…ä¸€ä¸ª QPNï¼Œä¸€èˆ¬çš„ QPN éƒ½æ˜¯ 2ã€3ã€4 è¿™æ ·æŒ‰é¡ºåºåˆ†é…çš„ã€‚å½“ QP è¢«é”€æ¯ä¹‹åï¼Œå®ƒçš„ QPN ä¹Ÿä¼šè¢«é‡æ–°å›æ”¶ï¼Œå¹¶åœ¨åˆé€‚çš„æ—¶å€™åˆ†é…ç»™å…¶ä»–æ–°åˆ›å»ºçš„ QPã€‚&lt;/p>
&lt;h2 id="ç”¨æˆ·æ¥å£">ç”¨æˆ·æ¥å£&lt;/h2>
&lt;p>æˆ‘ä»¬ä»æ§åˆ¶å±‚é¢å’Œæ•°æ®å±‚é¢æ¥åˆ†ç±»ä»‹ç»ç”¨æˆ·æ¥å£ï¼Œæ§åˆ¶é¢å³ç”¨æˆ·å¯¹æŸç§èµ„æºè¿›è¡ŒæŸç§è®¾ç½®ï¼Œä¸€èˆ¬éƒ½æ˜¯åœ¨æ­£å¼æ”¶å‘æ•°æ®ä¹‹å‰è¿›è¡Œï¼›è€Œæ•°æ®é¢è‡ªç„¶å°±æ˜¯çœŸæ­£çš„æ•°æ®æ”¶å‘è¿‡ç¨‹ä¸­è¿›è¡Œçš„æ“ä½œã€‚&lt;/p>
&lt;h3 id="æ§åˆ¶é¢">æ§åˆ¶é¢&lt;/h3>
&lt;p>æ¥è§¦è¿‡ç®—æ³•çš„è¯»è€…åº”è¯¥éƒ½äº†è§£ï¼Œé“¾è¡¨çš„èŠ‚ç‚¹æ¶‰åŠåˆ°â€œå¢ã€åˆ ã€æ”¹ã€æŸ¥â€å››ä¸ªæ“ä½œï¼Œé“¾è¡¨çš„èŠ‚ç‚¹æ˜¯ä¸€ç‰‡å†…å­˜åŒºåŸŸï¼Œæ˜¯ä¸€ç§è½¯ä»¶èµ„æºã€‚&lt;/p>
&lt;p>â€œå¢â€å³å‘æ“ä½œç³»ç»Ÿç”³è¯·ä¸€ç‰‡å†…å­˜ç”¨æ¥å­˜æ”¾æ•°æ®ï¼Œç³»ç»Ÿå°†åœ¨å†…å­˜ä¸­åˆ’åˆ†ä¸€å—ç©ºé—´ï¼Œå¹¶å°†å…¶æ ‡è®°ä¸ºâ€œå·²è¢«è¿›ç¨‹ XX ä½¿ç”¨â€ï¼Œå…¶ä»–æ²¡æœ‰æƒé™çš„è¿›ç¨‹å°†æ— æ³•è¦†ç›–ç”šè‡³è¯»å–è¿™ç‰‡å†…å­˜ç©ºé—´ã€‚&lt;/p>
&lt;p>â€œåˆ â€å³é€šçŸ¥æ“ä½œç³»ç»Ÿï¼Œè¿™ç‰‡ç©ºé—´æˆ‘ä¸ä½¿ç”¨äº†ï¼Œå¯ä»¥æ ‡è®°æˆâ€œæœªä½¿ç”¨â€å¹¶ç»™å…¶å®ƒè¿›ç¨‹ä½¿ç”¨äº†ã€‚&lt;/p>
&lt;p>â€œæ”¹â€å°±æ˜¯å†™ï¼Œå³ä¿®æ”¹è¿™ç‰‡å†…å­˜åŒºåŸŸçš„å†…å®¹ã€‚&lt;/p>
&lt;p>&amp;ldquo;æŸ¥&amp;quot;å°±æ˜¯è¯»ï¼Œå³è·å–è¿™ç‰‡å†…å­˜åŒºåŸŸçš„å†…å®¹ã€‚&lt;/p>
&lt;p>QP ä½œä¸º RDMA æŠ€æœ¯ä¸­æœ€é‡è¦çš„ä¸€ç§èµ„æºï¼Œåœ¨ç”Ÿå‘½å‘¨æœŸä¸Šä¸é“¾è¡¨å¹¶æ— äºŒè‡´ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>æ“ä½œ&lt;/th>
&lt;th>é“¾è¡¨èŠ‚ç‚¹&lt;/th>
&lt;th>QP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>å¢&lt;/td>
&lt;td>struct ListNode *node = malloc(sizeof(struct ListNode *));&lt;/td>
&lt;td>Create QP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>åˆ &lt;/td>
&lt;td>free(node);&lt;/td>
&lt;td>Destroy QP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æ”¹&lt;/td>
&lt;td>node-&amp;gt;val = xxx;&lt;/td>
&lt;td>Modify QP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>æŸ¥&lt;/td>
&lt;td>xxx = node-&amp;gt;val;&lt;/td>
&lt;td>Query QP&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>è¿™å››ç§æ“ä½œï¼Œå…¶å®å°±æ˜¯ Verbsï¼ˆRDMA å¯¹ä¸Šå±‚åº”ç”¨çš„ APIï¼‰åœ¨æ§åˆ¶é¢ä¸Šå¯¹ä¸Šå±‚ç”¨æˆ·æä¾›ç»™ç”¨æˆ·çš„å‡ ä¸ªæ¥å£ï¼š&lt;/p>
&lt;h4 id="create-qp">Create QP&lt;/h4>
&lt;p>åˆ›å»ºä¸€ä¸ª QP çš„è½¯ç¡¬ä»¶èµ„æºï¼ŒåŒ…å« QP æœ¬èº«ä»¥åŠ QPCã€‚ç”¨æˆ·åˆ›å»ºæ—¶ä¼šå†™ä¼ å…¥ä¸€ç³»åˆ—çš„åˆå§‹åŒ–å±æ€§ï¼ŒåŒ…å«è¯¥ QP çš„æœåŠ¡ç±»å‹ï¼Œå¯ä»¥å‚¨å­˜çš„ WQE æ•°é‡ç­‰ä¿¡æ¯&lt;/p>
&lt;h4 id="destroy-qp">Destroy QP&lt;/h4>
&lt;p>é‡Šæ”¾ä¸€ä¸ª QP çš„å…¨éƒ¨è½¯ç¡¬ä»¶èµ„æºï¼ŒåŒ…å« QP æœ¬èº«åŠ QPCã€‚é”€æ¯ QP åï¼Œç”¨æˆ·å°†æ— æ³•é€šè¿‡ QPN ç´¢å¼•åˆ°è¿™ä¸ª QPã€‚&lt;/p>
&lt;h4 id="modify-qp">Modify QP&lt;/h4>
&lt;p>ä¿®æ”¹ä¸€ä¸ª QP çš„æŸäº›å±æ€§ï¼Œæ¯”å¦‚ QP çš„çŠ¶æ€ï¼Œè·¯å¾„çš„ MTU ç­‰ç­‰ã€‚è¿™ä¸ªä¿®æ”¹è¿‡ç¨‹æ—¢åŒ…æ‹¬è½¯ä»¶æ•°æ®ç»“æ„çš„ä¿®æ”¹ï¼Œä¹ŸåŒ…æ‹¬å¯¹ QPC çš„ä¿®æ”¹ã€‚&lt;/p>
&lt;h4 id="query-qp">Query QP&lt;/h4>
&lt;p>æŸ¥è¯¢ä¸€ä¸ª QP å½“å‰çš„çŠ¶æ€å’Œä¸€äº›å±æ€§ï¼ŒæŸ¥è¯¢åˆ°çš„æ•°æ®æ¥æºäºé©±åŠ¨ä»¥åŠ QPC çš„å†…å®¹ã€‚&lt;/p>
&lt;p>è¿™å››ç§æ“ä½œéƒ½æœ‰é…å¥—çš„ Verbs æ¥å£ï¼Œç±»ä¼¼äº &lt;code>ibv_create_qp()&lt;/code> è¿™ç§å½¢å¼ï¼Œæˆ‘ä»¬ç¼–å†™ APP æ—¶ç›´æ¥è°ƒç”¨å°±å¯ä»¥äº†ã€‚æ›´å¤šå…³äºå¯¹ä¸Šå±‚çš„ API çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬å°†åœ¨åé¢ä¸“é—¨è¿›è¡Œä»‹ç»ã€‚&lt;/p>
&lt;h2 id="æ•°æ®é¢">æ•°æ®é¢&lt;/h2>
&lt;p>æ•°æ®é¢ä¸Šï¼Œä¸€ä¸ª QP å¯¹ä¸Šå±‚çš„æ¥å£å…¶å®åªæœ‰ä¸¤ç§ï¼Œåˆ†åˆ«ç”¨äºå‘ QP ä¸­å¡«å†™å‘é€å’Œæ¥æ”¶è¯·æ±‚ã€‚&lt;strong>è¿™é‡Œçš„â€œå‘é€â€å’Œâ€œæ¥æ”¶â€å¹¶ä¸æ˜¯æŒ‡çš„å‘é€å’Œæ¥æ”¶æ•°æ®ï¼Œè€Œæ˜¯æŒ‡çš„æ˜¯ä¸€æ¬¡é€šä¿¡è¿‡ç¨‹çš„â€œå‘èµ·æ–¹â€ï¼ˆRequestorï¼‰å’Œâ€œæ¥æ”¶æ–¹â€ï¼ˆResponserï¼‰&lt;/strong>ã€‚&lt;/p>
&lt;p>åœ¨è¡Œä¸ºä¸Šéƒ½æ˜¯è½¯ä»¶å‘ QP ä¸­å¡«å†™ä¸€ä¸ª WQEï¼ˆå¯¹åº”ç”¨å±‚æ¥è¯´å« WRï¼‰ï¼Œè¯·æ±‚ç¡¬ä»¶æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œã€‚æ‰€ä»¥è¿™ä¸¤ç§è¡Œä¸ºéƒ½å«åšâ€œPost XXX Requestâ€çš„å½¢å¼ï¼Œå³ä¸‹å‘ XXX è¯·æ±‚ã€‚&lt;/p>
&lt;h3 id="post-send-request">Post Send Request&lt;/h3>
&lt;p>å†å¼ºè°ƒä¸€ä¸‹ï¼ŒPost Send æœ¬èº«ä¸æ˜¯æŒ‡è¿™ä¸ª WQE çš„æ“ä½œç±»å‹æ˜¯ Sendï¼Œè€Œæ˜¯è¡¨ç¤ºè¿™ä¸ª WQE å±äºé€šä¿¡å‘èµ·æ–¹ã€‚è¿™ä¸ªæµç¨‹ä¸­å¡«å†™åˆ° QP ä¸­çš„ WQE/WR å¯ä»¥æ˜¯ Send æ“ä½œï¼ŒRDMA Write æ“ä½œä»¥åŠ RDMA Read æ“ä½œç­‰ã€‚&lt;/p>
&lt;p>ç”¨æˆ·éœ€è¦æå‰å‡†å¤‡å¥½æ•°æ®ç¼“å†²åŒºã€ç›®çš„åœ°å€ç­‰ä¿¡æ¯ï¼Œç„¶åè°ƒç”¨æ¥å£å°† WR ä¼ ç»™é©±åŠ¨ï¼Œé©±åŠ¨å†æŠŠ WQE å¡«å†™åˆ° QP ä¸­ã€‚&lt;/p>
&lt;h3 id="post-receive-request">Post Receive Request&lt;/h3>
&lt;p>Post Recv çš„ä½¿ç”¨åœºæ™¯å°±ç›¸å¯¹æ¯”è¾ƒå°‘äº†ï¼Œä¸€èˆ¬åªåœ¨ Send-Recv æ“ä½œçš„æ¥æ”¶ç«¯æ‰§è¡Œï¼Œæ¥æ”¶ç«¯éœ€è¦æå‰å‡†å¤‡å¥½æ¥æ”¶æ•°æ®çš„ç¼“å†²åŒºï¼Œå¹¶å°†ç¼“å†²åŒºåœ°å€ç­‰ä¿¡æ¯ä»¥ WQE çš„å½¢å¼å‘ŠçŸ¥ç¡¬ä»¶ã€‚&lt;/p>
&lt;h2 id="qp-çŠ¶æ€æœº">QP çŠ¶æ€æœº&lt;/h2>
&lt;p>è¯´åˆ° QP çš„çŠ¶æ€ï¼Œå°±ä¸å¾—ä¸ç¥­å‡ºä¸‹é¢è¿™å¼ å›¾ï¼ˆå–è‡ª IB åè®® 10.3.1 èŠ‚ï¼‰ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-26_9_3.webp"
alt="2024-06-26_9_3" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>QP çŠ¶æ€æœº&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>æ‰€è°“çŠ¶æ€æœºï¼Œå°±æ˜¯æè¿°ä¸€ä¸ªå¯¹è±¡çš„ä¸åŒçŠ¶æ€ï¼Œä»¥åŠè§¦å‘çŠ¶æ€é—´è·³è½¬çš„æ¡ä»¶ã€‚ä¸ºä¸€ä¸ªå¯¹è±¡è®¾è®¡çŠ¶æ€æœºå¯ä»¥ä½¿è¿™ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå˜å¾—éå¸¸æ˜ç¡®ï¼Œå®ç°ä¸Šä¹Ÿä¼šä½¿å¾—é€»è¾‘æ›´åŠ æ¸…æ™°ã€‚&lt;/p>
&lt;p>å¯¹äº QP æ¥è¯´ï¼ŒIB è§„èŒƒä¹Ÿä¸ºå…¶è®¾è®¡äº†å‡ ç§çŠ¶æ€ï¼Œå¤„äºä¸åŒçŠ¶æ€çš„ QP çš„åŠŸèƒ½æ˜¯æœ‰å·®å¼‚çš„ï¼Œæ¯”å¦‚åªæœ‰è¿›å…¥åˆ° Ready to Send çŠ¶æ€ä¹‹åï¼ŒQP æ‰èƒ½å¤Ÿè¿›è¡Œ Post Send æ•°æ®æ“ä½œã€‚æ­£å¸¸çŠ¶æ€ï¼ˆç»¿è‰²çš„ï¼‰ä¹‹é—´çš„çŠ¶æ€è½¬æ¢éƒ½æ˜¯ç”±ç”¨æˆ·é€šè¿‡ä¸Šæ–‡ä»‹ç»çš„ Modify QP çš„ç”¨æˆ·æ¥å£æ¥ä¸»åŠ¨è§¦å‘çš„ï¼›è€Œé”™è¯¯çŠ¶æ€ï¼ˆçº¢è‰²çš„ï¼‰å¾€å¾€æ˜¯å‡ºé”™ä¹‹åè‡ªåŠ¨è·³è½¬çš„ï¼Œå½“ä¸€ä¸ª QP å¤„äºé”™è¯¯çŠ¶æ€ä¹‹åå°±æ— æ³•æ‰§è¡Œæ­£å¸¸çš„ä¸šåŠ¡äº†ï¼Œå°±éœ€è¦ä¸Šå±‚é€šè¿‡ Modify QP å°†å…¶é‡æ–°é…ç½®åˆ°æ­£å¸¸çŠ¶æ€ä¸Šã€‚&lt;/p>
&lt;p>ä¸Šå›¾ä¸­æˆ‘ä»¬åªå…³æ³¨ QP çš„éƒ¨åˆ†ï¼ŒEEï¼ˆEnd-to-End Contextï¼‰æ˜¯ä¸“é—¨ç»™ RD æœåŠ¡ç±»å‹ä½¿ç”¨çš„ä¸€ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬æš‚ä¸æ¶‰åŠã€‚æˆ‘ä»¬é€šè¿‡ Create QP æ¥å£æ¥è¿›å…¥è¿™ä¸ªçŠ¶æ€å›¾ï¼Œé€šè¿‡ Destroy QP æ¥å£æ¥ç¦»å¼€è¿™ä¸ªçŠ¶æ€å›¾ã€‚&lt;/p>
&lt;p>QP æœ‰ä»¥ä¸‹å‡ ç§çŠ¶æ€ï¼Œæˆ‘ä»¬ä»…ä»‹ç»ä¸€ä¸‹æ¯”è¾ƒé‡è¦çš„ç‚¹ï¼š&lt;/p>
&lt;h3 id="rstreset">RSTï¼ˆResetï¼‰&lt;/h3>
&lt;p>å¤ä½çŠ¶æ€ã€‚å½“ä¸€ä¸ª QP é€šè¿‡ Create QP åˆ›å»ºå¥½ä¹‹åå°±å¤„äºè¿™ä¸ªçŠ¶æ€ï¼Œç›¸å…³çš„èµ„æºéƒ½å·²ç»ç”³è¯·å¥½äº†ï¼Œä½†æ˜¯è¿™ä¸ª QP ç›®å‰ä»€ä¹ˆéƒ½åšä¸äº†ï¼Œå…¶æ— æ³•æ¥æ”¶ç”¨æˆ·ä¸‹å‘çš„ WQEï¼Œä¹Ÿæ— æ³•æ¥å—å¯¹ç«¯æŸä¸ª QP çš„æ¶ˆæ¯ã€‚&lt;/p>
&lt;h3 id="initinitialized">INITï¼ˆInitializedï¼‰&lt;/h3>
&lt;p>å·²åˆå§‹åŒ–çŠ¶æ€ã€‚è¿™ä¸ªçŠ¶æ€ä¸‹ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ Post Receive ç»™è¿™ä¸ª QP ä¸‹å‘ Receive WRï¼Œä½†æ˜¯æ¥æ”¶åˆ°çš„æ¶ˆæ¯å¹¶ä¸ä¼šè¢«å¤„ç†ï¼Œä¼šè¢«é™é»˜ä¸¢å¼ƒï¼›å¦‚æœç”¨æˆ·ä¸‹å‘äº†ä¸€ä¸ª Post Send çš„ WRï¼Œåˆ™ä¼šæŠ¥é”™ã€‚&lt;/p>
&lt;h3 id="rtrready-to-receive">RTRï¼ˆReady to Receiveï¼‰&lt;/h3>
&lt;p>å‡†å¤‡æ¥æ”¶çŠ¶æ€ã€‚åœ¨ INIT çŠ¶æ€çš„åŸºç¡€ä¸Šï¼ŒRQ å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œå³å¯¹äºæ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œå¯ä»¥æŒ‰ç…§å…¶ä¸­ WQE çš„æŒ‡ç¤ºæ¬ç§»æ•°æ®åˆ°æŒ‡å®šå†…å­˜ä½ç½®ã€‚æ­¤çŠ¶æ€ä¸‹ SQ ä»ç„¶ä¸èƒ½å·¥ä½œã€‚&lt;/p>
&lt;h3 id="rtsready-to-send">RTSï¼ˆReady to Sendï¼‰&lt;/h3>
&lt;p>å‡†å¤‡å‘é€çŠ¶æ€ã€‚åœ¨ RTR åŸºç¡€ä¸Šï¼ŒSQ å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œå³ç”¨æˆ·å¯ä»¥è¿›è¡Œ Post Sendï¼Œå¹¶ä¸”ç¡¬ä»¶ä¹Ÿä¼šæ ¹æ® SQ çš„å†…å®¹å°†æ•°æ®å‘é€å‡ºå»ã€‚è¿›å…¥è¯¥çŠ¶æ€å‰ï¼ŒQP å¿…é¡»å·²äºå¯¹ç«¯å»ºç«‹å¥½é“¾æ¥ã€‚&lt;/p>
&lt;h3 id="sqdsend-queue-drain">SQDï¼ˆSend Queue Drainï¼‰&lt;/h3>
&lt;p>SQ æ’ç©ºçŠ¶æ€ã€‚é¡¾åæ€ä¹‰ï¼Œè¯¥çŠ¶æ€ä¼šå°† SQ é˜Ÿåˆ—ä¸­ç°å­˜çš„æœªå¤„ç†çš„ WQE å…¨éƒ¨å¤„ç†æ‰ï¼Œè¿™ä¸ªæ—¶å€™ç”¨æˆ·è¿˜å¯ä»¥ä¸‹å‘æ–°çš„ WQE ä¸‹æ¥ï¼Œä½†æ˜¯è¿™äº› WQE è¦ç­‰åˆ°æ—§çš„ WQE å…¨å¤„ç†ä¹‹åæ‰ä¼šè¢«å¤„ç†ã€‚&lt;/p>
&lt;h3 id="sqersend-queue-error">SQErï¼ˆSend Queue Errorï¼‰&lt;/h3>
&lt;p>SQ é”™è¯¯çŠ¶æ€ã€‚å½“æŸä¸ª Send WR å‘ç”Ÿå®Œæˆé”™è¯¯ï¼ˆå³ç¡¬ä»¶é€šè¿‡ CQE å‘ŠçŸ¥é©±åŠ¨å‘ç”Ÿçš„é”™è¯¯ï¼‰æ—¶ï¼Œä¼šå¯¼è‡´ QP è¿›å…¥æ­¤çŠ¶æ€ã€‚&lt;/p>
&lt;h3 id="errerror">ERRï¼ˆErrorï¼‰&lt;/h3>
&lt;p>å³é”™è¯¯çŠ¶æ€ã€‚å…¶ä»–çŠ¶æ€å¦‚æœå‘ç”Ÿäº†é”™è¯¯ï¼Œéƒ½å¯èƒ½è¿›å…¥è¯¥çŠ¶æ€ã€‚Error çŠ¶æ€æ—¶ï¼ŒQP ä¼šåœæ­¢å¤„ç† WQEï¼Œå·²ç»å¤„ç†åˆ°ä¸€åŠçš„ WQE ä¹Ÿä¼šåœæ­¢ã€‚ä¸Šå±‚éœ€è¦åœ¨ä¿®å¤é”™è¯¯åå†å°† QP é‡æ–°åˆ‡æ¢åˆ° RST çš„åˆå§‹çŠ¶æ€ã€‚&lt;/p>
&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;p>æœ¬æ–‡å…ˆå›é¡¾äº† QP çš„ä¸€äº›é‡è¦åŸºæœ¬æ¦‚å¿µï¼Œç„¶åè®²è§£äº† QPCã€QPN ç­‰ QP å¼ºç›¸å…³çš„æ¦‚å¿µï¼Œæœ€åä»‹ç»äº†ç”¨æˆ·æ“ä½œ QP å¸¸ç”¨çš„æ¥å£ä»¥åŠ QP çŠ¶æ€æœºï¼Œç›¸ä¿¡æœ¬æ–‡è¿‡åè¯»è€…ä¸€å®šå¯¹ QP æœ‰äº†æ›´æ·±çš„äº†è§£ã€‚&lt;/p>
&lt;p>å…¶å®ä½œä¸º RDMA çš„æ ¸å¿ƒæ¦‚å¿µï¼ŒQP çš„å†…å®¹å¾ˆå¤šï¼Œæœ¬æ–‡éš¾ä»¥å…¨éƒ¨å›Šæ‹¬ã€‚æˆ‘å°†åœ¨åé¢çš„æ–‡ç« ä¸­é€æ¸æŠŠç›¸å…³çš„å†…å®¹è¡¥å…¨ï¼Œæ¯”å¦‚ QKey çš„æ¦‚å¿µå°†åœ¨åç»­ä¸“é—¨ä»‹ç»å„ç§ Key çš„æ–‡ç« ä¸­è®²è§£ã€‚&lt;/p>
&lt;p>å¥½äº†ï¼Œæœ¬æ–‡å°±åˆ°è¿™äº†ï¼Œæ„Ÿè°¢é˜…è¯»ã€‚é¢„å‘Šä¸‹ä¸€ç¯‡æ–‡ç« å°†è¯¦ç»†è®²è§£ CQã€‚&lt;/p>
&lt;h2 id="åè®®ç›¸å…³ç« èŠ‚">åè®®ç›¸å…³ç« èŠ‚&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>3.5.1 10.2.4 QP çš„åŸºæœ¬æ¦‚å¿µ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.3 QP çŠ¶æ€æœº&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.2.5 QP ç›¸å…³çš„è½¯ä»¶æ¥å£&lt;/p>
&lt;/li>
&lt;li>
&lt;p>11.4 Post Send Post Recv&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>åŸºäº Workbox å®ç° Hugo æ¸è¿›å¼ Web åº”ç”¨</title><link>https://cuterwrite.top/p/hugo-pwa/</link><pubDate>Tue, 18 Jun 2024 22:28:00 +0000</pubDate><guid>https://cuterwrite.top/p/hugo-pwa/</guid><description>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-16_116406967_p0_master1200.webp" alt="Featured image of post åŸºäº Workbox å®ç° Hugo æ¸è¿›å¼ Web åº”ç”¨" />&lt;h1 id="åŸºäº-workbox-å®ç°-hugo-pwa">åŸºäº Workbox å®ç° Hugo PWA&lt;/h1>
&lt;p>æœ€è¿‘ç»™åŸºäº &lt;a class="link" href="https://gohugo.io/" target="_blank" rel="noopener" >Hugo
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æ­å»ºçš„åšå®¢æ·»åŠ äº† PWA åŠŸèƒ½ï¼Œæ˜¾è‘—æå‡äº†åŠ è½½é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒï¼Œç”šè‡³å®ç°äº†ç¦»çº¿è®¿é—®ã€‚è‡³äºå¦‚ä½•å®ç°ï¼Œé‚£ä¹ˆä½ éœ€è¦äº†è§£ &lt;strong>Progressive Web Apps (PWA)&lt;/strong>ã€‚&lt;/p>
&lt;h2 id="ä»€ä¹ˆæ˜¯-pwa">ä»€ä¹ˆæ˜¯ PWA&lt;/h2>
&lt;p>æ¸è¿›å¼ Web åº”ç”¨ï¼ˆProgressive Web Appsï¼Œç®€ç§° PWAï¼‰åˆ©ç”¨ç°ä»£ Web API å’Œä¼ ç»Ÿçš„æ¸è¿›å¼å¢å¼ºç­–ç•¥ï¼Œæ‰“é€ å‡ºè·¨å¹³å°çš„ Web åº”ç”¨ç¨‹åºã€‚è¿™äº›åº”ç”¨æ— å¤„ä¸åœ¨ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼Œä¸ºç”¨æˆ·å¸¦æ¥åª²ç¾åŸç”Ÿåº”ç”¨çš„ä½“éªŒã€‚&lt;/p>
&lt;p>&lt;strong>PWA çš„ä¼˜åŠ¿ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>âš¡ï¸ &lt;strong>æ›´å¿«çš„åŠ è½½é€Ÿåº¦&lt;/strong>: PWA å¯ä»¥ç¼“å­˜é‡è¦èµ„æºï¼Œå³ä½¿ç½‘ç»œçŠ¶å†µä¸ä½³ä¹Ÿèƒ½å¿«é€ŸåŠ è½½ã€‚&lt;/li>
&lt;li>âœˆï¸ &lt;strong>ç¦»çº¿è®¿é—®&lt;/strong>: PWA å¯ä»¥ç¼“å­˜å†…å®¹ï¼Œè®©ç”¨æˆ·å³ä½¿ç¦»çº¿ä¹Ÿèƒ½è®¿é—®å†…å®¹ã€‚&lt;/li>
&lt;li>ğŸ”” &lt;strong>æ¨é€é€šçŸ¥&lt;/strong>: åƒåŸç”Ÿåº”ç”¨ä¸€æ ·ï¼ŒPWA å¯ä»¥å‘ç”¨æˆ·å‘é€æ¨é€é€šçŸ¥ï¼Œæé«˜ç”¨æˆ·å‚ä¸åº¦ã€‚&lt;/li>
&lt;li>ğŸ“± &lt;strong>å®‰è£…åˆ°ä¸»å±å¹•&lt;/strong>: ç”¨æˆ·å¯ä»¥å°†ä½ çš„åº”ç”¨æ·»åŠ åˆ°ç”µè„‘æˆ–æ‰‹æœºæ¡Œé¢ï¼ŒåƒåŸç”Ÿåº”ç”¨ä¸€æ ·æµè§ˆä½ çš„ Web åº”ç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>PWA çš„å®ç°åŸç†æ˜¯ &lt;strong>Service Worker&lt;/strong>ã€‚&lt;strong>Service Worker æ˜¯ä¸€ç§ç‰¹æ®Šçš„ JavaScript èµ„æºï¼Œåœ¨æµè§ˆå™¨åå°ç‹¬ç«‹è¿è¡Œï¼Œå……å½“ç€ç½‘ç»œæµè§ˆå™¨å’Œ Web æœåŠ¡å™¨ä¹‹é—´çš„ä»£ç†ã€‚å®ƒå¯ä»¥æ‹¦æˆªå’Œå¤„ç†ç½‘ç»œè¯·æ±‚ã€ç¼“å­˜èµ„æºä»¥åŠæ¨é€é€šçŸ¥&lt;/strong>ã€‚&lt;/p>
&lt;p>ä¸»æµçš„å‰ç«¯æ¡†æ¶ Vueã€Reactã€Angular éƒ½æä¾›äº†ç›¸åº”çš„ PWA æ’ä»¶ã€‚è€Œå¯¹äº Hugo è¿™æ ·çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰‹åŠ¨æ·»åŠ  &lt;a class="link" href="https://developer.chrome.com/docs/workbox" target="_blank" rel="noopener" >Workbox
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æ¥å®ç° PWA åŠŸèƒ½ã€‚&lt;/p>
&lt;h2 id="workbox">Workbox&lt;/h2>
&lt;p>&lt;a class="link" href="https://developer.chrome.com/docs/workbox" target="_blank" rel="noopener" >Workbox
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æ˜¯ç”± Google Chrome å›¢é˜Ÿå¼€å‘çš„ä¸€å¥—æ¨¡å—ï¼Œæ—¨åœ¨ç®€åŒ–å¸¸è§çš„ Service Worker è·¯ç”±å’Œç¼“å­˜æ“ä½œã€‚æ¯ä¸ªæ¨¡å—éƒ½é’ˆå¯¹ Service Worker å¼€å‘çš„ç‰¹å®šæ–¹é¢è¿›è¡Œäº†ä¼˜åŒ–ã€‚Workbox çš„ç›®æ ‡æ˜¯å°½å¯èƒ½ç®€åŒ– Service Worker çš„ä½¿ç”¨ï¼ŒåŒæ—¶åœ¨éœ€è¦æ—¶çµæ´»åœ°æ»¡è¶³å¤æ‚åº”ç”¨çš„éœ€æ±‚ã€‚&lt;/p>
&lt;p>å¦‚æœæ²¡æœ‰ Workboxï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç¼–å†™ Service Worker æ¥ç›‘å¬ fetch äº‹ä»¶ã€ç¼“å­˜èµ„æºå¹¶å®ç°ç¦»çº¿è®¿é—®ç­‰åŠŸèƒ½ã€‚è€Œ Workbox æä¾›äº†ä¸€å¥—å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆ Service Workerï¼Œå¹¶ä¸”å†…ç½®äº†ä¸€äº›å¸¸ç”¨çš„ç¼“å­˜ç­–ç•¥ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚&lt;/p>
&lt;h2 id="é…ç½®-pwa">é…ç½® PWA&lt;/h2>
&lt;p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† PWA çš„æ¦‚å¿µå’Œä¼˜åŠ¿ï¼Œä»¥åŠ Workbox å¦‚ä½•ç®€åŒ– Service Worker çš„å¼€å‘ã€‚æ¥ä¸‹æ¥å°†ä¸€æ­¥æ­¥åœ°ç»™ Hugo åšå®¢é…ç½® PWA åŠŸèƒ½ã€‚&lt;/p>
&lt;h3 id="æ³¨å†Œ-service-worker">æ³¨å†Œ Service Worker&lt;/h3>
&lt;p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨é¡µé¢ä¸­æ³¨å†Œ Service Workerã€‚å°†ä»¥ä¸‹ä»£ç æ®µæ·»åŠ åˆ°ä½ çš„ Hugo ä¸»é¢˜çš„ &lt;code>layouts/partials/footer/custom.html&lt;/code> æ–‡ä»¶ä¸­ï¼ˆå…¶ä»–ä¸»é¢˜å¯èƒ½éœ€è¦æ ¹æ®æ–‡ä»¶ç»“æ„è¿›è¡Œè°ƒæ•´ï¼‰ï¼š&lt;/p>
&lt;pre>&lt;code class="language-javascript">&amp;lt;script&amp;gt;
// Check that service workers are registered
if ('serviceWorker' in navigator) {
// Use the window load event to keep the page load performant
window.addEventListener('load', () =&amp;gt; {
navigator.serviceWorker.register('/sw.js').then(reg =&amp;gt; {
console.log('Service worker registered with scope: ', reg.scope);
}, err =&amp;gt; {
console.log('Service worker registration failed: ', err);
});
});
}
&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>
&lt;div class="notice notice-tip" >
&lt;div class="notice-title">&lt;svg t="1705945832245" class="icon notice-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19409" width="200" height="200">&lt;path d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m238.933333 349.866666l-2.133333 2.133334-277.333333 277.333333c-10.666667 10.666667-29.866667 12.8-42.666667 2.133333L426.666667 704l-149.333334-149.333333c-12.8-12.8-12.8-32 0-44.8 10.666667-10.666667 29.866667-12.8 42.666667-2.133334l2.133333 2.133334 125.866667 125.866666 253.866667-253.866666c10.666667-10.666667 29.866667-12.8 42.666666-2.133334l2.133334 2.133334c12.8 12.8 12.8 32 4.266666 42.666666z" fill="#ffffff" p-id="19410">&lt;/path>&lt;/svg>&lt;/div>&lt;p>æ³¨æ„ï¼š åœ¨æ³¨å†Œ Service Worker ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆåˆ›å»º &lt;code>sw.js&lt;/code> æ–‡ä»¶ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€å°èŠ‚ä¸­å®Œæˆè¿™ä¸€æ­¥éª¤ã€‚&lt;/p>&lt;/div>
&lt;p>å®Œæˆæ³¨å†Œåï¼Œä½ å¯ä»¥åœ¨æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…· (F12) ä¸­çš„ &lt;strong>&amp;ldquo;Application&amp;rdquo; -&amp;gt; &amp;ldquo;Service Workers&amp;rdquo;&lt;/strong> é¢æ¿ä¸­æŸ¥çœ‹ Service Worker çš„æ³¨å†ŒçŠ¶æ€ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-19_service-worker.webp"
alt="Service Worker" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>Service Worker&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h3 id="å¯¼å…¥-workbox">å¯¼å…¥ Workbox&lt;/h3>
&lt;p>åœ¨ä½ çš„ Hugo ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„ &lt;code>static&lt;/code> æ–‡ä»¶å¤¹ä¸­åˆ›å»º &lt;code>sw.js&lt;/code> æ–‡ä»¶ã€‚ç„¶åï¼Œåœ¨ &lt;code>sw.js&lt;/code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œä½¿ç”¨ CDN å¯¼å…¥ Workboxï¼š&lt;/p>
&lt;pre>&lt;code class="language-javascript">importScripts('https://cdn.bootcdn.net/ajax/libs/workbox-sw/7.1.0/workbox-sw.js');
&lt;/code>&lt;/pre>
&lt;h3 id="ç¼“å­˜ç­–ç•¥">ç¼“å­˜ç­–ç•¥&lt;/h3>
&lt;p>Workbox æä¾›äº†ä¸€äº›å¸¸ç”¨çš„ç¼“å­˜ç­–ç•¥ï¼Œå¦‚ &lt;code>CacheFirst&lt;/code>ã€&lt;code>NetworkFirst&lt;/code>ã€&lt;code>StaleWhileRevalidate&lt;/code> ç­‰ã€‚è¿™é‡Œå…ˆä»‹ç»å‡ ç§å¸¸ç”¨çš„ç­–ç•¥ã€‚&lt;/p>
&lt;h4 id="cacheonly-ä»…ç¼“å­˜">CacheOnly ä»…ç¼“å­˜&lt;/h4>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-19_cache-6850d07d742bf_1440.webp"
alt="CacheOnly" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>CacheOnly&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¼ºåˆ¶å“åº”æ¥è‡ªç¼“å­˜ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.CacheOnly()
);
&lt;/code>&lt;/pre>
&lt;h4 id="networkonly-ä»…ç½‘ç»œ">NetworkOnly ä»…ç½‘ç»œ&lt;/h4>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-19_network-48f46158a5575_1440.webp"
alt="NetworkOnly" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>NetworkOnly&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>è¿™ç§ç¼“å­˜ç­–ç•¥å¼ºåˆ¶è¦æ±‚æ‰€æœ‰è¯·æ±‚éƒ½ä»ç½‘ç»œè·å–æœ€æ–°æ•°æ®ï¼Œå®Œå…¨ç»•è¿‡ç¼“å­˜ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.NetworkOnly()
);
&lt;/code>&lt;/pre>
&lt;h4 id="cachefirst-ä¼˜å…ˆç¼“å­˜">CacheFirst ä¼˜å…ˆç¼“å­˜&lt;/h4>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-19_cache-falling-to-networ-f4c1aa5570621_1440.webp"
alt="CacheFirst" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>CacheFirst&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>è¿™ç§ç¼“å­˜ç­–ç•¥ä»¥é€Ÿåº¦ä¸ºä¼˜å…ˆï¼Œä¼šé¦–å…ˆå°è¯•ä»ç¼“å­˜ä¸­è·å–å“åº”ï¼Œä»¥å°½å¿«å‘ç”¨æˆ·æ˜¾ç¤ºå†…å®¹ã€‚å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰æ‰€éœ€æ•°æ®ï¼Œå®ƒæ‰ä¼šå‘ç½‘ç»œå‘èµ·è¯·æ±‚è·å–æ•°æ®ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.CacheFirst()
);
&lt;/code>&lt;/pre>
&lt;h4 id="networkfirst-ä¼˜å…ˆç½‘ç»œ">NetworkFirst ä¼˜å…ˆç½‘ç»œ&lt;/h4>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-19_network-falling-to-cache-39d267a044b35_1440.webp"
alt="NetworkFirst" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>NetworkFirst&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>è¿™ç§ç¼“å­˜ç­–ç•¥ä¼˜å…ˆä½¿ç”¨æœ€æ–°æ•°æ®ï¼Œå› æ­¤ä¼šé¦–å…ˆå°è¯•ä»ç½‘ç»œè·å–å“åº”ã€‚å¦‚æœç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œä¾‹å¦‚ç”¨æˆ·ç¦»çº¿æˆ–ç½‘ç»œè¿æ¥ä¸ç¨³å®šï¼Œå®ƒä¼šå›é€€ä½¿ç”¨ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œç¡®ä¿ç”¨æˆ·ä»ç„¶å¯ä»¥è®¿é—®å†…å®¹ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.NetworkFirst()
);
&lt;/code>&lt;/pre>
&lt;h4 id="stalewhilerevalidate-è¯»å–ç¼“å­˜åŒæ—¶å‘èµ·ç½‘ç»œè¯·æ±‚">StaleWhileRevalidate è¯»å–ç¼“å­˜ï¼ŒåŒæ—¶å‘èµ·ç½‘ç»œè¯·æ±‚&lt;/h4>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-19_cache-network-873b1ec5f25cc_1440.webp"
alt="StaleWhileRevalidate" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>StaleWhileRevalidate&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>è¿™ç§ç¼“å­˜ç­–ç•¥ä¼˜å…ˆè¿”å›ç¼“å­˜å†…å®¹ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚å³ä½¿ç¼“å­˜å†…å®¹æœ‰æ•ˆï¼Œå®ƒä¹Ÿä¼šåœ¨åå°å‘èµ·ç½‘ç»œè¯·æ±‚ä»¥è·å–æœ€æ–°æ•°æ®ï¼Œä¿è¯ç”¨æˆ·æœ€ç»ˆèƒ½çœ‹åˆ°æœ€æ–°å†…å®¹ã€‚è™½ç„¶è¿™ç§ç­–ç•¥èƒ½ç¡®ä¿ç”¨æˆ·å®šæœŸæ›´æ–°ç¼“å­˜ï¼Œä½†ä¹Ÿæ„å‘³ç€æ¯æ¬¡è¯·æ±‚éƒ½ä¼šäº§ç”Ÿç½‘ç»œæµé‡ï¼Œå³ä½¿æ•°æ®æ²¡æœ‰å˜åŒ–ï¼Œä¹Ÿæ¯”è¾ƒæµªè´¹å¸¦å®½ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.StaleWhileRevalidate()
);
&lt;/code>&lt;/pre>
&lt;h4 id="ç­–ç•¥é…ç½®">ç­–ç•¥é…ç½®&lt;/h4>
&lt;p>Workbox ä¸ä»…æä¾›ä¸Šè¿°ç­–ç•¥ï¼Œè¿˜å…è®¸é€šè¿‡ cacheNameã€plugins å’Œ expiration ç­‰é…ç½®é¡¹è¿›è¡Œè‡ªå®šä¹‰ã€‚ä½ å¯ä»¥é€šè¿‡å®šä¹‰è¦ä½¿ç”¨çš„æ’ä»¶æ¥è‡ªå®šä¹‰è·¯ç”±è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥é…ç½®ç¼“å­˜åç§°ã€ç¼“å­˜æœ‰æ•ˆæœŸä»¥åŠå¯ç¼“å­˜çš„å“åº”çŠ¶æ€ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.CacheFirst({
cacheName: 'my-cache',
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: 60,
maxAgeSeconds: 30 * 24 * 60 * 60, // 30 Days
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h3 id="æœ¬ç«™é…ç½®">æœ¬ç«™é…ç½®&lt;/h3>
&lt;h4 id="å…¨å±€é…ç½®">å…¨å±€é…ç½®&lt;/h4>
&lt;p>ä»¥ä¸‹æ˜¯å…¨å±€ç¼“å­˜é…ç½®ï¼š&lt;/p>
&lt;pre>&lt;code class="language-javascript">// ç¼“å­˜ç‰ˆæœ¬å·
let cacheVersion = '-240619';
// æœ€å¤§æ¡ç›®æ•°
const maxEntries = 100;
&lt;/code>&lt;/pre>
&lt;h4 id="twitto-é…ç½®">Twitto é…ç½®&lt;/h4>
&lt;p>ä¸ºäº†ç¡®ä¿ç”¨æˆ·å³ä½¿åœ¨ç¦»çº¿çŠ¶æ€ä¸‹ä¹Ÿèƒ½æŸ¥çœ‹è¯„è®ºï¼ŒTwitto è¯„è®º API é‡‡ç”¨äº† &lt;code>NetworkFirst&lt;/code> ç¼“å­˜ç­–ç•¥ã€‚è¿™æ„å‘³ç€æµè§ˆå™¨ä¼šä¼˜å…ˆå°è¯•ä»ç½‘ç»œè·å–æœ€æ–°æ•°æ®ï¼Œå¦‚æœç½‘ç»œä¸å¯ç”¨ï¼Œåˆ™ä½¿ç”¨ç¼“å­˜ä¸­çš„æ•°æ®ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('^https://comment\.cuterwrite\.top'),
new workbox.strategies.NetworkFirst({
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="rss-ä¸-sitemap-é…ç½®">RSS ä¸ Sitemap é…ç½®&lt;/h4>
&lt;p>ä¸ºäº†ç¡®ä¿ç”¨æˆ·å§‹ç»ˆè·å–æœ€æ–°çš„ RSS å’Œ Sitemap æ•°æ®ï¼Œè¿™äº›é¡µé¢é…ç½®ä¸ºä»…ä½¿ç”¨ç½‘ç»œç­–ç•¥ (&lt;code>NetworkOnly&lt;/code>)ï¼Œä¸è¿›è¡Œç¼“å­˜ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('^https://cuterwrite\.top/(index|sitemap)\.xml'),
new workbox.strategies.NetworkOnly()
);
&lt;/code>&lt;/pre>
&lt;h4 id="html-é…ç½®">HTML é…ç½®&lt;/h4>
&lt;p>ä¸ºäº†åœ¨ä¿è¯ç”¨æˆ·å¿«é€ŸåŠ è½½é¡µé¢çš„åŒæ—¶ï¼Œä¹Ÿèƒ½è·å–åˆ°æœ€æ–°å†…å®¹ï¼Œç½‘ç«™å¯¹ HTML é¡µé¢é‡‡ç”¨äº† &lt;code>StaleWhileRevalidate&lt;/code> ç¼“å­˜ç­–ç•¥ã€‚è¿™æ„å‘³ç€æµè§ˆå™¨ä¼šä¼˜å…ˆä½¿ç”¨ç¼“å­˜ä¸­çš„é¡µé¢è¿›è¡Œå±•ç¤ºï¼ŒåŒæ—¶åœ¨åå°å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œè·å–æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶åœ¨ä¸‹æ¬¡è¯·æ±‚æ—¶ä½¿ç”¨ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('.*\.html'),
new workbox.strategies.StaleWhileRevalidate({
cacheName: 'html-cache' + cacheVersion,
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="google-fonts-é…ç½®">Google Fonts é…ç½®&lt;/h4>
&lt;p>ä¸ºäº†åœ¨ä¿è¯å­—ä½“æ–‡ä»¶æ›´æ–°çš„åŒæ—¶ï¼Œä¹Ÿèƒ½åˆ©ç”¨ç¼“å­˜åŠ é€Ÿé¡µé¢åŠ è½½é€Ÿåº¦ï¼Œç½‘ç«™å¯¹ Google Fonts èµ„æºé‡‡ç”¨äº† &lt;code>CacheFirst&lt;/code> ç¼“å­˜ç­–ç•¥ï¼Œå¹¶è®¾ç½®äº†è¾ƒé•¿çš„ç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('.*\.(?:woff|woff2|ttf|otf|eot)'),
new workbox.strategies.StaleWhileRevalidate({
cacheName: 'google-fonts' + cacheVersion,
plugins: [
// ä½¿ç”¨ expiration æ’ä»¶å®ç°ç¼“å­˜æ¡ç›®æ•°ç›®å’Œæ—¶é—´æ§åˆ¶
new workbox.expiration.ExpirationPlugin({
// æœ€å¤§ç¼“å­˜æ¡ç›®æ•°
maxEntries: maxEntries,
// æœ€é•¿ç¼“å­˜æ—¶é—´ 30 å¤©
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
// ä½¿ç”¨ cacheableResponse æ’ä»¶ç¼“å­˜çŠ¶æ€ç ä¸º 0 çš„è¯·æ±‚
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="cdn-é…ç½®">CDN é…ç½®&lt;/h4>
&lt;p>ä¸ºäº†æœ€å¤§ç¨‹åº¦åœ°åˆ©ç”¨ç¼“å­˜åŠ é€Ÿé¡µé¢åŠ è½½é€Ÿåº¦ï¼Œç½‘ç«™å¯¹æ¥è‡ªå¸¸ç”¨ CDN çš„èµ„æºé‡‡ç”¨äº† &lt;code>CacheFirst&lt;/code> ç¼“å­˜ç­–ç•¥ï¼Œå¹¶è®¾ç½®äº†è¾ƒé•¿çš„ç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('^https://(?:cdn\.bootcdn\.net|unpkg\.com|cdn\.jsdelivr\.net)'),
new workbox.strategies.CacheFirst({
cacheName: 'cdn' + cacheVersion,
fetchOptions: {
mode: 'cors',
credentials: 'omit',
},
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="umani-ç½‘ç«™ç»Ÿè®¡é…ç½®">Umani ç½‘ç«™ç»Ÿè®¡é…ç½®&lt;/h4>
&lt;p>ä¸ºäº†ç¡®ä¿ç½‘ç«™ç»Ÿè®¡æ•°æ®çš„å‡†ç¡®æ€§ï¼Œç½‘ç«™å¯¹ Umani ç½‘ç«™ç»Ÿè®¡è¯·æ±‚é‡‡ç”¨äº† &lt;code>NetworkOnly&lt;/code> ç­–ç•¥ï¼Œå¹¶ä½¿ç”¨ &lt;code>BackgroundSyncPlugin&lt;/code> æ’ä»¶æ¥å®ç°å³ä½¿åœ¨ç½‘ç»œç¦»çº¿çš„æƒ…å†µä¸‹ä¹Ÿèƒ½ä¿è¯æ•°æ®æœ€ç»ˆå‘é€æˆåŠŸã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('^https://analytics\.cuterwrite\.top/uma'),
new workbox.strategies.NetworkOnly({
plugins: [
// ä½¿ç”¨ background sync æ’ä»¶å®ç°åå°åŒæ­¥
new workbox.backgroundSync.BackgroundSyncPlugin('Optical_Collect', {
maxRetentionTime: 12 * 60,
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="å›¾ç‰‡é…ç½®">å›¾ç‰‡é…ç½®&lt;/h4>
&lt;p>ä¸ºäº†åŠ é€Ÿå›¾ç‰‡åŠ è½½é€Ÿåº¦ï¼Œå¹¶å‡å°‘ç½‘ç»œè¯·æ±‚æ¬¡æ•°ï¼Œç½‘ç«™å¯¹å›¾ç‰‡èµ„æºé‡‡ç”¨äº† &lt;code>CacheFirst&lt;/code> ç¼“å­˜ç­–ç•¥ï¼Œå¹¶è®¾ç½®äº†è¾ƒé•¿çš„ç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('^(https://cuterwrite-1302252842\.file\.myqcloud\.com|https://s2\.loli\.net)'),
new workbox.strategies.CacheFirst({
cacheName: 'image-cache' + cacheVersion,
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="åç¼€åŒ¹é…é…ç½®">åç¼€åŒ¹é…é…ç½®&lt;/h4>
&lt;p>ä¸ºäº†å…¼é¡¾åŠ è½½é€Ÿåº¦å’Œå†…å®¹æ›´æ–°ï¼Œç½‘ç«™å¯¹æœªè¢«åŸŸååŒ¹é…åˆ°çš„é™æ€æ–‡ä»¶ï¼ˆä¾‹å¦‚å›¾ç‰‡ã€CSS å’Œ JavaScript æ–‡ä»¶ï¼‰é‡‡ç”¨äº† &lt;code>StaleWhileRevalidate&lt;/code> ç¼“å­˜ç­–ç•¥ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('.*\.(?:png|jpg|jpeg|svg|gif|webp|ico)'),
new workbox.strategies.StaleWhileRevalidate()
);
workbox.routing.registerRoute(
new RegExp('.*\.(css|js)'),
new workbox.strategies.StaleWhileRevalidate()
);
&lt;/code>&lt;/pre>
&lt;h4 id="é»˜è®¤è¡Œä¸ºé…ç½®">é»˜è®¤è¡Œä¸ºé…ç½®&lt;/h4>
&lt;p>ä¸ºäº†å¤„ç†æœªè¢«ä»»ä½•è‡ªå®šä¹‰è·¯ç”±è§„åˆ™åŒ¹é…åˆ°çš„è¯·æ±‚ï¼Œç½‘ç«™é…ç½®äº†é»˜è®¤ç¼“å­˜è¡Œä¸ºï¼Œä½¿ç”¨ &lt;code>NetworkFirst&lt;/code> ç­–ç•¥å¹¶è®¾ç½®äº†ç½‘ç»œè¶…æ—¶æ—¶é—´ï¼Œä»¥å…¼é¡¾èµ„æºè·å–é€Ÿåº¦å’Œç¦»çº¿å¯ç”¨æ€§ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.setDefaultHandler(
// ä¼˜å…ˆä½¿ç”¨ç¼“å­˜ï¼Œç¼“å­˜æ²¡æœ‰åˆ™ä½¿ç”¨ç½‘ç»œè¯·æ±‚
new workbox.strategies.NetworkFirst({
networkTimeoutSeconds: 3,
})
);
&lt;/code>&lt;/pre>
&lt;h3 id="å®Œæ•´é…ç½®">å®Œæ•´é…ç½®&lt;/h3>
&lt;details>
&lt;summary>sw.js&lt;/summary>
&lt;pre>&lt;code class="language-javascript">importScripts('https://cdn.bootcdn.net/ajax/libs/workbox-sw/7.1.0/workbox-sw.js');
// ç¼“å­˜ç‰ˆæœ¬å·
let cacheVersion = '-240619';
// æœ€å¤§æ¡ç›®æ•°
const maxEntries = 100;
if (workbox) {
console.log(`Yay! Workbox is loaded ğŸ‰`);
// è¯„è®ºç¼“å­˜
workbox.routing.registerRoute(
new RegExp('^https://comment\.cuterwrite\.top'),
new workbox.strategies.NetworkFirst({
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
// rss ã€sitemap ä¸ç¼“å­˜
workbox.routing.registerRoute(
new RegExp('^https://cuterwrite\.top/(index|sitemap)\.xml'),
new workbox.strategies.NetworkOnly()
);
// ç¼“å­˜ HTML
workbox.routing.registerRoute(
new RegExp('.*\.html'),
new workbox.strategies.StaleWhileRevalidate({
cacheName: 'html-cache' + cacheVersion,
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
// ç¼“å­˜ Google Fonts
workbox.routing.registerRoute(
new RegExp('.*\.(?:woff|woff2|ttf|otf|eot)'),
new workbox.strategies.StaleWhileRevalidate({
cacheName: 'google-fonts' + cacheVersion,
plugins: [
// ä½¿ç”¨ expiration æ’ä»¶å®ç°ç¼“å­˜æ¡ç›®æ•°ç›®å’Œæ—¶é—´æ§åˆ¶
new workbox.expiration.ExpirationPlugin({
// æœ€å¤§ç¼“å­˜æ¡ç›®æ•°
maxEntries: maxEntries,
// æœ€é•¿ç¼“å­˜æ—¶é—´ 30 å¤©
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
// ä½¿ç”¨ cacheableResponse æ’ä»¶ç¼“å­˜çŠ¶æ€ç ä¸º 0 çš„è¯·æ±‚
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
// ç¼“å­˜ bootcdnã€unpkgã€jsdelivr ç­‰å…¬å…±åº“ï¼Œç”¨æ­£åˆ™åŒ¹é…
workbox.routing.registerRoute(
new RegExp('^https://(?:cdn\.bootcdn\.net|unpkg\.com|cdn\.jsdelivr\.net)'),
new workbox.strategies.CacheFirst({
cacheName: 'cdn' + cacheVersion,
fetchOptions: {
mode: 'cors',
credentials: 'omit',
},
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
],
})
);
// è‡ªå»º UMA ç»Ÿè®¡è„šæœ¬: https://analytics.cuterwrite.top/uma
workbox.routing.registerRoute(
new RegExp('^https://analytics\.cuterwrite\.top/uma'),
new workbox.strategies.NetworkOnly({
plugins: [
// ä½¿ç”¨ background sync æ’ä»¶å®ç°åå°åŒæ­¥
new workbox.backgroundSync.BackgroundSyncPlugin('Optical_Collect', {
maxRetentionTime: 12 * 60,
}),
],
})
);
// ç¼“å­˜å­˜å‚¨æ¡¶å›¾ç‰‡ https://cuterwrite-1302252842.file.myqcloud.com/
workbox.routing.registerRoute(
new RegExp('^(https://cuterwrite-1302252842\.file\.myqcloud\.com|https://s2\.loli\.net)'),
new workbox.strategies.CacheFirst({
cacheName: 'image-cache' + cacheVersion,
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
// åç¼€åŒ¹é…ï¼Œé’ˆå¯¹å…¶ä½™æ²¡æœ‰è¢«åŸŸååŒ¹é…åˆ°çš„é™æ€æ–‡ä»¶
workbox.routing.registerRoute(
new RegExp('.*\.(?:png|jpg|jpeg|svg|gif|webp|ico)'),
new workbox.strategies.StaleWhileRevalidate()
);
workbox.routing.registerRoute(
new RegExp('.*\.(css|js)'),
new workbox.strategies.StaleWhileRevalidate()
);
// é»˜è®¤åŒ¹é…å‰©ä¸‹çš„è¯·æ±‚
workbox.routing.setDefaultHandler(
// ä¼˜å…ˆä½¿ç”¨ç¼“å­˜ï¼Œç¼“å­˜æ²¡æœ‰åˆ™ä½¿ç”¨ç½‘ç»œè¯·æ±‚
new workbox.strategies.NetworkFirst({
networkTimeoutSeconds: 3,
})
);
} else {
console.log(`Boo! Workbox didn't load ğŸ˜¬`);
}
&lt;/code>&lt;/pre>
&lt;/details>
&lt;h3 id="manifestjson">manifest.json&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>åˆ›å»º manifest.json æ–‡ä»¶&lt;/strong>&lt;/li>
&lt;/ol>
&lt;p>åœ¨ä½ çš„ Hugo åšå®¢çš„æ ¹ç›®å½• &lt;code>static&lt;/code> æ–‡ä»¶å¤¹ä¸‹åˆ›å»º &lt;code>manifest.json&lt;/code> æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«äº†å…³äºä½ çš„åšå®¢çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚åç§°ã€å›¾æ ‡å’Œæ˜¾ç¤ºé€‰é¡¹ã€‚&lt;/p>
&lt;pre>&lt;code class="language-json">{
&amp;quot;name&amp;quot;: &amp;quot;ä½ çš„åšå®¢åç§°&amp;quot;,
&amp;quot;short_name&amp;quot;: &amp;quot;åšå®¢ç®€ç§°&amp;quot;,
&amp;quot;start_url&amp;quot;: &amp;quot;/&amp;quot;,
&amp;quot;display&amp;quot;: &amp;quot;standalone&amp;quot;,
&amp;quot;background_color&amp;quot;: &amp;quot;#ffffff&amp;quot;,
&amp;quot;theme_color&amp;quot;: &amp;quot;#000000&amp;quot;,
&amp;quot;icons&amp;quot;: [{
&amp;quot;src&amp;quot;: &amp;quot;/icon-192x192.png&amp;quot;,
&amp;quot;sizes&amp;quot;: &amp;quot;192x192&amp;quot;,
&amp;quot;type&amp;quot;: &amp;quot;image/png&amp;quot;
},
{
&amp;quot;src&amp;quot;: &amp;quot;/icon-512x512.png&amp;quot;,
&amp;quot;sizes&amp;quot;: &amp;quot;512x512&amp;quot;,
&amp;quot;type&amp;quot;: &amp;quot;image/png&amp;quot;
}
]
}
&lt;/code>&lt;/pre>
&lt;div class="notice notice-tip" >
&lt;div class="notice-title">&lt;svg t="1705945832245" class="icon notice-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19409" width="200" height="200">&lt;path d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m238.933333 349.866666l-2.133333 2.133334-277.333333 277.333333c-10.666667 10.666667-29.866667 12.8-42.666667 2.133333L426.666667 704l-149.333334-149.333333c-12.8-12.8-12.8-32 0-44.8 10.666667-10.666667 29.866667-12.8 42.666667-2.133334l2.133333 2.133334 125.866667 125.866666 253.866667-253.866666c10.666667-10.666667 29.866667-12.8 42.666666-2.133334l2.133334 2.133334c12.8 12.8 12.8 32 4.266666 42.666666z" fill="#ffffff" p-id="19410">&lt;/path>&lt;/svg>&lt;/div>&lt;p>æ³¨æ„ï¼šå°† icon-192x192.png å’Œ icon-512x512.png æ›¿æ¢ä¸ºä½ è‡ªå·±çš„å›¾æ ‡æ–‡ä»¶åã€‚å¹¶ç¡®ä¿å°†è¿™ä¸¤ä¸ªå›¾æ ‡æ–‡ä»¶æ”¾ç½®åœ¨ Hugo åšå®¢çš„ &lt;code>static&lt;/code> æ–‡ä»¶å¤¹ä¸­ã€‚å¦‚æœä½ æƒ³ä¿®æ”¹ä¸»é¢˜é¢œè‰²å’ŒèƒŒæ™¯é¢œè‰²ï¼Œå¯ä»¥ä¿®æ”¹ theme_color å’Œ background_color å­—æ®µã€‚&lt;/p>&lt;/div>
&lt;ol start="2">
&lt;li>&lt;strong>é“¾æ¥ manifest.json æ–‡ä»¶&lt;/strong>&lt;/li>
&lt;/ol>
&lt;p>åœ¨ä½ çš„ Hugo åšå®¢çš„ &lt;code>layouts/partials/head/custom.html&lt;/code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œå°† &lt;code>manifest.json&lt;/code> æ–‡ä»¶é“¾æ¥åˆ°ä½ çš„ç½‘ç«™ï¼š&lt;/p>
&lt;pre>&lt;code class="language-html">&amp;lt;link rel=&amp;quot;manifest&amp;quot; href=&amp;quot;/manifest.json&amp;quot;&amp;gt;
&lt;/code>&lt;/pre>
&lt;p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œä½ çš„ Hugo åšå®¢å°±å…·å¤‡äº† PWA åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥åƒä½¿ç”¨åŸç”Ÿåº”ç”¨ç¨‹åºä¸€æ ·è®¿é—®ä½ çš„ç½‘ç«™ã€‚&lt;/p>
&lt;h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a class="link" href="https://web.dev/articles/offline-cookbook?hl=zh-cn" target="_blank" rel="noopener" >ç¦»çº¿å®æˆ˜å®å…¸
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a class="link" href="https://developers.google.com/web/tools/workbox" target="_blank" rel="noopener" >Workbox
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a class="link" href="https://github.com/GoogleChrome/workbox" target="_blank" rel="noopener" >Workbox Github
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>Ollamaï¼šä»å…¥é—¨åˆ°è¿›é˜¶</title><link>https://cuterwrite.top/p/ollama/</link><pubDate>Sat, 15 Jun 2024 23:10:00 +0000</pubDate><guid>https://cuterwrite.top/p/ollama/</guid><description>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-16_116903387_p0_master1200.webp" alt="Featured image of post Ollamaï¼šä»å…¥é—¨åˆ°è¿›é˜¶" />&lt;p>è¿‘å¹´æ¥ï¼Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ä»¥å…¶å¼ºå¤§çš„æ–‡æœ¬ç”Ÿæˆå’Œç†è§£èƒ½åŠ›ï¼Œæˆä¸ºäº†äººå·¥æ™ºèƒ½é¢†åŸŸçš„ä¸­åšåŠ›é‡ã€‚å•†ä¸š LLM çš„ä»·æ ¼é€šå¸¸é«˜æ˜‚ä¸”ä»£ç å°é—­ï¼Œé™åˆ¶äº†ç ”ç©¶è€…å’Œå¼€å‘è€…çš„æ¢ç´¢ç©ºé—´ã€‚å¹¸è¿çš„æ˜¯ï¼Œå¼€æºç¤¾åŒºæä¾›äº†åƒ Ollama è¿™æ ·ä¼˜ç§€çš„æ›¿ä»£æ–¹æ¡ˆï¼Œè®©æ¯ä¸ªäººéƒ½èƒ½å¤Ÿè½»æ¾ä½“éªŒ LLM çš„é­…åŠ›ï¼Œå¹¶èƒ½ç»“åˆ HPC å’Œ IDE æ’ä»¶ï¼Œæ‰“é€ æ›´å¼ºå¤§çš„ä¸ªäººåŠ©æ‰‹ã€‚&lt;/p>
&lt;h2 id="ä»€ä¹ˆæ˜¯-ollama">ä»€ä¹ˆæ˜¯ Ollamaï¼Ÿ&lt;/h2>
&lt;p>Ollama æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºå¤§å‹è¯­è¨€æ¨¡å‹åº”ç”¨çš„å·¥å…·ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç®€æ´æ˜“ç”¨çš„å‘½ä»¤è¡Œç•Œé¢å’ŒæœåŠ¡å™¨ï¼Œè®©ä½ èƒ½å¤Ÿè½»æ¾ä¸‹è½½ã€è¿è¡Œå’Œç®¡ç†å„ç§å¼€æº LLMã€‚ä¸éœ€è¦å¤æ‚é…ç½®å’Œå¼ºå¤§ç¡¬ä»¶çš„ä¼ ç»Ÿ LLM ä¸åŒï¼ŒOllama è®©ä½ èƒ½å¤Ÿæ–¹ä¾¿åœ°åƒä½¿ç”¨æ‰‹æœº App ä¸€æ ·ä½“éªŒ LLM çš„å¼ºå¤§åŠŸèƒ½ã€‚&lt;/p>
&lt;h2 id="ollama-çš„ä¼˜åŠ¿">Ollama çš„ä¼˜åŠ¿&lt;/h2>
&lt;p>Ollama æ‹¥æœ‰ä»¥ä¸‹æ˜¾è‘—ä¼˜åŠ¿ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å¼€æºå…è´¹&lt;/strong>ï¼š Ollama åŠå…¶æ”¯æŒçš„æ¨¡å‹å®Œå…¨å¼€æºå…è´¹ï¼Œä»»ä½•äººéƒ½å¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘ã€‚&lt;/li>
&lt;li>&lt;strong>ç®€å•æ˜“ç”¨&lt;/strong>ï¼š æ— éœ€å¤æ‚çš„é…ç½®å’Œå®‰è£…è¿‡ç¨‹ï¼Œåªéœ€å‡ æ¡å‘½ä»¤å³å¯å¯åŠ¨å’Œè¿è¡Œ Ollamaã€‚&lt;/li>
&lt;li>&lt;strong>æ¨¡å‹ä¸°å¯Œ&lt;/strong>ï¼š Ollama æ”¯æŒ Llama 3ã€Mistralã€Qwen2 ç­‰ä¼—å¤šçƒ­é—¨å¼€æº LLMï¼Œå¹¶æä¾›ä¸€é”®ä¸‹è½½å’Œåˆ‡æ¢åŠŸèƒ½ã€‚&lt;/li>
&lt;li>&lt;strong>èµ„æºå ç”¨ä½&lt;/strong>ï¼š ç›¸æ¯”äºå•†ä¸š LLMï¼ŒOllama å¯¹ç¡¬ä»¶è¦æ±‚æ›´ä½ï¼Œå³ä½¿åœ¨æ™®é€šç¬”è®°æœ¬ç”µè„‘ä¸Šä¹Ÿèƒ½æµç•…è¿è¡Œã€‚&lt;/li>
&lt;li>&lt;strong>ç¤¾åŒºæ´»è·ƒ&lt;/strong>ï¼š Ollama æ‹¥æœ‰åºå¤§ä¸”æ´»è·ƒçš„ç¤¾åŒºï¼Œç”¨æˆ·å¯ä»¥è½»æ¾è·å–å¸®åŠ©ã€åˆ†äº«ç»éªŒå’Œå‚ä¸æ¨¡å‹å¼€å‘ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å¦‚ä½•ä½¿ç”¨-ollama">å¦‚ä½•ä½¿ç”¨ Ollamaï¼Ÿ&lt;/h2>
&lt;p>ä½¿ç”¨ Ollama éå¸¸ç®€å•ï¼Œåªéœ€è¦æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>å®‰è£… Ollama&lt;/strong>ï¼š æ ¹æ®ä½ çš„æ“ä½œç³»ç»Ÿï¼Œä» &lt;a class="link" href="https://ollama.com/" target="_blank" rel="noopener" >Ollama å®˜ç½‘
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ä¸‹è½½å¹¶å®‰è£…æœ€æ–°ç‰ˆæœ¬ã€‚&lt;/li>
&lt;li>&lt;strong>å¯åŠ¨ Ollama&lt;/strong>ï¼š æ‰“å¼€ç»ˆç«¯æˆ–å‘½ä»¤è¡Œï¼Œè¾“å…¥ &lt;code>ollama serve&lt;/code> å‘½ä»¤å¯åŠ¨ Ollama æœåŠ¡å™¨ã€‚&lt;/li>
&lt;li>&lt;strong>ä¸‹è½½æ¨¡å‹&lt;/strong>ï¼š åœ¨&lt;a class="link" href="https://ollama.com/library" target="_blank" rel="noopener" >æ¨¡å‹ä»“åº“
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æ‰¾åˆ°æƒ³è¦çš„æ¨¡å‹ï¼Œç„¶åä½¿ç”¨ &lt;code>ollama pull&lt;/code> å‘½ä»¤ä¸‹è½½ï¼Œä¾‹å¦‚ &lt;code>ollama pull llama3:70b&lt;/code> ã€‚&lt;/li>
&lt;li>&lt;strong>è¿è¡Œæ¨¡å‹&lt;/strong>ï¼š ä½¿ç”¨ &lt;code>ollama run&lt;/code> å‘½ä»¤å¯åŠ¨æ¨¡å‹ï¼Œä¾‹å¦‚ &lt;code>ollama run llama3:70b&lt;/code> ã€‚&lt;/li>
&lt;li>&lt;strong>å¼€å§‹èŠå¤©&lt;/strong>ï¼š åœ¨ç»ˆç«¯ä¸­è¾“å…¥ä½ çš„é—®é¢˜æˆ–æŒ‡ä»¤ï¼ŒOllama ä¼šæ ¹æ®æ¨¡å‹ç”Ÿæˆç›¸åº”çš„å›å¤ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="å®‰è£…-ollama">å®‰è£… Ollama&lt;/h3>
&lt;h4 id="macos">macOS&lt;/h4>
&lt;p>&lt;a class="link" href="https://ollama.com/download/Ollama-darwin.zip" target="_blank" rel="noopener" >ä¸‹è½½ Ollama for macOS
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;h4 id="windows">Windows&lt;/h4>
&lt;p>&lt;a class="link" href="https://ollama.com/download/OllamaSetup.exe" target="_blank" rel="noopener" >ä¸‹è½½ Ollama for Windows
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;h4 id="linux">Linux&lt;/h4>
&lt;pre>&lt;code class="language-bash">curl -fsSL https://ollama.com/install.sh | sh
&lt;/code>&lt;/pre>
&lt;h4 id="docker">Docker&lt;/h4>
&lt;h5 id="cpu-ç‰ˆæœ¬">CPU ç‰ˆæœ¬&lt;/h5>
&lt;pre>&lt;code class="language-bash">docker run -d -v ollama:/root/.ollama -p 11434:11434 --name ollama ollama/ollama
&lt;/code>&lt;/pre>
&lt;h5 id="gpu-ç‰ˆæœ¬">GPU ç‰ˆæœ¬&lt;/h5>
&lt;ol>
&lt;li>å®‰è£… &lt;a class="link" href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html#installation" target="_blank" rel="noopener" >Nvidia container toolkit
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/li>
&lt;li>åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œ Ollama&lt;/li>
&lt;/ol>
&lt;pre>&lt;code class="language-bash">docker run -d --gpus=all -v ollama:/root/.ollama -p 11434:11434 --name ollama ollama/ollama
&lt;/code>&lt;/pre>
&lt;h3 id="å¯åŠ¨-ollama">å¯åŠ¨ Ollama&lt;/h3>
&lt;pre>&lt;code class="language-bash">ollama serve
&lt;/code>&lt;/pre>
&lt;p>è¾“å‡ºä»¥ä¸‹ä¿¡æ¯è¡¨ç¤º Ollama æœåŠ¡å™¨å·²æˆåŠŸå¯åŠ¨ï¼ˆV100 æœºå™¨ï¼‰ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash">$ ollama serve
### çœç•¥çš„æ—¥å¿—è¾“å‡º ###
Listening on [::]:11434 (version 0.1.42)
&lt;/code>&lt;/pre>
&lt;h3 id="ä¸‹è½½æ¨¡å‹">ä¸‹è½½æ¨¡å‹&lt;/h3>
&lt;pre>&lt;code class="language-bash">ollama pull qwen2:72b
&lt;/code>&lt;/pre>
&lt;h3 id="è¿è¡Œæ¨¡å‹">è¿è¡Œæ¨¡å‹&lt;/h3>
&lt;pre>&lt;code class="language-bash">ollama run qwen2:72b
&lt;/code>&lt;/pre>
&lt;p>ä¾‹å¦‚ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤åï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash">$ ollama run qwen2:72b
&amp;gt;&amp;gt;&amp;gt; Who are you?
I am Qwen, a pre-trained language model developed by Alibaba Cloud. My purpose is to assist users in generating various types of text, such as articles, stories, poems, and answering
questions by using the natural language processing techniques. How may I assist you today?
&amp;gt;&amp;gt;&amp;gt; Send a message(/? for help)
&lt;/code>&lt;/pre>
&lt;h4 id="docker-å®¹å™¨ä¸­è¿è¡Œæ¨¡å‹">Docker å®¹å™¨ä¸­è¿è¡Œæ¨¡å‹&lt;/h4>
&lt;pre>&lt;code class="language-bash">docker exec -it ollama ollama run qwen2:72b
&lt;/code>&lt;/pre>
&lt;h3 id="é…ç½®-ollama">é…ç½® Ollama&lt;/h3>
&lt;p>Ollama æä¾›äº†å¤šç§ç¯å¢ƒå˜é‡ä»¥ä¾›é…ç½®ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>OLLAMA_DEBUG&lt;/code>ï¼šæ˜¯å¦å¼€å¯è°ƒè¯•æ¨¡å¼ï¼Œé»˜è®¤ä¸º &lt;code>false&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_FLASH_ATTENTION&lt;/code>ï¼šæ˜¯å¦é—ªçƒæ³¨æ„åŠ›ï¼Œé»˜è®¤ä¸º &lt;code>true&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_HOST&lt;/code>ï¼šOllama æœåŠ¡å™¨çš„ä¸»æœºåœ°å€ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_KEEP_ALIVE&lt;/code>ï¼šä¿æŒè¿æ¥çš„æ—¶é—´ï¼Œé»˜è®¤ä¸º &lt;code>5m&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_LLM_LIBRARY&lt;/code>ï¼šLLM åº“ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_MAX_LOADED_MODELS&lt;/code>ï¼šæœ€å¤§åŠ è½½æ¨¡å‹æ•°ï¼Œé»˜è®¤ä¸º &lt;code>1&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_MAX_QUEUE&lt;/code>ï¼šæœ€å¤§é˜Ÿåˆ—æ•°ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_MAX_VRAM&lt;/code>ï¼šæœ€å¤§è™šæ‹Ÿå†…å­˜ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_MODELS&lt;/code>ï¼šæ¨¡å‹ç›®å½•ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_NOHISTORY&lt;/code>ï¼šæ˜¯å¦ä¿å­˜å†å²è®°å½•ï¼Œé»˜è®¤ä¸º &lt;code>false&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_NOPRUNE&lt;/code>ï¼šæ˜¯å¦å¯ç”¨å‰ªæï¼Œé»˜è®¤ä¸º &lt;code>false&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_NUM_PARALLEL&lt;/code>ï¼šå¹¶è¡Œæ•°ï¼Œé»˜è®¤ä¸º &lt;code>1&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_ORIGINS&lt;/code>ï¼šå…è®¸çš„æ¥æºï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_RUNNERS_DIR&lt;/code>ï¼šè¿è¡Œå™¨ç›®å½•ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_SCHED_SPREAD&lt;/code>ï¼šè°ƒåº¦åˆ†å¸ƒï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_TMPDIR&lt;/code>ï¼šä¸´æ—¶æ–‡ä»¶ç›®å½•ï¼Œé»˜è®¤ä¸ºç©ºã€‚Here is the optimized list in the desired format:&lt;/li>
&lt;li>&lt;code>OLLAMA_DEBUG&lt;/code>ï¼šæ˜¯å¦å¼€å¯è°ƒè¯•æ¨¡å¼ï¼Œé»˜è®¤ä¸º &lt;code>false&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_FLASH_ATTENTION&lt;/code>ï¼šæ˜¯å¦é—ªçƒæ³¨æ„åŠ›ï¼Œé»˜è®¤ä¸º &lt;code>true&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_HOST&lt;/code>ï¼šOllama æœåŠ¡å™¨çš„ä¸»æœºåœ°å€ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_KEEP_ALIVE&lt;/code>ï¼šä¿æŒè¿æ¥çš„æ—¶é—´ï¼Œé»˜è®¤ä¸º &lt;code>5m&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_LLM_LIBRARY&lt;/code>ï¼šLLM åº“ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_MAX_LOADED_MODELS&lt;/code>ï¼šæœ€å¤§åŠ è½½æ¨¡å‹æ•°ï¼Œé»˜è®¤ä¸º &lt;code>1&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_MAX_QUEUE&lt;/code>ï¼šæœ€å¤§é˜Ÿåˆ—æ•°ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_MAX_VRAM&lt;/code>ï¼šæœ€å¤§è™šæ‹Ÿå†…å­˜ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_MODELS&lt;/code>ï¼šæ¨¡å‹ç›®å½•ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_NOHISTORY&lt;/code>ï¼šæ˜¯å¦ä¿å­˜å†å²è®°å½•ï¼Œé»˜è®¤ä¸º &lt;code>false&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_NOPRUNE&lt;/code>ï¼šæ˜¯å¦å¯ç”¨å‰ªæï¼Œé»˜è®¤ä¸º &lt;code>false&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_NUM_PARALLEL&lt;/code>ï¼šå¹¶è¡Œæ•°ï¼Œé»˜è®¤ä¸º &lt;code>1&lt;/code>ã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_ORIGINS&lt;/code>ï¼šå…è®¸çš„æ¥æºï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_RUNNERS_DIR&lt;/code>ï¼šè¿è¡Œå™¨ç›®å½•ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_SCHED_SPREAD&lt;/code>ï¼šè°ƒåº¦åˆ†å¸ƒï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;li>&lt;code>OLLAMA_TMPDIR&lt;/code>ï¼šä¸´æ—¶æ–‡ä»¶ç›®å½•ï¼Œé»˜è®¤ä¸ºç©ºã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="è¿›é˜¶ç”¨æ³•hpc-é›†ç¾¤ä¸Šéƒ¨ç½²-ollama">è¿›é˜¶ç”¨æ³•ï¼šHPC é›†ç¾¤ä¸Šéƒ¨ç½² Ollama&lt;/h2>
&lt;p>å¯¹äºå¤§å‹æ¨¡å‹æˆ–éœ€è¦æ›´é«˜æ€§èƒ½çš„æƒ…å†µï¼Œå¯ä»¥åˆ©ç”¨ HPC é›†ç¾¤çš„å¼ºå¤§ç®—åŠ›æ¥è¿è¡Œ Ollamaã€‚ç»“åˆ Slurm è¿›è¡Œä»»åŠ¡ç®¡ç†ï¼Œå¹¶ä½¿ç”¨ç«¯å£æ˜ å°„å°†æœåŠ¡æš´éœ²åˆ°æœ¬åœ°ï¼Œå³å¯æ–¹ä¾¿åœ°è¿›è¡Œè¿œç¨‹è®¿é—®å’Œä½¿ç”¨ï¼š&lt;/p>
&lt;ol>
&lt;li>åœ¨ç™»å½•èŠ‚ç‚¹é…ç½® Ollama ç¯å¢ƒï¼š å®‰è£… Ollamaï¼Œå¹¶ä¸‹è½½éœ€è¦çš„æ¨¡å‹ã€‚&lt;/li>
&lt;li>&lt;strong>ç¼–å†™ slurm è„šæœ¬&lt;/strong>ï¼š æŒ‡å®šèµ„æºéœ€æ±‚ï¼ˆCPUã€å†…å­˜ã€GPU ç­‰ï¼‰ï¼Œå¹¶ä½¿ç”¨ &lt;code>ollama serve&lt;/code> å‘½ä»¤å¯åŠ¨æ¨¡å‹æœåŠ¡ï¼Œå¹¶ç»‘å®šåˆ°ç‰¹å®šç«¯å£ã€‚&lt;/li>
&lt;/ol>
&lt;pre>&lt;code class="language-bash">#!/bin/bash
#SBATCH --job-name=ollama
#SBATCH -N 1
#SBATCH -p GPU
#SBATCH --gres=gpu:1
module load CUDA
ollama serve
&lt;/code>&lt;/pre>
&lt;ol start="3">
&lt;li>&lt;strong>æäº¤ slurm ä»»åŠ¡&lt;/strong>: ä½¿ç”¨ &lt;code>sbatch&lt;/code> å‘½ä»¤æäº¤è„šæœ¬ï¼ŒSlurm ä¼šå°†ä»»åŠ¡åˆ†é…åˆ°è®¡ç®—èŠ‚ç‚¹è¿è¡Œã€‚&lt;/li>
&lt;li>&lt;strong>æœ¬åœ°ç«¯å£æ˜ å°„&lt;/strong>ï¼š ä½¿ç”¨ ssh -L å‘½ä»¤å°†è®¡ç®—èŠ‚ç‚¹çš„ç«¯å£æ˜ å°„åˆ°æœ¬åœ°ï¼Œä¾‹å¦‚:&lt;/li>
&lt;/ol>
&lt;pre>&lt;code class="language-bash">ssh -t -t ç”¨æˆ·å@ç™»å½•èŠ‚ç‚¹ ip -L 11434:localhost:11434 -i ç™»å½•èŠ‚ç‚¹ç§é’¥ ssh è®¡ç®—èŠ‚ç‚¹ IP -L 11434:127.0.0.1:11434
&lt;/code>&lt;/pre>
&lt;ol start="5">
&lt;li>&lt;strong>æœ¬åœ°è®¿é—®&lt;/strong>ï¼š åœ¨æµè§ˆå™¨æˆ–åº”ç”¨ç¨‹åºä¸­è®¿é—® http://localhost:11434 å³å¯ä½¿ç”¨ Ollama æœåŠ¡ã€‚&lt;/li>
&lt;/ol>
&lt;div class="notice notice-tip" >
&lt;div class="notice-title">&lt;svg t="1705945832245" class="icon notice-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19409" width="200" height="200">&lt;path d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m238.933333 349.866666l-2.133333 2.133334-277.333333 277.333333c-10.666667 10.666667-29.866667 12.8-42.666667 2.133333L426.666667 704l-149.333334-149.333333c-12.8-12.8-12.8-32 0-44.8 10.666667-10.666667 29.866667-12.8 42.666667-2.133334l2.133333 2.133334 125.866667 125.866666 253.866667-253.866666c10.666667-10.666667 29.866667-12.8 42.666666-2.133334l2.133334 2.133334c12.8 12.8 12.8 32 4.266666 42.666666z" fill="#ffffff" p-id="19410">&lt;/path>&lt;/svg>&lt;/div>&lt;p>æ³¨æ„ï¼šç”±äºè®¡ç®—èŠ‚ç‚¹ä¸è”ç½‘ï¼Œéœ€è¦æå‰åœ¨ç™»å½•èŠ‚ç‚¹ä½¿ç”¨ &lt;code>ollama pull&lt;/code> ä¸‹è½½æ‰€éœ€æ¨¡å‹ã€‚æ­¤å¤–ï¼Œéœ€è¦è®¾ç½® &lt;code>OLLAMA_ORIGINS&lt;/code> ä¸º &lt;code>*&lt;/code>ï¼Œè®¾ç½® &lt;code>OLLAMA_HOST&lt;/code> ä¸º &lt;code>0.0.0.0&lt;/code>ï¼Œä»¥å…è®¸æ‰€æœ‰æ¥æºè®¿é—®æœåŠ¡ã€‚&lt;/p>&lt;/div>
&lt;h2 id="è¿›é˜¶ç”¨æ³•æœ¬åœ°ä»£ç è¡¥å…¨åŠ©æ‰‹">è¿›é˜¶ç”¨æ³•ï¼šæœ¬åœ°ä»£ç è¡¥å…¨åŠ©æ‰‹&lt;/h2>
&lt;p>Ollama ä¸ä»…å¯ä»¥ç”¨äºèŠå¤©å’Œæ–‡æœ¬åˆ›ä½œï¼Œè¿˜å¯ä»¥ç»“åˆä»£ç ç”Ÿæˆæ¨¡å‹å’Œ IDE æ’ä»¶ï¼Œæ‰“é€ å¼ºå¤§çš„ä»£ç è¡¥å…¨åŠ©æ‰‹ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ Codeqwen 7B æ¨¡å‹å’Œ VS Code æ’ä»¶ &lt;a class="link" href="https://continue.dev/" target="_blank" rel="noopener" >Continue
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼Œå¯ä»¥å®ç°é«˜æ•ˆä¾¿æ·çš„ä»£ç è¡¥å…¨åŠŸèƒ½ã€‚&lt;/p>
&lt;p>é¦–å…ˆä»‹ç»ä¸€ä¸‹ Continue :
&lt;blockquote>
&lt;p>&lt;p>&lt;a class="link" href="https://continue.dev/" target="_blank" rel="noopener" >Continue
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
enables you to easily create your own coding assistant directly inside Visual Studio Code and JetBrains with open-source LLMs. All this can run entirely on your own laptop or have Ollama deployed on a server to remotely power code completion and chat experiences based on your needs.&lt;/p>
&lt;p>Continue ä½¿æ‚¨èƒ½å¤Ÿè½»æ¾åœ°åœ¨ Visual Studio Code å’Œ JetBrains ä¸­åˆ›å»ºè‡ªå·±çš„ä»£ç åŠ©æ‰‹ï¼Œåˆ©ç”¨å¼€æº LLMã€‚è¿™ä¸€åˆ‡éƒ½å¯ä»¥å®Œå…¨åœ¨æ‚¨çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šè¿è¡Œï¼Œæˆ–è€…åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½² Ollamaï¼Œè¿œç¨‹æ ¹æ®æ‚¨çš„éœ€æ±‚æä¾›ä»£ç è¡¥å…¨å’ŒèŠå¤©ä½“éªŒã€‚&lt;/p>
&lt;/p>&lt;span class="cite">&lt;span>â€• &lt;/span>&lt;span>Continue&lt;/span>&lt;cite>&lt;/cite>&lt;/span>&lt;/blockquote>&lt;/p>
&lt;p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œä½ éœ€è¦å®‰è£…å¦‚ä¸‹å·¥å…·ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://docs.continue.dev/quickstart" target="_blank" rel="noopener" >Continue
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼š&lt;a class="link" href="https://marketplace.visualstudio.com/items?itemName=Continue.continue" target="_blank" rel="noopener" >VS Code ç‰ˆæœ¬
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æˆ– &lt;a class="link" href="https://plugins.jetbrains.com/plugin/22707-continue" target="_blank" rel="noopener" >JetBrains ç‰ˆæœ¬
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/li>
&lt;li>&lt;a class="link" href="https://ollama.com/" target="_blank" rel="noopener" >Ollama
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»¥ VS Code ä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•ä½¿ç”¨ Ollama + Continue å®ç°ä»£ç è¡¥å…¨åŠŸèƒ½ï¼š&lt;/p>
&lt;h3 id="codestral-22b-æ¨¡å‹">Codestral 22B æ¨¡å‹&lt;/h3>
&lt;p>Codestral æ—¢èƒ½å®Œæˆä»£ç è‡ªåŠ¨è¡¥å…¨ï¼Œä¹Ÿæ”¯æŒèŠå¤©åŠŸèƒ½ã€‚ä½†é‰´äºå…¶æ‹¥æœ‰ 220 äº¿å‚æ•°ä¸”ä¸å…·å¤‡ç”Ÿäº§è®¸å¯ï¼Œå®ƒå¯¹æ˜¾å­˜è¦æ±‚é¢‡é«˜ï¼Œä»…é™äºç ”ç©¶å’Œæµ‹è¯•ä½¿ç”¨ï¼Œå› æ­¤å¯èƒ½å¹¶ä¸é€‚åˆæ—¥å¸¸æœ¬åœ°åº”ç”¨ã€‚&lt;/p>
&lt;h4 id="ä¸‹è½½å¹¶è¿è¡Œ-codestral-æ¨¡å‹">ä¸‹è½½å¹¶è¿è¡Œ Codestral æ¨¡å‹&lt;/h4>
&lt;pre>&lt;code class="language-bash">ollama run codestral
&lt;/code>&lt;/pre>
&lt;h4 id="é…ç½®-configjson">é…ç½® config.json&lt;/h4>
&lt;ul>
&lt;li>åœ¨ VS Code ä¾§è¾¹æ ç‚¹å‡» Continue æ’ä»¶å›¾æ ‡ï¼Œç„¶ååœ¨é¢æ¿å³ä¸‹è§’ç‚¹å‡» â€œé½¿è½®â€ å›¾æ ‡ï¼Œæ‰“å¼€ &lt;code>config.json&lt;/code> æ–‡ä»¶ã€‚ç„¶åå¤åˆ¶ä»¥ä¸‹é…ç½®åˆ° &lt;code>config.json&lt;/code> æ–‡ä»¶ä¸­ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-json">{
&amp;quot;models&amp;quot;: [
{
&amp;quot;title&amp;quot;: &amp;quot;Codestral&amp;quot;,
&amp;quot;provider&amp;quot;: &amp;quot;ollama&amp;quot;,
&amp;quot;model&amp;quot;: &amp;quot;codestral&amp;quot;
}
],
&amp;quot;tabAutocompleteModel&amp;quot;: {
&amp;quot;title&amp;quot;: &amp;quot;Codestral&amp;quot;,
&amp;quot;provider&amp;quot;: &amp;quot;ollama&amp;quot;,
&amp;quot;model&amp;quot;: &amp;quot;codestral&amp;quot;
}
}
&lt;/code>&lt;/pre>
&lt;h3 id="deepseek-coder-67b-æ¨¡å‹--llama-3-8b-æ¨¡å‹">DeepSeek Coder 6.7B æ¨¡å‹ + Llama 3 8B æ¨¡å‹&lt;/h3>
&lt;p>æ ¹æ®æœºå™¨çš„æ˜¾å­˜å¤§å°ï¼Œå¯ä»¥åˆ©ç”¨ Ollama åŒæ—¶è¿è¡Œå¤šä¸ªæ¨¡å‹å¹¶å¤„ç†å¤šä¸ªå¹¶å‘è¯·æ±‚çš„èƒ½åŠ›ï¼Œä½¿ç”¨ &lt;code>DeepSeek Coder 6.7B&lt;/code> è¿›è¡Œè‡ªåŠ¨è¡¥å…¨ï¼Œ&lt;code>Llama 3 8B&lt;/code> è¿›è¡ŒèŠå¤©ã€‚å¦‚æœä½ çš„æœºå™¨æ— æ³•åŒæ—¶è¿è¡Œä¸¤è€…ï¼Œé‚£ä¹ˆå¯ä»¥åˆ†åˆ«å°è¯•ï¼Œå†³å®šä½ æ›´åå¥½æœ¬åœ°è‡ªåŠ¨è¡¥å…¨è¿˜æ˜¯æœ¬åœ°èŠå¤©ä½“éªŒã€‚&lt;/p>
&lt;h4 id="ä¸‹è½½å¹¶è¿è¡Œ-deepseek-coder-æ¨¡å‹">ä¸‹è½½å¹¶è¿è¡Œ DeepSeek Coder æ¨¡å‹&lt;/h4>
&lt;pre>&lt;code class="language-bash">ollama run deepseek-coder:6.7b-base
&lt;/code>&lt;/pre>
&lt;h4 id="ä¸‹è½½å¹¶è¿è¡Œ-llama-3-æ¨¡å‹">ä¸‹è½½å¹¶è¿è¡Œ Llama 3 æ¨¡å‹&lt;/h4>
&lt;pre>&lt;code class="language-bash">ollama run llama3:8b
&lt;/code>&lt;/pre>
&lt;h4 id="é…ç½®-configjson-1">é…ç½® config.json&lt;/h4>
&lt;pre>&lt;code class="language-json">{
&amp;quot;models&amp;quot;: [
{
&amp;quot;title&amp;quot;: &amp;quot;Llama 3 8B&amp;quot;,
&amp;quot;provider&amp;quot;: &amp;quot;ollama&amp;quot;,
&amp;quot;model&amp;quot;: &amp;quot;llama3:8b&amp;quot;,
&amp;quot;apiBase&amp;quot;: &amp;quot;http://127.0.0.1:11434&amp;quot;
}
],
&amp;quot;tabAutocompleteModel&amp;quot;: {
&amp;quot;title&amp;quot;: &amp;quot;DeepSeek Coder 6.7B&amp;quot;,
&amp;quot;provider&amp;quot;: &amp;quot;ollama&amp;quot;,
&amp;quot;model&amp;quot;: &amp;quot;deepseek-coder:6.7b-base&amp;quot;,
&amp;quot;apiBase&amp;quot;: &amp;quot;http://127.0.0.1:11434&amp;quot;
}
}
&lt;/code>&lt;/pre>
&lt;h3 id="codeqwen-7b-æ¨¡å‹--qwen2-7b-æ¨¡å‹">Codeqwen 7B æ¨¡å‹ + Qwen2 7B æ¨¡å‹&lt;/h3>
&lt;p>Codeqwen 7B æ¨¡å‹æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºä»£ç è¡¥å…¨çš„æ¨¡å‹ï¼Œè€Œ Qwen2 7B æ¨¡å‹åˆ™æ˜¯ä¸€ä¸ªé€šç”¨çš„èŠå¤©æ¨¡å‹ã€‚è¿™ä¸¤ä¸ªæ¨¡å‹å¯ä»¥å¾ˆå¥½åœ°ç»“åˆåœ¨ä¸€èµ·ï¼Œå®ç°ä»£ç è¡¥å…¨å’ŒèŠå¤©åŠŸèƒ½ã€‚&lt;/p>
&lt;h4 id="ä¸‹è½½å¹¶è¿è¡Œ-codeqwen-æ¨¡å‹">ä¸‹è½½å¹¶è¿è¡Œ Codeqwen æ¨¡å‹&lt;/h4>
&lt;pre>&lt;code class="language-bash">ollama run codeqwen
&lt;/code>&lt;/pre>
&lt;h4 id="ä¸‹è½½å¹¶è¿è¡Œ-qwen2-æ¨¡å‹">ä¸‹è½½å¹¶è¿è¡Œ Qwen2 æ¨¡å‹&lt;/h4>
&lt;pre>&lt;code class="language-bash">ollama run qwen2:7b
&lt;/code>&lt;/pre>
&lt;h4 id="é…ç½®-configjson-2">é…ç½® config.json&lt;/h4>
&lt;pre>&lt;code class="language-json">{
&amp;quot;models&amp;quot;: [
{
&amp;quot;title&amp;quot;: &amp;quot;Codeqwen 7B&amp;quot;,
&amp;quot;provider&amp;quot;: &amp;quot;ollama&amp;quot;,
&amp;quot;model&amp;quot;: &amp;quot;codeqwen&amp;quot;,
&amp;quot;apiBase&amp;quot;: &amp;quot;http://127.0.0.1:11434&amp;quot;
}
],
&amp;quot;tabAutocompleteModel&amp;quot;: {
&amp;quot;title&amp;quot;: &amp;quot;Qwen2 7B&amp;quot;,
&amp;quot;provider&amp;quot;: &amp;quot;ollama&amp;quot;,
&amp;quot;model&amp;quot;: &amp;quot;qwen2:7b&amp;quot;,
&amp;quot;apiBase&amp;quot;: &amp;quot;http://127.0.0.1:11434&amp;quot;
}
}
&lt;/code>&lt;/pre>
&lt;h3 id="åˆ©ç”¨-rag-å‘é‡æ£€ç´¢ä¼˜åŒ–èŠå¤©">åˆ©ç”¨ RAG å‘é‡æ£€ç´¢ä¼˜åŒ–èŠå¤©&lt;/h3>
&lt;p>Continue å†…ç½®äº† &lt;a class="link" href="https://docs.continue.dev/customization/context-providers#codebase-retrieval" target="_blank" rel="noopener" >@codebase
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ä¸Šä¸‹æ–‡æä¾›å™¨ï¼Œèƒ½è‡ªåŠ¨ä»ä»£ç åº“ä¸­æ£€ç´¢åˆ°æœ€ç›¸å…³çš„ä»£ç ç‰‡æ®µã€‚å‡å¦‚ä½ å·²ç»è®¾ç½®å¥½äº†èŠå¤©æ¨¡å‹ï¼ˆä¾‹å¦‚ Codestralã€Llama 3ï¼‰ï¼Œé‚£ä¹ˆå€ŸåŠ© Ollama å’Œ &lt;a class="link" href="https://blog.lancedb.com/lancedb-x-continue/" target="_blank" rel="noopener" >LanceDB
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„å‘é‡åŒ–æŠ€æœ¯ï¼Œå¯ä»¥å®ç°æ›´é«˜æ•ˆçš„ä»£ç æ£€ç´¢å’ŒèŠå¤©ä½“éªŒã€‚&lt;/p>
&lt;p>è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ &lt;code>nomic-embed-text&lt;/code> æ¨¡å‹ä½œä¸ºå‘é‡æ£€ç´¢æ¨¡å‹ï¼š&lt;/p>
&lt;h4 id="ä¸‹è½½å¹¶è¿è¡Œ-nomic-embed-text-æ¨¡å‹">ä¸‹è½½å¹¶è¿è¡Œ Nomic Embed Text æ¨¡å‹&lt;/h4>
&lt;pre>&lt;code class="language-bash">ollama run nomic-embed-text
&lt;/code>&lt;/pre>
&lt;h4 id="é…ç½®-configjson-3">é…ç½® config.json&lt;/h4>
&lt;ul>
&lt;li>åœ¨æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-json">{
&amp;quot;embeddingsProvider&amp;quot;: {
&amp;quot;provider&amp;quot;: &amp;quot;ollama&amp;quot;,
&amp;quot;model&amp;quot;: &amp;quot;nomic-embed-text&amp;quot;,
&amp;quot;apiBase&amp;quot;: &amp;quot;http://127.0.0.1:11434&amp;quot;
}
}
&lt;/code>&lt;/pre>
&lt;h3 id="ä»£ç è¡¥å…¨æ•ˆæœ">ä»£ç è¡¥å…¨æ•ˆæœ&lt;/h3>
&lt;ul>
&lt;li>&lt;code>Ctrl + I&lt;/code>: æ ¹æ®æŒ‡ä»¤ç”Ÿæˆä»£ç ç‰‡æ®µã€‚&lt;/li>
&lt;/ul>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/codeqwen_1-2024-06-17.png"
alt="codeqwen_1-2024-06-17" width="90%" loading="lazy">
&lt;/figure>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/codeqwen_2-2024-06-17.png"
alt="codeqwen_2-2024-06-17" width="90%" loading="lazy">
&lt;/figure>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/codeqwen_3-2024-06-17.png"
alt="codeqwen_3-2024-06-17" width="90%" loading="lazy">
&lt;/figure>
&lt;ul>
&lt;li>å…‰æ ‡æ‚¬åœè‡ªåŠ¨è¡¥å…¨ä»£ç &lt;/li>
&lt;/ul>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/codeqwen_4-2024-06-17.png"
alt="codeqwen_4-2024-06-17" width="90%" loading="lazy">
&lt;/figure>
&lt;h3 id="ä¸-ollama-èŠå¤©">ä¸ Ollama èŠå¤©&lt;/h3>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/codeqwen_5-2024-06-17.png"
alt="codeqwen_5-2024-06-17" width="90%" loading="lazy">
&lt;/figure>
&lt;h3 id="ä»£ç è‡ªåŠ¨æ³¨é‡Š">ä»£ç è‡ªåŠ¨æ³¨é‡Š&lt;/h3>
&lt;ul>
&lt;li>é€‰ä¸­ä»£ç æ‰“å¼€å³é”®èœå•&lt;/li>
&lt;/ul>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/codeqwen_6-2024-06-17.png"
alt="codeqwen_6-2024-06-17" width="90%" loading="lazy">
&lt;/figure>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/codeqwen_7-2024-06-17.png"
alt="codeqwen_7-2024-06-17" width="90%" loading="lazy">
&lt;/figure>
&lt;h2 id="æ€»ç»“">æ€»ç»“&lt;/h2>
&lt;p>Ollama ä¸ºæˆ‘ä»¬æ‰“å¼€äº†é€šå¾€å¼€æº LLM ä¸–ç•Œçš„å¤§é—¨ï¼Œè®©æ¯ä¸ªäººéƒ½èƒ½è½»æ¾ä½“éªŒ LLM çš„å¼ºå¤§åŠŸèƒ½ï¼Œå¹¶å¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚è¿›è¡Œå®šåˆ¶åŒ–åº”ç”¨ã€‚æ— è®ºæ˜¯è¿›è¡Œç ”ç©¶ã€å¼€å‘ï¼Œè¿˜æ˜¯æ—¥å¸¸ä½¿ç”¨ï¼ŒOllama éƒ½èƒ½ä¸ºä½ æä¾›æ¢ç´¢ LLM æ— é™å¯èƒ½çš„å¹³å°ã€‚ç›¸ä¿¡éšç€ Ollama çš„ä¸æ–­å‘å±•ï¼Œå®ƒå°†ä¸ºæˆ‘ä»¬å¸¦æ¥æ›´å¤šæƒŠå–œï¼Œæ¨åŠ¨ LLM æŠ€æœ¯åœ¨å„ä¸ªé¢†åŸŸçš„åº”ç”¨å’Œå‘å±•ã€‚&lt;/p></description></item><item><title>RDMA ä¹‹ Address Handle</title><link>https://cuterwrite.top/p/rdma-address-handle/</link><pubDate>Sat, 15 Jun 2024 01:00:00 +0000</pubDate><guid>https://cuterwrite.top/p/rdma-address-handle/</guid><description>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-16_116373922_p9_master1200.webp" alt="Featured image of post RDMA ä¹‹ Address Handle" />&lt;h1 id="rdma-ä¹‹-address-handle">RDMA ä¹‹ Address Handle&lt;/h1>
&lt;p>&lt;strong>æœ¬æ–‡æ¬¢è¿éå•†ä¸šè½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>å£°æ˜ï¼šä»…ç”¨äºæ”¶è—ï¼Œä¾¿äºé˜…è¯»&lt;/p>&lt;span class="cite">&lt;span>â€• &lt;/span>&lt;span>Savir, &lt;/span>&lt;a href="https://zhuanlan.zhihu.com/p/163552044">&lt;cite>çŸ¥ä¹ä¸“æ ï¼š8. RDMA ä¹‹ Address Handle&lt;/cite>&lt;/a>&lt;/span>&lt;/blockquote>
&lt;p>å‰é¢å·²ç»ä»‹ç»è¿‡ï¼ŒRDMA é€šä¿¡çš„åŸºæœ¬å•å…ƒæ˜¯ QPã€‚æˆ‘ä»¬æ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œå‡è®¾ A èŠ‚ç‚¹çš„æŸä¸ª QP è¦è·Ÿ B èŠ‚ç‚¹çš„æŸä¸ª QP äº¤æ¢ä¿¡æ¯ï¼Œé™¤äº†è¦çŸ¥é“ B èŠ‚ç‚¹çš„ QP åºå·â€”â€”QPN ä¹‹å¤–ï¼Œè¿˜éœ€è¦ä»€ä¹ˆä¿¡æ¯ï¼Ÿè¦çŸ¥é“ï¼ŒQPN æ˜¯æ¯ä¸ªèŠ‚ç‚¹ç‹¬ç«‹ç»´æŠ¤çš„åºå·ï¼Œä¸æ˜¯æ•´ä¸ªç½‘ç»œä¸­å”¯ä¸€çš„ã€‚æ¯”å¦‚ A çš„ QP 3 è¦è·Ÿ B çš„ QP 5 é€šä¿¡ï¼Œç½‘ç»œä¸­å¯ä¸æ­¢ä¸€ä¸ª QP5ï¼Œå¯èƒ½æœ‰å¾ˆå¤šä¸ªèŠ‚ç‚¹éƒ½æœ‰è‡ªå·±çš„ QP 5ã€‚æ‰€ä»¥æˆ‘ä»¬è‡ªç„¶å¯ä»¥æƒ³åˆ°ï¼Œè¿˜éœ€è¦æ‰¾åˆ°è®©æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„æ ‡è¯†ã€‚&lt;/p>
&lt;p>åœ¨ä¼ ç»Ÿ TCP-IP åè®®æ ˆä¸­ï¼Œä½¿ç”¨äº†å®¶å–»æˆ·æ™“çš„ IP åœ°å€æ¥æ ‡è¯†ç½‘ç»œå±‚çš„æ¯ä¸ªèŠ‚ç‚¹ã€‚è€Œ IB åè®®ä¸­çš„è¿™ä¸ªæ ‡è¯†è¢«ç§°ä¸º&lt;strong>GIDï¼ˆGlobal Identifierï¼Œå…¨å±€ IDï¼‰&lt;/strong>ï¼Œæ˜¯ä¸€ä¸ª 128 bits çš„åºåˆ—ã€‚å…³äº GID æœ¬ç¯‡ä¸å±•å¼€è®¨è®ºï¼Œå°†åœ¨åé¢ä»‹ç»ã€‚&lt;/p>
&lt;h2 id="ah-æ˜¯ä»€ä¹ˆ">AH æ˜¯ä»€ä¹ˆ&lt;/h2>
&lt;p>AH å…¨ç§°ä¸º Address Handleï¼Œæ²¡æœ‰æƒ³åˆ°ç‰¹åˆ«åˆé€‚çš„ä¸­æ–‡ç¿»è¯‘ï¼Œå°±å…ˆç›´è¯‘ä¸ºâ€œåœ°å€å¥æŸ„â€å§ã€‚è¿™é‡Œçš„åœ°å€ï¼ŒæŒ‡çš„æ˜¯ä¸€ç»„ç”¨äºæ‰¾åˆ°æŸä¸ªè¿œç«¯èŠ‚ç‚¹çš„ä¿¡æ¯çš„é›†åˆï¼Œåœ¨ IB åè®®ä¸­ï¼Œåœ°å€æŒ‡çš„æ˜¯ GIDã€ç«¯å£å·ç­‰ç­‰ä¿¡æ¯ï¼›è€Œæ‰€è°“å¥æŸ„ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæŒ‡å‘æŸä¸ªå¯¹è±¡çš„æŒ‡é’ˆã€‚&lt;/p>
&lt;p>å¤§å®¶æ˜¯å¦è¿˜è®°å¾— IB åè®®ä¸­æœ‰å››ç§åŸºæœ¬æœåŠ¡ç±»å‹â€”â€”RCã€UDã€RD å’Œ UCï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„æ˜¯ RC å’Œ UDã€‚RC çš„ç‰¹ç‚¹æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹çš„ QP ä¹‹é—´ä¼šå»ºç«‹å¯é çš„è¿æ¥ï¼Œä¸€æ—¦å»ºç«‹è¿æ¥å…³ç³»ä¾¿ä¸å®¹æ˜“æ”¹å˜ï¼Œå¯¹ç«¯çš„ä¿¡æ¯æ˜¯åˆ›å»º QP çš„æ—¶å€™å‚¨å­˜åœ¨ QP Context ä¸­çš„ï¼›&lt;/p>
&lt;p>è€Œå¯¹äº UD æ¥è¯´ï¼ŒQP é—´æ²¡æœ‰è¿æ¥å…³ç³»ï¼Œç”¨æˆ·æƒ³å‘ç»™è°ï¼Œå°±åœ¨ WQE ä¸­å¡«å¥½å¯¹ç«¯çš„åœ°å€ä¿¡æ¯å°±å¯ä»¥äº†ã€‚&lt;strong>ç”¨æˆ·ä¸æ˜¯ç›´æ¥æŠŠå¯¹ç«¯çš„åœ°å€ä¿¡æ¯å¡«åˆ° WQE ä¸­çš„ï¼Œè€Œæ˜¯æå‰å‡†å¤‡äº†ä¸€ä¸ªâ€œåœ°å€è–„â€ï¼Œæ¯æ¬¡é€šè¿‡ä¸€ä¸ªç´¢å¼•æ¥æŒ‡å®šå¯¹ç«¯èŠ‚ç‚¹çš„åœ°å€ä¿¡æ¯ï¼Œè€Œè¿™ä¸ªç´¢å¼•å°±æ˜¯ AHã€‚&lt;/strong>&lt;/p>
&lt;p>AH çš„æ¦‚å¿µå¤§è‡´å¯ä»¥ç”¨ä¸‹å›¾è¡¨ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-16_8_1.webp"
alt="2024-06-16_8_1" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>Address Handle åŠŸèƒ½ç¤ºæ„å›¾&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¯¹äºæ¯ä¸€ä¸ªç›®çš„èŠ‚ç‚¹ï¼Œæœ¬ç«¯éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå¯¹åº”çš„ AHï¼Œè€ŒåŒä¸€ä¸ª AH å¯ä»¥è¢«å¤šä¸ª QP å…±åŒä½¿ç”¨ã€‚&lt;/p>
&lt;h2 id="ah-çš„ä½œç”¨">AH çš„ä½œç”¨&lt;/h2>
&lt;p>æ¯æ¬¡è¿›è¡Œ UD æœåŠ¡ç±»å‹çš„é€šä¿¡ä¹‹å‰ï¼Œç”¨æˆ·éƒ½éœ€è¦å…ˆé€šè¿‡ IB æ¡†æ¶æä¾›çš„æ¥å£ï¼Œæ¥&lt;strong>ä¸ºæ¯ä¸€ä¸ªå¯èƒ½çš„å¯¹ç«¯èŠ‚ç‚¹åˆ›å»ºä¸€ä¸ª AH&lt;/strong>ï¼Œç„¶åè¿™äº› AH ä¼šè¢«é©±åŠ¨æ”¾åˆ°ä¸€ä¸ªâ€œå®‰å…¨â€çš„åŒºåŸŸï¼Œå¹¶è¿”å›ä¸€ä¸ªç´¢å¼•ï¼ˆæŒ‡é’ˆ/å¥æŸ„ï¼‰ç»™ç”¨æˆ·ã€‚ç”¨æˆ·çœŸæ­£ä¸‹å‘ WRï¼ˆWork Requestï¼‰æ—¶ï¼Œå°±æŠŠè¿™ä¸ªç´¢å¼•ä¼ é€’è¿›æ¥å°±å¯ä»¥äº†ã€‚&lt;/p>
&lt;p>ä¸Šè¿°è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒA èŠ‚ç‚¹æ”¶åˆ°ç”¨æˆ·çš„è¿™æ ·ä¸€ä¸ªä»»åŠ¡â€”â€”ä½¿ç”¨æœ¬ç«¯çš„ QP4 ä¸ B èŠ‚ç‚¹ï¼ˆé€šè¿‡ AH æŒ‡å®šï¼‰çš„ QP3 è¿›è¡Œæ•°æ®äº¤æ¢ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-16_8_2.webp"
alt="2024-06-16_8_2" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>UD æœåŠ¡ç±»å‹ä½¿ç”¨ AH æŒ‡å®šå¯¹ç«¯èŠ‚ç‚¹&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>IB åè®®ä¸­å¹¶æ²¡æœ‰å¯¹ä¸ºä»€ä¹ˆä½¿ç”¨ AH åšå‡ºè§£é‡Šï¼Œæˆ‘è®¤ä¸ºå®šä¹‰ AH çš„æ¦‚å¿µçš„åŸå› æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š&lt;/p>
&lt;ol>
&lt;li>ä¿è¯ç›®çš„åœ°å€å¯ç”¨ï¼Œæé«˜æ•ˆç‡&lt;/li>
&lt;/ol>
&lt;p>å› ä¸º UD æ— è¿æ¥çš„ç‰¹ç‚¹ï¼Œç”¨æˆ·å¯ä»¥åœ¨ç”¨æˆ·æ€ç›´æ¥é€šè¿‡ WR æ¥æŒ‡å®šç›®çš„åœ°ã€‚è€Œå¦‚æœè®©ç”¨æˆ·éšæ„å¡«å†™åœ°å€ä¿¡æ¯ï¼Œç„¶åç¡¬ä»¶å°±æ ¹æ®è¿™äº›ä¿¡æ¯è¿›è¡Œç»„åŒ…çš„è¯ï¼Œæ˜¯ä¼šå¸¦æ¥é—®é¢˜çš„ã€‚æ¯”å¦‚æœ‰è¿™æ ·ä¸€ç§åœºæ™¯ï¼šç”¨æˆ·é€šè¿‡ WR å‘Šè¯‰ç¡¬ä»¶è¯·ç»™ GID ä¸º Xï¼ŒMAC åœ°å€ä¸º Y çš„èŠ‚ç‚¹çš„ç«¯å£ Z å‘é€æ•°æ®ã€‚ç„¶è€Œ Xï¼ŒYï¼ŒZ å¯èƒ½ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„ç»„åˆï¼Œæˆ–è€… GID ä¸º X çš„èŠ‚ç‚¹å‹æ ¹éƒ½ä¸å­˜åœ¨äºç½‘ç»œä¸­ï¼Œè€Œç¡¬ä»¶æ˜¯æ— åŠ›æ ¡éªŒè¿™äº›å†…å®¹çš„ï¼Œåªèƒ½ä¹–ä¹–çš„ç»„åŒ…ã€å‘é€æ•°æ®ï¼Œè¿™ä¸ªç›®çš„åœ°æ— æ•ˆçš„æ•°æ®åŒ…å°±ç™½ç™½å‘é€å‡ºå»äº†ã€‚&lt;/p>
&lt;p>è€Œæå‰å‡†å¤‡å¥½åœ°å€ä¿¡æ¯ï¼Œåˆ™å¯ä»¥é¿å…ä¸Šè¿°æƒ…å†µã€‚ç”¨æˆ·åœ¨åˆ›å»º AH æ—¶ä¼šé™·å…¥å†…æ ¸æ€ï¼Œå¦‚æœç”¨æˆ·ä¼ é€’çš„å‚æ•°æœ‰æ•ˆï¼Œå†…æ ¸ä¼šæŠŠè¿™äº›ç›®çš„èŠ‚ç‚¹ä¿¡æ¯å‚¨å­˜èµ·æ¥ï¼Œç”Ÿæˆä¸€ä¸ªæŒ‡é’ˆè¿”å›ç»™ç”¨æˆ·ï¼›å¦‚æœç”¨æˆ·ä¼ é€’çš„å‚æ•°æ— æ•ˆï¼ŒAH å°†åˆ›å»ºå¤±è´¥ã€‚è¿™ä¸€è¿‡ç¨‹å¯ä»¥ä¿è¯åœ°å€ä¿¡æ¯æ˜¯æœ‰æ•ˆçš„ã€‚ç”¨æˆ·é€šè¿‡æŒ‡é’ˆå°±å¯ä»¥å¿«é€ŸæŒ‡å®šç›®çš„èŠ‚ç‚¹ï¼ŒåŠ å¿«æ•°æ®äº¤äº’æµç¨‹ã€‚&lt;/p>
&lt;p>å¯èƒ½æœ‰äººä¼šé—®ï¼Œæ—¢ç„¶å†…æ ¸æ˜¯å¯ä¿¡çš„ï¼Œä¸ºä»€ä¹ˆä¸èƒ½åœ¨å‘é€æ•°æ®æ—¶é™·å…¥å†…æ ¸æ€å»æ ¡éªŒç”¨æˆ·ä¼ é€’çš„åœ°å€ä¿¡æ¯å‘¢ï¼Ÿè¯·åˆ«å¿˜äº† RDMA æŠ€æœ¯çš„ä¸€å¤§ä¼˜åŠ¿åœ¨å“ªé‡Œâ€”â€”æ•°æ®æµç¨‹å¯ä»¥ç›´æ¥ä»ç”¨æˆ·ç©ºé—´åˆ°ç¡¬ä»¶ï¼Œå®Œå…¨ç»•è¿‡å†…æ ¸ï¼Œè¿™æ ·å¯ä»¥é¿å…ç³»ç»Ÿè°ƒç”¨å’Œæ‹·è´çš„å¼€é”€ã€‚å¦‚æœæ¯æ¬¡å‘é€éƒ½è¦æ£€éªŒåœ°å€åˆæ³•æ€§çš„è¯ï¼Œå¿…ç„¶ä¼šé™ä½é€šä¿¡é€Ÿç‡ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>å‘ç”¨æˆ·éšè—åº•å±‚åœ°å€ç»†èŠ‚&lt;/li>
&lt;/ol>
&lt;p>ç”¨æˆ·åˆ›å»º AH æ—¶ï¼Œåªéœ€è¦ä¼ é€’ gidã€ç«¯å£å·ã€é™æ€é€Ÿç‡ç­‰ä¿¡æ¯ï¼Œè€Œå…¶ä»–é€šä¿¡æ‰€éœ€çš„åœ°å€ä¿¡æ¯ï¼ˆä¸»è¦æ˜¯ MAC åœ°å€ï¼‰æ˜¯å†…æ ¸é©±åŠ¨é€šè¿‡æŸ¥è¯¢ç³»ç»Ÿé‚»å±…è¡¨ç­‰æ–¹å¼è§£æåˆ°çš„ï¼Œåº•å±‚æ²¡æœ‰å¿…è¦æš´éœ²è¿™äº›é¢å¤–çš„ä¿¡æ¯ç»™ç”¨æˆ·å±‚ã€‚&lt;/p>
&lt;ol start="3">
&lt;li>å¯ä»¥ä½¿ç”¨ PD å¯¹ç›®çš„åœ°å€è¿›è¡Œç®¡ç†&lt;/li>
&lt;/ol>
&lt;p>å‰æ–‡æˆ‘ä»¬ä»‹ç»ä¿æŠ¤åŸŸæ—¶æ›¾ç»æè¿‡ï¼Œé™¤äº† QPã€MR ä¹‹å¤–ï¼ŒAH ä¹Ÿç”± PD æ¥è¿›è¡Œèµ„æºåˆ’åˆ†ã€‚å½“å®šä¹‰äº† AH è¿™ä¸ªè½¯ä»¶å®ä½“ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹æ‰€æœ‰çš„ QP å¯è¾¾çš„ç›®çš„åœ°è¿›è¡Œç›¸äº’éš”ç¦»å’Œç®¡ç†ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-16_8_3.webp"
alt="2024-06-16_8_3" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>ä½¿ç”¨ PD éš”ç¦» AH&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>â€‹æ¯”å¦‚ä¸Šå›¾ä¸­ï¼ŒAH1~3 åªèƒ½è¢«åŒä¸€ä¸ª PD ä¸‹çš„ QP3 å’Œ QP9 ä½¿ç”¨ï¼Œè€Œ AH4 åªèƒ½è¢« QP5 ä½¿ç”¨ã€‚&lt;/p>
&lt;h2 id="åè®®ç›¸å…³ç« èŠ‚">åè®®ç›¸å…³ç« èŠ‚&lt;/h2>
&lt;p>åè®®ä¸­å…³äº AH çš„ç¯‡å¹…å¹¶ä¸å¤šï¼Œç”šè‡³æ²¡æœ‰ç‹¬ç«‹ä»‹ç»å…¶æ¦‚å¿µçš„ç« èŠ‚ï¼š&lt;/p>
&lt;p>[1] 9.8.3 UD æœåŠ¡ç±»å‹ä¸­çš„ç›®çš„åœ°å€ç”±å“ªäº›éƒ¨åˆ†ç»„æˆï¼šåŒ…æ‹¬ AHã€ QPN å’Œ Q_key&lt;/p>
&lt;p>[2] 10.2.2.2 ç›®çš„åœ°å€çš„ç›¸å…³æ³¨æ„äº‹é¡¹&lt;/p>
&lt;p>[3] 11.2.2.1 AH ç›¸å…³çš„ Verbs æ¥å£&lt;/p>
&lt;p>AH å°±ä»‹ç»åˆ°è¿™é‡Œï¼Œæ„Ÿè°¢é˜…è¯»ã€‚ä¸‹ä¸€ç¯‡æ‰“ç®—å‘å¤§å®¶æè¿°æ›´å¤šå…³äº QP çš„ç»†èŠ‚ã€‚&lt;/p></description></item><item><title>Docker Hub é•œåƒä¸‹æ¶è§£å†³æ–¹æ¡ˆ</title><link>https://cuterwrite.top/p/dockerhub-takedown/</link><pubDate>Wed, 12 Jun 2024 19:00:00 +0000</pubDate><guid>https://cuterwrite.top/p/dockerhub-takedown/</guid><description>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-05-28_crop_68935d3d33a3abc75c797b67ad25160f195413.webp" alt="Featured image of post Docker Hub é•œåƒä¸‹æ¶è§£å†³æ–¹æ¡ˆ" />&lt;h1 id="docker-hub-é•œåƒä¸‹æ¶è§£å†³æ–¹æ¡ˆ">Docker Hub é•œåƒä¸‹æ¶è§£å†³æ–¹æ¡ˆ&lt;/h1>
&lt;p>Docker Hub ä½œä¸º Docker å®˜æ–¹çš„é•œåƒä»“åº“ï¼Œæ‹¥æœ‰ç€ä¸°å¯Œçš„é•œåƒèµ„æºï¼Œ æå¤§åœ°æ–¹ä¾¿äº†å¼€å‘è€…è·å–å’Œä½¿ç”¨å„ç§è½¯ä»¶å’ŒæœåŠ¡ã€‚ç„¶è€Œï¼Œä» 2024 å¹´ 6 æœˆ 6 æ—¥å¼€å§‹ï¼Œå›½å†…å„å¤§é•œåƒç«™ç‚¹é™†ç»­å‡ºç°äº† Docker Hub é•œåƒä¸‹æ¶çš„æƒ…å†µï¼ŒåŒ…æ‹¬é˜¿é‡Œäº‘ã€ç§‘å¤§ã€å—å¤§ã€ä¸Šäº¤ç­‰å…¨éƒ¨æŒ‚æ‰ï¼Œå¯¼è‡´å¾ˆå¤šå¼€å‘è€…æ— æ³•æ­£å¸¸æ‹‰å–é•œåƒã€‚åœ¨æ‰§è¡Œ &lt;code>docker pull&lt;/code> å‘½ä»¤æ‹‰å–é•œåƒ docker é•œåƒæ—¶æ— ååº”ï¼Œä¼šä¸€ç›´å¾ªç¯å°è¯•ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-13_takedown-dockerhub.webp"
alt="2024-06-13_takedown-dockerhub" width="auto" loading="lazy">
&lt;/figure>
&lt;p>Docker Hub é•œåƒä¸‹æ¶çš„å¯èƒ½åŸå› ä¸»è¦ä¸ºä¸€äº›é•œåƒåŒ…å«è¿è§„å†…å®¹ï¼Œå¯¼è‡´ä¸Šé¢ä¿¡æ¯ç›‘ç®¡éƒ¨é—¨å‡ºäº†æœ€æ–°è¦æ±‚ï¼Œè¦æ±‚å„å¤§é•œåƒç«™ç‚¹ä¸‹æ¶ç›¸å…³é•œåƒã€‚&lt;/p>
&lt;h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h2>
&lt;p>é¢å¯¹ Docker Hub é•œåƒä¸‹æ¶é—®é¢˜ï¼Œç›®å‰æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼è§£å†³ï¼š&lt;/p>
&lt;h3 id="1-ä½¿ç”¨-atomhub-é•œåƒç«™ç‚¹">1. ä½¿ç”¨ AtomHub é•œåƒç«™ç‚¹&lt;/h3>
&lt;p>AtomHub æ˜¯ç”±å¼€æ”¾åŸå­å¼€æºåŸºé‡‘ä¼šå‘èµ·ï¼Œéµå¾ª OCI æ ‡å‡†ï¼Œæ—¨åœ¨ä¸ºå¼€å‘è€…æä¾›å¼€æ”¾ä¸­ç«‹ã€å®‰å…¨å¯ä¿¡ã€é«˜æ•ˆä¾¿æ·çš„æ–°ä¸€ä»£å¼€æºå®¹å™¨é•œåƒä¸­å¿ƒã€‚å…¶å…·æœ‰å®˜æ–¹èƒŒä¹¦ï¼Œæ˜¯å½“å‰å”¯ä¸€æ­£å¸¸çš„ Docker Hub é•œåƒç«™ç‚¹ã€‚&lt;/p>
&lt;p>ä¸è¿‡ï¼ŒAtomHub çš„é—®é¢˜æ˜¯é•œåƒæ•°é‡è¾ƒå°‘ï¼Œç›®å‰åªæœ‰å‡ ç™¾ä¸ªé•œåƒæ–‡ä»¶ï¼›ä»¥åŠï¼Œéƒ¨åˆ†è½¯ä»¶çš„ç‰ˆæœ¬è¾ƒæ—§ã€‚&lt;/p>
&lt;h4 id="é…ç½®-atomhub-é•œåƒç«™ç‚¹">é…ç½® AtomHub é•œåƒç«™ç‚¹&lt;/h4>
&lt;ul>
&lt;li>ä¿®æ”¹ /etc/docker/daemon.json æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-json">{
&amp;quot;registry-mirrors&amp;quot;: [&amp;quot;https://atomhub.openatom.cn&amp;quot;]
}
&lt;/code>&lt;/pre>
&lt;h4 id="é‡å¯-docker-æœåŠ¡">é‡å¯ Docker æœåŠ¡ï¼š&lt;/h4>
&lt;pre>&lt;code class="language-bash">sudo systemctl daemon-reload
sudo systemctl restart docker
&lt;/code>&lt;/pre>
&lt;p>ç„¶åå°±å¯ä»¥æ­£å¸¸æ‹‰å–ä¸€äº›å¸¸ç”¨é•œåƒäº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ éœ€è¦çš„é•œåƒä¸åœ¨ AtomHub ä¸Šï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¸é€‚ç”¨äº†ã€‚&lt;/p>
&lt;h3 id="2-é…ç½®-vpn-ä»£ç†">2. é…ç½® VPN ä»£ç†&lt;/h3>
&lt;p>é€šè¿‡é…ç½® VPN ä»£ç†ï¼Œå¯ä»¥è®¿é—®è¢«å±è”½çš„ Docker Hub æºç«™ç‚¹ï¼Œä»è€Œæ‹‰å–é•œåƒã€‚ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•éœ€è¦è‡ªå¤‡ VPN æœåŠ¡ï¼Œä¸”é€Ÿåº¦å¯èƒ½è¾ƒæ…¢ä¸”ä¸ç¨³å®šã€‚&lt;/p>
&lt;h4 id="é…ç½®æ–¹æ³•">é…ç½®æ–¹æ³•&lt;/h4>
&lt;ul>
&lt;li>åˆ›å»º &lt;code>/etc/systemd/system/docker.service.d/http-proxy.conf&lt;/code> æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-bash">[Service]
Environment=&amp;quot;HTTP_PROXY=http://your_proxy_server:port&amp;quot;
Environment=&amp;quot;HTTPS_PROXY=http://your_proxy_server:port&amp;quot;
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>é‡å¯ Docker æœåŠ¡ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-bash">sudo systemctl daemon-reload
sudo systemctl restart docker
&lt;/code>&lt;/pre>
&lt;h3 id="3-ä½¿ç”¨-skopeo-æ‹·è´é•œåƒåˆ°ç§æœ‰é•œåƒä»“åº“">3. ä½¿ç”¨ Skopeo æ‹·è´é•œåƒåˆ°ç§æœ‰é•œåƒä»“åº“&lt;/h3>
&lt;p>Skopeo æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥ç”¨äºåœ¨ä¸åŒçš„é•œåƒä»“åº“ä¹‹é—´å¤åˆ¶ã€æ£€æŸ¥å’Œç­¾åé•œåƒã€‚è¯¥æ–¹æ³•éœ€è¦ä¸€å°æµ·å¤–äº‘ä¸»æœºï¼Œä¸”éœ€è¦æ²¡æœ‰è¢«å¢™ã€‚&lt;/p>
&lt;h4 id="å…·ä½“æ­¥éª¤">å…·ä½“æ­¥éª¤&lt;/h4>
&lt;p>è¿™é‡Œä»¥é˜¿é‡Œäº‘ç§æœ‰é•œåƒä»“åº“ä¸ºä¾‹ï¼Œå°† Docker Hub ä¸Šçš„é•œåƒå¤åˆ¶åˆ°é˜¿é‡Œäº‘ç§æœ‰é•œåƒä»“åº“ã€‚&lt;/p>
&lt;ul>
&lt;li>é¦–å…ˆï¼Œä½ éœ€è¦å¯ç”¨&lt;a class="link" href="https://cr.console.aliyun.com/" target="_blank" rel="noopener" >é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼Œåˆ›å»ºä¸€ä¸ªä¸ªäººå®ä¾‹ï¼š&lt;/li>
&lt;/ul>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-13_aliyun-container.webp"
alt="2024-06-13_aliyun-container" width="90%" loading="lazy">
&lt;/figure>
&lt;ul>
&lt;li>è¿›å…¥ä¸ªäººå®ä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´ï¼š&lt;/li>
&lt;/ul>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-13_create-namespace.webp"
alt="2024-06-13_create-namespace" width="90%" loading="lazy">
&lt;/figure>
&lt;ul>
&lt;li>åˆ›å»ºä¸€ä¸ªé•œåƒä»“åº“ï¼ˆå¯¹åº”ä½ æƒ³è¦å¤åˆ¶çš„é•œåƒï¼‰ï¼š&lt;/li>
&lt;/ul>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-13_create-repository.webp"
alt="2024-06-13_create-repository" width="90%" loading="lazy">
&lt;/figure>
&lt;ul>
&lt;li>è®¾ç½®è®¿é—®å‡­è¯ï¼š&lt;/li>
&lt;/ul>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/2024-06-13_set-pass.webp"
alt="2024-06-13_set-pass" width="90%" loading="lazy">
&lt;/figure>
&lt;ul>
&lt;li>ç„¶åï¼Œç™»å½•åˆ°ä½ çš„æµ·å¤–äº‘ä¸»æœºï¼Œå…ˆå®‰è£… Skopeoï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-bash">sudo apt-get update &amp;amp;&amp;amp; sudo apt-get install -y skopeo
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>ä½¿ç”¨ Skopeo æ‹·è´é•œåƒï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-bash">docker login --username=yourusername registry.cn-hangzhou.aliyuncs.com
skopeo copy docker://docker.io/library/image:tag docker://registry.cn-hangzhou.aliyuncs.com/yournamespace/yourimage:tag
&lt;/code>&lt;/pre>
&lt;h3 id="4-éƒ¨ç½²ç§æœ‰é•œåƒä»“åº“">4. éƒ¨ç½²ç§æœ‰é•œåƒä»“åº“&lt;/h3>
&lt;p>é™¤äº†ä»¥ä¸Šæ–¹æ³•ï¼Œè¿˜å¯ä»¥é€šè¿‡æœ€è¿‘ä¸€å¤§ä½¬å¼€æºçš„ &lt;a class="link" href="https://github.com/dqzboy/Docker-Proxy" target="_blank" rel="noopener" >Docker-Proxy
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
é¡¹ç›®æ­å»ºè‡ªå·±çš„ç§æœ‰é•œåƒä»“åº“ã€‚&lt;/p>
&lt;a href="https://github.com/dqzboy/Docker-Proxy" target="_blank" class="card-github fetch-waiting no-styling"
repo="dqzboy/Docker-Proxy" id="repo-AoA94QzCUrFt4oCg-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-AoA94QzCUrFt4oCg-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">dqzboy&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">Docker-Proxy&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-AoA94QzCUrFt4oCg-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-AoA94QzCUrFt4oCg-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-AoA94QzCUrFt4oCg-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-AoA94QzCUrFt4oCg-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-AoA94QzCUrFt4oCg-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-AoA94QzCUrFt4oCg-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/dqzboy\/Docker-Proxy', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-AoA94QzCUrFt4oCg-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-AoA94QzCUrFt4oCg-language').innerText = data.language;
document.getElementById('repo-AoA94QzCUrFt4oCg-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-AoA94QzCUrFt4oCg-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-AoA94QzCUrFt4oCg-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-AoA94QzCUrFt4oCg-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-AoA94QzCUrFt4oCg-license').classList.add = "no-license"
};
document.getElementById('repo-AoA94QzCUrFt4oCg-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for dqzboy\/Docker-Proxy.")
}).catch(err => {
const c = document.getElementById('repo-AoA94QzCUrFt4oCg-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for dqzboy\/Docker-Proxy.")
})
&lt;/script>
&lt;p>è¯¥æ–¹æ³•ä¹Ÿéœ€è¦ä¸€å°æµ·å¤–äº‘ä¸»æœºï¼Œä¸”éœ€è¦æ²¡æœ‰è¢«å¢™ï¼›ä»¥åŠä¸€ä¸ªåŸŸåï¼ˆä¸éœ€è¦å¤‡æ¡ˆï¼‰ã€‚&lt;/p>
&lt;h4 id="éƒ¨ç½²">éƒ¨ç½²&lt;/h4>
&lt;p>ç›®å‰é¡¹ç›®æä¾›äº†ä¸‰ç§éƒ¨ç½²æ–¹å¼ï¼Œæˆ‘é‡‡ç”¨çš„æ˜¯ç¬¬ä¸€ç§æ–¹å¼ï¼Œä½¿ç”¨é¡¹ç›®è„šæœ¬ä¸€é”®éƒ¨ç½²ã€‚&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨é¡¹ç›®è„šæœ¬ä¸€é”®éƒ¨ç½²ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-bash"># CentOS
yum -y install wget curl
# ubuntu
apt -y install wget curl
bash -c &amp;quot;$(curl -fsSL https://raw.githubusercontent.com/dqzboy/Docker-Proxy/main/install/DockerProxy_Install.sh)&amp;quot;
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>
&lt;p>éƒ¨ç½²åˆ° Render&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://github.com/dqzboy/Docker-Proxy/blob/main/Render/README.md" target="_blank" rel="noopener" >ä½¿ç”¨ Render å¿«é€Ÿéƒ¨ç½²
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Docker Compose éƒ¨ç½²&lt;/p>
&lt;ol>
&lt;li>ä¸‹è½½ config ç›®å½•ä¸‹å¯¹åº”çš„ yml æ–‡ä»¶åˆ°ä½ æœ¬åœ°æœºå™¨ä¸Š&lt;/li>
&lt;li>ä¸‹è½½ &lt;a class="link" href="https://github.com/dqzboy/Docker-Proxy/blob/main/docker-compose.yaml" target="_blank" rel="noopener" >docker-compose.yaml
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æ–‡ä»¶åˆ°ä½ æœ¬åœ°æœºå™¨ä¸Šï¼Œå¹¶ä¸”ä¸é…ç½®æ–‡ä»¶åŒçº§ç›®å½•ä¸‹&lt;/li>
&lt;li>æ‰§è¡Œ &lt;code>docker compose&lt;/code> å‘½ä»¤å¯åŠ¨å®¹å™¨æœåŠ¡&lt;/li>
&lt;/ol>
&lt;pre>&lt;code class="language-bash">docker compose up -d
# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs -f [å®¹å™¨ ID æˆ–åç§°]
&lt;/code>&lt;/pre>
&lt;/li>
&lt;/ul>
&lt;p>æœ€åï¼Œéœ€è¦ç™»å½•åŸŸåè§£ææ–¹ï¼Œå°† &lt;code>hub&lt;/code>ã€&lt;code>gcr&lt;/code>ã€&lt;code>ghcr&lt;/code>ã€&lt;code>k8s-gcr&lt;/code>ã€&lt;code>ui&lt;/code>ã€&lt;code>quay&lt;/code> ç­‰ A è®°å½•è§£æåˆ°ä½ çš„æµ·å¤–äº‘ä¸»æœº IPv4 åœ°å€ï¼Œç„¶åå°±å¯ä»¥å°† &lt;code>/etc/docker/daemon.json&lt;/code> ä¸­çš„ &lt;strong>registry-mirrors&lt;/strong> è®¾ç½®ä¸º &lt;code>https://hub.yourdomain&lt;/code> è¿›è¡Œé•œåƒåŠ é€Ÿäº†ã€‚&lt;/p></description></item><item><title>RDMA ä¹‹ Protection Domain</title><link>https://cuterwrite.top/p/rdma-protection-domain/</link><pubDate>Thu, 18 Apr 2024 21:42:00 +0000</pubDate><guid>https://cuterwrite.top/p/rdma-protection-domain/</guid><description>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/d31a474af07682028ca085f871bc5d07195413-2024-04-19.webp" alt="Featured image of post RDMA ä¹‹ Protection Domain" />&lt;h1 id="rdma-ä¹‹-protection-domain">RDMA ä¹‹ Protection Domain&lt;/h1>
&lt;p>&lt;strong>æœ¬æ–‡æ¬¢è¿éå•†ä¸šè½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>å£°æ˜ï¼šä»…ç”¨äºæ”¶è—ï¼Œä¾¿äºé˜…è¯»&lt;/p>&lt;span class="cite">&lt;span>â€• &lt;/span>&lt;span>Savir, &lt;/span>&lt;a href="https://zhuanlan.zhihu.com/p/159493100">&lt;cite>çŸ¥ä¹ä¸“æ ï¼š7. RDMA ä¹‹ Protection Domain&lt;/cite>&lt;/a>&lt;/span>&lt;/blockquote>
&lt;p>å‰æ–‡æˆ‘ä»¬ç®€å•ä»‹ç»äº† RDMA ä¸­æœ€å¸¸è§çš„ä¸€äº›èµ„æºï¼ŒåŒ…æ‹¬å„ç§ Queueï¼Œä»¥åŠ MR çš„æ¦‚å¿µç­‰ç­‰ã€‚MR ç”¨äºæ§åˆ¶å’Œç®¡ç† HCA å¯¹äºæœ¬ç«¯å’Œè¿œç«¯å†…å­˜çš„è®¿é—®æƒé™ï¼Œç¡®ä¿ HCA åªæœ‰æ‹¿åˆ°æ­£ç¡® Key ä¹‹åæ‰èƒ½è¯»å†™ç”¨æˆ·å·²ç»æ³¨å†Œäº†çš„å†…å­˜åŒºåŸŸã€‚ä¸ºäº†æ›´å¥½çš„ä¿éšœå®‰å…¨æ€§ï¼ŒIB åè®®åˆæå‡ºäº† Protection Domainï¼ˆPDï¼‰çš„æ¦‚å¿µï¼Œç”¨äºä¿è¯ RDMA èµ„æºé—´çš„ç›¸äº’éš”ç¦»ï¼Œæœ¬æ–‡å°±ä»‹ç»ä¸€ä¸‹ PD çš„æ¦‚å¿µã€‚&lt;/p>
&lt;h2 id="pd-æ˜¯ä»€ä¹ˆ">PD æ˜¯ä»€ä¹ˆ&lt;/h2>
&lt;p>PD å…¨ç§°æ˜¯ Protection Domainï¼Œæ„ä¸º&amp;quot;ä¿æŠ¤åŸŸ&amp;quot;ã€‚åŸŸçš„æ¦‚å¿µæˆ‘ä»¬ç»å¸¸è§åˆ°ï¼Œä»æ•°å­¦ä¸Šçš„â€œå®æ•°åŸŸâ€ã€â€œå¤æ•°åŸŸâ€ï¼Œåˆ°åœ°ç†ä¸Šçš„â€œç©ºåŸŸâ€ã€â€œæµ·åŸŸâ€ç­‰ç­‰ï¼Œè¡¨ç¤ºä¸€ä¸ªç©ºé—´/èŒƒå›´ã€‚åœ¨ RDMA ä¸­ï¼ŒPD åƒæ˜¯ä¸€ä¸ªå®¹çº³äº†å„ç§èµ„æºï¼ˆQPã€MR ç­‰ï¼‰çš„â€œå®¹å™¨â€ï¼Œå°†è¿™äº›èµ„æºçº³å…¥è‡ªå·±çš„ä¿æŠ¤èŒƒå›´å†…ï¼Œé¿å…ä»–ä»¬è¢«æœªç»æˆæƒçš„è®¿é—®ã€‚ä¸€ä¸ªèŠ‚ç‚¹ä¸­å¯ä»¥å®šä¹‰å¤šä¸ªä¿æŠ¤åŸŸï¼Œå„ä¸ª PD æ‰€å®¹çº³çš„èµ„æºå½¼æ­¤éš”ç¦»ï¼Œæ— æ³•ä¸€èµ·ä½¿ç”¨ã€‚&lt;/p>
&lt;p>æ¦‚å¿µè¿˜æ˜¯æœ‰äº›æŠ½è±¡ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ PD æœ‰ä»€ä¹ˆä½œç”¨ï¼Œå…·ä½“è§£å†³äº†ä»€ä¹ˆé—®é¢˜ã€‚&lt;/p>
&lt;h2 id="pd-çš„ä½œç”¨">PD çš„ä½œç”¨&lt;/h2>
&lt;p>ä¸€ä¸ªç”¨æˆ·å¯èƒ½åˆ›å»ºå¤šä¸ª QP å’Œå¤šä¸ª MRï¼Œæ¯ä¸ª QP å¯èƒ½å’Œä¸åŒçš„è¿œç«¯ QP å»ºç«‹äº†è¿æ¥ï¼Œæ¯”å¦‚ä¸‹å›¾è¿™æ ·ï¼ˆç°è‰²ç®­å¤´è¡¨ç¤º QP é—´çš„è¿æ¥å…³ç³»ï¼‰ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/7_1-2024-04-19.webp"
alt="7_1-2024-04-19" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>å›¾ 1ï¼šæ²¡æœ‰ PD æ¦‚å¿µæ—¶çš„ RDMA èµ„æº&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>ç”±äº MR å’Œ QP ä¹‹é—´å¹¶æ²¡æœ‰ç»‘å®šå…³ç³»ï¼Œè¿™å°±æ„å‘³ç€ä¸€æ—¦æŸä¸ªè¿œç«¯çš„ QP ä¸æœ¬ç«¯çš„ä¸€ä¸ª QP å»ºç«‹äº†è¿æ¥ï¼Œå…·å¤‡äº†é€šä¿¡çš„æ¡ä»¶ï¼Œé‚£ä¹ˆç†è®ºä¸Šè¿œç«¯èŠ‚ç‚¹åªè¦çŸ¥é“ VA å’Œ R_keyï¼ˆç”šè‡³å¯ä»¥é ä¸æ–­çš„çŒœæµ‹ç›´åˆ°å¾—åˆ°ä¸€å¯¹æœ‰æ•ˆçš„å€¼ï¼‰ï¼Œå°±å¯ä»¥è®¿é—®æœ¬ç«¯èŠ‚ç‚¹æŸä¸ª MR çš„å†…å®¹ã€‚&lt;/p>
&lt;p>å…¶å®ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒMR çš„è™šæ‹Ÿåœ°å€ VA å’Œç§˜é’¥ R_Key æ˜¯å¾ˆéš¾çŒœåˆ°çš„ï¼Œå·²ç»å¯ä»¥ä¿è¯ä¸€å®šçš„å®‰å…¨æ€§äº†ã€‚ä½†æ˜¯ä¸ºäº†æ›´å¥½çš„ä¿æŠ¤å†…å­˜ä¸­çš„æ•°æ®ï¼ŒæŠŠå„ç§èµ„æºçš„æƒé™åšè¿›ä¸€æ­¥çš„éš”ç¦»å’Œåˆ’åˆ†ï¼Œæˆ‘ä»¬åœ¨åˆåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸­å®šä¹‰äº† PDï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º&lt;/p>
&lt;figure>&lt;img src="https://cuterwrite-1302252842.file.myqcloud.com/img/7_2-2024-04-19.webp"
alt="7_2-2024-04-19" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>å›¾ 2ï¼šåŠ å…¥ PD æ¦‚å¿µæ—¶çš„ RDMA èµ„æº&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å›¾ä¸­ Node 0 ä¸Šæœ‰ä¸¤ä¸ª PDï¼Œå°† 3 ä¸ª QP å’Œ 2 ä¸ª MR åˆ†ä¸ºäº†ä¸¤ç»„ï¼Œæ­¤å¤– Node 1 å’Œ Node 2 ä¸­å„æœ‰ä¸€ä¸ª PD åŒ…å«äº†æ‰€æœ‰ QP å’Œ MRã€‚Node 0 ä¸Šçš„ä¸¤ä¸ª PD ä¸­çš„èµ„æºä¸å¯ä»¥ä¸€èµ·ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ QP3 å’Œ QP9 ä¸èƒ½è®¿é—® MR1 çš„æ•°æ®ï¼ŒQP6 ä¹Ÿä¸å¯ä»¥è®¿é—® MR0 çš„æ•°æ®ã€‚å¦‚æœæˆ‘ä»¬åœ¨æ•°æ®æ”¶å‘æ—¶ï¼ŒæŒ‡å®šç¡¬ä»¶ä½¿ç”¨ QP3 å’Œ MR1ï¼Œé‚£ä¹ˆç¡¬ä»¶æ ¡éªŒä»–ä»¬ä¸å±äºåŒä¸€ä¸ª PD åï¼Œä¼šè¿”å›é”™è¯¯ã€‚&lt;/p>
&lt;p>å¯¹äºè¿œç«¯èŠ‚ç‚¹æ¥è¯´ï¼ŒNode1 åªèƒ½é€šè¿‡ QP8 ç›¸è¿çš„ QP3 æ¥è®¿é—® Node0 çš„å†…å­˜ï¼Œä½†æ˜¯å› ä¸º Node 0 çš„ QP3 è¢«â€œåœˆâ€åˆ°äº† PD0 è¿™ä¸ªä¿æŠ¤åŸŸä¸­ï¼Œæ‰€ä»¥ Node 1 çš„ QP8 ä¹Ÿåªèƒ½è®¿é—® MR0 å¯¹åº”çš„å†…å­˜ï¼Œ&lt;strong>æ— è®ºå¦‚ä½•éƒ½æ— æ³•è®¿é—® MR1 ä¸­çš„æ•°æ®&lt;/strong>ï¼Œè¿™æ˜¯ä»ä¸¤ä¸ªæ–¹é¢é™åˆ¶çš„ï¼š&lt;/p>
&lt;ol>
&lt;li>Node 1 çš„ QP8 åªè·Ÿ Node 0 çš„ QP3 æœ‰è¿æ¥å…³ç³»ï¼Œæ— æ³•é€šè¿‡ Node 0 çš„ QP6 è¿›è¡Œå†…å­˜è®¿é—®ã€‚&lt;/li>
&lt;li>Node 0 çš„ MR1 å’Œ QP3 å±äºä¸åŒçš„ PDï¼Œå°±ç®— Node 1 çš„ QP8 æ‹¿åˆ°äº† MR1 çš„ VA å’Œ R_keyï¼Œç¡¬ä»¶ä¹Ÿä¼šå› ä¸º PD ä¸åŒè€Œæ‹’ç»æä¾›æœåŠ¡ã€‚&lt;/li>
&lt;/ol>
&lt;p>æ‰€ä»¥å°±å¦‚æœ¬æ–‡ä¸€å¼€å§‹æ‰€è¯´çš„ï¼ŒPD å°±åƒæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå°†ä¸€äº› RDMA èµ„æºä¿æŠ¤èµ·æ¥ï¼Œå½¼æ­¤éš”ç¦»ï¼Œä»¥æé«˜å®‰å…¨æ€§ã€‚å…¶å® RDMA ä¸­ä¸æ­¢æœ‰ QPã€MR è¿™äº›èµ„æºï¼Œåæ–‡å³å°†ä»‹ç»çš„ Address Handleï¼ŒMemory Window ç­‰ä¹Ÿæ˜¯ç”± PD è¿›è¡Œéš”ç¦»ä¿æŠ¤çš„ã€‚&lt;/p>
&lt;h2 id="å¦‚ä½•ä½¿ç”¨-pd">å¦‚ä½•ä½¿ç”¨ PD&lt;/h2>
&lt;p>è¿˜æ˜¯çœ‹ä¸Šé¢çš„å›¾ï¼Œæˆ‘ä»¬æ³¨æ„åˆ° Node 0 ä¸ºäº†éš”ç¦»èµ„æºï¼Œå­˜åœ¨ä¸¤ä¸ª PDï¼›è€Œ Node 1 å’Œ Node 2 åªæœ‰ä¸€ä¸ª PD åŒ…å«äº†æ‰€æœ‰èµ„æºã€‚&lt;/p>
&lt;p>æˆ‘ä¹‹æ‰€ä»¥è¿™æ ·ç”»ï¼Œæ˜¯ä¸ºäº†è¯´æ˜ä¸€ä¸ªèŠ‚ç‚¹ä¸Šåˆ’åˆ†å¤šå°‘ä¸ª PD å®Œå…¨æ˜¯ç”±ç”¨æˆ·å†³å®šçš„ï¼Œ&lt;strong>å¦‚æœæƒ³æé«˜å®‰å…¨æ€§ï¼Œé‚£ä¹ˆå¯¹æ¯ä¸ªè¿æ¥åˆ°è¿œç«¯èŠ‚ç‚¹çš„ QP å’Œä¾›è¿œç«¯è®¿é—®çš„ MR éƒ½åº”è¯¥å°½é‡é€šè¿‡åˆ’åˆ† PD åšåˆ°éš”ç¦»ï¼›å¦‚æœä¸è¿½æ±‚æ›´é«˜çš„å®‰å…¨æ€§ï¼Œé‚£ä¹ˆåˆ›å»ºä¸€ä¸ª PDï¼Œå›Šæ‹¬æ‰€æœ‰çš„èµ„æºä¹Ÿæ˜¯å¯ä»¥çš„&lt;/strong>ã€‚&lt;/p>
&lt;p>IB åè®®ä¸­è§„å®šï¼š&lt;strong>æ¯ä¸ªèŠ‚ç‚¹éƒ½è‡³å°‘è¦æœ‰ä¸€ä¸ª PDï¼Œæ¯ä¸ª QP éƒ½å¿…é¡»å±äºä¸€ä¸ª PDï¼Œæ¯ä¸ª MR ä¹Ÿå¿…é¡»å±äºä¸€ä¸ª PD&lt;/strong>ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆ PD çš„åŒ…å«å…³ç³»åœ¨è½¯ä»¶ä¸Šæ˜¯å¦‚ä½•ä½“ç°çš„å‘¢ï¼Ÿå®ƒæœ¬èº«æ˜¯æœ‰ä¸€ä¸ªè½¯ä»¶å®ä½“çš„ï¼ˆç»“æ„ä½“ï¼‰ï¼Œè®°å½•äº†è¿™ä¸ªä¿æŠ¤åŸŸçš„ä¸€äº›ä¿¡æ¯ã€‚ç”¨æˆ·åœ¨åˆ›å»º QP å’Œ MR ç­‰èµ„æºä¹‹å‰ï¼Œå¿…é¡»å…ˆé€šè¿‡ IB æ¡†æ¶çš„æ¥å£åˆ›å»ºä¸€ä¸ª PDï¼Œæ‹¿åˆ°å®ƒçš„æŒ‡é’ˆ/å¥æŸ„ã€‚æ¥ä¸‹æ¥åœ¨åˆ›å»º QP å’Œ MR çš„æ—¶å€™ï¼Œéœ€è¦ä¼ å…¥è¿™ä¸ª PD çš„æŒ‡é’ˆ/å¥æŸ„ï¼ŒPD ä¿¡æ¯å°±ä¼šåŒ…å«åœ¨ QP å’Œ MR ä¸­ã€‚ç¡¬ä»¶æ”¶å‘åŒ…æ—¶ï¼Œä¼šå¯¹ QP å’Œ MR çš„ PD è¿›è¡Œæ ¡éªŒã€‚æ›´å¤šçš„è½¯ä»¶åè®®æ ˆçš„å†…å®¹ï¼Œæˆ‘ä¼šåœ¨åé¢çš„æ–‡ç« ä¸­ä»‹ç»ã€‚&lt;/p>
&lt;p>å¦å¤–éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œ&lt;strong>PD æ˜¯æœ¬åœ°æ¦‚å¿µï¼Œä»…å­˜åœ¨äºèŠ‚ç‚¹å†…éƒ¨&lt;/strong>ï¼Œå¯¹å…¶ä»–èŠ‚ç‚¹æ˜¯ä¸å¯è§çš„ï¼›è€Œ MR æ˜¯å¯¹æœ¬ç«¯å’Œå¯¹ç«¯éƒ½å¯è§çš„ã€‚&lt;/p>
&lt;p>ä¸ºäº†æ–¹ä¾¿å¤§å®¶æŸ¥é˜…å’Œå­¦ä¹ ï¼Œä»¥åæˆ‘ä¼šåˆ—å‡ºæ–‡ç« æ¶‰åŠçš„åè®®ç« èŠ‚ï¼Œå‰é¢çš„å†…å®¹æœ‰æ—¶é—´çš„æ—¶å€™æˆ‘ä¹Ÿä¼šè¡¥å……ä¸€ä¸‹ã€‚&lt;/p>
&lt;h2 id="pd-ç›¸å…³åè®®ç« èŠ‚">PD ç›¸å…³åè®®ç« èŠ‚&lt;/h2>
&lt;ul>
&lt;li>3.5.5 PD çš„åŸºæœ¬æ¦‚å¿µå’Œä½œç”¨&lt;/li>
&lt;li>10.2.3 ä»‹ç»äº† PD å’Œå…¶ä»–ä¸€äº› RDMA èµ„æºçš„å…³ç³»ï¼Œä»¥åŠ PD ç›¸å…³çš„è½¯ä»¶æ¥å£ã€‚&lt;/li>
&lt;li>10.6.3.5 å†æ¬¡å¼ºè°ƒ PD å’Œ MR åŠ QP çš„å…³ç³»ã€‚&lt;/li>
&lt;li>11.2.1.5 è¯¦ç»†ä»‹ç» PD çš„ Verbs æ¥å£ï¼ŒåŒ…æ‹¬ä½œç”¨ã€å…¥å‚ã€å‡ºå‚å’Œè¿”å›å€¼ç­‰ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¥½äº†ï¼Œå…³äº PD çš„ä»‹ç»å°±åˆ°è¿™é‡Œã€‚ä¸‹æ–‡æˆ‘ä¼šä»‹ç»ç”¨äº UD æœåŠ¡ç±»å‹çš„ Address Handle çš„æ¦‚å¿µã€‚&lt;/p></description></item></channel></rss>