<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Cuterwrite's Blog</title><link>https://cuterwrite.top/</link><description>Recent content on Cuterwrite's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><copyright>cuterwrite</copyright><lastBuildDate>Fri, 27 Sep 2024 00:00:00 +0000</lastBuildDate><atom:link href="https://cuterwrite.top/index.xml" rel="self" type="application/rss+xml"/><item><title>å…³äº | About</title><link>https://cuterwrite.top/about/</link><pubDate>Fri, 27 Sep 2024 00:00:00 +0000</pubDate><guid>https://cuterwrite.top/about/</guid><description>&lt;img src="https://cloud.cuterwrite.fun/blog/GA11qGVXwAASzAL-2023-12-25.webp" alt="Featured image of post å…³äº | About" />
&lt;link rel="stylesheet" href="https://libs.jshub.com/aplayer/1.10.1/APlayer.min.css">
&lt;script src="https://libs.jshub.com/aplayer/1.10.1/APlayer.min.js" defer>&lt;/script>
&lt;script src="https://libs.jshub.com/meting/2.0.1/Meting.min.js" defer>&lt;/script>
&lt;meting-js
server="netease"
type="song"
id="30064088"
autoplay="true" loop="true">
&lt;/meting-js>
&lt;h1 id="cuterwrite-çš„æŠ€æœ¯åšå®¢">
&lt;a href="#cuterwrite-%e7%9a%84%e6%8a%80%e6%9c%af%e5%8d%9a%e5%ae%a2" class="header-anchor">#&lt;/a>
Cuterwrite çš„æŠ€æœ¯åšå®¢
&lt;/h1>
&lt;p>ğŸ‘€æ¬¢è¿æ¥åˆ° Cuterwrite çš„æŠ€æœ¯åšå®¢ï¼&lt;/p>
&lt;h2 id="-å…³äºæˆ‘">
&lt;a href="#-%e5%85%b3%e4%ba%8e%e6%88%91" class="header-anchor">#&lt;/a>
âœ‹ å…³äºæˆ‘
&lt;/h2>
&lt;p>æˆ‘æ˜¯ Cuterwriteï¼Œä¸€ååœ¨è¯»åšå£«ç”Ÿï¼Œåšå®¢ä¸“æ³¨äºä»¥ä¸‹é¢†åŸŸï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>é«˜æ€§èƒ½è®¡ç®—&lt;/strong>ï¼šè¿™æ˜¯æˆ‘çš„ä¸»ä¸šï¼Œä¸»è¦ç ”ç©¶å¹¶è¡Œè®¡ç®—ã€åˆ†å¸ƒå¼ç³»ç»Ÿå’Œé«˜æ€§èƒ½è®¡ç®—æ¶æ„ã€‚æˆ‘è‡´åŠ›äºåœ¨å¤§è§„æ¨¡é›†ç¾¤ï¼ˆè¶…ç®—ï¼‰ä¸Šè¿›è¡Œåº”ç”¨ä¼˜åŒ–ï¼Œä»¥æå‡ç³»ç»Ÿçš„è®¡ç®—æ•ˆç‡å’Œæ€§èƒ½ã€‚&lt;/li>
&lt;li>&lt;strong>æ“ä½œç³»ç»Ÿ&lt;/strong>ï¼šä¸»è¦æ˜¯ Linux ç³»ç»Ÿçš„å†…æ ¸æœºåˆ¶å’Œæ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼Œä¸€äº›åº•å±‚ç»†èŠ‚å¯¹äºæˆ‘æ¥è¯´æ˜¯æŒºæœ‰å¸®åŠ©çš„ã€‚&lt;/li>
&lt;li>&lt;strong>å…¨æ ˆå¼€å‘&lt;/strong>ï¼šå¯¹å‰ç«¯å’Œåç«¯çš„æŠ€æœ¯éƒ½æœ‰æ¶‰çŒï¼Œä¸»è¦æ˜¯ä¸ºäº†è‡ªå·±çš„åšå®¢å’Œä¸€äº› Toy é¡¹ç›®ï¼Œä¹Ÿä¼šå°è¯•ä¸€äº›æ–°æŠ€æœ¯ï¼Œåƒæ˜¯å‰ç«¯çš„ Vueã€Reactï¼Œåç«¯çš„ Golangã€Javaã€Rust ç­‰ã€‚&lt;/li>
&lt;li>&lt;strong>äººå·¥æ™ºèƒ½&lt;/strong>ï¼šè™½ç„¶è¿™ä¸æ˜¯æˆ‘çš„ä¸“ä¸šç ”ç©¶æ–¹å‘ï¼Œä»¥å‰åªæ˜¯æ¥è§¦å’Œä¸Šæ‰‹è¿‡ï¼Œä½†éšç€è¿‘å¹´æ¥å¤§æ¨¡å‹çš„å¿«é€Ÿå‘å±•ï¼Œæˆ‘ä¹Ÿå¯¹äººå·¥æ™ºèƒ½é¢†åŸŸäº§ç”Ÿäº†æµ“åšå…´è¶£ã€‚æˆ‘æ­£åœ¨äº†è§£å¦‚æ·±åº¦å­¦ä¹ ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰ AI æŠ€æœ¯ï¼Œå¹¶åŸºäºå¼€æºä»£ç å’Œæ¨¡å‹è¿›è¡Œä¸€äº›æ¢ç´¢å®è·µã€‚&lt;/li>
&lt;/ul>
&lt;p>æˆ‘ä¸ªäººç›®å‰å¸Œæœ›æŠŠ idea è½å®ä¸‹æ¥å¹¶å‘å‡ºè®ºæ–‡ï¼Œå°½å¿«å®Œæˆè‡ªå·±çš„åšå£«å­¦ä¸šã€‚æœªæ¥æ‰“ç®—æ‰¾å®¶åœ¨å¤§æ¹¾åŒºçš„å…¬å¸ï¼Œæœ€å¥½æ˜¯é«˜æ€§èƒ½è®¡ç®—é¢†åŸŸç›¸å…³çš„ï¼Œå…ˆæé’±å…»æ´»è‡ªå·±ï¼Œç„¶åå†å»åšä¸€äº›è‡ªå·±æƒ³åšçš„äº‹æƒ…ã€‚è‡³äºåšå®¢æˆ‘ä¼šåœ¨ä¸šä½™æ—¶é—´ä¸å®šæœŸä¿æŒæ›´æ–°çš„ã€‚&lt;/p>
&lt;p>å¸Œæœ›é€šè¿‡ä¸æ–­åœ°å­¦ä¹ ï¼Œæå‡è‡ªå·±çš„æŠ€æœ¯æ°´å¹³ã€‚å¦‚æœä½ å¯¹æˆ‘çš„åšå®¢æ„Ÿå…´è¶£ï¼Œæ¬¢è¿å…³æ³¨æˆ‘çš„åŠ¨æ€ï¼Œä¹Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘ä¼šå°½å¿«å›å¤çš„ã€‚&lt;/p>
&lt;h2 id="-å…³äºç½‘ç«™">
&lt;a href="#-%e5%85%b3%e4%ba%8e%e7%bd%91%e7%ab%99" class="header-anchor">#&lt;/a>
âŒ›ï¸ å…³äºç½‘ç«™
&lt;/h2>
&lt;p>&lt;strong>Cuterwrite&amp;rsquo;s Blog&lt;/strong> æ­å»ºäº 2021 å¹´ï¼Œåˆšå¼€å§‹åªæ˜¯æœ¬ç§‘æœŸé—´çš„ä¸€äº›æŠ€æœ¯ç¬”è®°å’Œå­¦ä¹ å¿ƒå¾—ï¼Œåæ¥é€æ¸å‘å±•æˆäº†ä¸€ä¸ªæŠ€æœ¯åšå®¢ã€‚ç½‘ç«™é‡‡ç”¨ Hugoï¼Œæ‰˜ç®¡äº Github Pagesï¼Œå¹¶ç»‘å®šåŸŸå cuterwrite.topã€‚&lt;/p>
&lt;ul>
&lt;li>è¯„è®ºç³»ç»Ÿï¼šä½¿ç”¨çš„æ˜¯ &lt;a class="link" href="https://twikoo.js.org/" target="_blank" rel="noopener" >Twikoo
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼Œæ•°æ®æ‰˜ç®¡åœ¨å…è´¹çš„ MongoDB Atlas ä¸Šã€‚&lt;/li>
&lt;li>ç½‘ç«™ç»Ÿè®¡åˆ†æï¼šä½¿ç”¨çš„æ˜¯ &lt;a class="link" href="https://umami.is/" target="_blank" rel="noopener" >Umami
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼Œæ•°æ®æ‰˜ç®¡åœ¨å…è´¹çš„ &lt;a class="link" href="https://neon.dev/" target="_blank" rel="noopener" >Neon
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„ PostgreSQL æœåŠ¡ä¸Šã€‚&lt;/li>
&lt;li>æœç´¢åŠŸèƒ½ï¼šä½¿ç”¨çš„æ˜¯è‡ªå»ºçš„ &lt;a class="link" href="https://www.meilisearch.com/" target="_blank" rel="noopener" >MeiliSearch
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æœåŠ¡ã€‚&lt;/li>
&lt;li>è‡³äºå·¦è¾¹çš„ç”»æ¿å’Œç”»å†Œï¼šåˆ†åˆ«åŸºäºå¼€æºé¡¹ç›® &lt;a class="link" href="https://github.com/nicokaiser/hugo-theme-gallery" target="_blank" rel="noopener" >hugo-theme-gallery
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
å’Œ &lt;a class="link" href="https://github.com/korbinzhao/excalidraw-cn" target="_blank" rel="noopener" >excalidraw-cn
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æ­å»ºçš„ã€‚&lt;/li>
&lt;li>ç½‘ç«™ CDNï¼šä½¿ç”¨çš„æ˜¯ &lt;a class="link" href="https://lucdn.cn/" target="_blank" rel="noopener" >è¯­é¹¿äº‘ç›¾
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼Œç¨³å®šæ€§å’Œé€Ÿåº¦éƒ½å¾ˆä¸é”™ï¼ŒåŸºç¡€å¥—é¤å¯¹äºæˆ‘çš„ç«™ç‚¹æ¥è¯´å°±å·²ç»è¶³å¤Ÿäº†ã€‚è¦çŸ¥é“æ²¡åŠ  CDN ä¹‹å‰ï¼ŒGithub Pages åœ¨å›½å†…çš„è®¿é—®é€Ÿåº¦æ˜¯çœŸçš„æ…¢ï¼Œæœ‰æ—¶å€™è¿˜ä¼šè¢«å¢™ï¼Œæ‰“ä¸å¼€ç½‘ç«™ï¼ŒåŠ äº† CDN ä¹‹åé€Ÿåº¦æ˜æ˜¾æå‡äº†ä¸å°‘ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Cuterwrite&lt;/strong> çš„å‘½åæ²¡æœ‰ç‰¹åˆ«çš„å«ä¹‰ï¼Œåªæ˜¯åšä¸»å½“åˆç©æ¸¸æˆçš„æ—¶å€™å®åœ¨ä¸çŸ¥é“å–ä»€ä¹ˆ ID å¥½ï¼Œå°±åœ¨æŸä¸ª ID ç”Ÿæˆç½‘ç«™ä¸Šéšæœºç”Ÿæˆäº†ä¸€å¤§å †ç„¶åæŒ‘äº†è¿™ä¸ªï¼Œä¹ŸæŒºå¥½è®°çš„ï¼Œæ‰€ä»¥åé¢å°±ä¸€ç›´æ²¿ç”¨è‡³ä»Šã€‚&lt;/p>
&lt;p>&lt;strong>Cuterwrite&amp;rsquo;s Blog&lt;/strong> ä¹Ÿä¸€ç›´åœ¨åŠªåŠ›æå‡ç”¨æˆ·ä½“éªŒã€‚å› æ­¤ï¼Œæˆ‘æ—¶ä¸æ—¶å°±å¯¹ç‰ˆé¢è¿›è¡Œä¼˜åŒ–ï¼Œæ·»åŠ æ–°åŠŸèƒ½ï¼ŒåŠ›æ±‚è®©æ¯ä¸€ä½è®¿é—®è€…éƒ½èƒ½æœ‰è‰¯å¥½çš„é˜…è¯»ä½“éªŒã€‚&lt;/p>
&lt;h2 id="-å…³äºå°é¢">
&lt;a href="#-%e5%85%b3%e4%ba%8e%e5%b0%81%e9%9d%a2" class="header-anchor">#&lt;/a>
ğŸ¨ å…³äºå°é¢
&lt;/h2>
&lt;p>æˆ‘æœ€å–œæ¬¢çš„ä¹é˜Ÿï¼š&lt;a class="link" href="https://www.oneokrock.com/" target="_blank" rel="noopener" >One OK Rock
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼Œä¸€ä¸ªæ¥è‡ªæ—¥æœ¬çš„æ‘‡æ»šä¹é˜Ÿï¼Œè¿™å¼ å°é¢æ˜¯ 2023 å¹´ 12 æœˆ 8 æ—¥åœ¨é¦™æ¸¯äºšæ´²åšè§ˆé¦†ä¸¾åŠçš„æ¼”å”±ä¼šçš„ç°åœºç…§ç‰‡ï¼Œæˆ‘ä¹Ÿæ˜¯åœ¨é‚£å¤©ç¬¬ä¸€æ¬¡å»åˆ°ä»–ä»¬çš„ç°åœºï¼Œæ„Ÿè§‰éå¸¸éœ‡æ’¼ï¼Œæ‰€ä»¥å°±ç”¨è¿™å¼ ç…§ç‰‡ä½œä¸ºäº†ä¸ªäººé¡µçš„å°é¢ã€‚&lt;/p>
&lt;h2 id="-å¦‚ä½•è”ç³»">
&lt;a href="#-%e5%a6%82%e4%bd%95%e8%81%94%e7%b3%bb" class="header-anchor">#&lt;/a>
ğŸŒ å¦‚ä½•è”ç³»
&lt;/h2>
&lt;ul>
&lt;li>&lt;a class="link" href="https://github.com/PKUcoldkeyboard" target="_blank" rel="noopener" >Github
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼šå…³æ³¨æˆ‘çš„é¡¹ç›®å’ŒåŠ¨æ€ã€‚ï¼ˆç›®å‰è¿˜æ²¡ä»€ä¹ˆæ–°é¡¹ç›®ï¼‰&lt;/li>
&lt;li>&lt;a class="link" href="https://www.zhihu.com/people/kong-tiao-cheng-tai-lang-30-57" target="_blank" rel="noopener" >çŸ¥ä¹ä¸»é¡µ
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼šæˆ‘ä¸€èˆ¬å½“æ£€ç´¢å¼•æ“å’Œæ”¶è—å¤¹ç”¨ï¼Œä¸æ€ä¹ˆå›ç­”é—®é¢˜ï¼Œç§ä¿¡ä¹Ÿä¸æ€ä¹ˆçœ‹ï¼Œå½“ç„¶ç°åœ¨æµé‡å¤šäº†å¯èƒ½ä¼šçœ‹ä¸€ä¸‹ã€‚&lt;/li>
&lt;li>&lt;a class="link" href="https://telegram.me/cuterwrite" target="_blank" rel="noopener" >Telegram
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼šå¶å°”ä¼šä¸Šçº¿çœ‹çœ‹ã€‚&lt;/li>
&lt;li>&lt;a class="link" href="https://linux.do" target="_blank" rel="noopener" >Linux Do
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼š&lt;del>æŸå¤§å‹é»‘äº§è®ºå›&lt;/del>ï¼Œå¯ä»¥åœ¨è¯¥è®ºå›ç§ä¿¡æˆ‘ï¼Œç”¨æˆ·åä¸º cuterwriteã€‚ï¼ˆè®ºå›é‚€è¯·åˆ¶ï¼Œæœ‰éœ€æ±‚å¯è”ç³»æˆ‘è·å–é‚€è¯·æƒé™ã€‚ï¼‰&lt;/li>
&lt;/ul></description></item><item><title>å®ç°æœ¬åœ° RAG æœåŠ¡ï¼šæ•´åˆ Open WebUIã€Ollama å’Œ Qwen2.5</title><link>https://cuterwrite.top/p/integrate-open-webui-ollama-qwen25-local-rag/</link><pubDate>Fri, 20 Sep 2024 22:44:00 +0000</pubDate><guid>https://cuterwrite.top/p/integrate-open-webui-ollama-qwen25-local-rag/</guid><description>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-29_116903285_p0_master1200.webp" alt="Featured image of post å®ç°æœ¬åœ° RAG æœåŠ¡ï¼šæ•´åˆ Open WebUIã€Ollama å’Œ Qwen2.5" />&lt;h1 id="å®ç°æœ¬åœ°-rag-æœåŠ¡æ•´åˆ-open-webuiollama-å’Œ-qwen25">
&lt;a href="#%e5%ae%9e%e7%8e%b0%e6%9c%ac%e5%9c%b0-rag-%e6%9c%8d%e5%8a%a1%e6%95%b4%e5%90%88-open-webuiollama-%e5%92%8c-qwen25" class="header-anchor">#&lt;/a>
å®ç°æœ¬åœ° RAG æœåŠ¡ï¼šæ•´åˆ Open WebUIã€Ollama å’Œ Qwen2.5
&lt;/h1>
&lt;h2 id="å¼•è¨€">
&lt;a href="#%e5%bc%95%e8%a8%80" class="header-anchor">#&lt;/a>
å¼•è¨€
&lt;/h2>
&lt;p>åœ¨æ„å»ºä¿¡æ¯æ£€ç´¢å’Œç”Ÿæˆå¼ AI åº”ç”¨æ—¶ï¼ŒRetrieval-Augmented Generation (RAG) æ¨¡å‹å‡­å€Ÿå…¶èƒ½å¤Ÿä»çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯å¹¶ç”Ÿæˆå‡†ç¡®ç­”æ¡ˆçš„å¼ºå¤§èƒ½åŠ›ï¼Œå—åˆ°è¶Šæ¥è¶Šå¤šå¼€å‘è€…çš„é’çã€‚ç„¶è€Œï¼Œå®ç°ç«¯åˆ°ç«¯çš„æœ¬åœ° RAG æœåŠ¡ï¼Œéœ€æ±‚çš„ä¸åªæ˜¯åˆé€‚çš„æ¨¡å‹ï¼Œè¿˜éœ€è¦é›†æˆå¼ºå¤§çš„ç”¨æˆ·ç•Œé¢å’Œé«˜æ•ˆçš„æ¨ç†æ¡†æ¶ã€‚&lt;/p>
&lt;p>åœ¨æ„å»ºæœ¬åœ° RAG æœåŠ¡æ—¶ï¼Œåˆ©ç”¨æ˜“äºéƒ¨ç½²çš„ Docker æ–¹å¼ï¼Œå¯ä»¥æå¤§ç®€åŒ–æ¨¡å‹ç®¡ç†å’ŒæœåŠ¡é›†æˆã€‚è¿™é‡Œæˆ‘ä»¬ä¾èµ– Open WebUI æä¾›çš„ç”¨æˆ·ç•Œé¢ä¸æ¨¡å‹æ¨ç†æœåŠ¡ï¼Œå†é€šè¿‡ Ollama æ¥å¼•å…¥ &lt;code>bge-m3&lt;/code> embedding æ¨¡å‹ä»¥å®ç°æ–‡æ¡£å‘é‡åŒ–æ–¹å¼çš„æ£€ç´¢åŠŸèƒ½ï¼Œä»è€Œå¸®åŠ© Qwen2.5 å®Œæˆæ›´ç²¾å‡†çš„ç­”æ¡ˆç”Ÿæˆã€‚&lt;/p>
&lt;p>æœ¬æ–‡æˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•é€šè¿‡ Docker å¿«é€Ÿå¯åŠ¨ Open WebUIï¼ŒåŒæ­¥ Ollama çš„ RAG èƒ½åŠ›ï¼Œå¹¶ç»“åˆ Qwen2.5 æ¨¡å‹å®ç°é«˜æ•ˆçš„æ–‡æ¡£æ£€ç´¢ä¸ç”Ÿæˆç³»ç»Ÿã€‚&lt;/p>
&lt;h2 id="é¡¹ç›®æ¦‚è§ˆ">
&lt;a href="#%e9%a1%b9%e7%9b%ae%e6%a6%82%e8%a7%88" class="header-anchor">#&lt;/a>
é¡¹ç›®æ¦‚è§ˆ
&lt;/h2>
&lt;p>è¯¥é¡¹ç›®å°†ä½¿ç”¨ä»¥ä¸‹å…³é”®å·¥å…·ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;strong>Open WebUI&lt;/strong> : æä¾›ç”¨æˆ·ä¸æ¨¡å‹äº¤äº’çš„ web ç•Œé¢ã€‚&lt;/li>
&lt;li>&lt;strong>Ollama&lt;/strong> : ç”¨äºç®¡ç† embedding å’Œå¤§è¯­è¨€æ¨¡å‹çš„æ¨¡å‹æ¨ç†ä»»åŠ¡ã€‚å…¶ä¸­ Ollama ä¸­çš„ &lt;code>bge-m3&lt;/code> æ¨¡å‹å°†ç”¨äºæ–‡æ¡£æ£€ç´¢ï¼ŒQwen2.5 å°†è´Ÿè´£å›ç­”ç”Ÿæˆã€‚&lt;/li>
&lt;li>&lt;strong>Qwen2.5&lt;/strong> : æ¨¡å‹éƒ¨åˆ†ä½¿ç”¨é˜¿é‡Œæ¨å‡ºçš„ Qwen 2.5 ç³»åˆ—ï¼Œä¸ºæ£€ç´¢å¢å¼ºç”ŸæˆæœåŠ¡æä¾›è‡ªç„¶è¯­è¨€ç”Ÿæˆã€‚&lt;/li>
&lt;/ol>
&lt;p>ä¸ºäº†å®ç° RAG æœåŠ¡ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p>
&lt;ol>
&lt;li>éƒ¨ç½² Open WebUI ä½œä¸ºç”¨æˆ·äº¤äº’ç•Œé¢ã€‚&lt;/li>
&lt;li>é…ç½® Ollama ä»¥é«˜æ•ˆè°ƒåº¦ Qwen2.5 ç³»åˆ—æ¨¡å‹ã€‚&lt;/li>
&lt;li>ä½¿ç”¨ Ollama é…ç½®çš„åä¸º &lt;code>bge-m3&lt;/code> çš„ embedding æ¨¡å‹å®ç°æ£€ç´¢å‘é‡åŒ–å¤„ç†ã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="éƒ¨ç½²-open-webui">
&lt;a href="#%e9%83%a8%e7%bd%b2-open-webui" class="header-anchor">#&lt;/a>
éƒ¨ç½² Open WebUI
&lt;/h2>
&lt;p>Open WebUI æä¾›äº†ä¸€ä¸ªç®€æ´çš„ Docker åŒ–è§£å†³æ–¹æ¡ˆï¼Œç”¨æˆ·æ— éœ€æ‰‹åŠ¨é…ç½®å¤§é‡ä¾èµ–ï¼Œç›´æ¥é€šè¿‡ Docker å¯åŠ¨ Web ç•Œé¢ã€‚&lt;/p>
&lt;p>é¦–å…ˆï¼ŒæœåŠ¡å™¨ä¸Šéœ€è¦ç¡®ä¿å·²ç»å®‰è£…äº† &lt;a class="link" href="https://docs.docker.com/get-docker/" target="_blank" rel="noopener" >Docker
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå¿«é€Ÿå®‰è£…ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash">curl https://get.docker.com | sh
&lt;/code>&lt;/pre>
&lt;p>ç„¶ååˆ›å»ºä¸€ä¸ªç›®å½•ç”¨äºä¿å­˜ Open WebUI çš„æ•°æ®ï¼Œè¿™æ ·æ•°æ®ä¸ä¼šåœ¨é¡¹ç›®æ›´æ–°åä¸¢å¤±ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash">sudo mkdir -p /DATA/open-webui
&lt;/code>&lt;/pre>
&lt;p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ Open WebUI ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash">docker run -d -p 3000:8080 \
--add-host=host.docker.internal:host-gateway \
-v /DATA/open-webui:/app/backend/data \
--name open-webui \
--restart always \
ghcr.io/open-webui/open-webui:main
&lt;/code>&lt;/pre>
&lt;p>å¦‚æœæƒ³è¦è¿è¡Œæ”¯æŒ Nvidia GPU çš„ Open WebUI ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash">docker run -d -p 3000:8080 \
--gpus all \
--add-host=host.docker.internal:host-gateway \
-v /DATA/open-webui:/app/backend/data \
--name open-webui \
--restart always \
ghcr.io/open-webui/open-webui:cuda
&lt;/code>&lt;/pre>
&lt;p>è¿™é‡Œæˆ‘ä»¬å°† Open WebUI çš„æœåŠ¡æš´éœ²åœ¨æœºå™¨çš„ 3000 ç«¯å£ï¼Œå¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—® &lt;code>http://localhost:3000&lt;/code> å³å¯ä½¿ç”¨ï¼ˆè¿œç¨‹è®¿é—®åˆ™ä½¿ç”¨å…¬ç½‘ ip ï¼Œå¼€æ”¾ 3000 ç«¯å£ï¼‰ã€‚/DATA/open-webui æ˜¯æ•°æ®å­˜å‚¨ç›®å½•ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´è¿™ä¸ªè·¯å¾„ã€‚&lt;/p>
&lt;p>å½“ç„¶é™¤äº† Docker å®‰è£…æ–¹å¼å¤–ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ pip ã€æºç ç¼–è¯‘ã€Podman ç­‰æ–¹å¼å®‰è£… Open WebUI ã€‚æ›´å¤šå®‰è£…æ–¹å¼è¯·å‚è€ƒ &lt;a class="link" href="https://docs.openwebui.com/getting-started" target="_blank" rel="noopener" >Open WebUI å®˜æ–¹æ–‡æ¡£
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/p>
&lt;h3 id="åŸºç¡€è®¾ç½®">
&lt;a href="#%e5%9f%ba%e7%a1%80%e8%ae%be%e7%bd%ae" class="header-anchor">#&lt;/a>
åŸºç¡€è®¾ç½®
&lt;/h3>
&lt;ol>
&lt;li>è¾“å…¥è¦æ³¨å†Œçš„è´¦å·ä¿¡æ¯ï¼Œ&lt;strong>è®¾ç½®å¼ºå¯†ç ï¼ï¼ï¼&lt;/strong>&lt;/li>
&lt;/ol>
&lt;blockquote class="alert-blockquote alert-important">
&lt;p class="alert-heading">
&lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
&lt;path d="M0 1.75C0 .784.784 0 1.75 0h12.5C15.216 0 16 .784 16 1.75v9.5A1.75 1.75 0 0 1 14.25 13H8.06l-2.573 2.573A1.458 1.458 0 0 1 3 14.543V13H1.75A1.75 1.75 0 0 1 0 11.25Zm1.75-.25a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h2a.75.75 0 0 1 .75.75v2.19l2.72-2.72a.749.749 0 0 1 .53-.22h6.5a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25Zm7 2.25v2.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 1 1.5 0ZM9 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z">&lt;/path>
&lt;/svg>
&lt;span>é‡è¦&lt;/span>
&lt;/p>
&lt;p>ç¬¬ä¸€ä¸ªæ³¨å†Œçš„ç”¨æˆ·å°†è¢«è‡ªåŠ¨è®¾ç½®ä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼Œæ‰€ä»¥è¯·ç¡®ä¿ä½ æ˜¯ç¬¬ä¸€ä¸ªæ³¨å†Œçš„ç”¨æˆ·ã€‚&lt;/p>
&lt;/blockquote>
&lt;ol start="2">
&lt;li>ç‚¹å‡»å·¦ä¸‹è§’å¤´åƒï¼Œé€‰æ‹©ç®¡ç†å‘˜é¢æ¿&lt;/li>
&lt;li>ç‚¹å‡»é¢æ¿ä¸­çš„è®¾ç½®&lt;/li>
&lt;li>å…³é—­å…è®¸æ–°ç”¨æˆ·æ³¨å†Œï¼ˆå¯é€‰ï¼‰&lt;/li>
&lt;li>ç‚¹å‡»å³ä¸‹è§’ä¿å­˜&lt;/li>
&lt;/ol>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-09-21_openwebui_admin.webp"
alt="Open WebUI" width="85%" loading="lazy">
&lt;/figure>
&lt;h2 id="é…ç½®-ollama-å’Œ-qwen25">
&lt;a href="#%e9%85%8d%e7%bd%ae-ollama-%e5%92%8c-qwen25" class="header-anchor">#&lt;/a>
é…ç½® Ollama å’Œ Qwen2.5
&lt;/h2>
&lt;h3 id="éƒ¨ç½²-ollama">
&lt;a href="#%e9%83%a8%e7%bd%b2-ollama" class="header-anchor">#&lt;/a>
éƒ¨ç½² Ollama
&lt;/h3>
&lt;p>åœ¨æœ¬åœ°æœåŠ¡å™¨ä¸Šå®‰è£… Ollamaã€‚ç›®å‰ Ollama æä¾›å¤šç§å®‰è£…æ–¹å¼ï¼Œè¯·å‚è€ƒ Ollama çš„&lt;a class="link" href="https://ollama.com/" target="_blank" rel="noopener" >å®˜æ–¹æ–‡æ¡£
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ä¸‹è½½å®‰è£…æœ€æ–°çš„ &lt;code>0.3.11&lt;/code> ç‰ˆæœ¬ï¼ˆQwen2.5 åœ¨è¯¥ç‰ˆæœ¬æ‰å¼€å§‹æ”¯æŒï¼‰ã€‚å®‰è£…ç»†èŠ‚å¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å†™çš„ä¸€ç¯‡æ–‡ç« ï¼š&lt;a class="link" href="https://cuterwrite.top/p/ollama/" >Ollamaï¼šä»å…¥é—¨åˆ°è¿›é˜¶
&lt;/a>
ã€‚&lt;/p>
&lt;p>å¯åŠ¨ Ollama æœåŠ¡ï¼ˆå¦‚æœæ˜¯ Docker æ–¹å¼å¯åŠ¨åˆ™ä¸éœ€è¦ï¼Œä½†å¿…é¡»æš´éœ² 11434 ç«¯å£ï¼‰ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash">ollama serve
&lt;/code>&lt;/pre>
&lt;p>Ollama æœåŠ¡å¯åŠ¨åï¼Œå¯ä»¥é€šè¿‡è®¿é—®åœ°å€ &lt;code>http://localhost:11434&lt;/code> è¿æ¥åˆ° Ollama æœåŠ¡ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://ollama.com/library" target="_blank" rel="noopener" >Ollama Library
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æä¾›äº†è¯­ä¹‰å‘é‡æ¨¡å‹ ( &lt;code>bge-m3&lt;/code> ) ä»¥åŠå„å¤§æ–‡æœ¬ç”Ÿæˆæ¨¡å‹ï¼ˆåŒ…æ‹¬ Qwen2.5ï¼‰ã€‚ä¸‹ä¸€æ­¥æˆ‘ä»¬å°†é…ç½® Ollama ä»¥é€‚åº”æœ¬é¡¹ç›®å¯¹æ–‡æ¡£æ£€ç´¢å’Œé—®ç­”ç”Ÿæˆçš„éœ€æ±‚ã€‚&lt;/p>
&lt;h3 id="ä¸‹è½½-qwen25-æ¨¡å‹">
&lt;a href="#%e4%b8%8b%e8%bd%bd-qwen25-%e6%a8%a1%e5%9e%8b" class="header-anchor">#&lt;/a>
ä¸‹è½½ Qwen2.5 æ¨¡å‹
&lt;/h3>
&lt;p>é€šè¿‡ Ollama å®‰è£… Qwen2.5ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ &lt;code>ollama pull&lt;/code> å‘½ä»¤æ¥ä¸‹è½½ Qwen2.5 æ¨¡å‹ï¼Œæ¯”å¦‚è¦ä¸‹è½½ Qwen2.5 çš„ 72B æ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash">ollama pull qwen2.5:72b
&lt;/code>&lt;/pre>
&lt;p>è¯¥å‘½ä»¤å°†ä» Ollama çš„æ¨¡å‹ä»“åº“æŠ“å– Qwen2.5 æ¨¡å‹ï¼Œå¹¶å‡†å¤‡è¿è¡Œç¯å¢ƒã€‚&lt;/p>
&lt;p>Qwen2.5 æä¾›äº†å¤šç§æ¨¡å‹å°ºå¯¸ï¼ŒåŒ…æ‹¬ 72Bã€32Bã€14Bã€7Bã€3Bã€1.5Bã€0.5B ç­‰ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å’Œ GPU æ˜¾å­˜å¤§å°é€‰æ‹©åˆé€‚çš„æ¨¡å‹ã€‚æˆ‘é‡‡ç”¨çš„æ˜¯ 4x V100 çš„æœåŠ¡å™¨ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é€‰æ‹© 72B æ¨¡å‹ã€‚å¦‚æœè¦æ±‚åå­—é€Ÿåº¦å¿«ä¸”èƒ½æ¥æ”¶å¾®å°çš„æ€§èƒ½æŸå¤±çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>q4_0&lt;/code> é‡åŒ–ç‰ˆæœ¬ &lt;code>qwen2.5:72b-instruct-q4_0&lt;/code> ï¼›å¦‚æœèƒ½æ¥å—åå­—é€Ÿåº¦æ…¢ä¸€äº›ï¼Œå¯ä»¥ä½¿ç”¨ &lt;code>qwen2.5:72b-instruct-q5_K_M&lt;/code> ã€‚å¯¹äº 4x V100 çš„æœåŠ¡å™¨ï¼Œè™½ç„¶ &lt;code>q5_K_M&lt;/code> æ¨¡å‹çš„ token ç”Ÿæˆæ˜æ˜¾å¡é¡¿ï¼Œä½†æ˜¯ä¸ºäº†è¯•éªŒä¸€ä¸‹ Qwen2.5 çš„æ€§èƒ½ï¼Œæˆ‘è¿˜æ˜¯é€‰æ‹©äº† &lt;code>q5_K_M&lt;/code> æ¨¡å‹ã€‚&lt;/p>
&lt;p>å¯¹äºæ˜¾å­˜è¾ƒå°‘çš„ä¸ªäººç”µè„‘ï¼Œæ¨èä½¿ç”¨ 14B æˆ– 7B æ¨¡å‹ï¼Œé€šè¿‡ä»¥ä¸‹å‘½ä»¤ä¸‹è½½ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash">ollama pull qwen2.5:14b
&lt;/code>&lt;/pre>
&lt;p>æˆ–è€…&lt;/p>
&lt;pre>&lt;code class="language-bash">ollama pull qwen2.5:7b
&lt;/code>&lt;/pre>
&lt;p>å¦‚æœä½ åŒæ—¶å¯åŠ¨å¥½äº† Open WebUI å’Œ Ollama æœåŠ¡ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥åœ¨ç®¡ç†å‘˜é¢æ¿ä¸­ä¸‹è½½æ¨¡å‹ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-09-21_download_qwen2-5-7b.webp"
alt="Download Ollama Model in Open WebUI" width="85%" loading="lazy">
&lt;/figure>
&lt;h3 id="ä¸‹è½½-bge-m3-æ¨¡å‹">
&lt;a href="#%e4%b8%8b%e8%bd%bd-bge-m3-%e6%a8%a1%e5%9e%8b" class="header-anchor">#&lt;/a>
ä¸‹è½½ bge-m3 æ¨¡å‹
&lt;/h3>
&lt;p>åœ¨ Ollama ä¸­ä¸‹è½½ &lt;code>bge-m3&lt;/code> æ¨¡å‹ï¼Œè¯¥æ¨¡å‹ç”¨äºæ–‡æ¡£å‘é‡åŒ–å¤„ç†ã€‚åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ä¸‹è½½æ¨¡å‹ï¼ˆæˆ–è€…åœ¨ Open WebUI ç•Œé¢ä¸‹è½½ï¼‰ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash">ollama pull bge-m3:latest
&lt;/code>&lt;/pre>
&lt;p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº† Ollama çš„é…ç½®ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†åœ¨ Open WebUI ä¸­é…ç½® RAG æœåŠ¡ã€‚&lt;/p>
&lt;h2 id="rag-é›†æˆä¸é…ç½®">
&lt;a href="#rag-%e9%9b%86%e6%88%90%e4%b8%8e%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
RAG é›†æˆä¸é…ç½®
&lt;/h2>
&lt;h3 id="åœ¨-open-webui-ä¸­é…ç½®-ollama-çš„-rag-æ¥å£">
&lt;a href="#%e5%9c%a8-open-webui-%e4%b8%ad%e9%85%8d%e7%bd%ae-ollama-%e7%9a%84-rag-%e6%8e%a5%e5%8f%a3" class="header-anchor">#&lt;/a>
åœ¨ Open WebUI ä¸­é…ç½® Ollama çš„ RAG æ¥å£
&lt;/h3>
&lt;h4 id="è®¿é—®-open-webui-ç®¡ç†ç•Œé¢">
&lt;a href="#%e8%ae%bf%e9%97%ae-open-webui-%e7%ae%a1%e7%90%86%e7%95%8c%e9%9d%a2" class="header-anchor">#&lt;/a>
è®¿é—® Open WebUI ç®¡ç†ç•Œé¢
&lt;/h4>
&lt;p>å¯åŠ¨ Open WebUI ä¹‹åï¼Œä½ å¯ä»¥ç›´æ¥é€šè¿‡ Web æµè§ˆå™¨è®¿é—®æœåŠ¡åœ°å€ï¼Œç™»å½•ä½ çš„ç®¡ç†å‘˜è´¦æˆ·ï¼Œç„¶åè¿›å…¥ç®¡ç†å‘˜é¢æ¿ã€‚&lt;/p>
&lt;h4 id="è®¾ç½®-ollama-æ¥å£">
&lt;a href="#%e8%ae%be%e7%bd%ae-ollama-%e6%8e%a5%e5%8f%a3" class="header-anchor">#&lt;/a>
è®¾ç½® Ollama æ¥å£
&lt;/h4>
&lt;p>åœ¨ Open WebUI çš„ç®¡ç†å‘˜é¢æ¿ä¸­ï¼Œç‚¹å‡»&lt;strong>è®¾ç½®&lt;/strong>ï¼Œä½ ä¼šçœ‹åˆ°å¤–éƒ¨è¿æ¥çš„é€‰é¡¹ï¼Œç¡®ä¿ Ollama API çš„åœ°å€ä¸º &lt;code>host.docker.internal:11434&lt;/code> ï¼Œç„¶åç‚¹å‡»å³è¾¹çš„ &lt;strong>verify connection&lt;/strong> æŒ‰é’®ç¡®è®¤ Ollama æœåŠ¡æ˜¯å¦æ­£å¸¸è¿æ¥ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-09-21_ollama_api.webp"
alt="Open WebUI Ollama Setting" width="85%" loading="lazy">
&lt;/figure>
&lt;h4 id="è®¾ç½®è¯­ä¹‰å‘é‡æ¨¡å‹">
&lt;a href="#%e8%ae%be%e7%bd%ae%e8%af%ad%e4%b9%89%e5%90%91%e9%87%8f%e6%a8%a1%e5%9e%8b" class="header-anchor">#&lt;/a>
è®¾ç½®è¯­ä¹‰å‘é‡æ¨¡å‹
&lt;/h4>
&lt;p>åœ¨ Open WebUI çš„ç®¡ç†å‘˜é¢æ¿ä¸­ï¼Œç‚¹å‡»&lt;strong>è®¾ç½®&lt;/strong>ï¼Œæ¥ç€ç‚¹å‡»&lt;strong>æ–‡æ¡£&lt;/strong>ï¼Œä¾æ¬¡å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p>
&lt;ol>
&lt;li>è®¾ç½®è¯­ä¹‰å‘é‡æ¨¡å‹å¼•æ“ä¸º Ollama ã€‚&lt;/li>
&lt;li>è®¾ç½®è¯­ä¹‰å‘é‡æ¨¡å‹ä¸º &lt;code>bge-m3:latest&lt;/code> ã€‚&lt;/li>
&lt;li>å…¶ä½™è®¾ç½®å¯ä»¥ä¿æŒé»˜è®¤ï¼Œè¿™é‡Œæˆ‘è®¾ç½®äº†æ–‡ä»¶æœ€å¤§ä¸Šä¼ å¤§å°ä¸º 10MBï¼Œæœ€å¤§ä¸Šä¼ æ•°é‡ä¸º 3ï¼ŒTop K è®¾ç½®ä¸º 5ï¼Œå—å¤§å°å’Œå—é‡å åˆ†åˆ«è®¾ç½®ä¸º 1500 å’Œ 100 ï¼Œå¹¶å¼€å¯ PDF å›¾åƒå¤„ç†ã€‚&lt;/li>
&lt;li>ç‚¹å‡»å³ä¸‹è§’ä¿å­˜ã€‚&lt;/li>
&lt;/ol>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-09-21_openwebui_embedding.webp"
alt="Open WebUI Embedding Setting" width="85%" loading="lazy">
&lt;/figure>
&lt;h3 id="æµ‹è¯•-rag-æœåŠ¡">
&lt;a href="#%e6%b5%8b%e8%af%95-rag-%e6%9c%8d%e5%8a%a1" class="header-anchor">#&lt;/a>
æµ‹è¯• RAG æœåŠ¡
&lt;/h3>
&lt;p>ç°åœ¨ï¼Œä½ å·²ç»å®ç°äº†å®Œæ•´çš„æœ¬åœ° RAG ç³»ç»Ÿã€‚ä½ å¯ä»¥åœ¨ Open WebUI çš„ä¸»ç•Œé¢ä¸­è¾“å…¥ä»»æ„è‡ªç„¶è¯­è¨€é—®é¢˜ï¼Œç„¶åä¸Šä¼ å“åº”æ–‡æ¡£ï¼Œç³»ç»Ÿä¼šè°ƒç”¨è¯­ä¹‰å‘é‡æ¨¡å‹å‘é‡åŒ–æ–‡æ¡£ï¼Œå†ä½¿ç”¨ Qwen2.5 æ¨¡å‹æ£€ç´¢æ–‡æ¡£ç”Ÿæˆç­”æ¡ˆå¹¶è¿”å›ç»™ç”¨æˆ·ã€‚&lt;/p>
&lt;p>åœ¨ Open WebUI çš„ç”¨æˆ·èŠå¤©ç•Œé¢ï¼Œä¸Šä¼ ä½ è¦æ£€ç´¢çš„æ–‡æ¡£ï¼Œç„¶åè¾“å…¥ä½ çš„é—®é¢˜ï¼Œç‚¹å‡»å‘é€ï¼ŒOpen WebUI å°†ä¼šè°ƒç”¨ Ollama çš„ &lt;code>bge-m3&lt;/code> æ¨¡å‹è¿›è¡Œæ–‡æ¡£å‘é‡åŒ–å¤„ç†ï¼Œç„¶åè°ƒç”¨ Qwen2.5 æ¨¡å‹è¿›è¡Œé—®ç­”ç”Ÿæˆã€‚&lt;/p>
&lt;p>è¿™é‡Œæˆ‘ä¸Šä¼ äº†ä¸€ä¸ªç®€å•çš„ &lt;code>txt&lt;/code> æ–‡ä»¶ï¼ˆç”± GPT ç”Ÿæˆçš„æ–‡æœ¬ï¼‰ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p>
&lt;pre>&lt;code class="language-md"># å¥‡å¹»æ£®æ—çš„å†’é™©
## å¼•è¨€
åœ¨ä¸€ä¸ªé¥è¿œçš„ç‹å›½è¾¹ç•Œï¼Œæœ‰ä¸€ç‰‡ç¥ç§˜çš„å¥‡å¹»æ£®æ—ï¼Œä¼ è¯´ä¸­æ –æ¯ç€è®¸å¤šå¥‡å¼‚çš„ç”Ÿç‰©å’Œå¤è€çš„é­”æ³•ã€‚å¾ˆå°‘æœ‰äººæ•¢äºè¿›å…¥ï¼Œå› ä¸ºè¿›å…¥æ£®æ—çš„äººéƒ½æ²¡æœ‰å†å›æ¥è¿‡ã€‚æ•…äº‹çš„ä¸»äººå…¬æ˜¯ä¸€ä¸ªå¹´è½»çš„å†’é™©è€…ï¼Œä»–åå«è‰¾æ–‡ã€‚
## ç¬¬ä¸€ç« ï¼šè‰¾æ–‡çš„å†³å®š
è‰¾æ–‡æ˜¯ä¸€ä¸ªçƒ­çˆ±å†’é™©å’Œæ¢ç´¢çš„å¹´è½»äººï¼Œä»–ä»å°å°±å¬è¿‡å¾ˆå¤šå…³äºå¥‡å¹»æ£®æ—çš„æ•…äº‹ã€‚å°½ç®¡å®¶äººå’Œæœ‹å‹éƒ½åŠä»–ä¸è¦å»ï¼Œä½†ä»–åšå®šåœ°è®¤ä¸ºï¼Œè‡ªå·±æ³¨å®šè¦æ­å¼€è¿™ç‰‡æ£®æ—çš„ç§˜å¯†ã€‚ä¸€å¤©æ¸…æ™¨ï¼Œä»–æ”¶æ‹¾å¥½è¡Œå›Šï¼Œå¸¦ç€å‹‡æ°”å’Œå¥½å¥‡å¿ƒï¼Œå‘æ£®æ—è¿›å‘ã€‚
### 1.1 å‡ºå‘å‰çš„å‡†å¤‡
åœ¨å‡ºå‘å‰ï¼Œè‰¾æ–‡å»äº†åŸé‡Œæœ€æœ‰åçš„å›¾ä¹¦é¦†ï¼ŒæŸ¥é˜…äº†å…³äºå¥‡å¹»æ£®æ—çš„èµ„æ–™ã€‚ä»–å‘ç°ï¼Œæœ‰ä¸€æœ¬å¤è€çš„æ‰‹ç¨¿è®°å½•äº†è¿›å…¥æ£®æ—çš„è·¯çº¿ï¼Œä»¥åŠå¦‚ä½•é¿å¼€å…¶ä¸­ä¸€äº›å±é™©çš„ç”Ÿç‰©ã€‚è‰¾æ–‡å°†è¿™æœ¬æ‰‹ç¨¿å¤å°åœ¨è‡ªå·±çš„ç¬”è®°æœ¬ä¸Šï¼Œå‡†å¤‡åœ¨éœ€è¦çš„æ—¶å€™å‚è€ƒã€‚
### 1.2 ç¬¬ä¸€æ¬¡ç©¿è¶Š
è‰¾æ–‡åˆšè¿›å…¥æ£®æ—å°±æ„Ÿè§‰åˆ°è¿™é‡Œçš„æ°”æ¯ä¸å¤–ç•Œå®Œå…¨ä¸åŒã€‚ç©ºæ°”ä¸­å¼¥æ¼«ç€æµ“éƒçš„èŠ±é¦™ï¼Œè¿˜æœ‰éšéšçº¦çº¦çš„å¥‡æ€ªå£°éŸ³ã€‚ç©¿è¶Šæ£®æ—çš„ç¬¬ä¸€å¤©ï¼Œè‰¾æ–‡æ²¡æœ‰é‡åˆ°ä»€ä¹ˆå±é™©ï¼Œä½†ä»–èƒ½æ„Ÿè§‰åˆ°ï¼Œæœ‰ä»€ä¹ˆä¸œè¥¿åœ¨æš—ä¸­è§‚å¯Ÿä»–ã€‚
## ç¬¬äºŒç« ï¼šç¥ç§˜ç”Ÿç‰©
ç¬¬äºŒå¤©ï¼Œè‰¾æ–‡ç»§ç»­æ·±å…¥æ£®æ—ã€‚ç„¶è€Œï¼Œä»–æ²¡èµ°å¤šè¿œï¼Œå°±é‡åˆ°äº†ä¸€åªå¥‡å¼‚çš„ç”Ÿç‰©ã€‚è¿™æ˜¯ä¸€åªä¼šå‘å…‰çš„å°é¹¿ï¼Œå…¨èº«æ•£å‘ç€æŸ”å’Œçš„è“è‰²å…‰èŠ’ã€‚èµ·åˆï¼Œè‰¾æ–‡æ„Ÿåˆ°æƒŠè®¶å’Œç•æƒ§ï¼Œä½†è¿™åªå°é¹¿å´æ²¡æœ‰æ”»å‡»ä»–çš„æ„æ€ï¼Œè¿˜å¸¦ç€ä»–èµ°å‘ä¸€ä¸ªéšç§˜çš„æ´ç©´ã€‚
### 2.1 æ´ç©´ä¸­çš„ç§˜å¯†
åœ¨æ´ç©´ä¸­ï¼Œè‰¾æ–‡å‘ç°äº†ä¸€å—å¤è€çš„çŸ³æ¿ï¼ŒçŸ³æ¿ä¸Šåˆ»æœ‰ä¸€äº›å¥‡æ€ªçš„ç¬¦å·ã€‚å°é¹¿ä¼¼ä¹çŸ¥é“è¿™äº›ç¬¦å·çš„å«ä¹‰ï¼Œå¸¦ç€è‰¾æ–‡ä¸€æ­¥ä¸€æ­¥åœ°è§£è¯»ã€‚åŸæ¥ï¼Œè¿™äº›ç¬¦å·è®°è½½ç€ä¸€ç§å¼ºå¤§çš„é­”æ³•ï¼Œå¯ä»¥å¸®åŠ©ä»–åœ¨æ£®æ—ä¸­æ‰¾åˆ°å¤±è½çš„å®è—ã€‚
### 2.2 è·å¾—å¸®åŠ©
è‰¾æ–‡å†³å®šæ¥å—å°é¹¿çš„å¸®åŠ©ï¼Œè§£å¼€è¿™äº›ç¬¦å·çš„ç§˜å¯†ã€‚ä»–ä»¬åœ¨æ´ç©´ä¸­åº¦è¿‡äº†å‡ å¤©ï¼Œè‰¾æ–‡å­¦ä¼šäº†å¦‚ä½•åˆ©ç”¨æ£®æ—ä¸­çš„èµ„æºåˆ¶ä½œè¯å‰‚å’Œæ­¦å™¨ã€‚é€šè¿‡è¿™äº›ï¼Œä»–åœ¨æ£®æ—ä¸­çš„ç”Ÿå­˜èƒ½åŠ›å¤§å¤§æé«˜ã€‚
## ç¬¬ä¸‰ç« ï¼šæœ€ç»ˆçš„è¯•ç‚¼
åœ¨å°é¹¿çš„æŒ‡å¼•ä¸‹ï¼Œè‰¾æ–‡ç»ˆäºæ¥åˆ°äº†æ£®æ—çš„æ·±å¤„ï¼Œé‚£é‡Œæœ‰ä¸€ä¸ªå¤è€çš„ç¥­å›ã€‚æ®è¯´ï¼Œåªæœ‰æœ€å‹‡æ•¢çš„å†’é™©è€…æ‰èƒ½é€šè¿‡ç¥­å›çš„è¯•ç‚¼ï¼Œè·å¾—æœ€ç»ˆçš„å®è—ã€‚
### 3.1 é¢å¯¹ææƒ§
ç¥­å›å‘¨å›´å¸ƒæ»¡äº†å„ç§é™·é˜±å’Œå¹»è§‰ã€‚è‰¾æ–‡å¿…é¡»é¢å¯¹è‡ªå·±å†…å¿ƒæ·±å¤„çš„ææƒ§ï¼Œæ‰èƒ½é€šè¿‡è¿™äº›éšœç¢ã€‚æœ€ç»ˆï¼Œä»–ç”¨æ™ºæ…§å’Œå‹‡æ°”å…‹æœäº†ä¸€åˆ‡ï¼Œè·å¾—äº†è¿›å…¥ç¥­å›çš„èµ„æ ¼ã€‚
### 3.2 å‘ç°å®è—
åœ¨ç¥­å›çš„ä¸­å¿ƒï¼Œè‰¾æ–‡å‘ç°äº†ä¸€é¢—é—ªé—ªå‘å…‰çš„å®çŸ³ã€‚æ®ä¼ ï¼Œè¿™é¢—å®çŸ³æ‹¥æœ‰æ”¹å˜å‘½è¿çš„åŠ›é‡ã€‚è‰¾æ–‡æ‹¿èµ·å®çŸ³ï¼Œæ„Ÿå—åˆ°äº†å…¶ä¸­çš„å¼ºå¤§åŠ›é‡ã€‚ä»–çŸ¥é“ï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ä»¶çå®ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯ç ´è§£å¥‡å¹»æ£®æ—ç§˜å¯†çš„å…³é”®ã€‚
## ç»“è®º
è‰¾æ–‡æˆåŠŸåœ°æ­å¼€äº†å¥‡å¹»æ£®æ—çš„éƒ¨åˆ†ç§˜å¯†ï¼Œæˆä¸ºäº†ä¼ è¯´ä¸­çš„è‹±é›„ã€‚ä»–çš„å†’é™©æ•…äº‹ä¹Ÿæ¿€åŠ±äº†æ›´å¤šå¹´è½»çš„å†’é™©è€…ï¼Œå¸¦ç€å‹‡æ°”å’Œæ™ºæ…§ï¼Œè¸ä¸Šæ¢ç´¢æœªçŸ¥ä¸–ç•Œçš„æ—…ç¨‹ã€‚
&lt;/code>&lt;/pre>
&lt;p>ç„¶ååˆ†åˆ«æäº†ä¸‰ä¸ªé—®é¢˜ï¼š&lt;/p>
&lt;ol>
&lt;li>è‰¾æ–‡åœ¨æ£®æ—ä¸­é‡åˆ°çš„å¥‡å¼‚ç”Ÿç‰©æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/li>
&lt;li>è‰¾æ–‡åœ¨æ´ç©´ä¸­æ‰¾åˆ°çš„å¤è€çŸ³æ¿ä¸Šåˆ»çš„æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/li>
&lt;li>è‰¾æ–‡åœ¨ç¥­å›ä¸­å¿ƒå‘ç°äº†ä»€ä¹ˆå®è—ï¼Ÿ&lt;/li>
&lt;/ol>
&lt;p>ä¸‹å›¾æ˜¯å›ç­”ç»“æœï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-09-21_qwen2-5-QA.webp"
alt="Open WebUI Qwen2.5 Answer" width="90%" loading="lazy">
&lt;/figure>
&lt;h2 id="æ€»ç»“">
&lt;a href="#%e6%80%bb%e7%bb%93" class="header-anchor">#&lt;/a>
æ€»ç»“
&lt;/h2>
&lt;p>å€ŸåŠ© Open WebUI å’Œ Ollamaï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾æ­å»ºä¸€ä¸ªé«˜æ•ˆã€ç›´è§‚çš„æœ¬åœ° RAG ç³»ç»Ÿã€‚é€šè¿‡å°† &lt;code>bge-m3&lt;/code> è¯­ä¹‰å‘é‡æ¨¡å‹ç”¨äºæ–‡æœ¬å‘é‡åŒ–ï¼Œå†ç»“åˆ Qwen2.5 ç”Ÿæˆæ¨¡å‹ï¼Œç”¨æˆ·å¯ä»¥åœ¨ä¸€ä¸ªç»Ÿä¸€çš„ Web ç•Œé¢ä¸­è¿›è¡Œæ–‡æ¡£æ£€ç´¢ä¸å¢å¼ºç”Ÿæˆä»»åŠ¡çš„é«˜æ•ˆäº’åŠ¨ã€‚ä¸ä½†ä¿æŠ¤äº†æ•°æ®éšç§ï¼Œè¿˜å¤§å¹…æå‡äº†ç”Ÿæˆå¼ AI çš„æœ¬åœ°åŒ–åº”ç”¨èƒ½åŠ›ã€‚&lt;/p></description></item><item><title>Arm çŸ©é˜µåŠ é€Ÿï¼šå¯ä¼¸ç¼©çŸ©é˜µæ‰©å±• SME</title><link>https://cuterwrite.top/p/arm-sme-for-performance/</link><pubDate>Tue, 13 Aug 2024 22:44:00 +0000</pubDate><guid>https://cuterwrite.top/p/arm-sme-for-performance/</guid><description>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-14_117622407_p0_master1200.webp" alt="Featured image of post Arm çŸ©é˜µåŠ é€Ÿï¼šå¯ä¼¸ç¼©çŸ©é˜µæ‰©å±• SME" />&lt;h1 id="arm-çŸ©é˜µåŠ é€Ÿå¯ä¼¸ç¼©çŸ©é˜µæ‰©å±•-sme">
&lt;a href="#arm-%e7%9f%a9%e9%98%b5%e5%8a%a0%e9%80%9f%e5%8f%af%e4%bc%b8%e7%bc%a9%e7%9f%a9%e9%98%b5%e6%89%a9%e5%b1%95-sme" class="header-anchor">#&lt;/a>
Arm çŸ©é˜µåŠ é€Ÿï¼šå¯ä¼¸ç¼©çŸ©é˜µæ‰©å±• SME
&lt;/h1>
&lt;h2 id="1-sme-ç®€ä»‹">
&lt;a href="#1-sme-%e7%ae%80%e4%bb%8b" class="header-anchor">#&lt;/a>
1. SME ç®€ä»‹
&lt;/h2>
&lt;p>å¯ä¼¸ç¼©çŸ©é˜µæ‰©å±• SME (Scalable Matrix Extension) SME æ˜¯åœ¨å¯ä¼¸ç¼©å‘é‡æ‰©å±•ï¼ˆScalable Vector Extensionsï¼Œ SVE å’Œ SVE2ï¼‰çš„åŸºç¡€ä¸Šå»ºç«‹çš„ï¼Œå¹¶å¢åŠ äº†æœ‰æ•ˆå¤„ç†çŸ©é˜µçš„èƒ½åŠ›ï¼Œä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>è®¡ç®— SVE å‘é‡çš„å¤–ç§¯ï¼ˆOuter productï¼‰&lt;/li>
&lt;li>çŸ©é˜µå—ï¼ˆtileï¼‰ å­˜å‚¨&lt;/li>
&lt;li>tile å‘é‡çš„åŠ è½½ã€å­˜å‚¨ã€æ’å…¥å’Œæå–ï¼ˆåŒ…æ‹¬åŠ¨æ€è½¬ç½®ï¼‰&lt;/li>
&lt;li>Streaming SVE æ¨¡å¼&lt;/li>
&lt;/ul>
&lt;p>ä¸‹è¡¨æ€»ç»“äº† SMEã€SVE å’Œ SVE2 çš„ä¸»è¦åŠŸèƒ½ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">SME&lt;/th>
&lt;th style="text-align: left">SVE&lt;/th>
&lt;th style="text-align: left">SVE2&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">Streaming SVE æ¨¡å¼&lt;/td>
&lt;td style="text-align: left">NEON DSP++&lt;/td>
&lt;td style="text-align: left">å¯ä¼¸ç¼©å‘é‡&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">åŠ¨æ€çŸ©é˜µè½¬ç½®&lt;/td>
&lt;td style="text-align: left">å¤šç²¾åº¦ç®—æœ¯&lt;/td>
&lt;td style="text-align: left">per-lane predication&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">å‘é‡å¤–ç§¯&lt;/td>
&lt;td style="text-align: left">åŒ¹é…æ£€æµ‹å’Œç›´æ–¹å›¾&lt;/td>
&lt;td style="text-align: left">Gather-load ä¸ Scatter-store&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">åŠ è½½ã€å­˜å‚¨ã€æ’å…¥å’Œæå–çŸ©é˜µå‘é‡&lt;/td>
&lt;td style="text-align: left">éæ—¶é—´æ€§ scatter/gather&lt;/td>
&lt;td style="text-align: left">é¢„æµ‹å‘é‡åŒ–&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">&lt;/td>
&lt;td style="text-align: left">æŒ‰ä½ç½®æ¢ï¼ˆbitwise permuteï¼‰&lt;/td>
&lt;td style="text-align: left">ML æ‰©å±•ï¼ˆFP16 + DOTï¼‰&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">&lt;/td>
&lt;td style="text-align: left">AEã€SHA3ã€SM4ã€Crypto&lt;/td>
&lt;td style="text-align: left">V8.6 BF16, FP ä¸ Int8 æ”¯æŒ&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>SME å®šä¹‰äº†ä»¥ä¸‹æ–°åŠŸèƒ½ï¼š&lt;/p>
&lt;ul>
&lt;li>æ–°çš„æ¶æ„çŠ¶æ€ï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨äºŒç»´çŸ©é˜µ tile&lt;/li>
&lt;li>Streaming SVE æ¨¡å¼ï¼Œæ”¯æŒæ‰§è¡Œå‘é‡é•¿åº¦ä¸ tile é•¿åº¦åŒ¹é…çš„ SVE2 æŒ‡ä»¤ã€‚&lt;/li>
&lt;li>å°†ä¸¤ä¸ªå‘é‡çš„å¤–ç§¯ç´¯åŠ ï¼ˆæˆ–ç´¯å‡ï¼‰åˆ°ä¸€ä¸ªçŸ©é˜µ tile ä¸­çš„æ–°æŒ‡ä»¤ã€‚&lt;/li>
&lt;li>æ–°çš„åŠ è½½ã€å­˜å‚¨å’Œç§»åŠ¨æŒ‡ä»¤ï¼šå¯ä»¥å°†å‘é‡å†™å…¥åˆ°çŸ©é˜µ tile çš„ä¸€è¡Œæˆ–ä¸€åˆ—ï¼Œä¹Ÿå¯ä»¥å°†çŸ©é˜µ tile çš„ä¸€è¡Œæˆ–ä¸€åˆ—è¯»å–åˆ°å‘é‡ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¸ SVE2 ç±»ä¼¼ï¼ŒSME ä¹Ÿæ˜¯ä¸€ç§æ”¯æŒå¯ä¼¸ç¼©å‘é‡é•¿åº¦çš„æ‰©å±•ï¼Œå¯å®ç°å‘é‡é•¿åº¦æ— å…³æ€§ (VLA)ã€per-lane predicationã€predication é©±åŠ¨çš„å¾ªç¯æ§åˆ¶å’Œç®¡ç†åŠŸèƒ½ã€‚&lt;/p>
&lt;h2 id="2-streaming-sve-æ¨¡å¼">
&lt;a href="#2-streaming-sve-%e6%a8%a1%e5%bc%8f" class="header-anchor">#&lt;/a>
2. Streaming SVE æ¨¡å¼
&lt;/h2>
&lt;p>SME å¼•å…¥äº† Streaming SVE æ¨¡å¼ï¼Œè¯¥æ¨¡å¼å®ç°äº† SVE2 æŒ‡ä»¤é›†çš„ä¸€ä¸ªå­é›†ï¼Œå¹¶å¢åŠ äº†æ–°çš„ SME ä¸“ç”¨æŒ‡ä»¤ã€‚&lt;/p>
&lt;p>Streaming SVE æ¨¡å¼æ”¯æŒå¯¹å¤§å‹æ•°æ®é›†è¿›è¡Œé«˜ååé‡åœ°æµå¼æ•°æ®å¤„ç†ï¼Œæµå¼æ•°æ®é€šå¸¸å…·æœ‰ç®€å•çš„å¾ªç¯æ§åˆ¶æµå’Œæœ‰é™çš„æ¡ä»¶æ€§ã€‚&lt;/p>
&lt;p>åœ¨ Non-streaming SVE æ¨¡å¼ä¸‹ï¼Œæ”¯æŒå®Œæ•´çš„ SVE2 æŒ‡ä»¤é›†ï¼Œé€šå¸¸å¤„ç†å¤æ‚çš„æ•°æ®ç»“æ„å’Œå¤æ‚çš„åˆ¤æ–­ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-14_3443.webp"
alt="Streaming SVE æ¨¡å¼ä¸ Non-streaming SVE æ¨¡å¼" width="80%" loading="lazy">&lt;figcaption>
&lt;h4>Streaming SVE æ¨¡å¼ä¸ Non-streaming SVE æ¨¡å¼&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¤§å¤šæ•° SME æŒ‡ä»¤ä»…åœ¨ Streaming SVE æ¨¡å¼ä¸‹å¯ç”¨ã€‚Streaming SVE æ¨¡å¼ä¸‹çš„æµå‘é‡é•¿åº¦ï¼ˆSVLï¼‰å¯èƒ½ä¸éæµå‘é‡é•¿åº¦ï¼ˆNSVLï¼‰ä¸åŒã€‚&lt;/p>
&lt;p>é¢„æœŸæ˜¯ï¼šSVL è¦æ¯” NSVL æ›´é•¿æˆ–æ˜¯ç›¸åŒï¼Œä¹Ÿå°±æ˜¯ SVL &amp;gt;= NSVLã€‚ä¾‹å¦‚ï¼ŒNSVL çš„é•¿åº¦å¯ä»¥ä¸º 128-bit , è€Œ SVL çš„é•¿åº¦å¯ä»¥ä¸º 512-bit ã€‚&lt;/p>
&lt;p>SME çš„ SVL å¯ä»¥æ˜¯ 128-bit , 256-bit , 512-bit, 1024-bit æˆ–æ˜¯ 2048-bit ã€‚SVL éœ€è¦æ˜¯ 2 çš„æ¬¡å¹‚ï¼Œè€Œ NSVL éœ€è¦æ˜¯ 128 çš„æ•´æ•°å€ã€‚&lt;/p>
&lt;p>ä¸ SVE2 ç±»ä¼¼ï¼Œè½¯ä»¶å¯ä»¥æ§åˆ¶ &lt;code>SMCR_ELx.LEN&lt;/code> å¯„å­˜å™¨ä½æ¥è®¾ç½® EL1, EL2, EL3 æƒ³ç”¨çš„æœ‰æ•ˆ SVL é•¿åº¦ï¼ˆå¯ä»¥è®¾ç½®ä¸ºæ¯”ç¡¬ä»¶æ”¯æŒçš„ SVL æ›´çŸ­ï¼‰ã€‚&lt;/p>
&lt;p>æœ‰å…³ Streaming SVE æ¨¡å¼çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ã€ŠArm æ¶æ„å‚è€ƒæ‰‹å†Œã€‹ç¬¬ B1.4.6 èŠ‚ï¼ˆA-profile æ¶æ„ï¼‰ã€‚&lt;/p>
&lt;h2 id="3-åˆ‡æ¢-non-streaming-å’Œ-streaming-sve-æ¨¡å¼">
&lt;a href="#3-%e5%88%87%e6%8d%a2-non-streaming-%e5%92%8c-streaming-sve-%e6%a8%a1%e5%bc%8f" class="header-anchor">#&lt;/a>
3. åˆ‡æ¢ Non-streaming å’Œ Streaming SVE æ¨¡å¼
&lt;/h2>
&lt;p>å¦‚æœ CPU ç¡¬ä»¶å®ç°æ—¢æ”¯æŒ Streaming SVE æ¨¡å¼çš„ SME ï¼Œåˆæ”¯æŒ Non-streaming SVE æ¨¡å¼çš„ SVE2 ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚åŠ¨æ€åˆ‡æ¢è¿™ä¸¤ä¸ªæ“ä½œæ¨¡å¼ã€‚&lt;/p>
&lt;p>ä¸º SME æä¾›ä¸€ä¸ªç‹¬ç«‹çš„æ“ä½œæ¨¡å¼ï¼Œä½¿ CPU ç¡¬ä»¶å®ç°å¯ä»¥ä¸ºåŒä¸€åº”ç”¨æä¾›ä¸åŒçš„å‘é‡é•¿åº¦ã€‚æ¯”å¦‚ CPU ç¡¬ä»¶å®ç°å¯ä»¥é€‰æ‹©æ”¯æŒä¸€ä¸ªæ›´é•¿çš„ Streaming SVE æ¨¡å¼å‘é‡é•¿åº¦ï¼Œå¹¶é’ˆå¯¹é€‚ç”¨äºé«˜ååé‡çš„æµæ“ä½œå¯¹ç¡¬ä»¶è¿›è¡Œä¼˜åŒ–ã€‚&lt;/p>
&lt;p>åº”ç”¨ç¨‹åºå¾ˆå®¹æ˜“åœ¨ Streaming SVE æ¨¡å¼å’Œ Non-streaming SVE æ¨¡å¼ä¹‹é—´åŠ¨æ€åˆ‡æ¢ã€‚SME å¼•å…¥çš„ &lt;code>PSTATE.{SM, ZA}&lt;/code> ä½å¯ä»¥å¯å¯ç”¨å’Œç¦ç”¨ Streaming SVE æ¨¡å¼å’Œ SME ZA å­˜å‚¨ï¼š&lt;/p>
&lt;ul>
&lt;li>SM: å¯ç”¨ä¸ç¦ç”¨ Streaming SVE æ¨¡å¼&lt;/li>
&lt;li>ZAï¼šå¯ç”¨å’Œç¦ç”¨ ZA å­˜å‚¨è®¿é—®&lt;/li>
&lt;/ul>
&lt;p>å¯ä»¥é€šè¿‡ &lt;code>MSR/MRS&lt;/code> æŒ‡ä»¤æ“ä½œ Streaming Vector Control Register (SVCR) æ¥è®¾ç½®å’Œè¯»å– &lt;code>PSTATE.{SM, ZA}&lt;/code> ä½ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>MSR SVCRSM, #&amp;lt;imm&amp;gt; MSR SVCRSMï¼Œ#&lt;/code>&lt;/li>
&lt;li>&lt;code>MSR SVCRZA, #&amp;lt;imm&amp;gt;&lt;/code>&lt;/li>
&lt;li>&lt;code>MSR SVCRSMZA, #&amp;lt;imm&amp;gt;&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>SMSTART æŒ‡ä»¤æ˜¯è®¾ç½® &lt;code>PSTATE.SM&lt;/code> å’Œ &lt;code>PSTATE.ZA&lt;/code> çš„ &lt;code>MSR&lt;/code> æŒ‡ä»¤çš„åˆ«å&lt;/p>
&lt;ul>
&lt;li>&lt;code>SMSTART&lt;/code>ï¼šåŒæ—¶å¯ç”¨ Streaming SVE æ¨¡å¼å’Œ ZA å­˜å‚¨è®¿é—®&lt;/li>
&lt;li>&lt;code>SMSTART SM&lt;/code>ï¼šå¯ç”¨ Streaming SVE æ¨¡å¼&lt;/li>
&lt;li>&lt;code>SMSTART ZA&lt;/code>ï¼šå¯ç”¨ ZA å­˜å‚¨è®¿é—®&lt;/li>
&lt;/ul>
&lt;p>SMSTOP æŒ‡ä»¤åˆ™æ˜¯æ¸…é™¤ &lt;code>PSTATE.SM&lt;/code> å’Œ &lt;code>PSTATE.ZA&lt;/code> çš„ &lt;code>MSR&lt;/code> æŒ‡ä»¤çš„åˆ«åã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>SMSTOP&lt;/code>ï¼šåŒæ—¶ç¦ç”¨ Streaming SVE æ¨¡å¼å’Œ ZA å­˜å‚¨è®¿é—®&lt;/li>
&lt;li>&lt;code>SMSTOP SM&lt;/code>ï¼šç¦ç”¨ Streaming SVE æ¨¡å¼&lt;/li>
&lt;li>&lt;code>SMSTOP ZA&lt;/code>ï¼šç¦ç”¨ ZA å­˜å‚¨è®¿é—®&lt;/li>
&lt;/ul>
&lt;p>ä¸‹å›¾å±•ç¤ºäº†åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•åœ¨ Streaming SVE æ¨¡å¼å’Œ Non-streaming SVE æ¨¡å¼ä¹‹é—´åˆ‡æ¢çš„ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-15_Scalable_Matrix_p1.webp"
alt="åº”ç”¨ç¨‹åºåˆ‡æ¢ Streaming SVE æ¨¡å¼å’Œ Non-streaming SVE æ¨¡å¼" width="50%" loading="lazy">&lt;figcaption>
&lt;h4>åº”ç”¨ç¨‹åºåˆ‡æ¢ Streaming SVE æ¨¡å¼å’Œ Non-streaming SVE æ¨¡å¼&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>æœ‰å…³ä½¿ç”¨ SMSTART å’Œ SMSTOP åœ¨ Streaming SVE æ¨¡å¼å’Œ Non-Streaming SVE æ¨¡å¼ä¹‹é—´åˆ‡æ¢çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ã€ŠArm æ¶æ„å‚è€ƒæ‰‹å†Œã€‹ä¸­æœ‰å…³ A-profile æ¶æ„çš„ C6.2.327 å’Œ C6.2.328 èŠ‚ã€‚&lt;/p>
&lt;h2 id="4-sme-æ¶æ„çŠ¶æ€">
&lt;a href="#4-sme-%e6%9e%b6%e6%9e%84%e7%8a%b6%e6%80%81" class="header-anchor">#&lt;/a>
4. SME æ¶æ„çŠ¶æ€
&lt;/h2>
&lt;p>ä¸ SVE2 ç±»ä¼¼ï¼Œåœ¨ Streaming SVE æ¨¡å¼ï¼Œå®ƒæœ‰ &lt;code>Z0-Z31&lt;/code> å‘é‡å¯„å­˜å™¨ï¼Œå’Œ &lt;code>P0-P15&lt;/code> Predicate å¯„å­˜å™¨ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-15_4130_ARM2799_3_Scalable_Matrix_p1.webp"
alt="Streaming mode registers" width="70%" loading="lazy">
&lt;/figure>
&lt;p>SVE å‘é‡å¯„å­˜å™¨çš„æœ€ä½ç¼–å·ä½ &lt;code>Zn&lt;/code> ä¹Ÿä¿å­˜ç€å›ºå®šé•¿åº¦çš„ &lt;code>Vnã€Qnã€Dnã€Snã€Hn&lt;/code> å’Œ &lt;code>Bn&lt;/code> å¯„å­˜å™¨ã€‚&lt;/p>
&lt;p>è¿›å…¥ Streaming SVE æ¨¡å¼ï¼ˆ &lt;code>PSTATE.SM&lt;/code> ç”± 0 å˜ä¸º 1ï¼‰æˆ–é€€å‡º Streaming SVE æ¨¡å¼ï¼ˆ &lt;code>PSTATE.SM&lt;/code> ç”± 1 å˜ä¸º 0ï¼‰æ—¶ï¼Œæ‰€æœ‰è¿™äº›å¯„å­˜å™¨éƒ½å°†ç½®é›¶ã€‚&lt;/p>
&lt;p>å¤§å¤šæ•° Non-streaming SVE2 æŒ‡ä»¤å¯ç”¨äº Streaming SVE æ¨¡å¼ï¼Œä½†&lt;strong>å¯èƒ½ä½¿ç”¨ä¸åŒçš„å‘é‡é•¿åº¦&lt;/strong>ï¼ˆæµæ¨¡å¼ä½¿ç”¨ VSL é•¿åº¦ï¼Œéæµæ¨¡å¼ä½¿ç”¨ NVSL é•¿åº¦ï¼‰ã€‚å¯ä»¥ä½¿ç”¨ &lt;code>RDSVL&lt;/code> æŒ‡ä»¤è¯»å–å½“å‰çš„æœ‰æ•ˆå‘é‡é•¿åº¦ VLã€‚&lt;/p>
&lt;pre>&lt;code class="language-armasm">//Read multiple of Streaming SVE vector register size to Xd
RDSVL &amp;lt;Xd&amp;gt;, #&amp;lt;imm&amp;gt;
&lt;/code>&lt;/pre>
&lt;blockquote class="alert-blockquote alert-note">
&lt;p class="alert-heading">
&lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
&lt;path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z">&lt;/path>
&lt;/svg>
&lt;span>æ³¨é‡Š&lt;/span>
&lt;/p>
&lt;p>å› ä¸º SME æ”¯æŒ Vector Length Agnostic (VLA) ï¼Œåœ¨ Streaming SVE æ¨¡å¼ä¸‹ï¼Œè½¯ä»¶å¾ˆå°‘éœ€è¦æ˜ç¡®è¯» SVL å‘é‡é•¿åº¦ã€‚åœ¨ Non-streaming SVE æ¨¡å¼ä¸‹ï¼Œé€šå¸¸ä½¿ç”¨ RDSVL æŒ‡ä»¤æ¥ç¡®å®š SVL çš„å€¼ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="5-za-array">
&lt;a href="#5-za-array" class="header-anchor">#&lt;/a>
5. ZA array
&lt;/h2>
&lt;p>SME æ–°å¼•å…¥çš„ ZA (Z Array, ZA Storage) æ˜¯ä¸€ä¸ªäºŒç»´ï¼ˆ2Dï¼‰æ­£æ–¹å½¢æ•°ç»„ï¼Œå¤§å°æ˜¯ SVL x SVLã€‚ä¹‹æ‰€ä»¥å« Z Arrayï¼Œä¹Ÿæ˜¯å› ä¸ºå®ƒè¡Œä¸åˆ—çš„é•¿åº¦ä¸ Streaming SVE æ¨¡å¼ä¸‹çš„ Zn å¯„å­˜å™¨ä¸€è‡´ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-15_4314_ARM2799_4_Scalable_Matrix_p1.webp"
alt="ZA array" width="50%" loading="lazy">&lt;figcaption>
&lt;h4>ZA array&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>ä¾‹å¦‚ï¼šå¦‚æœ Streaming SVE æ¨¡å¼ä¸‹çš„å‘é‡é•¿åº¦ä¸º 256-bitï¼Œå³ Zn å¯„å­˜å™¨çš„é•¿åº¦ä¸º 256-bitï¼Œé‚£ä¹ˆ ZA çš„å¤§å°ä¸º (256/8 bytes) x (256/8 bytes) ã€‚&lt;/p>
&lt;p>ZA array å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®ï¼š&lt;/p>
&lt;ul>
&lt;li>ZA array vector è®¿é—®&lt;/li>
&lt;li>ZA tiles&lt;/li>
&lt;li>ZA tile slices&lt;/li>
&lt;/ul>
&lt;h3 id="51-za-array-vector-è®¿é—®">
&lt;a href="#51-za-array-vector-%e8%ae%bf%e9%97%ae" class="header-anchor">#&lt;/a>
5.1 ZA array vector è®¿é—®
&lt;/h3>
&lt;p>ZA array çš„ä¸€è¡Œå¯ä»¥å½“æˆä¸€ä¸ª SVL é•¿åº¦çš„å‘é‡æ¥è®¿é—®ï¼Œè¿™ä¸ªå‘é‡å¯ä»¥æ”¾æ•°æ®ç±»å‹é•¿åº¦ä¸º 8-bit, 16-bit, 32-bit, 64-bit æˆ– 128-bit çš„å…ƒç´ ï¼Œæ¯”å¦‚ 32-bit çš„ fp32 æµ®ç‚¹æ•°ã€‚&lt;/p>
&lt;pre>&lt;code class="language-c">ZA.B[N], ZA.H[N], ZA.S[N], ZA.D[N], ZA.Q[N]
&lt;/code>&lt;/pre>
&lt;p>å…¶ä¸­ &lt;code>Bï¼ŒHï¼ŒSï¼ŒDï¼ŒQ&lt;/code> åˆ†åˆ«è¡¨ç¤º 8-bit , 16-bit , 32-bit , 64-bit , 128-bitã€‚&lt;/p>
&lt;p>ZA array vector çš„æ•°é‡ä¸ SVL ä¸­çš„å­—èŠ‚æ•°ç›¸åŒï¼Œä¾‹å¦‚ï¼Œå¦‚æœ SLV æ˜¯ 256-bit ï¼Œé‚£ä¹ˆ ZA array vector çš„æ•°é‡æ˜¯ 32 ä¸ªï¼ŒN çš„èŒƒå›´æ˜¯ 0 åˆ° 31ã€‚&lt;/p>
&lt;p>ä¸ºäº†æ”¯æŒä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒSME å¼•å…¥äº†æ–°çš„ &lt;code>LDR&lt;/code> å’Œ &lt;code>STR&lt;/code> æŒ‡ä»¤ï¼Œç”¨äºä»å†…å­˜åŠ è½½å’Œå­˜å‚¨ä¸€ä¸ª ZA array vectorã€‚&lt;/p>
&lt;pre>&lt;code class="language-armasm">LDR ZA[&amp;lt;Wv&amp;gt;, &amp;lt;imm&amp;gt;], [&amp;lt;Xn|SP&amp;gt;{, #&amp;lt;imm&amp;gt;, MUL VL}]
STR ZA[&amp;lt;Wv&amp;gt;, &amp;lt;imm&amp;gt;], [&amp;lt;Xn|SP&amp;gt;{, #&amp;lt;imm&amp;gt;, MUL VL}]
&lt;/code>&lt;/pre>
&lt;h3 id="52-za-tiles">
&lt;a href="#52-za-tiles" class="header-anchor">#&lt;/a>
5.2 ZA tiles
&lt;/h3>
&lt;p>ZA tile æ˜¯åœ¨ ZA ä¸­çš„æ­£æ–¹å½¢çš„äºŒç»´å­çŸ©é˜µã€‚ZA tile çš„å®½åº¦å§‹ç»ˆæ˜¯ SVLï¼Œä¸ ZA array çš„å®½åº¦ç›¸åŒã€‚&lt;/p>
&lt;p>ZA å¯ä»¥åˆ†æˆå¤šå°‘ä¸ªå¯ç”¨çš„ ZA tile æ˜¯ç”±å…ƒç´ çš„æ•°æ®ç±»å‹å¤§å°å†³å®šçš„ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">å…ƒç´ æ•°æ®ç±»å‹å¤§å°&lt;/th>
&lt;th style="text-align: left">tile æ•°é‡&lt;/th>
&lt;th style="text-align: left">tile åç§°&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">8-bit&lt;/td>
&lt;td style="text-align: left">1&lt;/td>
&lt;td style="text-align: left">ZA0.B&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">16-bit&lt;/td>
&lt;td style="text-align: left">2&lt;/td>
&lt;td style="text-align: left">ZA0.H-ZA1.H&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">32-bit&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">ZA0.S-ZA3.S&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">64-bit&lt;/td>
&lt;td style="text-align: left">8&lt;/td>
&lt;td style="text-align: left">ZA0.D-ZA7.D&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">128-bit&lt;/td>
&lt;td style="text-align: left">16&lt;/td>
&lt;td style="text-align: left">ZA0.Q-ZA15.Q&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;ul>
&lt;li>å½“å…ƒç´ æ•°æ®ç±»å‹ä¸º 8-bit æ—¶ï¼ŒZA åªèƒ½ä½œä¸ºä¸€ä¸ª ZA tile (ZA0.B) è¢«è®¿é—®ã€‚&lt;/li>
&lt;li>å½“å…ƒç´ æ•°æ®ç±»å‹ä¸º 16-bit æ—¶ï¼ŒZA å¯ä»¥ä½œä¸º 2 ä¸ª ZA tile (ZA0.H å’Œ ZA1.H) è¢«è®¿é—®ã€‚&lt;/li>
&lt;li>å½“å…ƒç´ æ•°æ®ç±»å‹ä¸º 32-bit æ—¶ï¼ŒZA å¯ä»¥ä½œä¸º 4 ä¸ª ZA tile (ZA0.S åˆ° ZA3.S) è¢«è®¿é—®ã€‚&lt;/li>
&lt;li>å½“å…ƒç´ æ•°æ®ç±»å‹ä¸º 64-bit æ—¶ï¼ŒZA å¯ä»¥ä½œä¸º 8 ä¸ª ZA tile (ZA0.D åˆ° ZA7.D) è¢«è®¿é—®ã€‚&lt;/li>
&lt;li>å½“å…ƒç´ æ•°æ®ç±»å‹ä¸º 128-bit æ—¶ï¼ŒZA å¯ä»¥ä½œä¸º 16 ä¸ª ZA tile (ZA0.Q åˆ° ZA15.Q) è¢«è®¿é—®ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¾‹å¦‚ï¼Œå¦‚æœ SVL ä¸º 256-bitï¼Œå…ƒç´ æ•°æ®ç±»å‹å¤§å°ä¸º 8-bitï¼Œåˆ™ ZA å¯ä»¥è§†ä¸º ZA0.Bï¼Œä¹Ÿå¯è§†ä¸º 32 ä¸ªå‘é‡ï¼ˆ32 è¡Œï¼Œæ¯è¡Œå¤§å°ä¸º 32 x 8-bitï¼Œå³æ¯è¡Œ 32 ä¸ªå…ƒç´ ï¼‰ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-15_ZA0B.webp"
alt="ZA0.B" width="50%" loading="lazy">
&lt;/figure>
&lt;p>å¦‚æœ SVL ä¸º 256-bitï¼Œå…ƒç´ æ•°æ®ç±»å‹å¤§å°ä¸º 16-bitï¼Œåˆ™ ZA å¯ä»¥è§†ä¸º 2 ä¸ª ZA tile (ZA0.H å’Œ ZA1.H)ï¼Œæ¯ä¸ª tile è§†ä¸º 16 ä¸ªå‘é‡ï¼ˆ16 è¡Œï¼Œæ¯è¡Œå¤§å°ä¸º 16 x 16-bitï¼Œå³æ¯è¡Œ 16 ä¸ªå…ƒç´ ï¼‰ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-15_ZA0H_ZA1H.webp"
alt="ZA0.H å’Œ ZA1.H" width="40%" loading="lazy">
&lt;/figure>
&lt;p>è¿™æ ·åšçš„å¥½å¤„æ˜¯å……åˆ†åˆ©ç”¨äº† ZA storageï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæ¯”å¦‚è¯´å½“ SVL ä¸º 256-bitï¼Œå…ƒç´ æ•°æ®ç±»å‹å¤§å°ä¸º 32-bitï¼ŒZA çš„å¤§å°ä¸º 256-bit x 256-bit æ—¶ï¼Œ&lt;strong>è¦å¯¹ä¸¤ä¸ª Z å¯„å­˜å™¨é‡Œçš„å‘é‡åšå¤–ç§¯è¿ç®—&lt;/strong>ï¼Œè®¡ç®—å¾—åˆ°çš„å¤–ç§¯ç»“æœæ˜¯ 8 x 8 çš„äºŒç»´æµ®ç‚¹æ•°æ•°ç»„ï¼Œè¿™ä¸ªå¤–ç§¯åªéœ€è¦ ZA çš„ 1/4 çš„å­˜å‚¨ç©ºé—´ã€‚å°† ZA åˆ†æˆ 4 ä¸ª ZA tileï¼Œè¿™æ ·å°±å¯ä»¥å……åˆ†åˆ©ç”¨ ZA storageã€‚&lt;/p>
&lt;h3 id="53-za-tile-slices">
&lt;a href="#53-za-tile-slices" class="header-anchor">#&lt;/a>
5.3 ZA tile slices
&lt;/h3>
&lt;p>ä¸€ä¸ª ZA tile å¯ä»¥ä½œä¸ºä¸€ä¸ªæ•´ä½“æ¥è®¿é—®ï¼Œä¹Ÿå¯ä»¥ä»¥ä¸€ä¸ªä¸ª ZA tile slice çš„æ–¹å¼è®¿é—®ã€‚&lt;/p>
&lt;p>å½“ä½œä¸ºä¸€ä¸ªæ•´ä½“è®¿é—®æ—¶ï¼ŒæŒ‡ä»¤å¯ä»¥ä½¿ç”¨ tile çš„åå­—è®¿é—®ï¼š&lt;/p>
&lt;pre>&lt;code class="language-text">ZA0.B, ZA0.H-ZA1.H, ZA0.S-ZA3.S, ZA0.D-ZA7.D or ZA0.Q-ZA15.Q
&lt;/code>&lt;/pre>
&lt;p>ä¸€ä¸ª ZA tile slice æ˜¯ç”±å…¶ ZA tile ä¸­&lt;strong>æ°´å¹³æ–¹å‘æˆ–æ˜¯å‚ç›´æ–¹å‘çš„è¿ç»­å…ƒç´ ç»„æˆçš„ä¸€ç»´æ•°ç»„&lt;/strong>ï¼Œå³åœ¨ ZA tile ä¸­çš„ä¸€è¡Œæˆ–æ˜¯ä¸€åˆ—ã€‚&lt;/p>
&lt;p>å¯¹ä¸€ä¸ª ZA tile çš„å‘é‡è®¿é—®å³æ˜¯è¯»å†™ä¸€ä¸ª ZA tile slice ï¼š&lt;/p>
&lt;ul>
&lt;li>æ°´å¹³æˆ–å‚ç›´æ–¹å‘çš„ ZA tile slice è®¿é—®ï¼Œç”± ZA tile åå­—åçš„ &lt;code>H&lt;/code> æˆ– &lt;code>V&lt;/code> åç¼€æ¥è¡¨ç¤ºã€‚&lt;/li>
&lt;li>å…·ä½“çš„ ZA tile slice ç”±ä¸€ä¸ªç´¢å¼•æ¥è¡¨ç¤ºï¼Œç”± ZA tile åå­—åçš„åˆ‡ç‰‡ç´¢å¼• &lt;code>[N]&lt;/code> æ¥è¡¨ç¤ºã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¾‹å¦‚ï¼Œå¦‚æœ SVL ä¸º 128 ä½ï¼Œå…ƒç´ æ•°æ®ç±»å‹å¤§å°ä¸º 8-bitï¼Œé‚£ä¹ˆå…¶æ°´å¹³çš„å’Œå‚ç›´çš„ ZA tile slice å¯ç”±ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-15_6724_ARM2799_7_Scalable_Matrix_p1.webp"
alt="ZA tile slices" width="50%" loading="lazy">
&lt;/figure>
&lt;p>å†ä¾‹å¦‚ï¼Œå¦‚æœ SVL ä¸º 128 ä½ï¼Œå…ƒç´ æ•°æ®ç±»å‹å¤§å°ä¸º 16-bitï¼Œé‚£ä¹ˆå…¶æ°´å¹³çš„å’Œå‚ç›´çš„ ZA tile slice å¯ç”±ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-15_6888_ARM2799_8_Scalable_Matrix_p1.webp"
alt="ZA tile slices" width="50%" loading="lazy">
&lt;/figure>
&lt;p>ä¸ºäº†æé«˜ç¡¬ä»¶è®¿é—® ZA tile å’Œ ZA tile slices çš„æ•ˆç‡ï¼ŒZA tile çš„ ZA tile slices æ˜¯äº¤é”™æ’åˆ—çš„ã€‚&lt;/p>
&lt;p>ä¸‹å›¾æ˜¾ç¤ºäº†è¿™ç§äº¤é”™æ’åˆ—çš„ç¤ºä¾‹ã€‚åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒSVL ä¸º 256 ä½ï¼Œå…ƒç´ æ•°æ®ç±»å‹å¤§å°ä¸º 16 ä½ã€‚è¿™æ„å‘³ç€ï¼ŒZA å¯è¢«è§†ä¸ºä¸¤ä¸ª ZA tileï¼ˆZA0H å’Œ ZA1Hï¼‰ï¼Œå¹¶å…·æœ‰äº¤é”™çš„æ°´å¹³ tile slices ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-15_4885_SME_interleave.webp"
alt="ZA tile slices" width="auto" loading="lazy">
&lt;/figure>
&lt;p>ä¸‹å›¾å±•ç¤ºäº†ä¸åŒçš„å…ƒç´ æ•°æ®ç±»å‹å¤§å°çš„æ°´å¹³å’Œå‚ç›´æ–¹å‘ ZA tile slice çš„æ··åˆè§†å›¾:&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-15_7673_SME_V_H.webp"
alt="ZA tile slices" width="auto" loading="lazy">
&lt;/figure>
&lt;p>å·¦ä¾§å„æ æ˜¾ç¤ºäº† ZA å­˜å‚¨å™¨æ¯ä¸€è¡Œçš„ä¸åŒå¤„ç†æ–¹å¼ã€‚&lt;/p>
&lt;p>è®¾ SIZE ä¸ºå‘é‡å…ƒç´ çš„å¤§å°ï¼Œå…¶ä¸­ SIZE ä¸º 1ã€2ã€4ã€8ã€16ï¼Œåˆ†åˆ«ä»£è¡¨æ•°æ®ç±»å‹ Bã€Hã€Sã€D æˆ– Qã€‚&lt;/p>
&lt;p>è®¾ NUM_OF_ELEMENTS ä¸ºå‘é‡ä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œå³ bytes_of(SVL)/SIZEã€‚&lt;/p>
&lt;p>æ°´å¹³ tile sliceï¼Œ &lt;code>ZAnH.&amp;lt;B|H|S|D|Q&amp;gt;[m]&lt;/code> è®¿é—®ä¸€ä¸ªå‘é‡ï¼Œè¯¥å‘é‡åŒ…å« ZA storage ä¸­çš„æ•´è¡Œï¼ˆm x SIZE + nï¼‰ã€‚è¯¥å‘é‡åŒ…å«æ•°æ®ç±»å‹ä¸º Bã€Hã€Sã€D æˆ– Q çš„å…ƒç´ ã€‚&lt;/p>
&lt;p>å‚ç›´ tile sliceï¼Œ&lt;code>ZAnV.&amp;lt;B|H|S|D|Q&amp;gt;[m] &lt;/code> è®¿é—®ä¸€ä¸ªå‘é‡ï¼Œè¯¥å‘é‡åŒ…å« ZA storage ä¸­çš„æ•´åˆ—ï¼ˆm x SIZEï¼‰ã€‚è¯¥å‘é‡åŒ…å«æ•°æ®ç±»å‹ä¸º Bã€Hã€Sã€D æˆ– Q çš„å…ƒç´ ã€‚&lt;/p>
&lt;p>&lt;code>ZAnV.[m] &lt;/code> è®¿é—®ä¸€ä¸ªåŒ…å«åˆ—ï¼ˆm x SIZEï¼‰å’Œè¡Œå…ƒç´ ï¼ˆi x SIZE + nï¼‰çš„å‘é‡ï¼Œå…¶ä¸­ i ä¸º 0 ~ NUM_OF_ELEMENTS-1ã€‚è¯¥å‘é‡åŒ…å«æ•°æ®ç±»å‹ä¸º Bã€Hã€Sã€D æˆ– Q çš„å…ƒç´ ã€‚&lt;/p>
&lt;p>ä½¿ç”¨æ··åˆå…ƒç´ æ•°æ®ç±»å‹å¤§å°ä»¥åŠæ°´å¹³å’Œå‚ç›´ tile slice çš„åº”ç”¨åº”å°å¿ƒå¤„ç†é‡å ã€‚&lt;/p>
&lt;p>æœ‰å…³ ZA Arrayã€ZA array vectorsã€tile å’Œ tile slices çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ã€ŠArm æ¶æ„å‚è€ƒæ‰‹å†Œã€‹ä¸­æœ‰å…³ A-profile æ¶æ„çš„ B1.4.8 è‡³ B1.4.12 èŠ‚ã€‚&lt;/p>
&lt;h2 id="6-steaming-sve-æ¨¡å¼ä¸‹æ”¯æŒçš„æŒ‡ä»¤">
&lt;a href="#6-steaming-sve-%e6%a8%a1%e5%bc%8f%e4%b8%8b%e6%94%af%e6%8c%81%e7%9a%84%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
6. Steaming SVE æ¨¡å¼ä¸‹æ”¯æŒçš„æŒ‡ä»¤
&lt;/h2>
&lt;p>æŸäº›æŒ‡ä»¤åœ¨ Streaming SVE æ¨¡å¼ä¸‹æœ‰é™åˆ¶ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸€äº› SVE/SVE2 æŒ‡ä»¤å˜ä¸ºéæ³•æ‰§è¡Œ
&lt;ul>
&lt;li>Gathed-load å’Œ Scatter-store æŒ‡ä»¤&lt;/li>
&lt;li>ä½¿ç”¨ First Fault å¯„å­˜å™¨çš„ SVE2 æŒ‡ä»¤&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¤§å¤šçš„ NEON æŒ‡ä»¤å˜ä¸º UNDEFINED&lt;/li>
&lt;/ul>
&lt;p>æœ‰å…³å— Streaming SVE æ¨¡å¼å½±å“çš„æŒ‡ä»¤çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æ–‡æ¡£ ã€ŠArm æ¶æ„å‚è€ƒæ‰‹å†Œã€‹ã€‚&lt;/p>
&lt;p>SME å¢åŠ äº†å‡ æ¡æ–°æŒ‡ä»¤ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>çŸ©é˜µå¤–ç§¯å’Œç´¯åŠ æˆ–å‡æ³•æŒ‡ä»¤ï¼ŒåŒ…æ‹¬ FMOPAã€UMOPA å’Œ BFMOPAã€‚
&lt;ul>
&lt;li>SVE2 å‘é‡å¯„å­˜å™¨ï¼ˆZ0-Z31ï¼‰ä½œä¸ºå¤–ç§¯è¿ç®—çš„è¡Œå’Œåˆ—è¾“å…¥ã€‚&lt;/li>
&lt;li>ZA storage ä¿å­˜äºŒç»´çŸ©é˜µ tile çš„è¾“å‡ºç»“æœã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å°† SVE2 Z å‘é‡ä¸ ZA çš„è¡Œæˆ–åˆ—åšåŠ æ³•è¿ç®—çš„æŒ‡ä»¤&lt;/li>
&lt;li>å¯¹ ZA tiles çš„æ¸…é›¶æ“ä½œæŒ‡ä»¤&lt;/li>
&lt;li>å¢åŠ äº†ä¸€äº›åœ¨ Streaming å’Œ Non-streaming æ¨¡å¼ä¸‹éƒ½èƒ½ä½¿ç”¨çš„æŒ‡ä»¤&lt;/li>
&lt;/ul>
&lt;h2 id="7-sme-æŒ‡ä»¤">
&lt;a href="#7-sme-%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7. SME æŒ‡ä»¤
&lt;/h2>
&lt;p>æ“ä½œ ZA storage çš„ SME æŒ‡ä»¤ä¸»è¦åŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>è®¡ç®—ä¸¤ä¸ªå‘é‡çš„å¤–ç§¯ï¼Œå¹¶ç´¯åŠ æˆ–ç´¯å‡ï¼Œç„¶åå°†ç»“æœæ”¾å…¥ä¸€ä¸ª ZA tile çš„æŒ‡ä»¤&lt;/li>
&lt;li>å°† SVE å‘é‡ï¼ˆZ å¯„å­˜å™¨ï¼‰å­˜å…¥æˆ–å–å‡º ZA tile çš„è¡Œæˆ–åˆ—çš„æŒ‡ä»¤&lt;/li>
&lt;li>æ°´å¹³æˆ–å‚ç›´æ–¹å‘ä¸Šï¼Œä¸€ä¸ª SVE å‘é‡ä¸ ZA tile çš„åŠ æ³•æŒ‡ä»¤&lt;/li>
&lt;li>ç»™ä¸€ä¸ªæ ‡é‡å¯„å­˜å™¨åŠ ä¸Š Streaming SVE æ¨¡å¼ä¸‹å‘é‡é•¿åº¦çš„å€æ•°çš„æŒ‡ä»¤&lt;/li>
&lt;/ul>
&lt;h3 id="71-å¤–ç§¯å¹¶ç´¯åŠ æˆ–ç´¯å‡æŒ‡ä»¤">
&lt;a href="#71-%e5%a4%96%e7%a7%af%e5%b9%b6%e7%b4%af%e5%8a%a0%e6%88%96%e7%b4%af%e5%87%8f%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7.1 å¤–ç§¯å¹¶ç´¯åŠ æˆ–ç´¯å‡æŒ‡ä»¤
&lt;/h3>
&lt;p>ä¸ºäº†å¸®åŠ©ç†è§£å¤–ç§¯å¹¶ç´¯åŠ æˆ–ç´¯å‡æŒ‡ä»¤ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å¤–ç§¯æ“ä½œæ¥åšçŸ©é˜µä¹˜æ³•ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_2313_Picture1_png-1280x960.webp"
alt="Outer product" width="auto" loading="lazy">
&lt;/figure>
&lt;p>è®¡ç®—ä¸¤ä¸ªå‘é‡ a å’Œ b çš„å¤–ç§¯ä¼šå¾—åˆ°ä¸€ä¸ªåŒ…å«å¤–ç§¯çš„ç»“æœçŸ©é˜µ Cï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_1665_Picture2_png-1280x960.webp"
alt="Outer product" width="auto" loading="lazy">
&lt;/figure>
&lt;p>ç°åœ¨è€ƒè™‘ä¸¤ä¸ªçŸ©é˜µ a å’Œ b çš„çŸ©é˜µä¹˜è¿ç®—ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_8117_Picture3_png-1280x960.webp"
alt="Matrix multiplication" width="auto" loading="lazy">
&lt;/figure>
&lt;p>è¿™ä¸ªçŸ©é˜µä¹˜å¯ä»¥é€šè¿‡è®¡ç®—ä¸¤æ¬¡å¤–ç§¯æ“ä½œå’Œä¸¤ä¸ªç»“æœçŸ©é˜µçš„ç´¯åŠ æ¥å®ç°ï¼ˆå°±æ˜¯å¸¸ç”¨çš„æ‰‹å†™è®¡ç®—çš„æ–¹æ³•ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_3731_Picture4_png-1280x960.webp"
alt="Matrix multiplication with outer product" width="auto" loading="lazy">
&lt;/figure>
&lt;p>SME ä¸ºä»¥ä¸‹æ•°æ®ç±»å‹å¼•å…¥äº†é«˜æ•ˆçš„å¤–ç§¯å¹¶ç´¯åŠ æˆ–å‡æ³•æŒ‡ä»¤ï¼š&lt;/p>
&lt;ul>
&lt;li>8-bit, 16-bit æ•´æ•°&lt;/li>
&lt;li>FP16, BF16, FP32 å’Œ FP64 æµ®ç‚¹æ•°&lt;/li>
&lt;/ul>
&lt;p>è¿™äº›æŒ‡ä»¤è®¡ç®—ä¸¤ä¸ª Z å‘é‡å¯„å­˜å™¨ï¼ˆZn å’Œ Zmï¼‰ä¸­ä¸¤ä¸ªå‘é‡çš„å¤–ç§¯ï¼Œå°†ç»“æœæ•°ç»„ä¸ä¸€ä¸ª ZA tileï¼ˆZAdaï¼‰ä¸­å·²æœ‰æ•°æ®è¿›è¡Œç´¯åŠ æˆ–ç´¯å‡ï¼Œå¹¶å°†ç»“æœå­˜å…¥åŒä¸€ ZA tileï¼ˆZAdaï¼‰ä¸­ã€‚æ¯ä¸ªæºå‘é‡ç”±ç›¸åº”çš„æ§åˆ¶ predicate å¯„å­˜å™¨ï¼ˆPn å’Œ Pmï¼‰ç‹¬ç«‹åœ° predicateã€‚&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">è¾“å‡ºæ•°ç»„&lt;/th>
&lt;th style="text-align: left">è¾“å…¥å‘é‡&lt;/th>
&lt;th style="text-align: left">æè¿°&lt;/th>
&lt;th style="text-align: left">ç¤ºä¾‹&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">INT32&lt;/td>
&lt;td style="text-align: left">INT8, INT8&lt;/td>
&lt;td style="text-align: left">å°†å››ä¸ª INT8 å¤–ç§¯ä¹‹å’Œå­˜å…¥æ¯ä¸ª INT32 å…ƒç´ &lt;/td>
&lt;td style="text-align: left">SMOPA æˆ– SMOPS æˆ– UMOPA æˆ– UMOPSï¼šå¸¦ç¬¦å·æˆ–æ— ç¬¦å·æ•´æ•°å¤–ç§¯å’Œï¼Œå¹¶ç´¯åŠ æˆ–ç´¯å‡ã€‚ä¾‹å¦‚ï¼š &lt;code>UMOPS &amp;lt;ZAda&amp;gt;.S, &amp;lt;Pn&amp;gt;/M, &amp;lt;Pm&amp;gt;/M, &amp;lt;Zn&amp;gt;.B, &amp;lt;Zm&amp;gt;.B&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">INT32&lt;/td>
&lt;td style="text-align: left">INT16, INT16&lt;/td>
&lt;td style="text-align: left">å°†ä¸¤ä¸ª INT16 å¤–ç§¯ä¹‹å’Œå­˜å…¥æ¯ä¸ª INT32 å…ƒç´ &lt;/td>
&lt;td style="text-align: left">SMOPA æˆ– SMOPS æˆ– UMOPA æˆ– UMOPSï¼šå¸¦ç¬¦å·æˆ–æ— ç¬¦å·æ•´æ•°å¤–ç§¯å’Œï¼Œå¹¶ç´¯åŠ æˆ–ç´¯å‡ã€‚ä¾‹å¦‚ï¼š &lt;code>UMOPS &amp;lt;ZAda&amp;gt;.S, &amp;lt;Pn&amp;gt;/M, &amp;lt;Pm&amp;gt;/M, &amp;lt;Zn&amp;gt;.H, &amp;lt;Zm&amp;gt;.H&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">INT64&lt;/td>
&lt;td style="text-align: left">INT16, INT16&lt;/td>
&lt;td style="text-align: left">å¦‚æœå®ç°äº† FEAT_SME_I16I64ï¼Œåˆ™å°†å››ä¸ª INT16 å¤–ç§¯ä¹‹å’Œå­˜å…¥æ¯ä¸ª INT64 å…ƒç´ &lt;/td>
&lt;td style="text-align: left">SMOPA æˆ– SMOPS æˆ– UMOPA æˆ– UMOPSï¼šå¸¦ç¬¦å·æˆ–æ— ç¬¦å·æ•´æ•°å¤–ç§¯å’Œï¼Œå¹¶ç´¯åŠ æˆ–ç´¯å‡ã€‚ä¾‹å¦‚ï¼š &lt;code>UMOPS &amp;lt;ZAda&amp;gt;.D, &amp;lt;Pn&amp;gt;/M, &amp;lt;Pm&amp;gt;/M, &amp;lt;Zn&amp;gt;.H, &amp;lt;Zm&amp;gt;.H&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">FP32&lt;/td>
&lt;td style="text-align: left">BF16, BF16&lt;/td>
&lt;td style="text-align: left">å°†ä¸¤ä¸ª BF16 å¤–ç§¯ä¹‹å’Œå­˜å…¥æ¯ä¸ª FP32 å…ƒç´ &lt;/td>
&lt;td style="text-align: left">BFMOPA æˆ– BFMOPSï¼šBFloat16 å¤–ç§¯å’Œï¼Œå¹¶ç´¯åŠ æˆ–ç´¯å‡ã€‚ä¾‹å¦‚ï¼š &lt;code>BFMOPS &amp;lt;ZAda&amp;gt;.S, &amp;lt;Pn&amp;gt;/M, &amp;lt;Pm&amp;gt;/M, &amp;lt;Zn&amp;gt;.H, &amp;lt;Zm&amp;gt;.H&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">FP32&lt;/td>
&lt;td style="text-align: left">FP16, FP16&lt;/td>
&lt;td style="text-align: left">å°†ä¸¤ä¸ª FP16 å¤–ç§¯ä¹‹å’Œå­˜å…¥æ¯ä¸ª FP32 å…ƒç´ &lt;/td>
&lt;td style="text-align: left">FMOPA æˆ– FMOPSï¼šåŠç²¾åº¦æµ®ç‚¹å¤–ç§¯å’Œï¼Œå¹¶ç´¯åŠ æˆ–ç´¯å‡ã€‚ä¾‹å¦‚ï¼š &lt;code>FMOPS &amp;lt;ZAda&amp;gt;.S, &amp;lt;Pn&amp;gt;/M, &amp;lt;Pm&amp;gt;/M, &amp;lt;Zn&amp;gt;.H, &amp;lt;Zm&amp;gt;.H&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">FP32&lt;/td>
&lt;td style="text-align: left">FP32, FP32&lt;/td>
&lt;td style="text-align: left">ç®€å•çš„ FP32 å¤–ç§¯&lt;/td>
&lt;td style="text-align: left">FMOPA æˆ– FMOPSï¼šæµ®ç‚¹å¤–ç§¯å’Œï¼Œå¹¶ç´¯åŠ æˆ–ç´¯å‡ã€‚ä¾‹å¦‚ï¼š &lt;code>FMOPS &amp;lt;ZAda&amp;gt;.S, &amp;lt;Pn&amp;gt;/M, &amp;lt;Pm&amp;gt;/M, &amp;lt;Zn&amp;gt;.S, &amp;lt;Zm&amp;gt;.S&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">FP64&lt;/td>
&lt;td style="text-align: left">FP64, FP64&lt;/td>
&lt;td style="text-align: left">å¦‚æœå®ç°äº† FEAT_SME_F64F64ï¼Œåˆ™è¿›è¡Œç®€å•çš„ FP64 å¤–ç§¯&lt;/td>
&lt;td style="text-align: left">FMOPA æˆ– FMOPSï¼šæµ®ç‚¹å¤–ç§¯å’Œï¼Œå¹¶ç´¯åŠ æˆ–ç´¯å‡ã€‚ä¾‹å¦‚ï¼š &lt;code>FMOPS &amp;lt;ZAda&amp;gt;.D, &amp;lt;Pn&amp;gt;/M, &amp;lt;Pm&amp;gt;/M, &amp;lt;Zn&amp;gt;.D, &amp;lt;Zm&amp;gt;.D&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4 id="711-fp32-fp64-å¤–ç§¯å¹¶ç´¯åŠ æˆ–ç´¯å‡æŒ‡ä»¤">
&lt;a href="#711-fp32-fp64-%e5%a4%96%e7%a7%af%e5%b9%b6%e7%b4%af%e5%8a%a0%e6%88%96%e7%b4%af%e5%87%8f%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7.1.1 FP32, FP64 å¤–ç§¯å¹¶ç´¯åŠ æˆ–ç´¯å‡æŒ‡ä»¤
&lt;/h4>
&lt;p>é‚£äº›è¾“å…¥å‘é‡å’Œè¾“å‡ºæ•°ç»„æœ‰åŒæ ·æ•°æ®ç±»å‹ï¼ˆFP32ï¼Œ FP64ï¼‰çš„æŒ‡ä»¤ç›¸å¯¹ç®€å•ã€‚&lt;/p>
&lt;p>ä¸‹ä¾‹å±•ç¤ºäº† FP32 ç±»å‹çš„å¤–ç§¯å¹¶ç´¯åŠ æˆ–ç´¯å‡æŒ‡ä»¤ã€‚&lt;/p>
&lt;pre>&lt;code class="language-armasm">FMOPA &amp;lt;ZAda&amp;gt;.S, &amp;lt;Pn&amp;gt;/M, &amp;lt;Pm&amp;gt;/M, &amp;lt;Zn&amp;gt;.S, &amp;lt;Zm&amp;gt;.S
FMOPS &amp;lt;ZAda&amp;gt;.S, &amp;lt;Pn&amp;gt;/M, &amp;lt;Pm&amp;gt;/M, &amp;lt;Zn&amp;gt;.S, &amp;lt;Zm&amp;gt;.S
&lt;/code>&lt;/pre>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_3613751670-667e5f923c64.webp"
alt="FMOPA and FMOPS" width="auto" loading="lazy">
&lt;/figure>
&lt;p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡è®¾ SVL å‘é‡é•¿åº¦ä¸º 128ï¼Œ&lt;code>Zn.S&lt;/code> å’Œ &lt;code>Zm.S&lt;/code> ä¸­å­˜æ”¾äº† 4 ä¸ª FP32 æ•°ç»„æˆçš„å‘é‡ï¼Œæ­¤æŒ‡ä»¤è®¡ç®— &lt;code>Zn.S&lt;/code> å’Œ &lt;code>Zm.S&lt;/code> çš„å¤–ç§¯ï¼Œå¤–ç§¯ç»“æœä¸ºå›¾ä¸­ç°è‰²çš„çŸ©é˜µï¼Œç„¶åå°†æ­¤å¤–ç§¯ç»“æœç´¯åŠ æˆ–ç´¯å‡ &lt;code>ZAda.S&lt;/code> è¿™ä¸ª ZA tile ä¸­åŸæœ‰çš„å€¼ï¼Œå°†ç»“æœå­˜å…¥åŒä¸€ ZA tileã€‚&lt;/p>
&lt;h4 id="712-fp16-bf16-int16-int8-i16i64-ç±»å‹çš„å¤–ç§¯å¹¶ç´¯åŠ æˆ–ç´¯å‡æŒ‡ä»¤">
&lt;a href="#712-fp16-bf16-int16-int8-i16i64-%e7%b1%bb%e5%9e%8b%e7%9a%84%e5%a4%96%e7%a7%af%e5%b9%b6%e7%b4%af%e5%8a%a0%e6%88%96%e7%b4%af%e5%87%8f%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7.1.2 FP16, BF16, INT16, INT8, I16I64 ç±»å‹çš„å¤–ç§¯å¹¶ç´¯åŠ æˆ–ç´¯å‡æŒ‡ä»¤
&lt;/h4>
&lt;p>ç”±äºè¿™äº›æŒ‡ä»¤ä¼šæ‰©å¤§è®¡ç®—ç»“æœæ•°æ®ç±»å‹ï¼Œå› æ­¤è¿™äº›æ“ä½œä¸åƒå‰é¢ FP32ï¼ŒFP64 ç±»å‹æŒ‡ä»¤é‚£ä¹ˆç®€å•æ˜äº†ã€‚&lt;/p>
&lt;ul>
&lt;li>BF16 æŒ‡ä»¤è®¡ç®—ä¸¤ä¸ª BF16 çš„å¤–ç§¯çš„å’Œï¼Œæ‰©å¤§ç»“æœç±»å‹ä¸º FP32, ç„¶åå°†ç»“æœä¸ç›®æ ‡ tile è¿›è¡Œç ´åæ€§ç›¸åŠ æˆ–ç›¸å‡ã€‚&lt;/li>
&lt;li>INT8 æŒ‡ä»¤è®¡ç®—å››ä¸ª INT8 çš„å¤–ç§¯çš„å’Œï¼Œæ‰©å¤§ç»“æœç±»å‹ä¸º INT32ï¼Œç„¶åå°†ç»“æœä¸ç›®æ ‡ tile è¿›è¡Œç ´åæ€§ç›¸åŠ æˆ–ç›¸å‡ã€‚&lt;/li>
&lt;li>INT16 æŒ‡ä»¤è®¡ç®—ä¸¤ä¸ª INT16 çš„å¤–ç§¯çš„å’Œï¼Œæ‰©å¤§ç»“æœç±»å‹ä¸º INT32ï¼Œç„¶åå°†ç»“æœä¸ç›®æ ‡ tile è¿›è¡Œç ´åæ€§ç›¸åŠ æˆ–ç›¸å‡ã€‚&lt;/li>
&lt;li>FP16 æŒ‡ä»¤è®¡ç®—ä¸¤ä¸ª FP16 çš„å¤–ç§¯çš„å’Œï¼Œæ‰©å¤§ç»“æœç±»å‹ä¸º FP32ï¼Œç„¶åå°†ç»“æœä¸ç›®æ ‡ tile è¿›è¡Œç ´åæ€§ç›¸åŠ æˆ–ç›¸å‡ã€‚&lt;/li>
&lt;li>å¦‚æœå®ç°äº† FEAT_SME_I16I64ï¼ŒI16I64 æŒ‡ä»¤è®¡ç®—å››ä¸ª INT16 çš„å¤–ç§¯çš„å’Œï¼Œæ‰©å¤§ç»“æœç±»å‹ä¸º INT64, ç„¶åå°†ç»“æœä¸ç›®æ ‡ tile è¿›è¡Œç ´åæ€§ç›¸åŠ æˆ–ç›¸å‡ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä»¥ä¸‹ä¾‹å­å±•ç¤ºäº† SVL å‘é‡é•¿åº¦ä¸º 128 çš„ INT8 UMOPA æŒ‡ä»¤è¿›è¡Œçš„æ“ä½œï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">UMOPA &amp;lt;ZAda&amp;gt;.S, &amp;lt;Pn&amp;gt;/M, &amp;lt;Pm&amp;gt;/M, &amp;lt;Zn&amp;gt;.B, &amp;lt;Zm&amp;gt;.B
&lt;/code>&lt;/pre>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_1030_Picture6_png-1280x960.webp"
alt="INT8 UMOPA" width="auto" loading="lazy">
&lt;/figure>
&lt;p>æ¯ä¸ªè¾“å…¥å¯„å­˜å™¨ï¼ˆ&lt;code>Zn.B&lt;/code>ã€&lt;code>Zm.B&lt;/code>ï¼‰éƒ½è¢«è§†ä¸ºä¸€ä¸ªåŒ…å« 4x4 å…ƒç´ çš„çŸ©é˜µï¼Œå¯ä»¥çœ‹ä½œæ˜¯ 4 ä¸ªè¿ç»­å…ƒç´ ç»„æˆçš„å—ï¼ˆå¦‚å›¾ä¸­çº¢çº¿æ‰€æ ‡ï¼‰è¢«è½¬ç½®äº†ã€‚&lt;/p>
&lt;p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå› ä¸º SVL å‘é‡é•¿åº¦ä¸º 128-bitï¼š&lt;/p>
&lt;ul>
&lt;li>ç¬¬ä¸€æºå‘é‡ &lt;code>Zn.B&lt;/code> ï¼ŒåŒ…å«ä¸€ä¸ªæ— ç¬¦å· 8-bit æ•´æ•°çš„ 4x4 å­çŸ©é˜µã€‚&lt;/li>
&lt;li>ç¬¬äºŒæºå‘é‡ &lt;code>Zm.B&lt;/code> ï¼ŒåŒ…å«ä¸€ä¸ªæ— ç¬¦å· 8-bit æ•´æ•°çš„ 4x4 å­çŸ©é˜µã€‚&lt;/li>
&lt;li>UMOPA æŒ‡ä»¤è®¡ç®—å‡º 4x4 æ‰©å¤§äº†çš„ 32-bit æ•´æ•°å¤–ç§¯çš„å’Œï¼Œç„¶åç ´åæ€§åœ°ç´¯åŠ ä¸Šç›®æ ‡ tileï¼ˆZAdaï¼‰ä¸­çš„æ•´æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ›´ç¬¼ç»Ÿåœ°è¯´ï¼ŒUMOPA æŒ‡ä»¤æ˜¯å°†ç¬¬ä¸€ä¸ªæºå‘é‡ä¸­çš„å­çŸ©é˜µä¸ç¬¬äºŒä¸ªæºå‘é‡ä¸­çš„å­çŸ©é˜µç›¸ä¹˜ã€‚æ¯ä¸ªæºå‘é‡åŒ…å«ä¸€ä¸ª(SVL/32) x 4 çš„æ— ç¬¦å· 8-bit æ•´æ•°çš„å­çŸ©é˜µã€‚ç„¶åå°†å¾—åˆ°çš„ (SVL/32) x (SVL/32)æ‰©å¤§äº†çš„ 32-bit æ•´æ•°å¤–ç§¯å’Œç ´åæ€§åœ°åŠ ä¸Šä¸€ä¸ª 32-bit æ•´æ•°ç›®æ ‡ tileã€‚&lt;/p>
&lt;p>ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº† SVL ä¸º 128-bit çš„ BF16 BFMOPA è¿›è¡Œçš„æ“ä½œï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">BFMOPA &amp;lt;ZAda&amp;gt;.S, &amp;lt;Pn&amp;gt;/M, &amp;lt;Pm&amp;gt;/M, &amp;lt;Zn&amp;gt;.H, &amp;lt;Zm&amp;gt;.H
&lt;/code>&lt;/pre>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_6545_Picture7_png-1280x960.webp"
alt="BF16 BFMOPA" width="auto" loading="lazy">
&lt;/figure>
&lt;p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå› ä¸º SVL å‘é‡é•¿åº¦ä¸º 128-bitï¼š&lt;/p>
&lt;ul>
&lt;li>ç¬¬ä¸€æºå‘é‡ &lt;code>Zn.H&lt;/code> ï¼ŒåŒ…å«ä¸€ä¸ª BF16 æ•´æ•°çš„ 4x2 å­çŸ©é˜µï¼Œå®ƒè¢«æ‰©å¤§æˆå•ç²¾åº¦æµ®ç‚¹æ•°ã€‚&lt;/li>
&lt;li>ç¬¬äºŒæºå‘é‡ &lt;code>Zm.H&lt;/code> ï¼ŒåŒ…å«ä¸€ä¸ª BF16 æ•´æ•°çš„ 2x4 å­çŸ©é˜µï¼Œå®ƒè¢«æ‰©å¤§æˆå•ç²¾åº¦æµ®ç‚¹æ•°ã€‚&lt;/li>
&lt;li>BMOPA æŒ‡ä»¤è®¡ç®—å‡º 4x4 å•ç²¾åº¦å¤–ç§¯çš„å’Œï¼Œç„¶åç ´åæ€§åœ°ç´¯åŠ ä¸Šç›®æ ‡ tileï¼ˆZAdaï¼‰ä¸­çš„å•ç²¾åº¦æµ®ç‚¹æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ›´ç¬¼ç»Ÿåœ°è¯´ï¼ŒBFMOPA æŒ‡ä»¤æ‰©å¤§äº†å­˜æ”¾åœ¨ç¬¬ä¸€æºå‘é‡é‡Œçš„(SVL/32) x2 BF16 å­çŸ©é˜µçš„ç±»å‹ä¸ºå•ç²¾åº¦ï¼Œæ‰©å¤§äº†å­˜æ”¾åœ¨ç¬¬äºŒæºå‘é‡é‡Œçš„ 2x (SVL/32) BF16 å­çŸ©é˜µçš„ç±»å‹ä¸ºå•ç²¾åº¦ï¼Œå°†è¿™ä¸¤ä¸ªå­çŸ©é˜µç›¸ä¹˜ã€‚ç„¶åå°†å¾—åˆ°çš„ (SVL/32) x (SVL/32)å•ç²¾åº¦å¤–ç§¯å’Œç ´åæ€§åœ°åŠ ä¸Šä¸€ä¸ªå•ç²¾åº¦ç›®æ ‡ tileã€‚&lt;/p>
&lt;p>ä»¥ä¸‹è¡¨æ ¼æ˜¾ç¤ºäº†å‡ ç§æ•°æ®ç±»å‹å’Œ SVL é•¿åº¦çš„ä¸€æ¡å¤–ç§¯å¹¶ç´¯åŠ æˆ–ç´¯å‡æŒ‡ä»¤æ‰€åšçš„å¯¹åº”æ•°æ®ç±»å‹çš„ MAC(ä¹˜ç´¯åŠ )æ•°é‡ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">&lt;/th>
&lt;th style="text-align: left">128-bit&lt;/th>
&lt;th style="text-align: left">256-bit&lt;/th>
&lt;th style="text-align: left">512-bit&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">FP32&lt;/td>
&lt;td style="text-align: left">16&lt;/td>
&lt;td style="text-align: left">64&lt;/td>
&lt;td style="text-align: left">256&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">FP64&lt;/td>
&lt;td style="text-align: left">4&lt;/td>
&lt;td style="text-align: left">16&lt;/td>
&lt;td style="text-align: left">64&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">INT8&lt;/td>
&lt;td style="text-align: left">64&lt;/td>
&lt;td style="text-align: left">256&lt;/td>
&lt;td style="text-align: left">1024&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">INT16&lt;/td>
&lt;td style="text-align: left">32&lt;/td>
&lt;td style="text-align: left">128&lt;/td>
&lt;td style="text-align: left">512&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">BF16&lt;/td>
&lt;td style="text-align: left">32&lt;/td>
&lt;td style="text-align: left">128&lt;/td>
&lt;td style="text-align: left">512&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">FP16&lt;/td>
&lt;td style="text-align: left">32&lt;/td>
&lt;td style="text-align: left">128&lt;/td>
&lt;td style="text-align: left">512&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="72-å¸¦-predication-çš„-sme-æŒ‡ä»¤">
&lt;a href="#72-%e5%b8%a6-predication-%e7%9a%84-sme-%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7.2 å¸¦ Predication çš„ SME æŒ‡ä»¤
&lt;/h3>
&lt;p>æ¯ä¸ªæºå‘é‡éƒ½å¯ä»¥è¢«å…¶ç›¸åº”çš„æ§åˆ¶ predicate å¯„å­˜å™¨ç‹¬ç«‹åœ° predicate:&lt;/p>
&lt;ul>
&lt;li>å¤–ç§¯å¹¶ç´¯åŠ æˆ–ç´¯å‡æŒ‡ä»¤ä½¿ç”¨ Pn/M å’Œ Pn/M (æ²¡æœ‰/Z å½¢å¼)ï¼šInactive çš„æºå…ƒç´ è¢«å½“æˆå…·æœ‰ 0 å€¼ã€‚&lt;/li>
&lt;li>Slice move æŒ‡ä»¤ä½¿ç”¨ Pg/M: ç›®æ ‡ slice ä¸­ Inactive çš„å…ƒç´ ä¿æŒä¸å˜ã€‚&lt;/li>
&lt;li>Tile slice load æŒ‡ä»¤ä½¿ç”¨ Pg/Z: ç›®æ ‡ tile slice ä¸­çš„ Inactive å…ƒç´ è¢«è®¾ç½®ä¸º 0ã€‚&lt;/li>
&lt;li>Tile slice store æŒ‡ä»¤ä½¿ç”¨ Pg: Inactive çš„å…ƒç´ ä¸ä¼šå†™å…¥å†…å­˜ã€‚&lt;/li>
&lt;/ul>
&lt;p>Predication è®©çŸ©é˜µçš„ç»´æ•°ä¸æ˜¯ SVL çš„å€æ•°çš„æƒ…å†µæ›´å®¹æ˜“å¤„ç†ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ä¸‹å›¾çš„æŒ‡ä»¤ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_2656_Picture12_png-600x0.webp"
alt="SME predication" width="auto" loading="lazy">
&lt;/figure>
&lt;p>è¾“å…¥å‘é‡ &lt;code>Z0&lt;/code> è¢« &lt;code>P0&lt;/code> predicateï¼Œ&lt;code>Z1&lt;/code> è¢« &lt;code>P1&lt;/code> predicateã€‚&lt;/p>
&lt;p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼š&lt;/p>
&lt;ul>
&lt;li>SVL å‘é‡é•¿åº¦ä¸º 512-bitã€‚&lt;/li>
&lt;li>Z å¯„å­˜å™¨ä¸­åŒ…å« 16 ä¸ª FP32 æ•°ç»„æˆçš„å‘é‡ã€‚&lt;/li>
&lt;li>&lt;code>P0&lt;/code> ä¸­æœ€åä¸¤ä¸ªå…ƒç´ æ˜¯ inactive çš„ã€‚&lt;/li>
&lt;li>&lt;code>P1&lt;/code> ä¸­æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ inactive çš„ã€‚&lt;/li>
&lt;/ul>
&lt;p>è¿™æ¡æŒ‡ä»¤æ›´æ–° &lt;code>ZA0.S&lt;/code> ä¸­ (16-2) x (16-1) ä¸ª FP32 å…ƒç´ ï¼Œå› ä¸ºä½¿ç”¨äº† &lt;code>Pn/M&lt;/code> , &lt;code>ZA0.S&lt;/code> ä¸­å‰©ä¸‹çš„å…ƒç´ ä¿æŒä¸å˜ã€‚&lt;/p>
&lt;p>ä¸‹å›¾å±•ç¤ºäº†æ›´å¤šçš„ predicated å¤–ç§¯å¹¶ç´¯åŠ æˆ–ç´¯å‡çš„ä¾‹å­ã€‚å›¾ä¸­è¢«åˆ’çº¿çš„æ–‡å­—è¡¨ç¤ºè¢« inactive predicate å…ƒç´ å½±å“çš„è®¡ç®—éƒ¨åˆ†ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_2072_Picture14_png-1280x960.webp"
alt="SME predication FMOPA" width="auto" loading="lazy">
&lt;/figure>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_3513_Picture16_png-1280x960.webp"
alt="SME predication UMOPA" width="auto" loading="lazy">
&lt;/figure>
&lt;h3 id="73-za-tile-ä¸ä¸€ä¸ª-z-å‘é‡çš„åŠ è¿ç®—">
&lt;a href="#73-za-tile-%e4%b8%8e%e4%b8%80%e4%b8%aa-z-%e5%90%91%e9%87%8f%e7%9a%84%e5%8a%a0%e8%bf%90%e7%ae%97" class="header-anchor">#&lt;/a>
7.3 ZA tile ä¸ä¸€ä¸ª Z å‘é‡çš„åŠ è¿ç®—
&lt;/h3>
&lt;p>SME åŒ…æ‹¬ ZA tile çš„è¡Œæˆ–åˆ—éƒ½åŠ ä¸Šä¸€ä¸ªå‘é‡çš„æŒ‡ä»¤ï¼Œè¿™äº›æŒ‡ä»¤ä¹Ÿæœ‰ predication çš„æ”¯æŒã€‚&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">æŒ‡ä»¤&lt;/th>
&lt;th style="text-align: left">è¯´æ˜&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">ADDHA&lt;/td>
&lt;td style="text-align: left">å°†æºå‘é‡æ·»åŠ åˆ° ZA tile çš„æ¯ä¸ªæ°´å¹³ slice ä¸Š&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">ADDVA&lt;/td>
&lt;td style="text-align: left">å°†æºå‘é‡æ·»åŠ åˆ° ZA tile çš„æ¯ä¸ªå‚ç›´ slice ä¸Š&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>ä¾‹å¦‚ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">ADDHA ZA0.S, P0/M, P1/M, Z1.S
&lt;/code>&lt;/pre>
&lt;p>å°†æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_ARM2799_9_Scalable_Matrix_p2_png-1200x0.webp"
alt="SME ADDHA" width="auto" loading="lazy">
&lt;/figure>
&lt;p>è¿™ä¸ª ADDHA æŒ‡ä»¤å°†æºå‘é‡ Z1 ä¸­çš„æ¯ä¸ªå…ƒç´ åŠ ä¸Š ZA0.S tile æ¯ä¸€æ°´å¹³ slice çš„ç›¸åº” active å…ƒç´ ã€‚&lt;/p>
&lt;p>Tile ä¸­å…ƒç´ è¢«ä¸€å¯¹ governing predicate è¿›è¡Œ predicateã€‚ ä¸€ä¸ªæ°´å¹³ slice ä¸­çš„ä¸€ä¸ªå…ƒç´ åœ¨ä¸‹é¢æƒ…å†µä¸‹å¯ä»¥è®¤ä¸ºæ˜¯ activeï¼š&lt;/p>
&lt;ul>
&lt;li>å®ƒåœ¨ç¬¬äºŒ governing predicate å¯¹åº”çš„å…ƒç´ æ˜¯ TRUE, å¹¶ä¸”&lt;/li>
&lt;li>å®ƒåœ¨ç¬¬ä¸€ governing predicate å¯¹åº”çš„æ°´å¹³ slice è¡Œå·ä¹Ÿä¸º TRUE,ç›®æ ‡ tile ä¸­ inactive å…ƒç´ ä¿æŒä¸å˜ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="74-tile-load-store-move-æŒ‡ä»¤">
&lt;a href="#74-tile-load-store-move-%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7.4 Tile load, store, move æŒ‡ä»¤
&lt;/h3>
&lt;p>SME tile load, store, move æŒ‡ä»¤å¯ä»¥ï¼š&lt;/p>
&lt;ul>
&lt;li>ä»å†…å­˜è¯»å–æ•°æ®ï¼Œæ”¾å…¥ ZA tile çš„è¡Œæˆ–åˆ—&lt;/li>
&lt;li>å°† ZA tile çš„è¡Œæˆ–åˆ—å†™å…¥å†…å­˜&lt;/li>
&lt;li>å°† ZA tile çš„è¡Œç§»åŠ¨åˆ° SVE Z å‘é‡å¯„å­˜å™¨&lt;/li>
&lt;li>å°† SVE Z å‘é‡å¯„å­˜å™¨ç§»åŠ¨åˆ° ZA tile è¡Œæˆ–åˆ—&lt;/li>
&lt;/ul>
&lt;h4 id="741-tile-slice-load-å’Œ-store-æŒ‡ä»¤">
&lt;a href="#741-tile-slice-load-%e5%92%8c-store-%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7.4.1 Tile slice load å’Œ store æŒ‡ä»¤
&lt;/h4>
&lt;p>LD1Bã€LD1Hã€LD1Sã€LD1D å’Œ LD1Q æŒ‡ä»¤åˆ†åˆ«å°†è¿ç»­å†…å­˜å€¼åŠ è½½åˆ°å…·æœ‰ 8-bitã€16-bitã€32-bitã€64-bit æˆ– 128-bit å…ƒç´ çš„ ZA tile slice ä¸­ã€‚&lt;/p>
&lt;p>ST1Bã€ST1Hã€ST1Sã€ST1D å’Œ ST1Q æŒ‡ä»¤åˆ†åˆ«å°†åŒ…å« 8-bitã€16-bitã€32-bitã€64-bit æˆ– 128-bit å…ƒç´ çš„ ZA tile slice å­˜å‚¨åˆ°è¿ç»­å†…å­˜ä¸­ã€‚&lt;/p>
&lt;p>è¿™äº›æŒ‡ä»¤ä¹Ÿæ”¯æŒ predication ï¼Œä¾‹å¦‚ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">LD1B ZA0H.B[W0, #imm], P0/Z, [X1, X2]
&lt;/code>&lt;/pre>
&lt;p>æ­¤ LD1B æŒ‡ä»¤æ‰§è¡Œ predicated çš„è¿ç»­ byte è¯»å–ï¼Œå®ƒä»åœ°å€ä¸º(X1+X2)çš„å†…å­˜è¯»å–æ•°æ®åˆ° ZA0 ä¸­è¡Œå·ä¸ºï¼ˆW0+immï¼‰çš„è¿™ä¸ªæ°´å¹³ tile slice ä¸­ã€‚ç›®æ ‡ tile slice ä¸­ Inactive çš„å…ƒç´ è¢«è®¾ç½®ä¸º 0ã€‚&lt;/p>
&lt;pre>&lt;code class="language-armasm">ST1H ZA1V.H[W0, #imm], P2, [X1, X2, LSL #1]
&lt;/code>&lt;/pre>
&lt;p>æ­¤ ST1H æŒ‡ä»¤æ‰§è¡Œ predicated è¿ç»­ halfword çš„å­˜æ“ä½œï¼Œå®ƒå°† ZA1 ä¸­åˆ—å·ä¸ºï¼ˆW0+immï¼‰çš„å‚ç›´ tile slice å­˜åˆ°åœ°å€ä¸ºï¼ˆX1+X2*2ï¼‰çš„å†…å­˜ï¼Œ tile slice ä¸­ Inactive çš„å…ƒç´ ä¸å†™å…¥å†…å­˜ã€‚&lt;/p>
&lt;h4 id="742-tile-slice-move-æŒ‡ä»¤">
&lt;a href="#742-tile-slice-move-%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7.4.2 Tile slice move æŒ‡ä»¤
&lt;/h4>
&lt;p>MOV æŒ‡ä»¤ï¼ˆMOVA æŒ‡ä»¤çš„åˆ«åï¼‰å°†ä¸€ä¸ª Z å‘é‡å¯„å­˜å™¨çš„å€¼ç§»åŠ¨åˆ°ä¸€ä¸ª ZA tile sliceï¼Œæˆ–å°†ä¸€ä¸ª ZA tile slice ä¸­çš„å€¼ç§»åŠ¨åˆ°ä¸€ä¸ª Z å‘é‡å¯„å­˜å™¨ã€‚è¿™æ¡æŒ‡ä»¤æ“ä½œå¸¦æŒ‡å®šå…ƒç´ å¤§å°çš„ ZA tile çš„å•ä¸ªæ°´å¹³æˆ–å‚ç›´ tile sliceã€‚ Slice çš„è¡Œå·/åˆ—å·ç”± slice çš„æ£€ç´¢å¯„å­˜å™¨åŠ ä¸Šç«‹å³æ•°åç§»æŒ‡å®šã€‚ç›®æ ‡ slice ä¸­ Inactive çš„å…ƒç´ ä¿æŒä¸å˜ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">MOV ZA0H.B[W0, #imm], P0/M, Z0.B
&lt;/code>&lt;/pre>
&lt;p>æˆ–&lt;/p>
&lt;pre>&lt;code class="language-armasm">MOVA ZA0H.B[W0, #imm], P0/M, Z0.B
&lt;/code>&lt;/pre>
&lt;p>æ­¤æŒ‡ä»¤å°†å‘é‡å¯„å­˜å™¨ &lt;code>Z0.B&lt;/code> ä¸­çš„å€¼ç§»åŠ¨åˆ° &lt;code>ZA0H.B[W0,#imm]&lt;/code> è¿™ä¸ªæ°´å¹³ ZA tile slice ä¸­ï¼Œä½¿ç”¨ &lt;code>P0&lt;/code> ä½œä¸º predication å¯„å­˜å™¨ã€‚ç›®æ ‡ tile slice ä¸­ Inactive çš„å…ƒç´ ä¿æŒä¸å˜ã€‚&lt;/p>
&lt;h3 id="75-za-array-vector-loadstore-æŒ‡ä»¤">
&lt;a href="#75-za-array-vector-loadstore-%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7.5 ZA array vector load/store æŒ‡ä»¤
&lt;/h3>
&lt;p>SME LDR æŒ‡ä»¤ä»å†…å­˜è¯»å–æ•°æ®åˆ°ä¸€ä¸ª ZA array å‘é‡ï¼ŒSME STR æŒ‡ä»¤å°†ä¸€ä¸ª ZA array å‘é‡ä¸­çš„å€¼å­˜å…¥å†…å­˜ã€‚
è¿™äº›æŒ‡ä»¤æ˜¯ä¸å¸¦ predication åŠŸèƒ½çš„ã€‚å®ƒä»¬ä¸»è¦æ˜¯ä¸ºäº†è½¯ä»¶çš„ context switching æ—¶å¯¹ ZA storage è¿›è¡Œ save/restoreã€‚SME LDR/STR æŒ‡ä»¤ä¹Ÿå¯ä»¥åœ¨ Non-streaming SVE æ¨¡å¼ä¸‹ï¼Œå½“ PSTATE.ZA ä½¿èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚
ä¾‹å¦‚ï¼Œä¸‹é¢çš„ STR æŒ‡ä»¤çš„ ZA array å‘é‡æ˜¯ç”±ä¸€ä¸ªå‘é‡é€‰æ‹©å¯„å­˜å™¨ Wvï¼ˆæ ‡é‡å¯„å­˜å™¨ Wï¼‰åŠ ä¸Šå¯é€‰çš„ç«‹å³æ•°ï¼ˆWv+Immï¼‰æŒ‡å®šã€‚è®¿é—®å†…å­˜çš„åœ°å€ä¸ºï¼šä¸€ä¸ªæ ‡é‡å¯„å­˜å™¨ä½œä¸º baseï¼ŒåŠ ä¸Šç›¸åŒçš„å¯é€‰ç«‹å³æ•°åç§»ä¹˜ä»¥å½“å‰å‘é‡é•¿åº¦ byte æ•°ã€‚&lt;/p>
&lt;pre>&lt;code class="language-armasm">STR ZA[&amp;lt;Wv&amp;gt;, &amp;lt;imm&amp;gt;], [&amp;lt;Xn|SP&amp;gt;{, #&amp;lt;imm&amp;gt;, MUL VL}]
&lt;/code>&lt;/pre>
&lt;h3 id="76-za-tile-æ¸…é›¶æŒ‡ä»¤">
&lt;a href="#76-za-tile-%e6%b8%85%e9%9b%b6%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7.6 ZA tile æ¸…é›¶æŒ‡ä»¤
&lt;/h3>
&lt;p>SME ZERO æŒ‡ä»¤å¯ä»¥æ¸…é›¶ä¸€ç»„ 64-bit ZA tile:&lt;/p>
&lt;pre>&lt;code class="language-armasm">ZERO { &amp;lt;mask&amp;gt;}
&lt;/code>&lt;/pre>
&lt;p>ZERO æŒ‡ä»¤å¯ä»¥æ¸…é›¶å¤šåˆ° 8 ä¸ªåä¸º &lt;code>ZA0.D&lt;/code> åˆ° &lt;code>ZA8.D&lt;/code> çš„ ZA tileï¼Œé‚£äº› tile è¦æ¸…é›¶ç”±æŒ‡ä»¤ä¸­çš„ mask æŒ‡å®šï¼Œå‰©ä¸‹çš„å…¶ä»– tile ä¿æŒä¸å˜ã€‚&lt;/p>
&lt;p>è¿™æ¡æŒ‡ä»¤ä¹Ÿå¯ä»¥åœ¨ Non-streaming SVE æ¨¡å¼ï¼Œå½“ &lt;code>PSTATE.ZA&lt;/code> å¼€å¯çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚&lt;/p>
&lt;p>å¦‚æœè¦æ¸…é›¶æ•´ä¸ª ZA array, å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæŒ‡ä»¤åˆ«åï¼Œ&lt;code>ZERO {ZA}&lt;/code> ã€‚&lt;/p>
&lt;h3 id="77-æ–°çš„-sve2-æŒ‡ä»¤">
&lt;a href="#77-%e6%96%b0%e7%9a%84-sve2-%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7.7 æ–°çš„ SVE2 æŒ‡ä»¤
&lt;/h3>
&lt;p>SME æ„æ¶æ‰©å±•åŠ å…¥äº†ä¸€äº›æ–°çš„ SVE2 æŒ‡ä»¤ï¼Œè¿™äº›æŒ‡ä»¤ä¹Ÿå¯ä»¥åœ¨ PE å®ç°äº† SVE2, å¤„äº Non-streaming SVE æ¨¡å¼æ—¶ä½¿ç”¨ã€‚è¿™äº›æŒ‡ä»¤åŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>é€‰æ‹©ä¸€ä¸ª predicate å¯„å­˜å™¨æˆ–æ˜¯ all-false çš„ Predicate select æŒ‡ä»¤&lt;/li>
&lt;li>ç¿»è½¬ï¼ˆReverseï¼‰64-bit double word å…ƒç´ çš„æŒ‡ä»¤&lt;/li>
&lt;li>æœ‰ç¬¦å·/æ— ç¬¦å·é’³ä½ä¸ºæ›´å°/æ›´å¤§å€¼å‘é‡çš„æŒ‡ä»¤&lt;/li>
&lt;/ul>
&lt;p>ä¸‹é¢ä»‹ç»ä»¥ä¸‹ Predicate select æŒ‡ä»¤ã€‚&lt;/p>
&lt;h4 id="771-psel-æŒ‡ä»¤">
&lt;a href="#771-psel-%e6%8c%87%e4%bb%a4" class="header-anchor">#&lt;/a>
7.7.1 PSEL æŒ‡ä»¤
&lt;/h4>
&lt;p>PSEL æŒ‡ä»¤é€‰æ‹©ä¸€ä¸ª predicate å¯„å­˜å™¨å¤åˆ¶åˆ°åˆ°ç›®æ ‡ predicate å¯„å­˜å™¨æˆ–è€…å°†ç›®æ ‡ predicate å¯„å­˜å™¨è®¾ç½®ä¸ºå…¨é›¶ï¼ˆall-falseï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">PSEL &amp;lt;Pd&amp;gt;, &amp;lt;Pn&amp;gt;, &amp;lt;Pm&amp;gt;.&amp;lt;T&amp;gt;[&amp;lt;Wv&amp;gt;, &amp;lt;imm&amp;gt;]
&lt;/code>&lt;/pre>
&lt;p>å¦‚æœæŒ‡ä»¤ä¸­ Pm å¯„å­˜å™¨ä¸­å¯¹åº”ç´¢å¼•ä½ç½®çš„å…ƒç´ ä¸º True, è¿™æ¡æŒ‡ä»¤å°† Pn å¯„å­˜å™¨çš„å†…å®¹æ”¾åˆ°ç›®æ ‡å¯„å­˜å™¨ Pd ä¸­, å¦åˆ™è®¾ç½® Pd å¯„å­˜å™¨çš„å€¼å…¨éƒ¨ä¸º Falseã€‚
ä¾‹å¦‚ä»¥ä¸‹æŒ‡ä»¤ï¼Œå‡è®¾ W12 ä¸º 0ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">PSEL P0, P1, P2.B[W12, #0]
&lt;/code>&lt;/pre>
&lt;p>&lt;code>P2.B[W12 + 0]&lt;/code> ï¼Œå³ &lt;code>P2.B[0]&lt;/code> ä¸º False, å› æ­¤ç›®æ ‡å¯„å­˜å™¨ P0 è¢«å…¨éƒ¨è®¾ç½®ä¸º 0ï¼ˆall-falseï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_4401_Picture10_png-1280x960.webp"
alt="SME PSEL" width="auto" loading="lazy">
&lt;/figure>
&lt;p>ç°åœ¨çœ‹çœ‹å¦‚ä¸‹æŒ‡ä»¤ï¼Œä»ç„¶å‡è®¾ W12 ä¸º 0 ï¼Œä½†è¿™æ¬¡ç«‹å³æ•°åç§»é‡ï¼ˆå°±æ˜¯ç¡¬ç¼–ç çš„åç§»é‡ï¼‰ä¸º 1ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">PSEL P0, P1, P2.B[W12, #1]
&lt;/code>&lt;/pre>
&lt;p>&lt;code>P2.B[W12 + 1]&lt;/code> ï¼Œå³ &lt;code>P2.B[1]&lt;/code> ä¸º True, å› æ­¤é€‰æ‹©å°† P1 å¯„å­˜å™¨çš„å€¼å¤åˆ¶åˆ°ç›®æ ‡å¯„å­˜å™¨ P0ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-16_0116_Picture11_png-1280x960.webp"
alt="SME PSEL" width="auto" loading="lazy">
&lt;/figure>
&lt;h2 id="å‚è€ƒæ–‡çŒ®">
&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae" class="header-anchor">#&lt;/a>
å‚è€ƒæ–‡çŒ®
&lt;/h2>
&lt;ul>
&lt;li>&lt;a class="link" href="https://community.arm.com/arm-community-blogs/b/architectures-and-processors-blog/posts/arm-scalable-matrix-extension-introduction" target="_blank" rel="noopener" >Arm Scalable Matrix Extension (SME) Introduction
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/li>
&lt;li>&lt;a class="link" href="https://community.arm.com/arm-community-blogs/b/architectures-and-processors-blog/posts/arm-scalable-matrix-extension-introduction-p2" target="_blank" rel="noopener" >Arm Scalable Matrix Extension (SME) Instructions
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/li>
&lt;/ul></description></item><item><title>Arm æ€§èƒ½ä¼˜åŒ–ï¼šå¯ä¼¸ç¼©å‘é‡æ‰©å±• SVE</title><link>https://cuterwrite.top/p/arm-sve-for-performance/</link><pubDate>Sun, 11 Aug 2024 02:13:00 +0000</pubDate><guid>https://cuterwrite.top/p/arm-sve-for-performance/</guid><description>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-29_117622464_p0_master1200.webp" alt="Featured image of post Arm æ€§èƒ½ä¼˜åŒ–ï¼šå¯ä¼¸ç¼©å‘é‡æ‰©å±• SVE" />&lt;h1 id="arm-æ€§èƒ½ä¼˜åŒ–å¯ä¼¸ç¼©å‘é‡æ‰©å±•-sve">
&lt;a href="#arm-%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%8f%af%e4%bc%b8%e7%bc%a9%e5%90%91%e9%87%8f%e6%89%a9%e5%b1%95-sve" class="header-anchor">#&lt;/a>
Arm æ€§èƒ½ä¼˜åŒ–ï¼šå¯ä¼¸ç¼©å‘é‡æ‰©å±• SVE
&lt;/h1>
&lt;h2 id="1-sve-ä»‹ç»">
&lt;a href="#1-sve-%e4%bb%8b%e7%bb%8d" class="header-anchor">#&lt;/a>
1. SVE ä»‹ç»
&lt;/h2>
&lt;p>ç»§å›ºå®š 128 ä½å‘é‡é•¿åº¦æŒ‡ä»¤é›†çš„ Neon æ¶æ„æ‰©å±•ä¹‹åï¼ŒArm è®¾è®¡äº†å¯ä¼¸ç¼©å‘é‡æ‰©å±• (SVE) ä½œä¸º AArch64 çš„ä¸‹ä¸€ä»£ SIMD æ‰©å±•ã€‚SVE å¼•å…¥å¯ä¼¸ç¼©æ¦‚å¿µï¼Œå…è®¸çµæ´»çš„å‘é‡é•¿åº¦å®ç°ï¼Œå¹¶åœ¨ CPU å®ç°ä¸­æä¾›ä¸€ç³»åˆ—å¯èƒ½çš„å€¼ã€‚å‘é‡é•¿åº¦å¯ä»¥ä»æœ€å° 128 ä½åˆ°æœ€å¤§ 2048 ä½ä¸ç­‰ï¼Œä»¥ 128 ä½ä¸ºå¢é‡ã€‚&lt;strong>SVE è®¾è®¡ä¿è¯ç›¸åŒçš„åº”ç”¨ç¨‹åºå¯ä»¥åœ¨æ”¯æŒ SVE çš„ä¸åŒå®ç°ä¸Šè¿è¡Œï¼Œè€Œæ— éœ€é‡æ–°ç¼–è¯‘ä»£ç &lt;/strong>ã€‚SVE æé«˜äº†è¯¥æ¶æ„å¯¹é«˜æ€§èƒ½è®¡ç®— (HPC) å’Œæœºå™¨å­¦ä¹  (ML) åº”ç”¨ç¨‹åºçš„é€‚ç”¨æ€§ï¼Œè¿™äº›åº”ç”¨ç¨‹åºéœ€è¦éå¸¸å¤§é‡çš„æ•°æ®å¤„ç†ã€‚SVE2 æ˜¯ SVE å’Œ Neon çš„è¶…é›†ã€‚SVE2 å…è®¸åœ¨æ•°æ®çº§å¹¶è¡Œä¸­ä½¿ç”¨æ›´å¤šåŠŸèƒ½åŸŸã€‚SVE2 ç»§æ‰¿äº† SVE çš„æ¦‚å¿µã€å‘é‡å¯„å­˜å™¨å’Œæ“ä½œåŸç†ã€‚SVE å’Œ SVE2 å®šä¹‰äº† 32 ä¸ªå¯ä¼¸ç¼©å‘é‡å¯„å­˜å™¨ã€‚èŠ¯ç‰‡åˆä½œä¼™ä¼´å¯ä»¥é€‰æ‹©åˆé€‚çš„å‘é‡é•¿åº¦è®¾è®¡å®ç°ï¼Œç¡¬ä»¶å¯åœ¨ 128 ä½åˆ° 2048 ä½ä¹‹é—´ï¼ˆä»¥ 128 ä½ä¸ºå¢é‡ï¼‰å˜åŒ–ã€‚SVE å’Œ SVE2 çš„ä¼˜åŠ¿åœ¨äºï¼Œåªæœ‰ä¸€ä¸ªå‘é‡æŒ‡ä»¤é›†ä½¿ç”¨å¯ä¼¸ç¼©å˜é‡ã€‚&lt;/p>
&lt;p>SVE è®¾è®¡ç†å¿µä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿç¼–å†™å’Œæ„å»ºä¸€æ¬¡è½¯ä»¶ï¼Œç„¶ååœ¨å…·æœ‰å„ç§ SVE å‘é‡é•¿åº¦å®ç°çš„ä¸åŒ AArch64 ç¡¬ä»¶ä¸Šè¿è¡Œç›¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚äºŒè¿›åˆ¶æ–‡ä»¶çš„å¯ç§»æ¤æ€§æ„å‘³ç€å¼€å‘äººå‘˜ä¸å¿…çŸ¥é“å…¶ç³»ç»Ÿçš„å‘é‡é•¿åº¦å®ç°ã€‚æ¶ˆé™¤äº†é‡å»ºäºŒè¿›åˆ¶æ–‡ä»¶çš„éœ€æ±‚ï¼Œä½¿è½¯ä»¶æ›´å®¹æ˜“ç§»æ¤ã€‚é™¤äº†å¯ä¼¸ç¼©å‘é‡ä¹‹å¤–ï¼ŒSVE å’Œ SVE2 è¿˜åŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>per-lane predication&lt;/li>
&lt;li>Gather Load/Scatter Store&lt;/li>
&lt;li>æ¨æµ‹æ€§å‘é‡åŒ–&lt;/li>
&lt;/ul>
&lt;p>è¿™äº›ç‰¹æ€§æœ‰åŠ©äºåœ¨å¤„ç†å¤§å‹æ•°æ®é›†æ—¶å¯¹å¾ªç¯è¿›è¡Œå‘é‡åŒ–å’Œä¼˜åŒ–ã€‚&lt;/p>
&lt;p>SVE2 å’Œ SVE çš„ä¸»è¦åŒºåˆ«åœ¨äºæŒ‡ä»¤é›†çš„åŠŸèƒ½è¦†ç›–èŒƒå›´ã€‚SVE ä¸“ä¸º HPC å’Œ ML åº”ç”¨è€Œè®¾è®¡ã€‚SVE2 æ‰©å±•äº† SVE æŒ‡ä»¤é›†ï¼Œä½¿å…¶èƒ½å¤ŸåŠ é€Ÿ HPC å’Œ ML ä»¥å¤–é¢†åŸŸçš„æ•°æ®å¤„ç†ã€‚SVE2 æŒ‡ä»¤é›†è¿˜å¯ä»¥åŠ é€Ÿä»¥ä¸‹åº”ç”¨ä¸­ä½¿ç”¨çš„å¸¸è§ç®—æ³•ï¼š&lt;/p>
&lt;ul>
&lt;li>è®¡ç®—æœºè§†è§‰&lt;/li>
&lt;li>å¤šåª’ä½“&lt;/li>
&lt;li>LTE åŸºå¤„ç†&lt;/li>
&lt;li>åŸºå› ç»„å­¦&lt;/li>
&lt;li>å†…å­˜æ•°æ®åº“&lt;/li>
&lt;li>Web æœåŠ¡&lt;/li>
&lt;li>é€šç”¨è½¯ä»¶&lt;/li>
&lt;/ul>
&lt;p>SVE å’Œ SVE2 éƒ½æ”¯æŒæ”¶é›†å’Œå¤„ç†å¤§é‡æ•°æ®ã€‚SVE å’Œ SVE2 ä¸æ˜¯ Neon æŒ‡ä»¤é›†çš„æ‰©å±•ã€‚ç›¸åï¼ŒSVE å’Œ SVE2 ç»è¿‡é‡æ–°è®¾è®¡ï¼Œä»¥æä¾›æ¯” Neon æ›´å¥½çš„æ•°æ®å¹¶è¡Œæ€§ã€‚ä½†æ˜¯ï¼ŒSVE å’Œ SVE2 çš„ç¡¬ä»¶é€»è¾‘è¦†ç›–äº† Neon ç¡¬ä»¶çš„å®ç°ã€‚å½“å¾®æ¶æ„æ”¯æŒ SVE æˆ– SVE2 æ—¶ï¼Œå®ƒä¹Ÿæ”¯æŒ Neonã€‚è¦ä½¿ç”¨ SVE å’Œ SVE2ï¼Œåœ¨è¯¥å¾®æ¶æ„ä¸Šè¿è¡Œçš„è½¯ä»¶å¿…é¡»é¦–å…ˆæ”¯æŒ Neonã€‚&lt;/p>
&lt;h2 id="2-sve-æ¶æ„åŸºç¡€">
&lt;a href="#2-sve-%e6%9e%b6%e6%9e%84%e5%9f%ba%e7%a1%80" class="header-anchor">#&lt;/a>
2. SVE æ¶æ„åŸºç¡€
&lt;/h2>
&lt;p>æœ¬èŠ‚ä»‹ç» SVE å’Œ SVE2 å…±äº«çš„åŸºæœ¬æ¶æ„ç‰¹æ€§ã€‚ä¸ SVE ä¸€æ ·ï¼ŒSVE2 ä¹ŸåŸºäºå¯æ‰©å±•å‘é‡ã€‚é™¤äº† Neon æä¾›çš„ç°æœ‰å¯„å­˜å™¨åº“ä¹‹å¤–ï¼ŒSVE å’Œ SVE2 è¿˜æ·»åŠ äº†ä»¥ä¸‹å¯„å­˜å™¨ï¼š&lt;/p>
&lt;ul>
&lt;li>32 ä¸ªå¯ä¼¸ç¼©å‘é‡å¯„å­˜å™¨ï¼Œ&lt;code>Z0-Z31&lt;/code>&lt;/li>
&lt;li>16 ä¸ªå¯ä¼¸ç¼© Predicate å¯„å­˜å™¨ï¼Œ&lt;code>P0-P15&lt;/code>
&lt;ul>
&lt;li>1 ä¸ª é¦–æ•…éšœ Predicate å¯„å­˜å™¨ï¼Œ&lt;code>FFR&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¯ä¼¸ç¼©å‘é‡ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨, &lt;code>ZCR_ELx&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3 id="21-å¯ä¼¸ç¼©å‘é‡å¯„å­˜å™¨">
&lt;a href="#21-%e5%8f%af%e4%bc%b8%e7%bc%a9%e5%90%91%e9%87%8f%e5%af%84%e5%ad%98%e5%99%a8" class="header-anchor">#&lt;/a>
2.1 å¯ä¼¸ç¼©å‘é‡å¯„å­˜å™¨
&lt;/h3>
&lt;p>å¯ä¼¸ç¼©å‘é‡å¯„å­˜å™¨ &lt;code>Z0-Z31&lt;/code> å¯ä»¥åœ¨å¾®æ¶æ„ä¸­å®ç°ä¸º 128-2048 ä½ã€‚æœ€ä½çš„ 128 ä½ä¸ Neon çš„å›ºå®š 128 ä½å‘é‡ &lt;code>V0-V31&lt;/code> å…±äº«ã€‚&lt;/p>
&lt;p>ä¸‹å›¾æ˜¾ç¤ºäº†å¯ä¼¸ç¼©å‘é‡å¯„å­˜å™¨ &lt;code>Z0-Z31&lt;/code>ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_Z-register.webp"
alt="Z å¯„å­˜å™¨-2024-08-13" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>å¯ä¼¸ç¼©å‘é‡å¯„å­˜å™¨ Z0-Z31&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¯ä¼¸ç¼©å‘é‡ï¼š&lt;/p>
&lt;ul>
&lt;li>å¯ä»¥å®¹çº³ 64ã€32ã€16 å’Œ 8 ä½å…ƒç´ &lt;/li>
&lt;li>æ”¯æŒæ•´æ•°ã€åŒç²¾åº¦ã€å•ç²¾åº¦å’ŒåŠç²¾åº¦æµ®ç‚¹å…ƒç´ &lt;/li>
&lt;li>å¯ä»¥é’ˆå¯¹æ¯ä¸ªå¼‚å¸¸çº§åˆ«ï¼ˆELï¼‰é…ç½®å‘é‡é•¿åº¦&lt;/li>
&lt;/ul>
&lt;h3 id="22-å¯ä¼¸ç¼©-predicate-å¯„å­˜å™¨">
&lt;a href="#22-%e5%8f%af%e4%bc%b8%e7%bc%a9-predicate-%e5%af%84%e5%ad%98%e5%99%a8" class="header-anchor">#&lt;/a>
2.2 å¯ä¼¸ç¼© Predicate å¯„å­˜å™¨
&lt;/h3>
&lt;p>ä¸ºäº†æ§åˆ¶å“ªäº›æ´»åŠ¨å…ƒç´ å‚ä¸è¿ç®—ï¼ŒPredicate å¯„å­˜å™¨ï¼ˆç®€ç§°ä¸º P å¯„å­˜å™¨ï¼‰åœ¨è®¸å¤š SVE æŒ‡ä»¤ä¸­ç”¨ä½œæ©ç ï¼Œè¿™ä¹Ÿä¸ºå‘é‡è¿ç®—æä¾›äº†çµæ´»æ€§ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†å¯ä¼¸ç¼© Predicate å¯„å­˜å™¨ &lt;code>P0-P15&lt;/code> ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_Predicate-register.webp"
alt="P å¯„å­˜å™¨-2024-08-12" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>å¯ä¼¸ç¼© Predicate å¯„å­˜å™¨ P0-P15&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>P å¯„å­˜å™¨é€šå¸¸ç”¨ä½œæ•°æ®æ“ä½œçš„ä½æ©ç ï¼š&lt;/p>
&lt;ul>
&lt;li>æ¯ä¸ª P å¯„å­˜å™¨æ˜¯ Z å¯„å­˜å™¨é•¿åº¦çš„ 1/8&lt;/li>
&lt;li>&lt;code>P0-P7&lt;/code> ç”¨äºåŠ è½½ã€å­˜å‚¨å’Œç®—æœ¯è¿ç®—&lt;/li>
&lt;li>&lt;code>P8-P15&lt;/code> ç”¨äºå¾ªç¯ç®¡ç†&lt;/li>
&lt;li>FFR æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ P å¯„å­˜å™¨ï¼Œç”± first-fault vector load æŒ‡ä»¤å’Œ store æŒ‡ä»¤è®¾ç½®ï¼Œç”¨äºæŒ‡ç¤ºæ¯ä¸ªå…ƒç´ çš„åŠ è½½å’Œå­˜å‚¨æ“ä½œçš„æˆåŠŸæƒ…å†µã€‚FFR æ—¨åœ¨æ”¯æŒæ¨æµ‹æ€§å†…å­˜è®¿é—®ï¼Œè¿™ä½¿å¾—åœ¨è®¸å¤šæƒ…å†µä¸‹å‘é‡åŒ–æ›´å®¹æ˜“å’Œæ›´å®‰å…¨ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="23-å¯ä¼¸ç¼©å‘é‡ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨">
&lt;a href="#23-%e5%8f%af%e4%bc%b8%e7%bc%a9%e5%90%91%e9%87%8f%e7%b3%bb%e7%bb%9f%e6%8e%a7%e5%88%b6%e5%af%84%e5%ad%98%e5%99%a8" class="header-anchor">#&lt;/a>
2.3 å¯ä¼¸ç¼©å‘é‡ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨
&lt;/h3>
&lt;p>ä¸‹å›¾å±•ç¤ºäº†å¯ä¼¸ç¼©å‘é‡ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨ &lt;code>ZCR_ELx&lt;/code> ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_ZCR_Elx.webp"
alt="ZCR_Elx-2024-08-12" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>å¯ä¼¸ç¼©å‘é‡ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨ ZCR_Elx&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¯ä¼¸ç¼©å‘é‡ç³»ç»Ÿæ§åˆ¶å¯„å­˜å™¨æŒ‡ç¤º SVE å®ç°ç‰¹æ€§ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>ZCR_Elx.LEN&lt;/code> å­—æ®µç”¨äºå½“å‰å’Œè¾ƒä½å¼‚å¸¸çº§åˆ«çš„å‘é‡é•¿åº¦ã€‚&lt;/li>
&lt;li>å¤§å¤šæ•°ä½å½“å‰ä¿ç•™ä¾›å°†æ¥ä½¿ç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="24-sve-æ±‡ç¼–è¯­æ³•">
&lt;a href="#24-sve-%e6%b1%87%e7%bc%96%e8%af%ad%e6%b3%95" class="header-anchor">#&lt;/a>
2.4 SVE æ±‡ç¼–è¯­æ³•
&lt;/h3>
&lt;p>SVE æ±‡ç¼–è¯­æ³•æ ¼å¼ç”±æ“ä½œç ã€ç›®æ ‡å¯„å­˜å™¨ã€P å¯„å­˜å™¨ï¼ˆå¦‚æœæŒ‡ä»¤æ”¯æŒ Predicate æ©ç ï¼‰å’Œè¾“å…¥æ“ä½œæ•°ç»„æˆã€‚ä»¥ä¸‹æŒ‡ä»¤ç¤ºä¾‹å°†è¯¦ç»†è¯´æ˜æ­¤æ ¼å¼ã€‚&lt;/p>
&lt;p>ç¤ºä¾‹ 1:&lt;/p>
&lt;pre>&lt;code class="language-armasm">LDFF1D {&amp;lt;Zt&amp;gt;.D}, &amp;lt;Pg&amp;gt;/Z, [&amp;lt;Xn|SP&amp;gt;, &amp;lt;Zm&amp;gt;.D, LSL #3]
&lt;/code>&lt;/pre>
&lt;p>å…¶ä¸­ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>&amp;lt;Zt&amp;gt;&lt;/code> æ˜¯ Z å¯„å­˜å™¨, &lt;code>Z0-Z31&lt;/code>&lt;/li>
&lt;li>&lt;code>&amp;lt;Zt&amp;gt;&lt;/code>.D å’Œ &lt;code>&amp;lt;Zm&amp;gt;.D&lt;/code> æŒ‡å®šç›®æ ‡å’Œæ“ä½œæ•°å‘é‡çš„å…ƒç´ ç±»å‹ï¼Œä¸éœ€è¦æŒ‡å®šå…ƒç´ çš„æ•°é‡ã€‚&lt;/li>
&lt;li>&lt;code>&amp;lt;Pg&amp;gt;&lt;/code> æ˜¯ P å¯„å­˜å™¨, &lt;code>P0-P15&lt;/code>&lt;/li>
&lt;li>&lt;code>&amp;lt;Pg&amp;gt;/Z&lt;/code> æ˜¯å¯¹ P å¯„å­˜å™¨å½’é›¶ã€‚&lt;/li>
&lt;li>&lt;code>&amp;lt;Zm&amp;gt;&lt;/code> æŒ‡å®š Gather Load åœ°å€æ¨¡å¼çš„åç§»é‡ã€‚&lt;/li>
&lt;/ul>
&lt;p>ç¤ºä¾‹ 2:&lt;/p>
&lt;pre>&lt;code class="language-armasm">ADD &amp;lt;Zdn&amp;gt;.&amp;lt;T&amp;gt;, &amp;lt;Pg&amp;gt;/M, &amp;lt;Zdn&amp;gt;.&amp;lt;T&amp;gt;, &amp;lt;Zm&amp;gt;.&amp;lt;T&amp;gt;
&lt;/code>&lt;/pre>
&lt;p>å…¶ä¸­ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>&amp;lt;Pg&amp;gt;/M&lt;/code> æ˜¯åˆå¹¶ P å¯„å­˜å™¨ã€‚&lt;/li>
&lt;li>&lt;code>&amp;lt;Zdn&amp;gt;&lt;/code> æ—¢æ˜¯ç›®æ ‡å¯„å­˜å™¨ï¼Œä¹Ÿæ˜¯è¾“å…¥æ“ä½œæ•°ä¹‹ä¸€ã€‚æŒ‡ä»¤è¯­æ³•åœ¨ä¸¤ä¸ªä½ç½®éƒ½æ˜¾ç¤º &lt;code>&amp;lt;Zdn&amp;gt;&lt;/code> ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿èµ·è§ã€‚åœ¨æ±‡ç¼–ç¼–ç ä¸­ï¼Œä¸ºäº†ç®€åŒ–ï¼Œå®ƒä»¬åªè¢«ç¼–ç ä¸€æ¬¡ã€‚&lt;/li>
&lt;/ul>
&lt;p>ç¤ºä¾‹ 3:&lt;/p>
&lt;pre>&lt;code class="language-armasm">ORRS &amp;lt;Pd&amp;gt;.B, &amp;lt;Pg&amp;gt;.Z, &amp;lt;Pn&amp;gt;.B, &amp;lt;Pm&amp;gt;.B
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>&lt;code>S&lt;/code> æ˜¯ P å¯„å­˜å™¨æ¡ä»¶æ ‡å¿— &lt;code>NZCV&lt;/code> çš„æ–°è§£é‡Šã€‚&lt;/li>
&lt;li>&lt;code>&amp;lt;Pg&amp;gt;&lt;/code> æ§åˆ¶ P å¯„å­˜å™¨åœ¨ç¤ºä¾‹æ“ä½œä¸­å……å½“ä½æ©ç ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="25-sve-æ¶æ„ç‰¹æ€§">
&lt;a href="#25-sve-%e6%9e%b6%e6%9e%84%e7%89%b9%e6%80%a7" class="header-anchor">#&lt;/a>
2.5 SVE æ¶æ„ç‰¹æ€§
&lt;/h3>
&lt;p>SVE åŒ…æ‹¬ä»¥ä¸‹å…³é”®æ¶æ„ç‰¹æ€§ï¼š&lt;/p>
&lt;ul>
&lt;li>per-lane predication&lt;/li>
&lt;/ul>
&lt;p>ä¸ºäº†å…è®¸å¯¹æ‰€é€‰å…ƒç´ è¿›è¡Œçµæ´»çš„æ“ä½œï¼ŒSVE å¼•å…¥äº† 16 ä¸ª P å¯„å­˜å™¨ï¼Œ &lt;code>P0-P15&lt;/code> ï¼Œç”¨äºæŒ‡ç¤ºå¯¹å‘é‡æ´»åŠ¨é€šé“çš„æœ‰æ•ˆæ“ä½œã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">ADD Z0.D, P0/M, Z0.D, Z1.D
&lt;/code>&lt;/pre>
&lt;p>æ´»åŠ¨å…ƒç´  &lt;code>Z0&lt;/code> å’Œ &lt;code>Z1&lt;/code> ç›¸åŠ å¹¶å°†ç»“æœæ”¾å…¥ &lt;code>Z0&lt;/code> ä¸­ï¼Œ&lt;code>P0&lt;/code> æŒ‡ç¤ºæ“ä½œæ•°çš„å“ªäº›å…ƒç´ æ˜¯æ´»åŠ¨çš„å’Œéæ´»åŠ¨çš„ã€‚&lt;code>P0&lt;/code> åé¢çš„ &lt;strong>M&lt;/strong> è¡¨ç¤º Merging ï¼Œè¡¨ç¤ºå°†éæ´»åŠ¨å…ƒç´ åˆå¹¶ï¼Œå› æ­¤ &lt;code>Z0&lt;/code> çš„éæ´»åŠ¨å…ƒç´ åœ¨ &lt;code>ADD&lt;/code> æ“ä½œåå°†ä¿æŒå…¶åˆå§‹å€¼ã€‚å¦‚æœ &lt;code>P0&lt;/code> åé¢æ˜¯ &lt;strong>Z&lt;/strong> ï¼Œåˆ™éæ´»åŠ¨å…ƒç´ å°†è¢«æ¸…é›¶ï¼Œç›®æ ‡å¯„å­˜å™¨çš„éæ´»åŠ¨å…ƒç´ å°†åœ¨æ“ä½œåå½’é›¶ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_Per-lane_Predication.webp"
alt="Per-lane_Predication-2024-08-13" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>Per-lane predication merging&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¦‚æœä½¿ç”¨çš„æ˜¯ &lt;strong>\Z&lt;/strong> ï¼Œåˆ™éæ´»åŠ¨å…ƒç´ å°†è¢«æ¸…é›¶ï¼Œç›®æ ‡å¯„å­˜å™¨çš„éæ´»åŠ¨å…ƒç´ å°†åœ¨æ“ä½œåå½’é›¶ã€‚ä¾‹å¦‚&lt;/p>
&lt;pre>&lt;code class="language-armasm">CPY Z0.B, P0/Z, #0xFF
&lt;/code>&lt;/pre>
&lt;p>è¡¨ç¤ºå°†æœ‰ç¬¦å·æ•´æ•° 0xFF å¤åˆ¶åˆ° &lt;code>Z0&lt;/code> çš„æ´»åŠ¨é€šé“ä¸­ï¼Œè€Œéæ´»åŠ¨é€šé“å°†è¢«æ¸…é›¶ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_Per-lane_Predicate_Zeroing.webp"
alt="Per-lane_Predicate_Zeroing-2024-08-13" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>Per-lane predication zeroing&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;blockquote class="alert-blockquote alert-note">
&lt;p class="alert-heading">
&lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
&lt;path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z">&lt;/path>
&lt;/svg>
&lt;span>æ³¨é‡Š&lt;/span>
&lt;/p>
&lt;p>å¹¶éæ‰€æœ‰æŒ‡ä»¤éƒ½å…·æœ‰ Predicate é€‰é¡¹ã€‚æ­¤å¤–ï¼Œå¹¶éæ‰€æœ‰ Predicate æ“ä½œéƒ½åŒæ—¶å…·æœ‰åˆå¹¶å’Œæ¸…é›¶é€‰é¡¹ã€‚æ‚¨å¿…é¡»å‚è€ƒ &lt;a class="link" href="https://developer.arm.com/documentation/ddi0487/latest/t" target="_blank" rel="noopener" >AArch64 SVE Supplement
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ä»¥äº†è§£æ¯ä¸ªæŒ‡ä»¤çš„è§„èŒƒç»†èŠ‚ã€‚&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>Gather Load å’Œ Scatter Store&lt;/li>
&lt;/ul>
&lt;p>SVE ä¸­çš„å¯»å€æ¨¡å¼å…è®¸å°†å‘é‡ç”¨ä½œ Gather Load å’Œ Scatter Store æŒ‡ä»¤ä¸­çš„åŸºåœ°å€å’Œåç§»é‡ï¼Œè¿™ä½¿å¾—èƒ½å¤Ÿè®¿é—®éè¿ç»­çš„å†…å­˜ä½ç½®ã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">LD1SB Z0.S, P0/Z, [Z1.S] // å°†æœ‰ç¬¦å·å­—èŠ‚ä»ç”± 32 ä½å‘é‡åŸºåœ°å€ Z1 ç”Ÿæˆçš„å†…å­˜åœ°å€ Gather Load åˆ° Z0 çš„æ´»åŠ¨ 32 ä½å…ƒç´ ä¸­ã€‚
LD1SB Z0.D, P0/Z, [X0, Z1.D] // å°†æœ‰ç¬¦å·å­—èŠ‚ä»ç”± 64 ä½æ ‡é‡åŸºåœ°å€ X0 åŠ ä¸Š Z1.D ä¸­çš„å‘é‡ç´¢å¼•ç”Ÿæˆçš„å†…å­˜åœ°å€ Gather Load åˆ° Z0 çš„æ´»åŠ¨å…ƒç´ ä¸­ã€‚
&lt;/code>&lt;/pre>
&lt;p>ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†åŠ è½½æ“ä½œ &lt;code>LD1SB Z0.S, P0/Z, [Z1.S]&lt;/code> ï¼Œå…¶ä¸­ &lt;code>P0&lt;/code> åŒ…å«æ‰€æœ‰çœŸå…ƒç´ ï¼Œ&lt;code>Z1&lt;/code> åŒ…å«åˆ†æ•£çš„åœ°å€ã€‚åŠ è½½åï¼Œ&lt;code>Z0.S&lt;/code> çš„æ¯ä¸ªå…ƒç´ çš„ä½ä½å­—èŠ‚å°†ç”¨ä»åˆ†æ•£å†…å­˜ä½ç½®è·å–çš„æ•°æ®æ›´æ–°ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_gather-load_and_scatter_store_example.webp"
alt="gather-load_and_scatter_store_example-2024-08-13" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>Gather-load ä¸ Scatter-store ç¤ºä¾‹&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;ul>
&lt;li>P å¯„å­˜å™¨é©±åŠ¨çš„å¾ªç¯æ§åˆ¶å’Œç®¡ç†&lt;/li>
&lt;/ul>
&lt;p>ä½œä¸º SVE çš„ä¸€é¡¹å…³é”®ç‰¹æ€§ï¼ŒP å¯„å­˜å™¨ä¸ä»…å¯ä»¥çµæ´»åœ°æ§åˆ¶å‘é‡è¿ç®—çš„å„ä¸ªå…ƒç´ ï¼Œè¿˜å¯ä»¥å®ç° P å¯„å­˜å™¨é©±åŠ¨çš„å¾ªç¯æ§åˆ¶ã€‚P å¯„å­˜å™¨é©±åŠ¨çš„å¾ªç¯æ§åˆ¶å’Œç®¡ç†ä½¿å¾ªç¯æ§åˆ¶é«˜æ•ˆä¸”çµæ´»ã€‚æ­¤åŠŸèƒ½é€šè¿‡åœ¨ P å¯„å­˜å™¨ä¸­æ³¨å†Œæ´»åŠ¨å’Œéæ´»åŠ¨å…ƒç´ ç´¢å¼•ï¼Œæ¶ˆé™¤äº†å¤„ç†éƒ¨åˆ†å‘é‡çš„é¢å¤–å¾ªç¯å¤´å’Œå°¾çš„å¼€é”€ã€‚P å¯„å­˜å™¨é©±åŠ¨çš„å¾ªç¯æ§åˆ¶å’Œç®¡ç†æ„å‘³ç€ï¼Œåœ¨æ¥ä¸‹æ¥çš„å¾ªç¯è¿­ä»£ä¸­ï¼Œåªæœ‰æ´»åŠ¨å…ƒç´ æ‰ä¼šæ‰§è¡Œé¢„æœŸçš„æ“ä½œã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">WHILEL0 P0.S, x8, x9 // åœ¨ P0 ä¸­ç”Ÿæˆä¸€ä¸ªè°“è¯ï¼Œä»æœ€ä½ç¼–å·çš„å…ƒç´ å¼€å§‹ï¼Œå½“ç¬¬ä¸€ä¸ªæ— ç¬¦å·æ ‡é‡æ“ä½œæ•° X8 çš„é€’å¢å€¼å°äºç¬¬äºŒä¸ªæ ‡é‡æ“ä½œæ•° X9 æ—¶ä¸ºçœŸï¼Œä¹‹åä¸ºå‡ï¼Œç›´åˆ°æœ€é«˜ç¼–å·çš„å…ƒç´ ã€‚
B.FIRST Loop_start // B.FIRSTï¼ˆç­‰æ•ˆäº B.MIï¼‰æˆ– B.NFRSTï¼ˆç­‰æ•ˆäº B.PLï¼‰é€šå¸¸ç”¨äºæ ¹æ®ä¸Šè¿°æŒ‡ä»¤æµ‹è¯•ç»“æœè¿›è¡Œåˆ†æ”¯ï¼Œåˆ¤æ–­ P0 çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯çœŸè¿˜æ˜¯å‡ï¼Œä½œä¸ºå¾ªç¯çš„ç»“æŸæˆ–ç»§ç»­æ¡ä»¶ã€‚
&lt;/code>&lt;/pre>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_Predicate-driver_loop_control_and_management_example.webp"
alt="Predicate-driver_loop_control_and_management_example-2024-08-13" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>P å¯„å­˜å™¨é©±åŠ¨çš„å¾ªç¯æ§åˆ¶å’Œç®¡ç†ç¤ºä¾‹&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;ul>
&lt;li>ç”¨äºè½¯ä»¶ç®¡ç†æ¨æµ‹çš„å‘é‡åˆ†åŒº&lt;/li>
&lt;/ul>
&lt;p>æ¨æµ‹æ€§åŠ è½½å¯èƒ½ä¼šç»™ä¼ ç»Ÿå‘é‡çš„å†…å­˜è¯»å–å¸¦æ¥æŒ‘æˆ˜ï¼Œ&lt;strong>å¦‚æœåœ¨è¯»å–è¿‡ç¨‹ä¸­æŸäº›å…ƒç´ å‘ç”Ÿé”™è¯¯ï¼Œåˆ™éš¾ä»¥é€†è½¬åŠ è½½æ“ä½œå¹¶è·Ÿè¸ªå“ªäº›å…ƒç´ åŠ è½½å¤±è´¥&lt;/strong>ã€‚Neon ä¸å…è®¸æ¨æµ‹æ€§åŠ è½½ã€‚ä¸ºäº†å…è®¸å¯¹å‘é‡è¿›è¡Œæ¨æµ‹æ€§åŠ è½½ï¼ˆä¾‹å¦‚ LDRFFï¼‰ï¼ŒSVE å¼•å…¥äº† first-fault vector load æŒ‡ä»¤ã€‚ä¸ºäº†å…è®¸å‘é‡è®¿é—®è·¨è¶Šæ— æ•ˆé¡µé¢ï¼ŒSVE è¿˜å¼•å…¥äº† FFR å¯„å­˜å™¨ã€‚&lt;strong>ä½¿ç”¨ first-fault vector load æŒ‡ä»¤åŠ è½½åˆ° SVE å‘é‡æ—¶ï¼ŒFFR å¯„å­˜å™¨ä¼šæ›´æ–°æ¯ä¸ªå…ƒç´ çš„åŠ è½½æˆåŠŸæˆ–å¤±è´¥ç»“æœ&lt;/strong>ã€‚å½“å‘ç”ŸåŠ è½½é”™è¯¯æ—¶ï¼ŒFFR ä¼šç«‹å³æ³¨å†Œç›¸åº”çš„å…ƒç´ ï¼Œå°†å…¶ä½™å…ƒç´ æ³¨å†Œä¸º 0 æˆ– falseï¼Œå¹¶ä¸”ä¸ä¼šè§¦å‘å¼‚å¸¸ã€‚é€šå¸¸ï¼ŒRDFFR æŒ‡ä»¤ç”¨äºè¯»å– FFR çŠ¶æ€ã€‚å½“ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºå‡æ—¶ï¼ŒRDFFR æŒ‡ä»¤ç»“æŸè¿­ä»£ã€‚å¦‚æœç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºçœŸï¼ŒRDFFR æŒ‡ä»¤ç»§ç»­è¿­ä»£ã€‚FFR çš„é•¿åº¦ä¸ P å‘é‡ç›¸åŒã€‚å¯ä»¥ä½¿ç”¨ SETFFR æŒ‡ä»¤åˆå§‹åŒ–è¯¥å€¼ã€‚ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨ LDFF1D ä»å†…å­˜ä¸­è¯»å–æ•°æ®ï¼ŒFFR ä¼šç›¸åº”åœ°æ›´æ–°ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">LDFF1D Z0.D, P0/Z, [Z1.D, #0] // ä½¿ç”¨é¦–ä¸ªæ•…éšœè¡Œä¸ºå°†åŒå­—ä»ç”±å‘é‡åŸºåœ°å€ Z1 åŠ  0 ç”Ÿæˆçš„å†…å­˜åœ°å€æ”¶é›†åŠ è½½åˆ° Z0 çš„æ´»åŠ¨å…ƒç´ ä¸­ã€‚éæ´»åŠ¨å…ƒç´ ä¸ä¼šè¯»å–è®¾å¤‡å†…å­˜æˆ–å‘å‡ºæ•…éšœä¿¡å·ï¼Œå¹¶åœ¨ç›®æ ‡å‘é‡ä¸­è®¾ç½®ä¸ºé›¶ã€‚ä»æœ‰æ•ˆå†…å­˜æˆåŠŸåŠ è½½å°† FFR ä¸­çš„å¯¹åº”å…ƒç´ è®¾ç½®ä¸ºçœŸã€‚é¦–ä¸ªæ•…éšœåŠ è½½å°† FFR ä¸­çš„å¯¹åº”å…ƒç´ å’Œå…¶ä½™å…ƒç´ è®¾ç½®ä¸ºå‡æˆ– 0ã€‚
&lt;/code>&lt;/pre>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_Vector-partioning-for-software-managed-speculation-example.webp"
alt="Vector-partioning-for-software-managed-speculation-example-2024-08-13" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>ç”¨äºè½¯ä»¶ç®¡ç†æ¨æµ‹çš„å‘é‡åˆ†åŒºç¤ºä¾‹&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;ul>
&lt;li>æ‰©å±•çš„æµ®ç‚¹å’Œæ°´å¹³è§„çº¦&lt;/li>
&lt;/ul>
&lt;p>ä¸ºäº†å…è®¸åœ¨å‘é‡ä¸­è¿›è¡Œé«˜æ•ˆçš„å½’çº¦æ“ä½œï¼Œå¹¶æ»¡è¶³å¯¹ç²¾åº¦çš„ä¸åŒè¦æ±‚ï¼ŒSVE å¢å¼ºäº†æµ®ç‚¹å’Œæ°´å¹³å½’çº¦æ“ä½œã€‚è¿™äº›æŒ‡ä»¤å¯èƒ½å…·æœ‰é¡ºåºï¼ˆä»ä½åˆ°é«˜ï¼‰æˆ–åŸºäºæ ‘ï¼ˆæˆå¯¹ï¼‰çš„æµ®ç‚¹å½’çº¦é¡ºåºï¼Œå…¶ä¸­æ“ä½œé¡ºåºå¯èƒ½ä¼šå¯¼è‡´ä¸åŒçš„èˆå…¥ç»“æœã€‚è¿™äº›æ“ä½œéœ€è¦åœ¨å¯é‡å¤æ€§å’Œæ€§èƒ½ä¹‹é—´è¿›è¡Œæƒè¡¡ã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">FADDA D0, P0/M, D1, Z2.D // ä»æºå¤´å‘é‡çš„ä½ä½åˆ°é«˜ä½å…ƒç´ è¿›è¡Œæµ®ç‚¹åŠ ä¸¥æ ¼é¡ºåºå½’çº¦ï¼Œå°†ç»“æœç´¯ç§¯åˆ° SIMD&amp;amp;FP æ ‡é‡å¯„å­˜å™¨ä¸­ã€‚è¯¥ç¤ºä¾‹æŒ‡ä»¤å°† D1 ä¸ Z2.D çš„æ‰€æœ‰æ´»åŠ¨å…ƒç´ ç›¸åŠ ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åˆ°æ ‡é‡å¯„å­˜å™¨ D0 ä¸­ã€‚å‘é‡å…ƒç´ æŒ‰ä»ä½åˆ°é«˜çš„é¡ºåºä¸¥æ ¼å¤„ç†ï¼Œæ ‡é‡æº D1 æä¾›åˆå§‹å€¼ã€‚æºå‘é‡ä¸­çš„éæ´»åŠ¨å…ƒç´ å°†è¢«å¿½ç•¥ã€‚è€Œ FADDV å°†æ‰§è¡Œé€’å½’æˆå¯¹å½’çº¦ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åˆ°æ ‡é‡å¯„å­˜å™¨ä¸­ã€‚
&lt;/code>&lt;/pre>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_Extended_Floating-poing-and-horizontal-reductions-example.webp"
alt="Extended_Floating-poing-and-horizontal-reductions-example-2024-08-13" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>æ‰©å±•çš„æµ®ç‚¹å’Œæ°´å¹³è§„çº¦ç¤ºä¾‹&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="3-sve2-æ–°å¢ç‰¹æ€§">
&lt;a href="#3-sve2-%e6%96%b0%e5%a2%9e%e7%89%b9%e6%80%a7" class="header-anchor">#&lt;/a>
3. SVE2 æ–°å¢ç‰¹æ€§
&lt;/h2>
&lt;p>æœ¬èŠ‚ä»‹ç» SVE2 ä¸º Arm AArch64 æ¶æ„æ–°å¢çš„ç‰¹æ€§ã€‚ä¸ºäº†å®ç°å¯ä¼¸ç¼©çš„æ€§èƒ½ï¼ŒSVE2 åŸºäº SVE æ„å»ºï¼Œå…è®¸å‘é‡å®ç°é«˜è¾¾ 2048 ä½ã€‚&lt;/p>
&lt;p>åœ¨ SVE2 ä¸­ï¼Œæ·»åŠ äº†è®¸å¤šå¤åˆ¶ Neon ä¸­ç°æœ‰æŒ‡ä»¤çš„æŒ‡ä»¤ï¼ŒåŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>è½¬æ¢åçš„ Neon æ•´æ•°è¿ç®—ï¼Œä¾‹å¦‚ï¼Œå¸¦ç¬¦å·ç»å¯¹å·®ç´¯åŠ  (SAB) å’Œå¸¦ç¬¦å·å‡åŠåŠ æ³• (SHADD)ã€‚&lt;/li>
&lt;li>è½¬æ¢åçš„ Neon æ‰©å±•ã€ç¼©å°å’Œæˆå¯¹è¿ç®—ï¼Œä¾‹å¦‚ï¼Œæ— ç¬¦å·é•¿åŠ æ³• - åº•éƒ¨ (UADDLB) å’Œæ— ç¬¦å·é•¿åŠ æ³• - é¡¶éƒ¨ (UADDLT)ã€‚&lt;/li>
&lt;/ul>
&lt;p>å…ƒç´ å¤„ç†é¡ºåºå‘ç”Ÿäº†å˜åŒ–ã€‚SVE2 å¯¹äº¤é”™çš„å¶æ•°å’Œå¥‡æ•°å…ƒç´ è¿›è¡Œå¤„ç†ï¼Œè€Œ Neon å¯¹çª„æˆ–å®½æ“ä½œçš„ä½åŠéƒ¨åˆ†å’Œé«˜åŠéƒ¨åˆ†å…ƒç´ è¿›è¡Œå¤„ç†ã€‚ä¸‹å›¾è¯´æ˜äº† Neon å’Œ SVE2 å¤„ç†ä¹‹é—´çš„åŒºåˆ«ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_transformed_neon_widen_narraow_pairwise_operations.webp"
alt="transformed_neon_widen_narraow_pairwise_operations-2024-08-13" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>è½¬æ¢åçš„ Neon çª„æˆ–å®½æ“ä½œå¯¹æ¯”&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;ul>
&lt;li>å¤æ•°æ“ä½œï¼Œä¾‹å¦‚å¸¦æ—‹è½¬çš„å¤æ•´æ•°ä¹˜åŠ  (CMLA)ã€‚&lt;/li>
&lt;li>å¤šç²¾åº¦è¿ç®—ï¼Œç”¨äºå¤§æ•´æ•°è¿ç®—å’Œå¯†ç å­¦ï¼Œä¾‹å¦‚ï¼Œå¸¦è¿›ä½é•¿åŠ æ³• - åº•éƒ¨ (ADCLB)ã€å¸¦è¿›ä½é•¿åŠ æ³• - é¡¶éƒ¨ (ADCLT) ä»¥åŠ SM4 åŠ å¯†å’Œè§£å¯† (SM4E)ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¸ºäº†å‘åå…¼å®¹ï¼Œæœ€æ–°æ¶æ„ä¸­éœ€è¦ Neon å’Œ VFPã€‚è™½ç„¶ SVE2 åŒ…å« SVE å’Œ Neon çš„ä¸€äº›åŠŸèƒ½ï¼Œä½† SVE2 å¹¶ä¸æ’é™¤ Neon åœ¨èŠ¯ç‰‡ä¸Šçš„å­˜åœ¨ã€‚&lt;/p>
&lt;p>SVE2 æ”¯æŒé’ˆå¯¹ HPC å¸‚åœºä»¥å¤–çš„æ–°å…´åº”ç”¨è¿›è¡Œä¼˜åŒ–ï¼Œä¾‹å¦‚ï¼Œåœ¨æœºå™¨å­¦ä¹  (ML)ï¼ˆUDOT æŒ‡ä»¤ï¼‰ã€è®¡ç®—æœºè§†è§‰ï¼ˆTBL å’Œ TBX æŒ‡ä»¤ï¼‰ã€åŸºå¸¦ç½‘ç»œï¼ˆCADD å’Œ CMLA æŒ‡ä»¤ï¼‰ã€åŸºå› ç»„å­¦ï¼ˆBDEP å’Œ BEXT æŒ‡ä»¤ï¼‰å’ŒæœåŠ¡å™¨ï¼ˆMATCH å’Œ NMATCH æŒ‡ä»¤ï¼‰ä¸­ã€‚&lt;/p>
&lt;p>SVE2 å¢å¼ºäº†é€šç”¨å¤„ç†å™¨å¤§é‡æ•°æ®æ“ä½œçš„æ•´ä½“æ€§èƒ½ï¼Œè€Œæ— éœ€å…¶ä»–ç‰‡å¤–åŠ é€Ÿå™¨ã€‚&lt;/p>
&lt;h2 id="4-ä½¿ç”¨-sve-ç¼–ç¨‹">
&lt;a href="#4-%e4%bd%bf%e7%94%a8-sve-%e7%bc%96%e7%a8%8b" class="header-anchor">#&lt;/a>
4. ä½¿ç”¨ SVE ç¼–ç¨‹
&lt;/h2>
&lt;p>æœ¬èŠ‚ä»‹ç»æ”¯æŒ SVE2 åº”ç”¨ç¨‹åºå¼€å‘çš„è½¯ä»¶å·¥å…·å’Œåº“ã€‚æœ¬èŠ‚è¿˜ä»‹ç»äº†å¦‚ä½•ä¸ºæ”¯æŒ SVE2 çš„ç›®æ ‡å¼€å‘åº”ç”¨ç¨‹åºï¼Œåœ¨æ”¯æŒ SVE2 çš„ç¡¬ä»¶ä¸Šè¿è¡Œè¯¥åº”ç”¨ç¨‹åºï¼Œä»¥åŠåœ¨ä»»ä½• Armv8-A ç¡¬ä»¶ä¸Šæ¨¡æ‹Ÿè¯¥åº”ç”¨ç¨‹åºã€‚&lt;/p>
&lt;h3 id="41-è½¯ä»¶å’Œåº“æ”¯æŒ">
&lt;a href="#41-%e8%bd%af%e4%bb%b6%e5%92%8c%e5%ba%93%e6%94%af%e6%8c%81" class="header-anchor">#&lt;/a>
4.1 è½¯ä»¶å’Œåº“æ”¯æŒ
&lt;/h3>
&lt;p>è¦æ„å»º SVE æˆ– SVE2 åº”ç”¨ç¨‹åºï¼Œä½ å¿…é¡»é€‰æ‹©æ”¯æŒ SVE å’Œ SVE2 åŠŸèƒ½çš„ç¼–è¯‘å™¨ã€‚&lt;/p>
&lt;ul>
&lt;li>GNU å·¥å…· 8.0+ ç‰ˆæœ¬æ”¯æŒ SVEã€‚&lt;/li>
&lt;li>&lt;a class="link" href="https://developer.arm.com/tools-and-software/server-and-hpc/compile/arm-compiler-for-linux" target="_blank" rel="noopener" >Arm Compiler for Linux
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
18.0+ ç‰ˆæœ¬æ”¯æŒ SVEï¼Œ20.0+ ç‰ˆæœ¬æ”¯æŒ SVE å’Œ SVE2ã€‚&lt;/li>
&lt;li>GNU å’Œ Arm Compiler for Linux ç¼–è¯‘å™¨éƒ½æ”¯æŒä¼˜åŒ– C/C++/Fortran ä»£ç ã€‚&lt;/li>
&lt;li>LLVMï¼ˆå¼€æº Clangï¼‰5 åŠæ›´é«˜ç‰ˆæœ¬åŒ…æ‹¬å¯¹ SVE çš„æ”¯æŒï¼Œ9 åŠæ›´é«˜ç‰ˆæœ¬åŒ…æ‹¬å¯¹ SVE2 çš„æ”¯æŒã€‚è¦äº†è§£ LLVM å·¥å…·çš„æ¯ä¸ªç‰ˆæœ¬æ”¯æŒå“ªäº› SVE æˆ– SVE2 åŠŸèƒ½ï¼Œè¯·å‚é˜… &lt;a class="link" href="https://developer.arm.com/tools-and-software/open-source-software/developer-tools/llvm-toolchain/sve-support" target="_blank" rel="noopener" >LLVM å·¥å…·é“¾ SVE æ”¯æŒé¡µé¢
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/li>
&lt;/ul>
&lt;p>&lt;a class="link" href="https://developer.arm.com/Tools%20and%20Software/Arm%20Performance%20Libraries" target="_blank" rel="noopener" >Arm Performance Libraries
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
é’ˆå¯¹æ•°å­¦ä¾‹ç¨‹è¿›è¡Œäº†é«˜åº¦ä¼˜åŒ–ï¼Œå¯ä»¥é“¾æ¥åˆ°ä½ çš„åº”ç”¨ç¨‹åºã€‚Arm Performance Libraries 19.3+ ç‰ˆæœ¬æ”¯æŒ SVE çš„æ•°å­¦åº“ã€‚&lt;/p>
&lt;p>Arm Compiler for Linux æ˜¯ Arm Allinea Studio çš„ä¸€éƒ¨åˆ†ï¼ŒåŒ…å« Arm C/C++ ç¼–è¯‘å™¨ã€Arm Fortran ç¼–è¯‘å™¨å’Œ Arm Performance Librariesã€‚&lt;/p>
&lt;h3 id="42-å¦‚ä½•ä½¿ç”¨-sve2-ç¼–ç¨‹">
&lt;a href="#42-%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8-sve2-%e7%bc%96%e7%a8%8b" class="header-anchor">#&lt;/a>
4.2 å¦‚ä½•ä½¿ç”¨ SVE2 ç¼–ç¨‹
&lt;/h3>
&lt;p>ç¼–å†™æˆ–ç”Ÿæˆ SVE å’Œ SVE2 ä»£ç çš„æ–¹æ³•æœ‰å¤šç§ã€‚åœ¨æœ¬å°èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å…¶ä¸­çš„ä¸€äº›æ–¹æ³•ã€‚&lt;/p>
&lt;p>è¦ç¼–å†™æˆ–ç”Ÿæˆ SVE å’Œ SVE2 ä»£ç ï¼Œä½ å¯ä»¥ï¼š&lt;/p>
&lt;ul>
&lt;li>ç¼–å†™ SVE æ±‡ç¼–ä»£ç &lt;/li>
&lt;li>ä½¿ç”¨ SVE å†…éƒ¨å‡½æ•°ç¼–ç¨‹&lt;/li>
&lt;li>è‡ªåŠ¨å‘é‡åŒ–&lt;/li>
&lt;li>ä½¿ç”¨ SVE ä¼˜åŒ–åº“&lt;/li>
&lt;/ul>
&lt;p>è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°äº†è§£è¿™å››ç§é€‰æ‹©ã€‚&lt;/p>
&lt;h4 id="421-ç¼–å†™-sve-æ±‡ç¼–ä»£ç ">
&lt;a href="#421-%e7%bc%96%e5%86%99-sve-%e6%b1%87%e7%bc%96%e4%bb%a3%e7%a0%81" class="header-anchor">#&lt;/a>
4.2.1 ç¼–å†™ SVE æ±‡ç¼–ä»£ç 
&lt;/h4>
&lt;p>ä½ å¯ä»¥å°† SVE æŒ‡ä»¤ä½œä¸ºå†…è”æ±‡ç¼–ç¼–å†™åˆ° C/C++ ä»£ç ä¸­ï¼Œæˆ–è€…ä½œä¸ºå®Œæ•´çš„å‡½æ•°ç¼–å†™åˆ°æ±‡ç¼–æºä»£ç ä¸­ã€‚ä¾‹å¦‚ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm"> .globl subtract_arrays // -- Begin function
.p2align 2
.type subtract_arrays, @function
subtract_arrays: // @subtract_arrays
.cfi_startproc
// %bb.0:
orr w9, wzr, #0x400
mov x8, xzr
whilelo p0.s, xzr, x9
.LBB0_1: // =&amp;gt;This Inner Loop Header: Depth=1
ld1w { z0.s }, p0/z, [x1, x8, lsl #2]
ld1w { z1.s }, p0/z, [x2, x8, lsl #2]
sub z0.s, z0.s, z1.s
st1w { z0.s }, p0, [x0, x8, lsl #2]
incw x8
whilelo p0.s, x8, x9
b.mi .LBB0_1
// %bb.2:
ret
.Lfunc_end0:
.size subtract_arrays, .Lfunc_end0-subtract_arrays
.cfi_endproc
&lt;/code>&lt;/pre>
&lt;p>å¦‚æœä½ æ··åˆä½¿ç”¨é«˜çº§è¯­è¨€å’Œæ±‡ç¼–è¯­è¨€ç¼–å†™çš„å‡½æ•°ï¼Œåˆ™å¿…é¡»ç†Ÿæ‚‰é’ˆå¯¹ SVE æ›´æ–°çš„&lt;a class="link" href="https://developer.arm.com/documentation/ihi0036/latest/" target="_blank" rel="noopener" >åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ¥å£ (ABI)
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æ ‡å‡†ã€‚&lt;a class="link" href="https://developer.arm.com/documentation/ihi0055/latest" target="_blank" rel="noopener" >Arm æ¶æ„è¿‡ç¨‹è°ƒç”¨æ ‡å‡† (AAPCS)
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æŒ‡å®šäº†æ•°æ®ç±»å‹å’Œå¯„å­˜å™¨åˆ†é…ï¼Œå¹¶ä¸”ä¸æ±‡ç¼–ç¼–ç¨‹æœ€ç›¸å…³ã€‚AAPCS è¦æ±‚ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>Z0-Z7&lt;/code> å’Œ &lt;code>P0-P3 &lt;/code>ç”¨äºä¼ é€’å¯ä¼¸ç¼©å‘é‡å‚æ•°å’Œç»“æœã€‚&lt;/li>
&lt;li>&lt;code>Z8-Z15&lt;/code> å’Œ &lt;code>P4-P15&lt;/code> æ˜¯è¢«è°ƒç”¨è€…ä¿å­˜çš„ã€‚&lt;/li>
&lt;li>æ‰€æœ‰å…¶ä»–å‘é‡å¯„å­˜å™¨ï¼ˆ&lt;code>Z16-Z31&lt;/code>ï¼‰éƒ½å¯èƒ½è¢«è¢«è°ƒç”¨å‡½æ•°ç ´åï¼Œè°ƒç”¨å‡½æ•°è´Ÿè´£åœ¨éœ€è¦æ—¶å¤‡ä»½å’Œæ¢å¤å®ƒä»¬ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="422-ä½¿ç”¨-sve-instruction-å‡½æ•°intrinsics">
&lt;a href="#422-%e4%bd%bf%e7%94%a8-sve-instruction-%e5%87%bd%e6%95%b0intrinsics" class="header-anchor">#&lt;/a>
4.2.2 ä½¿ç”¨ SVE instruction å‡½æ•°ï¼ˆIntrinsicsï¼‰
&lt;/h4>
&lt;p>SVE å†…éƒ¨å‡½æ•°æ˜¯ç”±ç¼–è¯‘å™¨æ”¯æŒçš„å‡½æ•°ï¼Œå¯ä»¥æ›¿æ¢ä¸ºç›¸åº”çš„æŒ‡ä»¤ã€‚ç¨‹åºå‘˜å¯ä»¥ç›´æ¥åœ¨ C å’Œ C++ ç­‰é«˜çº§è¯­è¨€ä¸­è°ƒç”¨æŒ‡ä»¤å‡½æ•°ã€‚SVE çš„ ACLEï¼ˆArm C è¯­è¨€æ‰©å±•ï¼‰å®šä¹‰äº†å“ªäº› SVE æŒ‡ä»¤å‡½æ•°å¯ç”¨ã€å®ƒä»¬çš„å‚æ•°ä»¥åŠå®ƒä»¬çš„åŠŸèƒ½ã€‚æ”¯æŒ ACLE çš„ç¼–è¯‘å™¨å¯ä»¥åœ¨ç¼–è¯‘æœŸé—´å°†å†…éƒ¨å‡½æ•°æ›¿æ¢ä¸ºæ˜ å°„çš„ SVE æŒ‡ä»¤ã€‚è¦ä½¿ç”¨ ACLE å†…éƒ¨å‡½æ•°ï¼Œä½ å¿…é¡»åŒ…å«å¤´æ–‡ä»¶ &lt;code>arm_sve.h&lt;/code>ï¼Œå…¶ä¸­åŒ…å«å¯åœ¨ C/C++ ä¸­ä½¿ç”¨çš„å‘é‡ç±»å‹å’ŒæŒ‡ä»¤å‡½æ•°ï¼ˆé’ˆå¯¹ SVEï¼‰åˆ—è¡¨ã€‚æ¯ç§æ•°æ®ç±»å‹éƒ½æè¿°äº†å‘é‡ä¸­å…ƒç´ çš„å¤§å°å’Œæ•°æ®ç±»å‹ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>svint8_t svuint8_t&lt;/code>&lt;/li>
&lt;li>&lt;code>svint16_t svuint16_t svfloat16_t&lt;/code>&lt;/li>
&lt;li>&lt;code>svint32_t svuint32_t svfloat32_t&lt;/code>&lt;/li>
&lt;li>&lt;code>svint64_t svuint64_t svfloat64_t&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>ä¾‹å¦‚ï¼Œ&lt;code>svint64_t&lt;/code> è¡¨ç¤º 64 ä½æœ‰ç¬¦å·æ•´æ•°å‘é‡ï¼Œ&lt;code>svfloat16_t&lt;/code> è¡¨ç¤ºåŠç²¾åº¦æµ®ç‚¹æ•°å‘é‡ã€‚&lt;/p>
&lt;p>ä»¥ä¸‹ç¤ºä¾‹ C ä»£ç å·²ä½¿ç”¨ SVE å†…éƒ¨å‡½æ•°è¿›è¡Œäº†æ‰‹åŠ¨ä¼˜åŒ–ï¼š&lt;/p>
&lt;pre>&lt;code class="language-c">// intrinsic_example.c
#include &amp;lt;arm_sve.h&amp;gt;
svuint64_t uaddlb_array(svuint32_t Zs1, svuint32_t Zs2)
{
// widening add of even elements
svuint64_t result = svaddlb(Zs1, Zs2);
return result;
}
&lt;/code>&lt;/pre>
&lt;p>åŒ…å« &lt;code>arm_sve.h&lt;/code> å¤´æ–‡ä»¶çš„æºä»£ç å¯ä»¥ä½¿ç”¨ SVE å‘é‡ç±»å‹ï¼Œå°±åƒæ•°æ®ç±»å‹å¯ä»¥ç”¨äºå˜é‡å£°æ˜å’Œå‡½æ•°å‚æ•°ä¸€æ ·ã€‚è¦ä½¿ç”¨ Arm C/C++ ç¼–è¯‘å™¨ç¼–è¯‘ä»£ç å¹¶ä»¥æ”¯æŒ SVE çš„ Armv8-A æ¶æ„ä¸ºç›®æ ‡ï¼Œè¯·ä½¿ç”¨ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash">armclang -O3 -S -march=armv8-a+sve2 -o intrinsic_example.s intrinsic_example.c
&lt;/code>&lt;/pre>
&lt;p>æ­¤å‘½ä»¤ç”Ÿæˆä»¥ä¸‹æ±‡ç¼–ä»£ç ï¼š&lt;/p>
&lt;pre>&lt;code class="language-armasm">// instrinsic_example.s
uaddlb_array: // @uaddlb_array
.cfi_startproc
// %bb.0:
uaddlb z0.d, z0.s, z1.s
ret
&lt;/code>&lt;/pre>
&lt;h4 id="423-è‡ªåŠ¨å‘é‡åŒ–">
&lt;a href="#423-%e8%87%aa%e5%8a%a8%e5%90%91%e9%87%8f%e5%8c%96" class="header-anchor">#&lt;/a>
4.2.3 è‡ªåŠ¨å‘é‡åŒ–
&lt;/h4>
&lt;p>C/C++/Fortran ç¼–è¯‘å™¨ï¼ˆä¾‹å¦‚ï¼Œé€‚ç”¨äº Arm å¹³å°çš„åŸç”Ÿ &lt;a class="link" href="https://developer.arm.com/tools-and-software/server-and-hpc/compile/arm-compiler-for-linux" target="_blank" rel="noopener" >Arm Compiler for Linux
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
å’Œ GNU ç¼–è¯‘å™¨ï¼‰æ”¯æŒä½¿ç”¨ SVE æˆ– SVE2 æŒ‡ä»¤å¯¹ Cã€C++ å’Œ Fortran å¾ªç¯è¿›è¡Œå‘é‡åŒ–ã€‚è¦ç”Ÿæˆ SVE æˆ– SVE2 ä»£ç ï¼Œè¯·é€‰æ‹©é€‚å½“çš„ç¼–è¯‘å™¨é€‰é¡¹ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ armclang å¯ç”¨ SVE2 ä¼˜åŒ–çš„ä¸€ä¸ªé€‰é¡¹æ˜¯ &lt;code>-march=armv8-a+sve2&lt;/code> ã€‚å¦‚æœè¦ä½¿ç”¨ SVE ç‰ˆæœ¬çš„åº“ï¼Œè¯·å°† &lt;code>-march=armv8-a+sve2&lt;/code> ä¸ &lt;code>-armpl=sve&lt;/code> ç»“åˆä½¿ç”¨ã€‚&lt;/p>
&lt;h4 id="424-ä½¿ç”¨-svesve2-ä¼˜åŒ–åº“">
&lt;a href="#424-%e4%bd%bf%e7%94%a8-svesve2-%e4%bc%98%e5%8c%96%e5%ba%93" class="header-anchor">#&lt;/a>
4.2.4 ä½¿ç”¨ SVE/SVE2 ä¼˜åŒ–åº“
&lt;/h4>
&lt;p>ä½¿ç”¨é’ˆå¯¹ SVE/SVE2 é«˜åº¦ä¼˜åŒ–çš„åº“ï¼Œä¾‹å¦‚ &lt;a class="link" href="https://developer.arm.com/Tools%20and%20Software/Arm%20Performance%20Libraries" target="_blank" rel="noopener" >Arm Performance Libraries
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
å’Œ Arm Compute Librariesã€‚Arm Performance Libraries åŒ…å«é’ˆå¯¹ BLASã€LAPACKã€FFTã€ç¨€ç–çº¿æ€§ä»£æ•°å’Œ libamath ä¼˜åŒ–çš„æ•°å­¦å‡½æ•°çš„é«˜åº¦ä¼˜åŒ–å®ç°ã€‚è¦èƒ½å¤Ÿé“¾æ¥ä»»ä½• Arm Performance Libraries å‡½æ•°ï¼Œæ‚¨å¿…é¡»å®‰è£… Arm Allinea Studio å¹¶åœ¨ä»£ç ä¸­åŒ…å« armpl.hã€‚è¦ä½¿ç”¨ Arm Compiler for Linux å’Œ Arm Performance Libraries æ„å»ºåº”ç”¨ç¨‹åºï¼Œæ‚¨å¿…é¡»åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®š &lt;code>-armpl=&amp;lt;arg&amp;gt;&lt;/code> ã€‚å¦‚æœæ‚¨ä½¿ç”¨ GNU å·¥å…·ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ &lt;code>-L&amp;lt;armpl_install_dir&amp;gt;/lib&lt;/code> å°† Arm Performance Libraries å®‰è£…è·¯å¾„åŒ…å«åœ¨é“¾æ¥å™¨å‘½ä»¤è¡Œä¸­ï¼Œå¹¶æŒ‡å®šä¸ Arm Compiler for Linux &lt;code>-armpl=&amp;lt;arg&amp;gt;&lt;/code> é€‰é¡¹ç­‰æ•ˆçš„ GNU é€‰é¡¹ï¼Œå³ &lt;code>-larmpl_lp64&lt;/code> ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… Arm Performance Libraries å…¥é—¨æŒ‡å—ã€‚&lt;/p>
&lt;h3 id="43-å¦‚ä½•è¿è¡Œ-svesve2-ç¨‹åº">
&lt;a href="#43-%e5%a6%82%e4%bd%95%e8%bf%90%e8%a1%8c-svesve2-%e7%a8%8b%e5%ba%8f" class="header-anchor">#&lt;/a>
4.3 å¦‚ä½•è¿è¡Œ SVE/SVE2 ç¨‹åº
&lt;/h3>
&lt;p>å¦‚æœæ‚¨æ— æ³•è®¿é—® SVE ç¡¬ä»¶ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ¨¡å‹æˆ–ä»¿çœŸå™¨æ¥è¿è¡Œä»£ç ã€‚ä½ å¯ä»¥é€‰æ‹©ä»¥ä¸‹å‡ ç§æ¨¡å‹å’Œä»¿çœŸå™¨ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;strong>QEMU&lt;/strong>ï¼š äº¤å‰ç¼–è¯‘å’ŒåŸç”Ÿæ¨¡å‹ï¼Œæ”¯æŒåœ¨å…·æœ‰ SVE çš„ Arm AArch64 å¹³å°ä¸Šè¿›è¡Œå»ºæ¨¡ã€‚&lt;/li>
&lt;li>&lt;strong>Fast Models&lt;/strong>ï¼š è·¨å¹³å°æ¨¡å‹ï¼Œæ”¯æŒåœ¨åŸºäº x86 çš„ä¸»æœºä¸Šè¿è¡Œçš„å…·æœ‰ SVE çš„ Arm AArch64 å¹³å°è¿›è¡Œå»ºæ¨¡ã€‚æ”¯æŒ SVE2 çš„ æ¶æ„åŒ…ç»œæ¨¡å‹ AEM åªå¯¹ä¸»è¦åˆä½œä¼™ä¼´å¯ç”¨ã€‚&lt;/li>
&lt;li>&lt;strong>Arm Instruction Emulator (ArmIE)&lt;/strong>ï¼š ç›´æ¥åœ¨ Arm å¹³å°ä¸Šè¿è¡Œã€‚æ”¯æŒ SVEï¼Œå¹¶ä» 19.2+ ç‰ˆæœ¬å¼€å§‹æ”¯æŒ SVE2ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="5-acle-intrinsics">
&lt;a href="#5-acle-intrinsics" class="header-anchor">#&lt;/a>
5. ACLE Intrinsics
&lt;/h2>
&lt;h3 id="51-acle-ç®€ä»‹">
&lt;a href="#51-acle-%e7%ae%80%e4%bb%8b" class="header-anchor">#&lt;/a>
5.1 ACLE ç®€ä»‹
&lt;/h3>
&lt;p>ACLE (Arm C è¯­è¨€æ‰©å±•) æ˜¯åœ¨ C å’Œ C++ ä»£ç ä¸­åˆ©ç”¨å†…éƒ¨å‡½æ•°å’Œå…¶ä»–ç‰¹æ€§æ¥æ”¯æŒ Arm çš„åŠŸèƒ½ã€‚&lt;/p>
&lt;ul>
&lt;li>ACLE (ARM C è¯­è¨€æ‰©å±•) é€šè¿‡ç‰¹å®šäº Arm çš„ç‰¹æ€§æ‰©å±•äº† C/C++ è¯­è¨€ã€‚
&lt;ul>
&lt;li>é¢„å®šä¹‰å®ï¼š&lt;code>__ARM_ARCH_ISA_A64&lt;/code> ã€ &lt;code>__ARM_BIG_ENDIAN&lt;/code> ç­‰ã€‚&lt;/li>
&lt;li>å†…éƒ¨å‡½æ•°ï¼š&lt;code>__clz(uint32_t x)&lt;/code> ã€ &lt;code>__cls(uint32_t x)&lt;/code> ç­‰ã€‚&lt;/li>
&lt;li>æ•°æ®ç±»å‹ï¼šSVEã€NEON å’Œ FP16 æ•°æ®ç±»å‹ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ç”¨äº SVE çš„ ACLE æ”¯æŒä½¿ç”¨ ACLE è¿›è¡Œå¯å˜é•¿åº¦å‘é‡ (VLA) ç¼–ç¨‹ã€‚
&lt;ul>
&lt;li>å‡ ä¹æ¯ä¸ª SVE æŒ‡ä»¤éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„å†…éƒ¨å‡½æ•°ã€‚&lt;/li>
&lt;li>æ•°æ®ç±»å‹ç”¨äºè¡¨ç¤º SVE å†…éƒ¨å‡½æ•°æ‰€ä½¿ç”¨çš„æ— å¤§å°å‘é‡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>é€‚ç”¨äºä»¥ä¸‹ç”¨æˆ·çš„åœºæ™¯ï¼š
&lt;ul>
&lt;li>å¸Œæœ›æ‰‹åŠ¨è°ƒæ•´ SVE ä»£ç çš„ç”¨æˆ·ã€‚&lt;/li>
&lt;li>å¸Œæœ›é€‚é…æˆ–æ‰‹åŠ¨ä¼˜åŒ–åº”ç”¨ç¨‹åºå’Œåº“çš„ç”¨æˆ·ã€‚&lt;/li>
&lt;li>éœ€è¦å¯¹ Arm ç›®æ ‡è¿›è¡Œåº•å±‚è®¿é—®çš„ç”¨æˆ·ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="52-å¦‚ä½•ä½¿ç”¨-acle">
&lt;a href="#52-%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8-acle" class="header-anchor">#&lt;/a>
5.2 å¦‚ä½•ä½¿ç”¨ ACLE
&lt;/h3>
&lt;ul>
&lt;li>å¼•å…¥å¤´æ–‡ä»¶
&lt;ul>
&lt;li>&lt;code>arm_acle.h&lt;/code> ï¼šæ ¸å¿ƒ ACLE&lt;/li>
&lt;li>&lt;code>arm_fp16.h&lt;/code> ï¼šæ·»åŠ  FP16 æ•°æ®ç±»å‹ã€‚
&lt;ul>
&lt;li>ç›®æ ‡å¹³å°éœ€æ”¯æŒ FP16ï¼Œå³ &lt;code>march=armv8-a+fp16&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>arm_neon.h&lt;/code> ï¼šæ·»åŠ  NEON Intrinsics å’Œæ•°æ®ç±»å‹ã€‚
&lt;ul>
&lt;li>ç›®æ ‡å¹³å°éœ€æ”¯æŒ NEONï¼Œå³ &lt;code>march=armv8-a+simd&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>arm_sve.h&lt;/code> ï¼šæ·»åŠ  SVE Intrinsics å’Œæ•°æ®ç±»å‹ã€‚
&lt;ul>
&lt;li>ç›®æ ‡å¹³å°éœ€æ”¯æŒ SVEï¼Œå³ &lt;code>march=armv8-a+sve&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="53-sve-acle">
&lt;a href="#53-sve-acle" class="header-anchor">#&lt;/a>
5.3 SVE ACLE
&lt;/h3>
&lt;ul>
&lt;li>é¦–å…ˆéœ€è¦åšçš„æ˜¯å¼•å…¥å¤´æ–‡ä»¶&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-c">#include &amp;lt;arm_sve.h&amp;gt;
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>VLA æ•°æ®ç±»å‹
&lt;ul>
&lt;li>&lt;code>svfloat64_t&lt;/code>, &lt;code>svfloat16_t&lt;/code>, &lt;code>svuint32_t&lt;/code> ç­‰ã€‚&lt;/li>
&lt;li>å‘½åè§„åˆ™ï¼š&lt;code>sv&amp;lt;datatype&amp;gt;&amp;lt;datasize&amp;gt;_t&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Predication
&lt;ul>
&lt;li>åˆå¹¶ï¼š&lt;code>_m&lt;/code>&lt;/li>
&lt;li>ç½®é›¶ï¼š&lt;code>_z&lt;/code>&lt;/li>
&lt;li>ä¸ç¡®å®šï¼š&lt;code>_x&lt;/code>&lt;/li>
&lt;li>P å¯„å­˜å™¨çš„æ•°æ®ç±»å‹ï¼š&lt;code>svbool_t&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä½¿ç”¨æ³›å‹åšå‡½æ•°é‡è½½ï¼Œæ¯”å¦‚å‡½æ•° &lt;code>svadd&lt;/code> ä¼šæ ¹æ®å‚æ•°ç±»å‹è‡ªåŠ¨é€‰æ‹©å¯¹åº”çš„å‡½æ•°ã€‚&lt;/li>
&lt;li>å‡½æ•°å‘½åè§„åˆ™ï¼š&lt;code>svbase[disambiguator][type0][type1]...[predication]&lt;/code>
&lt;ul>
&lt;li>base æŒ‡çš„æ˜¯åŸºæœ¬æ“ä½œï¼Œæ¯”å¦‚ &lt;code>add&lt;/code>ã€&lt;code>mul&lt;/code>ã€&lt;code>sub&lt;/code> ç­‰ã€‚&lt;/li>
&lt;li>disambiguator ç”¨äºåŒºåˆ†ç›¸åŒåŸºæœ¬æ“ä½œçš„ä¸åŒå˜ä½“ã€‚&lt;/li>
&lt;li>typeN æŒ‡å®šäº†å‘é‡å’Œ P å¯„å­˜å™¨çš„ç±»å‹ã€‚&lt;/li>
&lt;li>predication æŒ‡å®šäº†éæ´»åŠ¨å…ƒç´ çš„å¤„ç†æ–¹å¼ã€‚&lt;/li>
&lt;li>ä¾‹å¦‚ï¼š &lt;code>svfloat64_t svld1_f64&lt;/code>, &lt;code>svbool_t svwhilelt_b8&lt;/code>, &lt;code>svuint32_t svmla_u32_z&lt;/code>, &lt;code>svuint32_t svmla_u32_m&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="54-sve-å¸¸ç”¨-intrinsics">
&lt;a href="#54-sve-%e5%b8%b8%e7%94%a8-intrinsics" class="header-anchor">#&lt;/a>
5.4 SVE å¸¸ç”¨ Intrinsics
&lt;/h3>
&lt;ul>
&lt;li>Predicate
&lt;ul>
&lt;li>Predicate æ˜¯ä¸€ä¸ª bool ç±»å‹çš„å‘é‡ï¼Œç”¨äºæ§åˆ¶è®¡ç®—è¿‡ç¨‹ä¸­å‘é‡ä¸­å¯¹åº”ä½ç½®æ˜¯å¦å‚ä¸è¿ç®—&lt;/li>
&lt;li>&lt;code>svbool_t pg = svwhilelt_b32(i, num)&lt;/code> äº§ç”Ÿ (i, i + 1, i + 2, &amp;hellip;, i + vl - 1) &amp;lt; num çš„ predicate&lt;/li>
&lt;li>&lt;code>svbool_t pg = svptrue_b32()&lt;/code> äº§ç”Ÿä¸€ä¸ªå…¨ä¸º true çš„ predicate&lt;/li>
&lt;li>å…¶ä¸­ï¼Œb32 å¯¹åº”å¤„ç† 32 ä½æ•°æ®ï¼ˆint/floatï¼‰ï¼Œæ­¤å¤–è¿˜æœ‰ b8, b16, b64 å¯¹åº”çš„ intrinsic&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å†…å­˜æ•°æ®å­˜å–
&lt;ul>
&lt;li>&lt;code>svld1(pg, *base)&lt;/code>ï¼š ä»åœ°å€ base ä¸­åŠ è½½è¿ç»­å‘é‡ã€‚&lt;/li>
&lt;li>&lt;code>svst1(pg, *base, vec)&lt;/code>ï¼š å°†å‘é‡ vec å­˜å‚¨åˆ°åœ°å€ base ä¸­ã€‚&lt;/li>
&lt;li>&lt;code>svld1_gather_index(pg, *base, vec_index)&lt;/code>ï¼š ä»åœ°å€ base ä¸­åŠ è½½å‘é‡ç´¢å¼•å¯¹åº”çš„æ•°æ®ã€‚&lt;/li>
&lt;li>&lt;code>svst1_scatter_index(pg, *base, vec_index, vec)&lt;/code>ï¼š å°†å‘é‡ vec ä¸­æ•°æ®å­˜å‚¨åˆ°å‘é‡ç´¢å¼•å¯¹åº”çš„ä½ç½®ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åŸºç¡€è®¡ç®—
&lt;ul>
&lt;li>&lt;code>svadd_z(pg, sv_vec1, sv_vec2)&lt;/code>&lt;/li>
&lt;li>&lt;code>svadd_m(pg, sv_vec1, sv_vec2)&lt;/code>&lt;/li>
&lt;li>&lt;code>svadd_x(pg, sv_vec1, sv_vec2)&lt;/code>&lt;/li>
&lt;li>&lt;code>svadd_x(pg, sv_vec1, x)&lt;/code>&lt;/li>
&lt;li>å…¶ä¸­ï¼Œ&lt;code>_z&lt;/code> è¡¨ç¤ºå°† pg ä¸º false çš„ä½ç½®ç½®é›¶ï¼Œ&lt;code>_m&lt;/code> è¡¨ç¤ºä¿ç•™åŸå€¼ï¼Œ&lt;code>_x&lt;/code> è¡¨ç¤ºä¸ç¡®å®šï¼ˆä»€ä¹ˆå€¼éƒ½æœ‰å¯èƒ½ï¼‰ã€‚&lt;/li>
&lt;li>ç¬¬äºŒä¸ªæ“ä½œæ•°å¯ä»¥ä¸ºæ ‡é‡æ•°æ®ã€‚&lt;/li>
&lt;li>&lt;code>svmul&lt;/code>, &lt;code>svsub&lt;/code>, &lt;code>svsubr&lt;/code>, &lt;code>svdiv&lt;/code>, &lt;code>svdivr&lt;/code>ï¼šå…¶ä¸­ï¼Œ&lt;code>svsubr&lt;/code> ç›¸æ¯” &lt;code>svsub&lt;/code> äº¤æ¢äº†å‡æ•°ä¸è¢«å‡æ•°çš„ä½ç½®ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å…¶å®ƒ
&lt;ul>
&lt;li>&lt;code>svdup_f64(double x)&lt;/code>ï¼š ç”Ÿæˆä¸€ä¸ªæ‰€æœ‰å…ƒç´ éƒ½ä¸º x çš„å‘é‡ã€‚&lt;/li>
&lt;li>&lt;code>svcntd()&lt;/code>ï¼šè¿”å› 64-bit æ•°æ®çš„å‘é‡é•¿åº¦ï¼š&lt;code>svcntb&lt;/code> å¯¹åº” 8 ä½ï¼Œ &lt;code>svcnth&lt;/code> å¯¹åº” 16 ä½ï¼Œ&lt;code>svcntw&lt;/code> å¯¹åº” 32 ä½ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="55-sve-ç»“æ„ä½“-intrinsics">
&lt;a href="#55-sve-%e7%bb%93%e6%9e%84%e4%bd%93-intrinsics" class="header-anchor">#&lt;/a>
5.5 SVE ç»“æ„ä½“ Intrinsics
&lt;/h3>
&lt;p>å¯¹åº”ç»“æ„ä½“æ•°æ®ï¼ŒSVE æä¾›äº†ä¸€äº›ç‰¹æ®Šçš„ Intrinsicsï¼Œæ¯”å¦‚ï¼š&lt;code>svld3&lt;/code>, &lt;code>svget3&lt;/code>, &lt;code>svset3&lt;/code>, &lt;code>svst3&lt;/code> ç­‰ã€‚è¿™äº› Intrinsics ç”¨äºå¤„ç†ç»“æ„ä½“æ•°æ®ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œå¯¹äºç²’å­ç»“æ„ä½“ï¼š&lt;/p>
&lt;pre>&lt;code class="language-c">typedef struct {
float x;
float y;
float z;
} Particle;
&lt;/code>&lt;/pre>
&lt;p>å¯ä»¥ä½¿ç”¨ &lt;code>svld3&lt;/code> åŠ è½½ç»“æ„ä½“ä¸­å…¨éƒ¨çš„æ•°æ®ä¸º 3 ä¸ªå‘é‡çš„ç»„ï¼Œç„¶åä½¿ç”¨ &lt;code>svget3&lt;/code> ä» 3 ä¸ªå‘é‡çš„ç»„ä¸­æå–ä¸€ä¸ªå‘é‡, index çš„å€¼ä¸º 0, 1, 2 åˆ†åˆ«å¯¹åº” x, y, zã€‚&lt;/p>
&lt;pre>&lt;code class="language-c">Particle *ps;
float factor = 2.2;
// åˆå§‹åŒ–éƒ¨åˆ†çœç•¥
for (int i = 0; i &amp;lt; num; i += svcntw()) {
svbool_t pg = svwhilelt_b32(i, num);
svfloat32x3_t sv_ps = svld3(pg, (float32_t *)&amp;amp;ps[i]);
svfloat32_t sv_ps_x = svget3(sv_ps, 0);
svfloat32_t sv_ps_y = svget3(sv_ps, 1);
// æ‰§è¡Œè®¡ç®—
sv_ps_x = svmul_x(pg, sv_ps_x, factor);
sv_ps_y = svmul_x(pg, sv_ps_y, factor);
//ä¿å­˜ç»“æœ
sv_ps = svset3(sv_ps, 0, sv_ps_x);
sv_ps = svset3(sv_ps, 1, sv_ps_y);
svst3(pg, (float32_t *)&amp;amp;ps[i], sv_ps);
}
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>&lt;code>svld3(pg, *base)&lt;/code>ï¼š åŠ è½½ç»“æ„ä½“ä¸­å…¨éƒ¨çš„æ•°æ®ä¸º 3 ä¸ªå‘é‡çš„ç»„ï¼›å…¶ä¸­ï¼Œbase æ˜¯ 3 ä¸ªå…ƒç´ ç»“æ„ä½“æ•°ç»„çš„åœ°å€ã€‚&lt;/li>
&lt;li>&lt;code>svget3(tuple, index)&lt;/code>ï¼š ä» 3 ä¸ªå‘é‡çš„ç»„ä¸­æå–ä¸€ä¸ªå‘é‡ï¼›index çš„å€¼ä¸º 0ã€1 æˆ– 2ã€‚&lt;/li>
&lt;li>&lt;code>svset3(tuple, index, vec)&lt;/code>ï¼š è®¾ç½® 3 ä¸ªå‘é‡çš„ç»„ä¸­çš„ä¸€ä¸ªå‘é‡ï¼›index çš„å€¼ä¸º 0ã€1 æˆ– 2ã€‚&lt;/li>
&lt;li>&lt;code>svst3(pg, *base, vec)&lt;/code>ï¼š å°† 3 ä¸ªå‘é‡çš„ç»„å­˜å‚¨åˆ°ç»“æ„ä½“ä¸­ï¼›å…¶ä¸­ï¼Œbase æ˜¯ 3 ä¸ªå…ƒç´ ç»“æ„ä½“æ•°ç»„çš„åœ°å€ã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="56-sve-æ¡ä»¶é€‰æ‹©">
&lt;a href="#56-sve-%e6%9d%a1%e4%bb%b6%e9%80%89%e6%8b%a9" class="header-anchor">#&lt;/a>
5.6 SVE æ¡ä»¶é€‰æ‹©
&lt;/h3>
&lt;p>SVE ä¸­æä¾›äº† &lt;code>svcmplt&lt;/code>ã€&lt;code>svcompact&lt;/code>ã€&lt;code>svcntp_b32&lt;/code> ç­‰æ–¹æ³•ï¼Œå¯ä»¥æ ¹æ®æ¡ä»¶é€‰æ‹©ä¿ç•™å‘é‡ä¸­çš„å…ƒç´ ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œå¯¹äºæ— å‘é‡åŒ–çš„ä»£ç ï¼š&lt;/p>
&lt;pre>&lt;code class="language-c">for (int i = 0; i &amp;lt; num; i++) {
float tmp = provided[i];
if (tmp &amp;lt; mark) {
selected[count++] = tmp;
if (count &amp;gt;= maxSize) {
break;
}
}
}
&lt;/code>&lt;/pre>
&lt;p>è¯¥ä»£ç çš„ä½œç”¨æ˜¯ä» provided æ•°ç»„ä¸­é€‰æ‹©å°äº mark çš„å…ƒç´ ï¼Œå­˜å‚¨åˆ° selected æ•°ç»„ä¸­ï¼Œç›´åˆ° selected æ•°ç»„æ»¡ã€‚&lt;/p>
&lt;p>ç”¨ SVE Intrinsic æ”¹å†™ï¼š&lt;/p>
&lt;pre>&lt;code class="language-c">for (int i = 0; i &amp;lt; num; i += svcntw()) {
svbool_t pg = svwhilelt_b32(i, num);
svfloat32_t sv_tmp = svld1(pg, &amp;amp;provided[i]);
svbool_t pg_sel = svcmplt(pg, sv_tmp, mark);
sv_tmp = svcompact(pg_sel, sv_tmp);
svst1(pg, &amp;amp;selected[count], sv_tmp);
count += svcntp_b32(pg, pg_sel);
if (count &amp;gt;= maxSize) {
break;
}
}
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>&lt;code>svcmplt(pg, vec1, vec2)&lt;/code> ï¼šæ¯”è¾ƒä¸¤ä¸ªå‘é‡çš„å¤§å°ï¼Œè¿”å›ä¸€ä¸ª predicateï¼Œè¡¨ç¤º vec1 ä¸­å°äº vec2 çš„ä½ç½®ã€‚&lt;/li>
&lt;li>&lt;code>svcompact(pg, sv_tmp)&lt;/code> ï¼šå‹ç¼©å‘é‡ï¼Œå°† pg ä¸º active çš„æ•°æ®æŒ‰åºç§»åŠ¨åˆ°å‘é‡ä½ä½ï¼Œå…¶ä½™ä½ç½®ç½®é›¶ã€‚&lt;/li>
&lt;li>&lt;code>svcntp_b32(pg, pg2)&lt;/code> ï¼šè¿”å› pg2 ä¸­ active çš„å…ƒç´ ä¸ªæ•°&lt;/li>
&lt;li>è¿™æ®µä»£ç å…ˆå°† provided æ•°ç»„ä¸­çš„æ•°æ®åŠ è½½åˆ° sv_tmp ä¸­ï¼Œç„¶åä½¿ç”¨ &lt;code>svcmplt&lt;/code> ç”Ÿæˆä¸€ä¸ª predicateï¼Œè¡¨ç¤ºå°äº mark çš„ä½ç½®ã€‚æ¥ç€ä½¿ç”¨ &lt;code>svcompact&lt;/code> å‹ç¼© sv_tmpï¼Œå¾—åˆ°å°äº mark çš„æ•°æ®ï¼Œå†é€šè¿‡ &lt;code>svst1&lt;/code> å­˜å‚¨åˆ° selected æ•°ç»„ä¸­ã€‚æœ€åï¼Œä½¿ç”¨ &lt;code>svcntp_b32&lt;/code> ç»Ÿè®¡ active çš„å…ƒç´ ä¸ªæ•°ï¼Œæ›´æ–° countã€‚&lt;/li>
&lt;/ul>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_compact.webp"
alt="compact-2024-08-13" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>svcompact ç¤ºæ„å›¾ï¼ˆ256-bit å‘é‡ï¼‰&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>ç”±äºè¿›è¡Œäº† compact æ“ä½œï¼Œæ‰€ä»¥ selected æ•°ç»„ä» count ä½ç½®è¿ç»­å­˜å‚¨æ–°çš„å°äº mark çš„æ•°æ®ï¼Œå‰©ä¸‹çš„ä½ç½®è¢«ç½®é›¶ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-08-13_svst1.webp"
alt="svst1-2024-08-13" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>svst1 ç¤ºæ„å›¾ï¼ˆ256-bit å‘é‡ï¼‰&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h3 id="57-sve-å‘é‡åŒ–å¾ªç¯äº¤ç»‡">
&lt;a href="#57-sve-%e5%90%91%e9%87%8f%e5%8c%96%e5%be%aa%e7%8e%af%e4%ba%a4%e7%bb%87" class="header-anchor">#&lt;/a>
5.7 SVE å‘é‡åŒ–å¾ªç¯äº¤ç»‡
&lt;/h3>
&lt;p>SVE Intrinsic å®ç°çš„å‘é‡åŒ–å¾ªç¯äº¤ç»‡ï¼Œç›¸æ¯”ç¼–è¯‘å™¨è‡ªåŠ¨å‘é‡åŒ–èƒ½å¤§å¤§å‡å°‘è¯»å–å‘é‡çš„æ¬¡æ•°ã€‚&lt;/p>
&lt;p>ä¾‹å¦‚ï¼Œå¯¹äºæ— å‘é‡åŒ–çš„ä»£ç ï¼š&lt;/p>
&lt;pre>&lt;code class="language-c">for (int j = offset; j &amp;lt; outerLen - offset; j++) {
int m2index = (j - offset) * innerLen;
int m1index = m2index + innerLen;
int m0index = m1index + innerLen;
int p1index = m0index + innerLen;
int p2index = p1index + innerLen;
for (int i = 0; i &amp;lt; innerLen; i++) {
res[m0index + i] = m2factor * field[m2index + i] +
m1factor * field[m1index + i] +
m0factor * field[m0index + i] +
p1factor * field[p1index + i] +
p2factor * field[p2index + i];
}
}
&lt;/code>&lt;/pre>
&lt;p>ç¼–è¯‘å™¨å¯¹è¯¥ä»£ç è¿›è¡Œè‡ªåŠ¨å‘é‡åŒ–åï¼Œæ¯æ¬¡è¿­ä»£éœ€è¯»å–äº”æ¬¡ä¸åŒå‘é‡çš„æ•°æ®ï¼Œæ•ˆç‡è¾ƒä½ã€‚&lt;/p>
&lt;p>ç”¨ SVE Intrinsic æ”¹å†™ï¼š&lt;/p>
&lt;pre>&lt;code class="language-c">for (int i = 0; i &amp;lt; innerLen; i += svcntd()) {
svbool_t pg = svwhilelt_b32(i, innerLen);
int dataIndex = i;
svfloat64_t jm2Field = svld1(pg, &amp;amp;field[dataIndex]);
dataIndex += innerLen;
svfloat64_t jm1Field = svld1(pg, &amp;amp;field[dataIndex]);
dataIndex += innerLen;
svfloat64_t jm0Field = svld1(pg, &amp;amp;field[dataIndex]);
dataIndex += innerLen;
svfloat64_t jp1Field = svld1(pg, &amp;amp;field[dataIndex]);
for (int j = offset; j &amp;lt; outerLen - offset; j += 1) {
svfloat64_t jp2Field = svld1(pg, &amp;amp;field[(j + offset) * innerLen + i]);
svfloat64_t svRes = svmul_x(pg, jm2Field, m2factor);
svRes = svmad_x(pg, jm1Field, m1factor, svRes);
svRes = svmad_x(pg, jm0Field, m0factor, svRes);
svRes = svmad_x(pg, jp1Field, p1factor, svRes);
svRes = svmad_x(pg, jp2Field, p2factor, svRes);
svst1(pg, &amp;amp;res[j * innerLen + 1], svRes);
jm2Field = jm1Field;
jm1Field = jm0Field;
jm0Field = jp1Field;
jp1Field = jp2Field;
}
}
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>&lt;code>svmad_x(pg, vec1, vec2, vec3)&lt;/code> ï¼šè®¡ç®— vec1 * vec2 + vec3ï¼Œè¿”å›ä¸€ä¸ªå‘é‡ã€‚&lt;/li>
&lt;li>è¿™æ®µä»£ç æ¯æ¬¡è¿­ä»£åªéœ€è¯»å–ä¸€ä¸ªå‘é‡ï¼Œå¤§å¤§å‡å°‘å‘é‡è¯»å–çš„æ¬¡æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="å‚è€ƒæ–‡çŒ®">
&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae" class="header-anchor">#&lt;/a>
å‚è€ƒæ–‡çŒ®
&lt;/h2>
&lt;ol>
&lt;li>&lt;a class="link" href="https://developer.arm.com/-/media/Arm%20Developer%20Community/PDF/102340_0001_02_en_introduction-to-sve2.pdf?revision=b208e56b-6569-4ae2-b6f3-cd7d5d1ecac3" target="_blank" rel="noopener" >Introduction to SVE2
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/li>
&lt;li>&lt;a class="link" href="https://www.stonybrook.edu/commcms/ookami/support/_docs/5%20-%20Advanced%20SVE.pdf" target="_blank" rel="noopener" >SVE Deep Dive
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/li>
&lt;li>&lt;a class="link" href="https://arm-software.github.io/acle/main/acle.html" target="_blank" rel="noopener" >Arm C Language Extensions
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/li>
&lt;/ol></description></item><item><title>LLM ç”Ÿæ€ä»‹ç»ï¼šä»æ¨¡å‹å¾®è°ƒåˆ°åº”ç”¨è½åœ°</title><link>https://cuterwrite.top/p/llm-ecosystem/</link><pubDate>Fri, 05 Jul 2024 22:46:00 +0000</pubDate><guid>https://cuterwrite.top/p/llm-ecosystem/</guid><description>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-29_119269220_p0_master1200.webp" alt="Featured image of post LLM ç”Ÿæ€ä»‹ç»ï¼šä»æ¨¡å‹å¾®è°ƒåˆ°åº”ç”¨è½åœ°" />&lt;h1 id="llm-ç”Ÿæ€ä»‹ç»ä»æ¨¡å‹å¾®è°ƒåˆ°åº”ç”¨è½åœ°">
&lt;a href="#llm-%e7%94%9f%e6%80%81%e4%bb%8b%e7%bb%8d%e4%bb%8e%e6%a8%a1%e5%9e%8b%e5%be%ae%e8%b0%83%e5%88%b0%e5%ba%94%e7%94%a8%e8%90%bd%e5%9c%b0" class="header-anchor">#&lt;/a>
LLM ç”Ÿæ€ä»‹ç»ï¼šä»æ¨¡å‹å¾®è°ƒåˆ°åº”ç”¨è½åœ°
&lt;/h1>
&lt;h2 id="æ¨¡å‹å¾®è°ƒ">
&lt;a href="#%e6%a8%a1%e5%9e%8b%e5%be%ae%e8%b0%83" class="header-anchor">#&lt;/a>
æ¨¡å‹å¾®è°ƒ
&lt;/h2>
&lt;p>é¢„è®­ç»ƒçš„ LLM é€šå¸¸å…·å¤‡å¹¿æ³›çš„çŸ¥è¯†ï¼Œä½†è¦ä½¿å…¶åœ¨ç‰¹å®šä»»åŠ¡ä¸Šè¡¨ç°å‡ºè‰²ï¼Œå¾®è°ƒæ˜¯å¿…ä¸å¯å°‘çš„ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ LLM å¾®è°ƒå·¥å…·ï¼š&lt;/p>
&lt;h3 id="axolotl">
&lt;a href="#axolotl" class="header-anchor">#&lt;/a>
Axolotl
&lt;/h3>
&lt;a href="https://github.com/OpenAccess-AI-Collective/axolotl" target="_blank" class="card-github fetch-waiting no-styling"
repo="OpenAccess-AI-Collective/axolotl" id="repo-jaqLOd4bBSAit07Q-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-jaqLOd4bBSAit07Q-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">OpenAccess-AI-Collective&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">axolotl&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-jaqLOd4bBSAit07Q-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-jaqLOd4bBSAit07Q-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-jaqLOd4bBSAit07Q-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-jaqLOd4bBSAit07Q-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-jaqLOd4bBSAit07Q-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-jaqLOd4bBSAit07Q-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/OpenAccess-AI-Collective\/axolotl', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-jaqLOd4bBSAit07Q-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-jaqLOd4bBSAit07Q-language').innerText = data.language;
document.getElementById('repo-jaqLOd4bBSAit07Q-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-jaqLOd4bBSAit07Q-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-jaqLOd4bBSAit07Q-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-jaqLOd4bBSAit07Q-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-jaqLOd4bBSAit07Q-license').classList.add = "no-license"
};
document.getElementById('repo-jaqLOd4bBSAit07Q-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for OpenAccess-AI-Collective\/axolotl.")
}).catch(err => {
const c = document.getElementById('repo-jaqLOd4bBSAit07Q-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for OpenAccess-AI-Collective\/axolotl.")
})
&lt;/script>
&lt;p>Axolotl æ˜¯ä¸€æ¬¾æ—¨åœ¨ç®€åŒ–å„ç§äººå·¥æ™ºèƒ½æ¨¡å‹å¾®è°ƒçš„å·¥å…·ï¼Œæ”¯æŒå¤šç§é…ç½®å’Œæ¶æ„ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>è®­ç»ƒå„ç§ Huggingface æ¨¡å‹ï¼Œå¦‚ llamaã€pythiaã€falconã€mpt&lt;/li>
&lt;li>æ”¯æŒ fullfinetuneã€loraã€qloraã€relora å’Œ gptq&lt;/li>
&lt;li>ä½¿ç”¨ç®€å•çš„ yaml æ–‡ä»¶æˆ– CLI é‡å†™åŠŸèƒ½è‡ªå®šä¹‰é…ç½®&lt;/li>
&lt;li>åŠ è½½ä¸åŒçš„æ•°æ®é›†æ ¼å¼ï¼Œä½¿ç”¨è‡ªå®šä¹‰æ ¼å¼ï¼Œæˆ–è‡ªå¸¦æ ‡è®°åŒ–æ•°æ®é›†&lt;/li>
&lt;li>ä¸ xformerã€é—ªå­˜å…³æ³¨ã€ç»³ç´¢ç¼©æ”¾å’Œå¤šé‡åŒ…è£…é›†æˆ&lt;/li>
&lt;li>å¯é€šè¿‡ FSDP æˆ– Deepspeed ä¸å• GPU æˆ–å¤š GPU ååŒå·¥ä½œ&lt;/li>
&lt;li>ä½¿ç”¨ Docker åœ¨æœ¬åœ°æˆ–äº‘ç«¯è½»æ¾è¿è¡Œ&lt;/li>
&lt;li>å°†ç»“æœå’Œå¯é€‰çš„æ£€æŸ¥ç‚¹è®°å½•åˆ° wandb æˆ– mlflow ä¸­&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>å¿«é€Ÿå…¥é—¨ï¼š&lt;/strong>
è¦æ±‚ï¼š Python &amp;gt;=3.10 å’Œ Pytorch &amp;gt;=2.1.1&lt;/p>
&lt;pre>&lt;code class="language-bash">git clone https://github.com/OpenAccess-AI-Collective/axolotl
cd axolotl
pip3 install packaging ninja
pip3 install -e '.[flash-attn,deepspeed]'
&lt;/code>&lt;/pre>
&lt;p>&lt;strong>ä½¿ç”¨æ–¹æ³•ï¼š&lt;/strong>&lt;/p>
&lt;pre>&lt;code class="language-bash"># preprocess datasets - optional but recommended
CUDA_VISIBLE_DEVICES=&amp;quot;&amp;quot; python -m axolotl.cli.preprocess examples/openllama-3b/lora.yml
# finetune lora
accelerate launch -m axolotl.cli.train examples/openllama-3b/lora.yml
# inference
accelerate launch -m axolotl.cli.inference examples/openllama-3b/lora.yml \
--lora_model_dir=&amp;quot;./outputs/lora-out&amp;quot;
# gradio
accelerate launch -m axolotl.cli.inference examples/openllama-3b/lora.yml \
--lora_model_dir=&amp;quot;./outputs/lora-out&amp;quot; --gradio
# remote yaml files - the yaml config can be hosted on a public URL
# Note: the yaml config must directly link to the **raw** yaml
accelerate launch -m axolotl.cli.train https://raw.githubusercontent.com/OpenAccess-AI-Collective/axolotl/main/examples/openllama-3b/lora.yml
&lt;/code>&lt;/pre>
&lt;p>å…¶å®ƒè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/OpenAccess-AI-Collective/axolotl" target="_blank" rel="noopener" >Axolotl
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="llama-factory">
&lt;a href="#llama-factory" class="header-anchor">#&lt;/a>
Llama-Factory
&lt;/h3>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-07-07_llama-factory-logo.webp"
alt="Llama Factory Logo" width="80%" loading="lazy">
&lt;/figure>
&lt;a href="https://github.com/hiyouga/LLaMA-Factory" target="_blank" class="card-github fetch-waiting no-styling"
repo="hiyouga/LLaMA-Factory" id="repo-A3S0pZWd7DXNouQS-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-A3S0pZWd7DXNouQS-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">hiyouga&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">LLaMA-Factory&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-A3S0pZWd7DXNouQS-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-A3S0pZWd7DXNouQS-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-A3S0pZWd7DXNouQS-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-A3S0pZWd7DXNouQS-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-A3S0pZWd7DXNouQS-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-A3S0pZWd7DXNouQS-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/hiyouga\/LLaMA-Factory', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-A3S0pZWd7DXNouQS-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-A3S0pZWd7DXNouQS-language').innerText = data.language;
document.getElementById('repo-A3S0pZWd7DXNouQS-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-A3S0pZWd7DXNouQS-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-A3S0pZWd7DXNouQS-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-A3S0pZWd7DXNouQS-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-A3S0pZWd7DXNouQS-license').classList.add = "no-license"
};
document.getElementById('repo-A3S0pZWd7DXNouQS-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for hiyouga\/LLaMA-Factory.")
}).catch(err => {
const c = document.getElementById('repo-A3S0pZWd7DXNouQS-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for hiyouga\/LLaMA-Factory.")
})
&lt;/script>
&lt;p>Llama-Factory æ˜¯ Meta æ¨å‡ºçš„ï¼Œä¸“æ³¨äº Llama æ¨¡å‹å¾®è°ƒçš„æ¡†æ¶ã€‚å®ƒæ„å»ºäº PyTorch ç”Ÿæ€ä¹‹ä¸Šï¼Œå¹¶æä¾›é«˜æ•ˆçš„è®­ç»ƒå’Œè¯„ä¼°å·¥å…·ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å¤šç§æ¨¡å‹&lt;/strong>ï¼šLLaMAã€LLaVAã€Mistralã€Mixtral-MoEã€Qwenã€Yiã€Gemmaã€Baichuanã€ChatGLMã€Phi ç­‰ç­‰ã€‚&lt;/li>
&lt;li>&lt;strong>é›†æˆæ–¹æ³•&lt;/strong>ï¼šï¼ˆå¢é‡ï¼‰é¢„è®­ç»ƒã€ï¼ˆå¤šæ¨¡æ€ï¼‰æŒ‡ä»¤ç›‘ç£å¾®è°ƒã€å¥–åŠ±æ¨¡å‹è®­ç»ƒã€PPO è®­ç»ƒã€DPO è®­ç»ƒã€KTO è®­ç»ƒã€ORPO è®­ç»ƒç­‰ç­‰ã€‚&lt;/li>
&lt;li>&lt;strong>å¤šç§ç²¾åº¦&lt;/strong>ï¼š16 æ¯”ç‰¹å…¨å‚æ•°å¾®è°ƒã€å†»ç»“å¾®è°ƒã€LoRA å¾®è°ƒå’ŒåŸºäº AQLM/AWQ/GPTQ/LLM.int8/HQQ/EETQ çš„ 2/3/4/5/6/8 æ¯”ç‰¹ QLoRA å¾®è°ƒã€‚&lt;/li>
&lt;li>&lt;strong>å…ˆè¿›ç®—æ³•&lt;/strong>ï¼šGaLoreã€BAdamã€DoRAã€LongLoRAã€LLaMA Proã€Mixture-of-Depthsã€LoRA+ã€LoftQã€PiSSA å’Œ Agent å¾®è°ƒã€‚&lt;/li>
&lt;li>&lt;strong>å®ç”¨æŠ€å·§&lt;/strong>ï¼šFlashAttention-2ã€Unslothã€RoPE scalingã€NEFTune å’Œ rsLoRAã€‚&lt;/li>
&lt;li>&lt;strong>å®éªŒç›‘æ§&lt;/strong>ï¼šLlamaBoardã€TensorBoardã€Wandbã€MLflow ç­‰ç­‰ã€‚&lt;/li>
&lt;li>&lt;strong>æé€Ÿæ¨ç†&lt;/strong>ï¼šåŸºäº vLLM çš„ OpenAI é£æ ¼ APIã€æµè§ˆå™¨ç•Œé¢å’Œå‘½ä»¤è¡Œæ¥å£ã€‚&lt;/li>
&lt;/ul>
&lt;link href="https://web.sdk.qcloud.com/player/tcplayer/release/v4.2.1/tcplayer.min.css" rel="stylesheet">
&lt;script src="https://web.sdk.qcloud.com/player/tcplayer/release/v4.2.1/libs/hls.min.0.13.2m.js">&lt;/script>
&lt;script src="https://web.sdk.qcloud.com/player/tcplayer/release/v4.2.1/tcplayer.v4.2.1.min.js">&lt;/script>
&lt;style>
.tcplayer {
position: absolute;
width: 100%;
height: 100%;
left: 0;
top: 0;
border: 0;
}
&lt;/style>
&lt;div class="video-wrapper">
&lt;video
id="player-container-id"
preload="auto"
width="100%"
height="100%"
playsinline
webkit-playsinline>
&lt;/video>
&lt;/div>
&lt;script>
var tcplayer = TCPlayer("player-container-id", {
reportable: false,
poster: "",
});
tcplayer.src('https:\/\/cloud.cuterwrite.fun\/img\/2024-07-07_309488092-ec36a9dd-37f4-4f72-81bd-d76c6d0a6594_output.mp4');
&lt;/script>
&lt;p>&lt;strong>æ€§èƒ½æŒ‡æ ‡&lt;/strong>&lt;/p>
&lt;p>ä¸ ChatGLM å®˜æ–¹çš„ &lt;a class="link" href="https://github.com/THUDM/ChatGLM2-6B/tree/main/ptuning" target="_blank" rel="noopener" >P-Tuning
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
å¾®è°ƒç›¸æ¯”ï¼ŒLLaMA Factory çš„ LoRA å¾®è°ƒæä¾›äº† &lt;strong>3.7 å€&lt;/strong>çš„åŠ é€Ÿæ¯”ï¼ŒåŒæ—¶åœ¨å¹¿å‘Šæ–‡æ¡ˆç”Ÿæˆä»»åŠ¡ä¸Šå–å¾—äº†æ›´é«˜çš„ Rouge åˆ†æ•°ã€‚ç»“åˆ 4 æ¯”ç‰¹é‡åŒ–æŠ€æœ¯ï¼ŒLLaMA Factory çš„ QLoRA å¾®è°ƒè¿›ä¸€æ­¥é™ä½äº† GPU æ˜¾å­˜æ¶ˆè€—ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-07-07_benchmark.webp"
alt="Performance" width="auto" loading="lazy">
&lt;/figure>
&lt;details>
&lt;summary>å˜é‡å®šä¹‰&lt;/summary>
&lt;ul>
&lt;li>&lt;strong>Training Speed&lt;/strong>: è®­ç»ƒé˜¶æ®µæ¯ç§’å¤„ç†çš„æ ·æœ¬æ•°é‡ã€‚ï¼ˆæ‰¹å¤„ç†å¤§å°=4ï¼Œæˆªæ–­é•¿åº¦=1024ï¼‰&lt;/li>
&lt;li>&lt;strong>Rouge Score&lt;/strong>: &lt;a class="link" href="https://aclanthology.org/D19-1321.pdf" target="_blank" rel="noopener" >å¹¿å‘Šæ–‡æ¡ˆç”Ÿæˆ
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ä»»åŠ¡éªŒè¯é›†ä¸Šçš„ Rouge-2 åˆ†æ•°ã€‚ï¼ˆæ‰¹å¤„ç†å¤§å°=4ï¼Œæˆªæ–­é•¿åº¦=1024ï¼‰&lt;/li>
&lt;li>&lt;strong>GPU Memory&lt;/strong>: 4 æ¯”ç‰¹é‡åŒ–è®­ç»ƒçš„ GPU æ˜¾å­˜å³°å€¼ã€‚ï¼ˆæ‰¹å¤„ç†å¤§å°=1ï¼Œæˆªæ–­é•¿åº¦=1024ï¼‰&lt;/li>
&lt;li>æˆ‘ä»¬åœ¨ ChatGLM çš„ P-Tuning ä¸­é‡‡ç”¨ &lt;code>pre_seq_len=128&lt;/code>ï¼Œåœ¨ LLaMA Factory çš„ LoRA å¾®è°ƒä¸­é‡‡ç”¨ &lt;code>lora_rank=32&lt;/code>ã€‚&lt;/li>
&lt;/ul>
&lt;/details>
&lt;p>&lt;strong>å¿«é€Ÿå…¥é—¨&lt;/strong>&lt;/p>
&lt;pre>&lt;code class="language-bash">git clone --depth 1 https://github.com/hiyouga/LLaMA-Factory.git
cd LLaMA-Factory
pip install -e &amp;quot;.[torch,metrics]&amp;quot;
&lt;/code>&lt;/pre>
&lt;p>å¯é€‰çš„é¢å¤–ä¾èµ–é¡¹ï¼štorchã€torch-npuã€metricsã€deepspeedã€bitsandbytesã€hqqã€eetqã€gptqã€awqã€aqlmã€vllmã€galoreã€badamã€qwenã€modelscopeã€quality&lt;/p>
&lt;blockquote class="alert-blockquote alert-tip">
&lt;p class="alert-heading">
&lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
&lt;path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z">&lt;/path>
&lt;/svg>
&lt;span>æç¤º&lt;/span>
&lt;/p>
&lt;p>é‡åˆ°åŒ…å†²çªæ—¶ï¼Œå¯ä½¿ç”¨ pip install &amp;ndash;no-deps -e . è§£å†³ã€‚&lt;/p>
&lt;/blockquote>
&lt;details>
&lt;summary>Windows ç”¨æˆ·æŒ‡å—&lt;/summary>
&lt;p>å¦‚æœè¦åœ¨ Windows å¹³å°ä¸Šå¼€å¯é‡åŒ– LoRAï¼ˆQLoRAï¼‰ï¼Œéœ€è¦å®‰è£…é¢„ç¼–è¯‘çš„ &lt;code>bitsandbytes&lt;/code> åº“, æ”¯æŒ CUDA 11.1 åˆ° 12.2, è¯·æ ¹æ®æ‚¨çš„ CUDA ç‰ˆæœ¬æƒ…å†µé€‰æ‹©é€‚åˆçš„&lt;a class="link" href="https://github.com/jllllll/bitsandbytes-windows-webui/releases/tag/wheels" target="_blank" rel="noopener" >å‘å¸ƒç‰ˆæœ¬
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/p>
&lt;pre>&lt;code class="language-bash">pip install https://github.com/jllllll/bitsandbytes-windows-webui/releases/download/wheels/bitsandbytes-0.41.2.post2-py3-none-win_amd64.whl
&lt;/code>&lt;/pre>
&lt;p>å¦‚æœè¦åœ¨ Windows å¹³å°ä¸Šå¼€å¯ FlashAttention-2ï¼Œéœ€è¦å®‰è£…é¢„ç¼–è¯‘çš„ &lt;code>flash-attn&lt;/code> åº“ï¼Œæ”¯æŒ CUDA 12.1 åˆ° 12.2ï¼Œè¯·æ ¹æ®éœ€æ±‚åˆ° &lt;a class="link" href="https://github.com/bdashore3/flash-attention/releases" target="_blank" rel="noopener" >flash-attention
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ä¸‹è½½å¯¹åº”ç‰ˆæœ¬å®‰è£…ã€‚&lt;/p>
&lt;/details>
&lt;details>
&lt;summary>æ˜‡è…¾ NPU ç”¨æˆ·æŒ‡å—&lt;/summary>
&lt;p>åœ¨æ˜‡è…¾ NPU è®¾å¤‡ä¸Šå®‰è£… LLaMA Factory æ—¶ï¼Œéœ€è¦æŒ‡å®šé¢å¤–ä¾èµ–é¡¹ï¼Œä½¿ç”¨ &lt;code>pip install -e &amp;quot;.[torch-npu,metrics]&amp;quot;&lt;/code> å‘½ä»¤å®‰è£…ã€‚æ­¤å¤–ï¼Œè¿˜éœ€è¦å®‰è£… &lt;strong>&lt;a class="link" href="https://www.hiascend.com/developer/download/community/result?module=cann" target="_blank" rel="noopener" >Ascend CANN Toolkit ä¸ Kernels
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/strong>ï¼Œå®‰è£…æ–¹æ³•è¯·å‚è€ƒ&lt;a class="link" href="https://www.hiascend.com/document/detail/zh/CANNCommunityEdition/80RC2alpha002/quickstart/quickstart/quickstart_18_0004.html" target="_blank" rel="noopener" >å®‰è£…æ•™ç¨‹
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æˆ–ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p>
&lt;pre>&lt;code class="language-bash"># è¯·æ›¿æ¢ URL ä¸º CANN ç‰ˆæœ¬å’Œè®¾å¤‡å‹å·å¯¹åº”çš„ URL
# å®‰è£… CANN Toolkit
wget https://ascend-repo.obs.cn-east-2.myhuaweicloud.com/Milan-ASL/Milan-ASL%20V100R001C17SPC701/Ascend-cann-toolkit_8.0.RC1.alpha001_linux-&amp;quot;$(uname -i)&amp;quot;.run
bash Ascend-cann-toolkit_8.0.RC1.alpha001_linux-&amp;quot;$(uname -i)&amp;quot;.run --install
# å®‰è£… CANN Kernels
wget https://ascend-repo.obs.cn-east-2.myhuaweicloud.com/Milan-ASL/Milan-ASL%20V100R001C17SPC701/Ascend-cann-kernels-910b_8.0.RC1.alpha001_linux.run
bash Ascend-cann-kernels-910b_8.0.RC1.alpha001_linux.run --install
# è®¾ç½®ç¯å¢ƒå˜é‡
source /usr/local/Ascend/ascend-toolkit/set_env.sh
&lt;/code>&lt;/pre>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">ä¾èµ–é¡¹&lt;/th>
&lt;th style="text-align: left">è‡³å°‘&lt;/th>
&lt;th style="text-align: left">æ¨è&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">CANN&lt;/td>
&lt;td style="text-align: left">8.0.RC1&lt;/td>
&lt;td style="text-align: left">8.0.RC1&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">torch&lt;/td>
&lt;td style="text-align: left">2.1.0&lt;/td>
&lt;td style="text-align: left">2.1.0&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">torch-npu&lt;/td>
&lt;td style="text-align: left">2.1.0&lt;/td>
&lt;td style="text-align: left">2.1.0.post3&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">deepspeed&lt;/td>
&lt;td style="text-align: left">0.13.2&lt;/td>
&lt;td style="text-align: left">0.13.2&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>è¯·ä½¿ç”¨ &lt;code>ASCEND_RT_VISIBLE_DEVICES&lt;/code> è€Œé &lt;code>CUDA_VISIBLE_DEVICES&lt;/code> æ¥æŒ‡å®šè¿ç®—è®¾å¤‡ã€‚&lt;/p>
&lt;p>å¦‚æœé‡åˆ°æ— æ³•æ­£å¸¸æ¨ç†çš„æƒ…å†µï¼Œè¯·å°è¯•è®¾ç½® &lt;code>do_sample: false&lt;/code>ã€‚&lt;/p>
&lt;p>ä¸‹è½½é¢„æ„å»º Docker é•œåƒï¼š&lt;a class="link" href="http://mirrors.cn-central-221.ovaijisuan.com/detail/130.html" target="_blank" rel="noopener" >32GB
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
| &lt;a class="link" href="http://mirrors.cn-central-221.ovaijisuan.com/detail/131.html" target="_blank" rel="noopener" >64GB
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;/details>
&lt;p>ä¸‹é¢ä¸‰è¡Œå‘½ä»¤åˆ†åˆ«å¯¹ Llama3-8B-Instruct æ¨¡å‹è¿›è¡Œ LoRA å¾®è°ƒã€æ¨ç†å’Œåˆå¹¶ã€‚&lt;/p>
&lt;pre>&lt;code class="language-bash">llamafactory-cli train examples/train_lora/llama3_lora_sft.yaml
llamafactory-cli chat examples/inference/llama3_lora_sft.yaml
llamafactory-cli export examples/merge_lora/llama3_lora_sft.yaml
&lt;/code>&lt;/pre>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/hiyouga/LLaMA-Factory" target="_blank" rel="noopener" >Llama-Factory
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="firefly">
&lt;a href="#firefly" class="header-anchor">#&lt;/a>
Firefly
&lt;/h3>
&lt;a href="https://github.com/yangjianxin1/Firefly" target="_blank" class="card-github fetch-waiting no-styling"
repo="yangjianxin1/Firefly" id="repo-YRlrZQonFH5hviKa-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-YRlrZQonFH5hviKa-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">yangjianxin1&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">Firefly&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-YRlrZQonFH5hviKa-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-YRlrZQonFH5hviKa-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-YRlrZQonFH5hviKa-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-YRlrZQonFH5hviKa-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-YRlrZQonFH5hviKa-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-YRlrZQonFH5hviKa-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/yangjianxin1\/Firefly', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-YRlrZQonFH5hviKa-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-YRlrZQonFH5hviKa-language').innerText = data.language;
document.getElementById('repo-YRlrZQonFH5hviKa-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-YRlrZQonFH5hviKa-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-YRlrZQonFH5hviKa-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-YRlrZQonFH5hviKa-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-YRlrZQonFH5hviKa-license').classList.add = "no-license"
};
document.getElementById('repo-YRlrZQonFH5hviKa-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for yangjianxin1\/Firefly.")
}).catch(err => {
const c = document.getElementById('repo-YRlrZQonFH5hviKa-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for yangjianxin1\/Firefly.")
})
&lt;/script>
&lt;p>&lt;strong>Firefly&lt;/strong> æ˜¯ä¸€ä¸ªå¼€æºçš„å¤§æ¨¡å‹è®­ç»ƒé¡¹ç›®ï¼Œæ”¯æŒå¯¹ä¸»æµçš„å¤§æ¨¡å‹è¿›è¡Œé¢„è®­ç»ƒã€æŒ‡ä»¤å¾®è°ƒå’Œ DPOï¼ŒåŒ…æ‹¬ä½†ä¸é™äº Qwen2ã€Yi-1.5ã€Llama3ã€Gemmaã€Qwen1.5ã€MiniCPMã€Llamaã€InternLMã€Baichuanã€ChatGLMã€Yiã€Deepseekã€Qwenã€Orionã€Ziyaã€Xverseã€Mistralã€Mixtral-8x7Bã€Zephyrã€Vicunaã€Bloom ç­‰ã€‚
æœ¬é¡¹ç›®æ”¯æŒ&lt;strong>å…¨é‡å‚æ•°è®­ç»ƒã€LoRAã€QLoRA é«˜æ•ˆè®­ç»ƒ&lt;/strong>ï¼Œæ”¯æŒ&lt;strong>é¢„è®­ç»ƒã€SFTã€DPO&lt;/strong>ã€‚ å¦‚æœä½ çš„è®­ç»ƒèµ„æºæœ‰é™ï¼Œæˆ‘ä»¬æåŠ›æ¨èä½¿ç”¨ QLoRA è¿›è¡ŒæŒ‡ä»¤å¾®è°ƒï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ Open LLM Leaderboard ä¸ŠéªŒè¯äº†è¯¥æ–¹æ³•çš„æœ‰æ•ˆæ€§ï¼Œå¹¶ä¸”å–å¾—äº†éå¸¸ä¸é”™çš„æˆç»©ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>ğŸ“— æ”¯æŒé¢„è®­ç»ƒã€æŒ‡ä»¤å¾®è°ƒã€DPOï¼Œæ”¯æŒå…¨é‡å‚æ•°è®­ç»ƒã€LoRAã€QLoRA é«˜æ•ˆè®­ç»ƒã€‚é€šè¿‡é…ç½®æ–‡ä»¶çš„æ–¹å¼è®­ç»ƒä¸åŒçš„æ¨¡å‹ï¼Œå°ç™½äº¦å¯å¿«é€Ÿä¸Šæ‰‹è®­ç»ƒæ¨¡å‹ã€‚&lt;/li>
&lt;li>ğŸ“— æ”¯æŒä½¿ç”¨&lt;a class="link" href="https://github.com/yangjianxin1/unsloth" target="_blank" rel="noopener" >Unsloth
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
åŠ é€Ÿè®­ç»ƒï¼Œå¹¶ä¸”èŠ‚çœæ˜¾å­˜ã€‚&lt;/li>
&lt;li>ğŸ“— æ”¯æŒç»å¤§éƒ¨åˆ†ä¸»æµçš„å¼€æºå¤§æ¨¡å‹ï¼Œå¦‚ Llama3ã€Gemmaã€MiniCPMã€Llamaã€InternLMã€Baichuanã€ChatGLMã€Yiã€Deepseekã€Qwenã€Orionã€Ziyaã€Xverseã€Mistralã€Mixtral-8x7Bã€Zephyrã€Vicunaã€Bloomï¼Œè®­ç»ƒæ—¶ä¸å„ä¸ªå®˜æ–¹çš„ chat æ¨¡å‹çš„ template å¯¹é½ã€‚&lt;/li>
&lt;li>ğŸ“— æ•´ç†å¹¶å¼€æºæŒ‡ä»¤å¾®è°ƒæ•°æ®é›†ï¼šfirefly-train-1.1M ã€moss-003-sft-dataã€ultrachatã€ WizardLM_evol_instruct_V2_143kã€school_math_0.25Mã€‚&lt;/li>
&lt;li>ğŸ“— å¼€æº&lt;a class="link" href="https://huggingface.co/YeungNLP" target="_blank" rel="noopener" >Firefly ç³»åˆ—æŒ‡ä»¤å¾®è°ƒæ¨¡å‹æƒé‡
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/li>
&lt;li>ğŸ“— åœ¨ Open LLM Leaderboard ä¸ŠéªŒè¯äº† QLoRA è®­ç»ƒæµç¨‹çš„æœ‰æ•ˆæ€§ã€‚&lt;/li>
&lt;/ul>
&lt;p>è¯¥é¡¹ç›®çš„ README ä¸­åŒ…å«äº†è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜ï¼ŒåŒ…æ‹¬å¦‚ä½•å®‰è£…ã€å¦‚ä½•è®­ç»ƒã€å¦‚ä½•å¾®è°ƒã€å¦‚ä½•è¯„ä¼°ç­‰ã€‚è¯·è®¿é—® &lt;a class="link" href="https://github.com/yangjianxin1/Firefly" target="_blank" rel="noopener" >Firefly
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="xtuner">
&lt;a href="#xtuner" class="header-anchor">#&lt;/a>
XTuner
&lt;/h3>
&lt;a href="https://github.com/InternLM/xtuner" target="_blank" class="card-github fetch-waiting no-styling"
repo="InternLM/xtuner" id="repo-2SX208L5RZ5nkQy1-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-2SX208L5RZ5nkQy1-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">InternLM&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">xtuner&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-2SX208L5RZ5nkQy1-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-2SX208L5RZ5nkQy1-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-2SX208L5RZ5nkQy1-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-2SX208L5RZ5nkQy1-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-2SX208L5RZ5nkQy1-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-2SX208L5RZ5nkQy1-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/InternLM\/xtuner', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-2SX208L5RZ5nkQy1-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-2SX208L5RZ5nkQy1-language').innerText = data.language;
document.getElementById('repo-2SX208L5RZ5nkQy1-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-2SX208L5RZ5nkQy1-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-2SX208L5RZ5nkQy1-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-2SX208L5RZ5nkQy1-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-2SX208L5RZ5nkQy1-license').classList.add = "no-license"
};
document.getElementById('repo-2SX208L5RZ5nkQy1-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for InternLM\/xtuner.")
}).catch(err => {
const c = document.getElementById('repo-2SX208L5RZ5nkQy1-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for InternLM\/xtuner.")
})
&lt;/script>
&lt;p>XTuner æ˜¯ä¸€ä¸ªé«˜æ•ˆã€çµæ´»ã€å…¨èƒ½çš„è½»é‡åŒ–å¤§æ¨¡å‹å¾®è°ƒå·¥å…·åº“ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>é«˜æ•ˆ&lt;/strong>
&lt;ul>
&lt;li>æ”¯æŒå¤§è¯­è¨€æ¨¡å‹ LLMã€å¤šæ¨¡æ€å›¾æ–‡æ¨¡å‹ VLM çš„é¢„è®­ç»ƒåŠè½»é‡çº§å¾®è°ƒã€‚XTuner æ”¯æŒåœ¨ 8GB æ˜¾å­˜ä¸‹å¾®è°ƒ 7B æ¨¡å‹ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒå¤šèŠ‚ç‚¹è·¨è®¾å¤‡å¾®è°ƒæ›´å¤§å°ºåº¦æ¨¡å‹ï¼ˆ70B+ï¼‰ã€‚&lt;/li>
&lt;li>è‡ªåŠ¨åˆ†å‘é«˜æ€§èƒ½ç®—å­ï¼ˆå¦‚ FlashAttentionã€Triton kernels ç­‰ï¼‰ä»¥åŠ é€Ÿè®­ç»ƒååã€‚&lt;/li>
&lt;li>å…¼å®¹ &lt;a class="link" href="https://github.com/microsoft/DeepSpeed" target="_blank" rel="noopener" >DeepSpeed
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ğŸš€ï¼Œè½»æ¾åº”ç”¨å„ç§ ZeRO è®­ç»ƒä¼˜åŒ–ç­–ç•¥ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>çµæ´»&lt;/strong>
&lt;ul>
&lt;li>æ”¯æŒå¤šç§å¤§è¯­è¨€æ¨¡å‹ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº &lt;a class="link" href="https://huggingface.co/internlm" target="_blank" rel="noopener" >InternLM
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="https://huggingface.co/mistralai" target="_blank" rel="noopener" >Mixtral-8x7B
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="https://huggingface.co/meta-llama" target="_blank" rel="noopener" >Llama 2
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="https://huggingface.co/THUDM" target="_blank" rel="noopener" >ChatGLM
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="https://huggingface.co/Qwen" target="_blank" rel="noopener" >Qwen
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="https://huggingface.co/baichuan-inc" target="_blank" rel="noopener" >Baichuan
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/li>
&lt;li>æ”¯æŒå¤šæ¨¡æ€å›¾æ–‡æ¨¡å‹ LLaVA çš„é¢„è®­ç»ƒä¸å¾®è°ƒã€‚åˆ©ç”¨ XTuner è®­å¾—æ¨¡å‹ &lt;a class="link" href="https://huggingface.co/xtuner/llava-internlm2-20b" target="_blank" rel="noopener" >LLaVA-InternLM2-20B
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
è¡¨ç°ä¼˜å¼‚ã€‚&lt;/li>
&lt;li>ç²¾å¿ƒè®¾è®¡çš„æ•°æ®ç®¡é“ï¼Œå…¼å®¹ä»»æ„æ•°æ®æ ¼å¼ï¼Œå¼€æºæ•°æ®æˆ–è‡ªå®šä¹‰æ•°æ®çš†å¯å¿«é€Ÿä¸Šæ‰‹ã€‚&lt;/li>
&lt;li>æ”¯æŒ &lt;a class="link" href="http://arxiv.org/abs/2305.14314" target="_blank" rel="noopener" >QLoRA
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€&lt;a class="link" href="http://arxiv.org/abs/2106.09685" target="_blank" rel="noopener" >LoRA
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€å…¨é‡å‚æ•°å¾®è°ƒç­‰å¤šç§å¾®è°ƒç®—æ³•ï¼Œæ”¯æ’‘ç”¨æˆ·æ ¹æ®å…·ä½“éœ€æ±‚ä½œå‡ºæœ€ä¼˜é€‰æ‹©ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>å…¨èƒ½&lt;/strong>
&lt;ul>
&lt;li>æ”¯æŒå¢é‡é¢„è®­ç»ƒã€æŒ‡ä»¤å¾®è°ƒä¸ Agent å¾®è°ƒã€‚&lt;/li>
&lt;li>é¢„å®šä¹‰ä¼—å¤šå¼€æºå¯¹è¯æ¨¡ç‰ˆï¼Œæ”¯æŒä¸å¼€æºæˆ–è®­ç»ƒæ‰€å¾—æ¨¡å‹è¿›è¡Œå¯¹è¯ã€‚&lt;/li>
&lt;li>è®­ç»ƒæ‰€å¾—æ¨¡å‹å¯æ— ç¼æ¥å…¥éƒ¨ç½²å·¥å…·åº“ &lt;a class="link" href="https://github.com/InternLM/lmdeploy" target="_blank" rel="noopener" >LMDeploy
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€å¤§è§„æ¨¡è¯„æµ‹å·¥å…·åº“ &lt;a class="link" href="https://github.com/open-compass/opencompass" target="_blank" rel="noopener" >OpenCompass
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
åŠ &lt;a class="link" href="https://github.com/open-compass/VLMEvalKit" target="_blank" rel="noopener" >VLMEvalKit
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>å¿«é€Ÿä¸Šæ‰‹ï¼š&lt;/strong>
&lt;details>
&lt;summary>å®‰è£…&lt;/summary>
&lt;ul>
&lt;li>
&lt;p>æ¨èä½¿ç”¨ conda å…ˆæ„å»ºä¸€ä¸ª Python-3.10 çš„è™šæ‹Ÿç¯å¢ƒ&lt;/p>
&lt;pre>&lt;code class="language-bash">conda create --name xtuner-env python=3.10 -y
conda activate xtuner-env
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>é€šè¿‡ pip å®‰è£… XTunerï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">pip install -U xtuner
&lt;/code>&lt;/pre>
&lt;p>äº¦å¯é›†æˆ DeepSpeed å®‰è£…ï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">pip install -U 'xtuner[deepspeed]'
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>ä»æºç å®‰è£… XTunerï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">git clone https://github.com/InternLM/xtuner.git
cd xtuner
pip install -e '.[all]'
&lt;/code>&lt;/pre>
&lt;/li>
&lt;/ul>
&lt;/details>
&lt;/p>
&lt;details>
&lt;summary>å¾®è°ƒ&lt;/summary>
&lt;p>XTuner æ”¯æŒå¾®è°ƒå¤§è¯­è¨€æ¨¡å‹ã€‚æ•°æ®é›†é¢„å¤„ç†æŒ‡å—è¯·æŸ¥é˜…&lt;a class="link" href="./docs/zh_cn/user_guides/dataset_prepare.md" >æ–‡æ¡£
&lt;/a>
ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>&lt;strong>æ­¥éª¤ 0&lt;/strong>ï¼Œå‡†å¤‡é…ç½®æ–‡ä»¶ã€‚XTuner æä¾›å¤šä¸ªå¼€ç®±å³ç”¨çš„é…ç½®æ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä¸‹åˆ—å‘½ä»¤æŸ¥çœ‹ï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">xtuner list-cfg
&lt;/code>&lt;/pre>
&lt;p>æˆ–è€…ï¼Œå¦‚æœæ‰€æä¾›çš„é…ç½®æ–‡ä»¶ä¸èƒ½æ»¡è¶³ä½¿ç”¨éœ€æ±‚ï¼Œè¯·å¯¼å‡ºæ‰€æä¾›çš„é…ç½®æ–‡ä»¶å¹¶è¿›è¡Œç›¸åº”æ›´æ”¹ï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">xtuner copy-cfg ${CONFIG_NAME} ${SAVE_PATH}
vi ${SAVE_PATH}/${CONFIG_NAME}_copy.py
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ­¥éª¤ 1&lt;/strong>ï¼Œå¼€å§‹å¾®è°ƒã€‚&lt;/p>
&lt;pre>&lt;code class="language-shell">xtuner train ${CONFIG_NAME_OR_PATH}
&lt;/code>&lt;/pre>
&lt;p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ QLoRA ç®—æ³•åœ¨ oasst1 æ•°æ®é›†ä¸Šå¾®è°ƒ InternLM2.5-Chat-7Bï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell"># å•å¡
xtuner train internlm2_5_chat_7b_qlora_oasst1_e3 --deepspeed deepspeed_zero2
# å¤šå¡
(DIST) NPROC_PER_NODE=${GPU_NUM} xtuner train internlm2_5_chat_7b_qlora_oasst1_e3 --deepspeed deepspeed_zero2
(SLURM) srun ${SRUN_ARGS} xtuner train internlm2_5_chat_7b_qlora_oasst1_e3 --launcher slurm --deepspeed deepspeed_zero2
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>
&lt;p>&lt;code>--deepspeed&lt;/code> è¡¨ç¤ºä½¿ç”¨ &lt;a class="link" href="https://github.com/microsoft/DeepSpeed" target="_blank" rel="noopener" >DeepSpeed
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ğŸš€ æ¥ä¼˜åŒ–è®­ç»ƒè¿‡ç¨‹ã€‚XTuner å†…ç½®äº†å¤šç§ç­–ç•¥ï¼ŒåŒ…æ‹¬ ZeRO-1ã€ZeRO-2ã€ZeRO-3 ç­‰ã€‚å¦‚æœç”¨æˆ·æœŸæœ›å…³é—­æ­¤åŠŸèƒ½ï¼Œè¯·ç›´æ¥ç§»é™¤æ­¤å‚æ•°ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ›´å¤šç¤ºä¾‹ï¼Œè¯·æŸ¥é˜…&lt;a class="link" href="./docs/zh_cn/user_guides/finetune.md" >æ–‡æ¡£
&lt;/a>
ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>æ­¥éª¤ 2&lt;/strong>ï¼Œå°†ä¿å­˜çš„ PTH æ¨¡å‹ï¼ˆå¦‚æœä½¿ç”¨çš„ DeepSpeedï¼Œåˆ™å°†ä¼šæ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼‰è½¬æ¢ä¸º HuggingFace æ¨¡å‹ï¼š&lt;/p>
&lt;pre>&lt;code class="language-shell">xtuner convert pth_to_hf ${CONFIG_NAME_OR_PATH} ${PTH} ${SAVE_PATH}
&lt;/code>&lt;/pre>
&lt;/li>
&lt;/ul>
&lt;/details>
&lt;p>å…¶å®ƒè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/InternLM/xtuner" target="_blank" rel="noopener" >XTuner
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h2 id="æ¨¡å‹é‡åŒ–">
&lt;a href="#%e6%a8%a1%e5%9e%8b%e9%87%8f%e5%8c%96" class="header-anchor">#&lt;/a>
æ¨¡å‹é‡åŒ–
&lt;/h2>
&lt;p>LLM é€šå¸¸ä½“ç§¯åºå¤§ï¼Œå¯¹è®¡ç®—èµ„æºè¦æ±‚é«˜ã€‚æ¨¡å‹é‡åŒ–æŠ€æœ¯å¯ä»¥å‹ç¼©æ¨¡å‹å¤§å°ï¼Œæé«˜è¿è¡Œæ•ˆç‡ï¼Œä½¿å…¶æ›´æ˜“äºéƒ¨ç½²ï¼š&lt;/p>
&lt;h3 id="autogptq">
&lt;a href="#autogptq" class="header-anchor">#&lt;/a>
AutoGPTQ
&lt;/h3>
&lt;a href="https://github.com/PanQiWei/AutoGPTQ" target="_blank" class="card-github fetch-waiting no-styling"
repo="PanQiWei/AutoGPTQ" id="repo-Hdec1hdZzkInsvLS-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-Hdec1hdZzkInsvLS-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">PanQiWei&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">AutoGPTQ&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-Hdec1hdZzkInsvLS-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-Hdec1hdZzkInsvLS-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-Hdec1hdZzkInsvLS-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-Hdec1hdZzkInsvLS-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-Hdec1hdZzkInsvLS-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-Hdec1hdZzkInsvLS-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/PanQiWei\/AutoGPTQ', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-Hdec1hdZzkInsvLS-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-Hdec1hdZzkInsvLS-language').innerText = data.language;
document.getElementById('repo-Hdec1hdZzkInsvLS-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-Hdec1hdZzkInsvLS-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-Hdec1hdZzkInsvLS-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-Hdec1hdZzkInsvLS-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-Hdec1hdZzkInsvLS-license').classList.add = "no-license"
};
document.getElementById('repo-Hdec1hdZzkInsvLS-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for PanQiWei\/AutoGPTQ.")
}).catch(err => {
const c = document.getElementById('repo-Hdec1hdZzkInsvLS-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for PanQiWei\/AutoGPTQ.")
})
&lt;/script>
&lt;p>AutoGPTQ ä¸€ä¸ªåŸºäº GPTQ ç®—æ³•ï¼Œç®€å•æ˜“ç”¨ä¸”æ‹¥æœ‰ç”¨æˆ·å‹å¥½å‹æ¥å£çš„å¤§è¯­è¨€æ¨¡å‹é‡åŒ–å·¥å…·åŒ…ã€‚&lt;/p>
&lt;p>&lt;strong>å¿«é€Ÿå®‰è£…&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>å¯¹äº CUDA 11.7ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-bash">pip install auto-gptq --extra-index-url https://huggingface.github.io/autogptq-index/whl/cu117/
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>å¯¹äº CUDA 11.8ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-bash">pip install auto-gptq --extra-index-url https://huggingface.github.io/autogptq-index/whl/cu118/
&lt;/code>&lt;/pre>
&lt;ul>
&lt;li>å¯¹äº RoCm 5.4.2ï¼š&lt;/li>
&lt;/ul>
&lt;pre>&lt;code class="language-bash">pip install auto-gptq --extra-index-url https://huggingface.github.io/autogptq-index/whl/rocm542/
&lt;/code>&lt;/pre>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/AutoGPTQ/AutoGPTQ/" target="_blank" rel="noopener" >AutoGPTQ
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="autoawq">
&lt;a href="#autoawq" class="header-anchor">#&lt;/a>
AutoAWQ
&lt;/h3>
&lt;a href="https://github.com/casper-hansen/AutoAWQ" target="_blank" class="card-github fetch-waiting no-styling"
repo="casper-hansen/AutoAWQ" id="repo-1aBNtl9YcErLSpO7-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-1aBNtl9YcErLSpO7-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">casper-hansen&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">AutoAWQ&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-1aBNtl9YcErLSpO7-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-1aBNtl9YcErLSpO7-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-1aBNtl9YcErLSpO7-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-1aBNtl9YcErLSpO7-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-1aBNtl9YcErLSpO7-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-1aBNtl9YcErLSpO7-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/casper-hansen\/AutoAWQ', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-1aBNtl9YcErLSpO7-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-1aBNtl9YcErLSpO7-language').innerText = data.language;
document.getElementById('repo-1aBNtl9YcErLSpO7-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-1aBNtl9YcErLSpO7-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-1aBNtl9YcErLSpO7-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-1aBNtl9YcErLSpO7-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-1aBNtl9YcErLSpO7-license').classList.add = "no-license"
};
document.getElementById('repo-1aBNtl9YcErLSpO7-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for casper-hansen\/AutoAWQ.")
}).catch(err => {
const c = document.getElementById('repo-1aBNtl9YcErLSpO7-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for casper-hansen\/AutoAWQ.")
})
&lt;/script>
&lt;p>AutoAWQ æ˜¯å¦ä¸€æ¬¾è‡ªåŠ¨åŒ–æ¨¡å‹é‡åŒ–å·¥å…·ï¼Œæ”¯æŒå¤šç§é‡åŒ–ç²¾åº¦ï¼Œå¹¶æä¾›çµæ´»çš„é…ç½®é€‰é¡¹ï¼Œå¯ä»¥æ ¹æ®ä¸åŒçš„ç¡¬ä»¶å¹³å°å’Œæ€§èƒ½éœ€æ±‚è¿›è¡Œè°ƒæ•´ã€‚&lt;/p>
&lt;p>AutoAWQ æ˜¯ä¸€ä¸ªæ˜“äºä½¿ç”¨çš„ 4 ä½é‡åŒ–æ¨¡å‹è½¯ä»¶åŒ…ã€‚ä¸ FP16 ç›¸æ¯”ï¼ŒAutoAWQ å¯å°†æ¨¡å‹é€Ÿåº¦æé«˜ 3 å€ï¼Œå†…å­˜éœ€æ±‚å‡å°‘ 3 å€ã€‚AutoAWQ å®ç°äº†ç”¨äºé‡åŒ– LLMs çš„æ¿€æ´»æ„ŸçŸ¥æƒé‡é‡åŒ–ï¼ˆAWQï¼‰ç®—æ³•ã€‚AutoAWQ æ˜¯åœ¨ MIT çš„åŸå§‹å·¥ä½œ &lt;a class="link" href="https://github.com/mit-han-lab/llm-awq" target="_blank" rel="noopener" >AWQ
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
åŸºç¡€ä¸Šåˆ›å»ºå’Œæ”¹è¿›çš„ã€‚&lt;/p>
&lt;p>&lt;strong>å®‰è£…æ–¹æ³•ï¼š&lt;/strong>&lt;/p>
&lt;p>å®‰è£…å‰ï¼Œç¡®ä¿å®‰è£…äº† CUDA &amp;gt;= 12.1ï¼ˆæ³¨æ„ï¼šä»¥ä¸‹åªæ˜¯æœ€å¿«æ·çš„å®‰è£…æ–¹æ³•ï¼‰&lt;/p>
&lt;pre>&lt;code class="language-bash">pip install autoawq
&lt;/code>&lt;/pre>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯å’Œç¤ºä¾‹ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/casper-hansen/AutoAWQ" target="_blank" rel="noopener" >AutoAWQ
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="neural-compressor">
&lt;a href="#neural-compressor" class="header-anchor">#&lt;/a>
Neural Compressor
&lt;/h3>
&lt;a href="https://github.com/intel/neural-compressor" target="_blank" class="card-github fetch-waiting no-styling"
repo="intel/neural-compressor" id="repo-Iq6O1et8V3kHl72x-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-Iq6O1et8V3kHl72x-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">intel&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">neural-compressor&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-Iq6O1et8V3kHl72x-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-Iq6O1et8V3kHl72x-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-Iq6O1et8V3kHl72x-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-Iq6O1et8V3kHl72x-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-Iq6O1et8V3kHl72x-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-Iq6O1et8V3kHl72x-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/intel\/neural-compressor', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-Iq6O1et8V3kHl72x-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-Iq6O1et8V3kHl72x-language').innerText = data.language;
document.getElementById('repo-Iq6O1et8V3kHl72x-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-Iq6O1et8V3kHl72x-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-Iq6O1et8V3kHl72x-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-Iq6O1et8V3kHl72x-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-Iq6O1et8V3kHl72x-license').classList.add = "no-license"
};
document.getElementById('repo-Iq6O1et8V3kHl72x-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for intel\/neural-compressor.")
}).catch(err => {
const c = document.getElementById('repo-Iq6O1et8V3kHl72x-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for intel\/neural-compressor.")
})
&lt;/script>
&lt;p>Neural Compressor æ˜¯è‹±ç‰¹å°”å¼€å‘çš„æ¨¡å‹å‹ç¼©å·¥å…·åŒ…ï¼Œæ”¯æŒæ‰€æœ‰ä¸»æµæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆTensorFlowã€PyTorchã€ONNX Runtime å’Œ MXNetï¼‰ä¸Šæµè¡Œçš„æ¨¡å‹å‹ç¼©æŠ€æœ¯ã€‚&lt;/p>
&lt;p>&lt;strong>å®‰è£…æ–¹æ³•ï¼š&lt;/strong>&lt;/p>
&lt;pre>&lt;code class="language-bash">pip install &amp;quot;neural-compressor&amp;gt;=2.3&amp;quot; &amp;quot;transformers&amp;gt;=4.34.0&amp;quot; torch torchvision
&lt;/code>&lt;/pre>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯å’Œç¤ºä¾‹ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/intel/neural-compressor" target="_blank" rel="noopener" >Neural Compressor
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h2 id="æ¨¡å‹éƒ¨ç½²">
&lt;a href="#%e6%a8%a1%e5%9e%8b%e9%83%a8%e7%bd%b2" class="header-anchor">#&lt;/a>
æ¨¡å‹éƒ¨ç½²
&lt;/h2>
&lt;p>å°†è®­ç»ƒå¥½çš„ LLM éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒè‡³å…³é‡è¦ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ LLM éƒ¨ç½²å·¥å…·ï¼š&lt;/p>
&lt;h3 id="vllm">
&lt;a href="#vllm" class="header-anchor">#&lt;/a>
vLLM
&lt;/h3>
&lt;a href="https://github.com/vllm-project/vllm" target="_blank" class="card-github fetch-waiting no-styling"
repo="vllm-project/vllm" id="repo-9JfenFVjhE3kmJ9Q-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-9JfenFVjhE3kmJ9Q-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">vllm-project&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">vllm&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-9JfenFVjhE3kmJ9Q-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-9JfenFVjhE3kmJ9Q-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-9JfenFVjhE3kmJ9Q-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-9JfenFVjhE3kmJ9Q-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-9JfenFVjhE3kmJ9Q-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-9JfenFVjhE3kmJ9Q-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/vllm-project\/vllm', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-9JfenFVjhE3kmJ9Q-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-9JfenFVjhE3kmJ9Q-language').innerText = data.language;
document.getElementById('repo-9JfenFVjhE3kmJ9Q-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-9JfenFVjhE3kmJ9Q-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-9JfenFVjhE3kmJ9Q-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-9JfenFVjhE3kmJ9Q-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-9JfenFVjhE3kmJ9Q-license').classList.add = "no-license"
};
document.getElementById('repo-9JfenFVjhE3kmJ9Q-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for vllm-project\/vllm.")
}).catch(err => {
const c = document.getElementById('repo-9JfenFVjhE3kmJ9Q-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for vllm-project\/vllm.")
})
&lt;/script>
&lt;p>vLLM æ˜¯ä¸€ä¸ªå¿«é€Ÿã€æ˜“ç”¨çš„ LLM æ¨ç†æœåŠ¡åº“ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å¿«é€Ÿ&lt;/strong>
&lt;ul>
&lt;li>SOTA æœåŠ¡ååé‡&lt;/li>
&lt;li>åˆ©ç”¨ PagedAttention é«˜æ•ˆç®¡ç†æ³¨æ„åŠ›é”®å€¼å†…å­˜&lt;/li>
&lt;li>æŒç»­æ‰¹é‡å¤„ç†æ”¶åˆ°çš„è¯·æ±‚&lt;/li>
&lt;li>åˆ©ç”¨ CUDA/HIP å›¾è¿›è¡ŒåŠ é€Ÿ&lt;/li>
&lt;li>é‡åŒ–ï¼šæ”¯æŒ GPTQã€AWQã€SqueezeLLMã€FP8 KV é«˜é€Ÿç¼“å­˜&lt;/li>
&lt;li>ä¼˜åŒ–çš„ CUDA å†…æ ¸&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>çµæ´»&lt;/strong>
&lt;ul>
&lt;li>ä¸æµè¡Œçš„ Hugging Face æ¨¡å‹æ— ç¼é›†æˆ&lt;/li>
&lt;li>åˆ©ç”¨å„ç§è§£ç ç®—æ³•ï¼ˆåŒ…æ‹¬å¹¶è¡Œé‡‡æ ·ã€æ³¢æŸæœç´¢ç­‰ï¼‰æä¾›é«˜ååé‡æœåŠ¡&lt;/li>
&lt;li>ä¸ºåˆ†å¸ƒå¼æ¨ç†æä¾›å¼ é‡å¹¶è¡Œæ”¯æŒ&lt;/li>
&lt;li>æµè¾“å‡º&lt;/li>
&lt;li>å…¼å®¹ OpenAI çš„åº”ç”¨ç¨‹åºæ¥å£æœåŠ¡å™¨&lt;/li>
&lt;li>æ”¯æŒ NVIDIA GPUã€AMD GPUã€Intel CPU å’Œ GPU
-ï¼ˆå®éªŒæ€§ï¼‰æ”¯æŒå‰ç¼€ç¼“å­˜
-ï¼ˆè¯•éªŒæ€§ï¼‰æ”¯æŒå¤šç§è¯­è¨€&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>æ— ç¼æ”¯æŒ&lt;/strong>
&lt;ul>
&lt;li>åŸºäº Transformer çš„æ¨¡å‹ï¼Œä¾‹å¦‚ Llama&lt;/li>
&lt;li>åŸºäº MoE çš„æ¨¡å‹ï¼Œä¾‹å¦‚ Mixtral&lt;/li>
&lt;li>å¤šæ¨¡æ€æ¨¡å‹ï¼Œä¾‹å¦‚ LLaVA&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>å¿«é€Ÿå®‰è£…ï¼š&lt;/strong>&lt;/p>
&lt;pre>&lt;code class="language-bash">pip install vllm
&lt;/code>&lt;/pre>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ &lt;a class="link" href="https://vllm.readthedocs.io/en/latest/" target="_blank" rel="noopener" >vLLM
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
å®˜æ–¹æ–‡æ¡£ã€‚&lt;/p>
&lt;h3 id="sgl">
&lt;a href="#sgl" class="header-anchor">#&lt;/a>
SGL
&lt;/h3>
&lt;a href="https://github.com/sgl-project/sglang" target="_blank" class="card-github fetch-waiting no-styling"
repo="sgl-project/sglang" id="repo-g03Uo5JqraVSGGtl-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-g03Uo5JqraVSGGtl-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">sgl-project&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">sglang&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-g03Uo5JqraVSGGtl-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-g03Uo5JqraVSGGtl-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-g03Uo5JqraVSGGtl-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-g03Uo5JqraVSGGtl-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-g03Uo5JqraVSGGtl-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-g03Uo5JqraVSGGtl-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/sgl-project\/sglang', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-g03Uo5JqraVSGGtl-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-g03Uo5JqraVSGGtl-language').innerText = data.language;
document.getElementById('repo-g03Uo5JqraVSGGtl-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-g03Uo5JqraVSGGtl-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-g03Uo5JqraVSGGtl-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-g03Uo5JqraVSGGtl-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-g03Uo5JqraVSGGtl-license').classList.add = "no-license"
};
document.getElementById('repo-g03Uo5JqraVSGGtl-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for sgl-project\/sglang.")
}).catch(err => {
const c = document.getElementById('repo-g03Uo5JqraVSGGtl-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for sgl-project\/sglang.")
})
&lt;/script>
&lt;p>SGLang æ˜¯ä¸€ç§ç»“æ„åŒ–ç”Ÿæˆè¯­è¨€ï¼Œä¸“ä¸ºå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰è€Œè®¾è®¡ã€‚å®ƒé€šè¿‡å…±åŒè®¾è®¡å‰ç«¯è¯­è¨€å’Œè¿è¡Œç³»ç»Ÿï¼Œä½¿ä½ ä¸ LLMs çš„äº¤äº’æ›´å¿«ã€æ›´å¯æ§ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>çµæ´»çš„å‰ç«¯è¯­è¨€&lt;/strong>ï¼šé€šè¿‡é“¾å¼ç”Ÿæˆè°ƒç”¨ã€é«˜çº§æç¤ºã€æ§åˆ¶æµã€å¤šç§æ¨¡å¼ã€å¹¶è¡Œæ€§å’Œå¤–éƒ¨äº¤äº’ï¼Œå¯è½»æ¾ç¼–å†™ LLM åº”ç”¨ç¨‹åºã€‚&lt;/li>
&lt;li>&lt;strong>é«˜æ€§èƒ½åç«¯è¿è¡Œæ—¶&lt;/strong>ï¼šå…·æœ‰ RadixAttention åŠŸèƒ½ï¼Œå¯é€šè¿‡åœ¨å¤šæ¬¡è°ƒç”¨ä¸­é‡å¤ä½¿ç”¨ KV ç¼“å­˜æ¥åŠ é€Ÿå¤æ‚çš„ LLM ç¨‹åºã€‚å®ƒè¿˜å¯ä»¥ä½œä¸ºç‹¬ç«‹çš„æ¨ç†å¼•æ“ï¼Œå®ç°æ‰€æœ‰å¸¸ç”¨æŠ€æœ¯ï¼ˆå¦‚è¿ç»­æ‰¹å¤„ç†å’Œå¼ é‡å¹¶è¡Œï¼‰ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/sgl-project/" target="_blank" rel="noopener" >SGL
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="skypilot">
&lt;a href="#skypilot" class="header-anchor">#&lt;/a>
SkyPilot
&lt;/h3>
&lt;a href="https://github.com/skypilot-org/skypilot" target="_blank" class="card-github fetch-waiting no-styling"
repo="skypilot-org/skypilot" id="repo-0pAFPCGUrjSBmOXo-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-0pAFPCGUrjSBmOXo-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">skypilot-org&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">skypilot&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-0pAFPCGUrjSBmOXo-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-0pAFPCGUrjSBmOXo-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-0pAFPCGUrjSBmOXo-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-0pAFPCGUrjSBmOXo-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-0pAFPCGUrjSBmOXo-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-0pAFPCGUrjSBmOXo-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/skypilot-org\/skypilot', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-0pAFPCGUrjSBmOXo-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-0pAFPCGUrjSBmOXo-language').innerText = data.language;
document.getElementById('repo-0pAFPCGUrjSBmOXo-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-0pAFPCGUrjSBmOXo-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-0pAFPCGUrjSBmOXo-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-0pAFPCGUrjSBmOXo-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-0pAFPCGUrjSBmOXo-license').classList.add = "no-license"
};
document.getElementById('repo-0pAFPCGUrjSBmOXo-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for skypilot-org\/skypilot.")
}).catch(err => {
const c = document.getElementById('repo-0pAFPCGUrjSBmOXo-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for skypilot-org\/skypilot.")
})
&lt;/script>
&lt;p>SkyPilot æ˜¯ UC Berkeley RISELab æ¨å‡ºçš„çµæ´»çš„äº‘ç«¯ LLM éƒ¨ç½²å·¥å…·ï¼Œæ”¯æŒå¤šç§äº‘å¹³å°å’Œç¡¬ä»¶åŠ é€Ÿå™¨ï¼Œå¯ä»¥è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜çš„éƒ¨ç½²æ–¹æ¡ˆï¼Œå¹¶æä¾›æˆæœ¬ä¼˜åŒ–åŠŸèƒ½ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>å¤šäº‘æ”¯æŒ:&lt;/strong> æ”¯æŒ AWS, GCP, Azure ç­‰å¤šç§äº‘å¹³å°ï¼Œæ–¹ä¾¿ç”¨æˆ·é€‰æ‹©åˆé€‚çš„éƒ¨ç½²ç¯å¢ƒã€‚&lt;/li>
&lt;li>&lt;strong>è½»æ¾æ‰©å±•&lt;/strong>ï¼šæ’é˜Ÿå’Œè¿è¡Œå¤šä¸ªä½œä¸šï¼Œè‡ªåŠ¨ç®¡ç†&lt;/li>
&lt;li>&lt;strong>è½»æ¾æ¥å…¥å¯¹è±¡å­˜å‚¨&lt;/strong>ï¼šè½»æ¾è®¿é—®å¯¹è±¡å­˜å‚¨ï¼ˆS3ã€GCSã€R2ï¼‰&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/skypilot-org/skypilot" target="_blank" rel="noopener" >SkyPilot
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="tensorrt-llm">
&lt;a href="#tensorrt-llm" class="header-anchor">#&lt;/a>
TensorRT-LLM
&lt;/h3>
&lt;a href="https://github.com/NVIDIA/TensorRT-LLM" target="_blank" class="card-github fetch-waiting no-styling"
repo="NVIDIA/TensorRT-LLM" id="repo-lmFO3TvBtCWya0Rm-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-lmFO3TvBtCWya0Rm-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">NVIDIA&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">TensorRT-LLM&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-lmFO3TvBtCWya0Rm-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-lmFO3TvBtCWya0Rm-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-lmFO3TvBtCWya0Rm-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-lmFO3TvBtCWya0Rm-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-lmFO3TvBtCWya0Rm-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-lmFO3TvBtCWya0Rm-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/NVIDIA\/TensorRT-LLM', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-lmFO3TvBtCWya0Rm-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-lmFO3TvBtCWya0Rm-language').innerText = data.language;
document.getElementById('repo-lmFO3TvBtCWya0Rm-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-lmFO3TvBtCWya0Rm-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-lmFO3TvBtCWya0Rm-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-lmFO3TvBtCWya0Rm-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-lmFO3TvBtCWya0Rm-license').classList.add = "no-license"
};
document.getElementById('repo-lmFO3TvBtCWya0Rm-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for NVIDIA\/TensorRT-LLM.")
}).catch(err => {
const c = document.getElementById('repo-lmFO3TvBtCWya0Rm-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for NVIDIA\/TensorRT-LLM.")
})
&lt;/script>
&lt;p>TensorRT-LLM æ˜¯ NVIDIA æ¨å‡ºçš„é«˜æ€§èƒ½ LLM æ¨ç†å¼•æ“ï¼Œèƒ½å¤Ÿå……åˆ†åˆ©ç”¨ GPU åŠ é€Ÿè®¡ç®—ï¼Œå¹¶é’ˆå¯¹ Transformer æ¨¡å‹ç»“æ„è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¤§å¹…æå‡æ¨ç†é€Ÿåº¦ã€‚&lt;/p>
&lt;p>TensorRT-LLM ä¸ºç”¨æˆ·æä¾›äº†æ˜“äºä½¿ç”¨çš„ Python APIï¼Œç”¨äºå®šä¹‰å¤§å‹è¯­è¨€æ¨¡å‹ (LLMs) å’Œæ„å»º TensorRT å¼•æ“ï¼Œè¿™äº›å¼•æ“åŒ…å«æœ€å…ˆè¿›çš„ä¼˜åŒ–æŠ€æœ¯ï¼Œå¯åœ¨è‹±ä¼Ÿè¾¾â„¢ï¼ˆNVIDIAÂ®ï¼‰å›¾å½¢å¤„ç†å™¨ä¸Šé«˜æ•ˆæ‰§è¡Œæ¨ç†ã€‚TensorRT-LLM è¿˜åŒ…å«ç”¨äºåˆ›å»ºæ‰§è¡Œè¿™äº› TensorRT å¼•æ“çš„ Python å’Œ C++ è¿è¡Œæ—¶çš„ç»„ä»¶ã€‚&lt;/p>
&lt;p>è¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/NVIDIA/TensorRT-LLM" target="_blank" rel="noopener" >TensorRT-LLM
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="openvino">
&lt;a href="#openvino" class="header-anchor">#&lt;/a>
OpenVino
&lt;/h3>
&lt;a href="https://github.com/openvinotoolkit/openvino" target="_blank" class="card-github fetch-waiting no-styling"
repo="openvinotoolkit/openvino" id="repo-DM9ihxrdj2cASJ46-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-DM9ihxrdj2cASJ46-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">openvinotoolkit&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">openvino&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-DM9ihxrdj2cASJ46-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-DM9ihxrdj2cASJ46-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-DM9ihxrdj2cASJ46-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-DM9ihxrdj2cASJ46-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-DM9ihxrdj2cASJ46-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-DM9ihxrdj2cASJ46-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/openvinotoolkit\/openvino', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-DM9ihxrdj2cASJ46-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-DM9ihxrdj2cASJ46-language').innerText = data.language;
document.getElementById('repo-DM9ihxrdj2cASJ46-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-DM9ihxrdj2cASJ46-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-DM9ihxrdj2cASJ46-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-DM9ihxrdj2cASJ46-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-DM9ihxrdj2cASJ46-license').classList.add = "no-license"
};
document.getElementById('repo-DM9ihxrdj2cASJ46-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for openvinotoolkit\/openvino.")
}).catch(err => {
const c = document.getElementById('repo-DM9ihxrdj2cASJ46-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for openvinotoolkit\/openvino.")
})
&lt;/script>
&lt;p>OpenVINOâ„¢ æ˜¯ç”¨äºä¼˜åŒ–å’Œéƒ¨ç½²äººå·¥æ™ºèƒ½æ¨ç†çš„å¼€æºå·¥å…·åŒ…ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>æ¨ç†ä¼˜åŒ–&lt;/strong>ï¼šæå‡æ·±åº¦å­¦ä¹ åœ¨è®¡ç®—æœºè§†è§‰ã€è‡ªåŠ¨è¯­éŸ³è¯†åˆ«ã€ç”Ÿæˆå¼äººå·¥æ™ºèƒ½ã€ä½¿ç”¨å¤§å‹å’Œå°å‹è¯­è¨€æ¨¡å‹çš„è‡ªç„¶è¯­è¨€å¤„ç†ä»¥åŠè®¸å¤šå…¶ä»–å¸¸è§ä»»åŠ¡ä¸­çš„æ€§èƒ½ã€‚&lt;/li>
&lt;li>&lt;strong>çµæ´»çš„æ¨¡å‹æ”¯æŒ&lt;/strong>ï¼šä½¿ç”¨ TensorFlowã€PyTorchã€ONNXã€Keras å’Œ PaddlePaddle ç­‰æµè¡Œæ¡†æ¶è®­ç»ƒçš„æ¨¡å‹ã€‚æ— éœ€åŸå§‹æ¡†æ¶å³å¯è½¬æ¢å’Œéƒ¨ç½²æ¨¡å‹ã€‚&lt;/li>
&lt;li>&lt;strong>å¹¿æ³›çš„å¹³å°å…¼å®¹æ€§&lt;/strong>ï¼šå‡å°‘èµ„æºéœ€æ±‚ï¼Œåœ¨ä»è¾¹ç¼˜åˆ°äº‘çš„ä¸€ç³»åˆ—å¹³å°ä¸Šé«˜æ•ˆéƒ¨ç½²ã€‚OpenVINOâ„¢ æ”¯æŒåœ¨ CPUï¼ˆx86ã€ARMï¼‰ã€GPUï¼ˆæ”¯æŒ OpenCL çš„é›†æˆå’Œç‹¬ç«‹ GPUï¼‰å’Œ AI åŠ é€Ÿå™¨ï¼ˆè‹±ç‰¹å°” NPUï¼‰ä¸Šè¿›è¡Œæ¨ç†ã€‚&lt;/li>
&lt;li>&lt;strong>ç¤¾åŒºå’Œç”Ÿæ€ç³»ç»Ÿ&lt;/strong>ï¼šåŠ å…¥ä¸€ä¸ªæ´»è·ƒçš„ç¤¾åŒºï¼Œä¸ºæé«˜å„ä¸ªé¢†åŸŸçš„æ·±åº¦å­¦ä¹ æ€§èƒ½åšå‡ºè´¡çŒ®ã€‚&lt;/li>
&lt;/ul>
&lt;p>è¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/openvinotoolkit/openvino" target="_blank" rel="noopener" >OpenVino
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="tgi">
&lt;a href="#tgi" class="header-anchor">#&lt;/a>
TGI
&lt;/h3>
&lt;a href="https://github.com/huggingface/text-generation-inference" target="_blank" class="card-github fetch-waiting no-styling"
repo="huggingface/text-generation-inference" id="repo-HLxGiVXNizbpGh07-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-HLxGiVXNizbpGh07-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">huggingface&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">text-generation-inference&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-HLxGiVXNizbpGh07-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-HLxGiVXNizbpGh07-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-HLxGiVXNizbpGh07-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-HLxGiVXNizbpGh07-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-HLxGiVXNizbpGh07-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-HLxGiVXNizbpGh07-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/huggingface\/text-generation-inference', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-HLxGiVXNizbpGh07-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-HLxGiVXNizbpGh07-language').innerText = data.language;
document.getElementById('repo-HLxGiVXNizbpGh07-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-HLxGiVXNizbpGh07-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-HLxGiVXNizbpGh07-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-HLxGiVXNizbpGh07-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-HLxGiVXNizbpGh07-license').classList.add = "no-license"
};
document.getElementById('repo-HLxGiVXNizbpGh07-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for huggingface\/text-generation-inference.")
}).catch(err => {
const c = document.getElementById('repo-HLxGiVXNizbpGh07-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for huggingface\/text-generation-inference.")
})
&lt;/script>
&lt;p>æ–‡æœ¬ç”Ÿæˆæ¨ç†ï¼ˆTGIï¼‰æ˜¯ä¸€ä¸ªç”¨äºéƒ¨ç½²å’ŒæœåŠ¡å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰çš„å·¥å…·åŒ…ã€‚TGI å¯ä¸ºæœ€æµè¡Œçš„å¼€æº LLMs å®ç°é«˜æ€§èƒ½æ–‡æœ¬ç”Ÿæˆï¼ŒåŒ…æ‹¬ Llamaã€Falconã€StarCoderã€BLOOMã€GPT-NeoX ç­‰ã€‚&lt;/p>
&lt;p>TGI å®ç°äº†è®¸å¤šåŠŸèƒ½ï¼Œå¯ä»¥åœ¨ &lt;a class="link" href="https://github.com/huggingface/text-generation-inference" target="_blank" rel="noopener" >TGI
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µä¸Šæ‰¾åˆ°è¯¦ç»†ä¿¡æ¯ã€‚&lt;/p>
&lt;h2 id="æœ¬åœ°è¿è¡Œ">
&lt;a href="#%e6%9c%ac%e5%9c%b0%e8%bf%90%e8%a1%8c" class="header-anchor">#&lt;/a>
æœ¬åœ°è¿è¡Œ
&lt;/h2>
&lt;p>å¾—ç›Šäºæ¨¡å‹å‹ç¼©å’Œä¼˜åŒ–æŠ€æœ¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ä¸ªäººè®¾å¤‡ä¸Šè¿è¡Œ LLMï¼š&lt;/p>
&lt;h3 id="mlx">
&lt;a href="#mlx" class="header-anchor">#&lt;/a>
MLX
&lt;/h3>
&lt;a href="https://github.com/ml-explore/mlx" target="_blank" class="card-github fetch-waiting no-styling"
repo="ml-explore/mlx" id="repo-CMAspn3lmP7TbLSY-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-CMAspn3lmP7TbLSY-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">ml-explore&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">mlx&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-CMAspn3lmP7TbLSY-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-CMAspn3lmP7TbLSY-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-CMAspn3lmP7TbLSY-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-CMAspn3lmP7TbLSY-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-CMAspn3lmP7TbLSY-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-CMAspn3lmP7TbLSY-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/ml-explore\/mlx', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-CMAspn3lmP7TbLSY-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-CMAspn3lmP7TbLSY-language').innerText = data.language;
document.getElementById('repo-CMAspn3lmP7TbLSY-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-CMAspn3lmP7TbLSY-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-CMAspn3lmP7TbLSY-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-CMAspn3lmP7TbLSY-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-CMAspn3lmP7TbLSY-license').classList.add = "no-license"
};
document.getElementById('repo-CMAspn3lmP7TbLSY-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for ml-explore\/mlx.")
}).catch(err => {
const c = document.getElementById('repo-CMAspn3lmP7TbLSY-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for ml-explore\/mlx.")
})
&lt;/script>
&lt;p>MLX æ˜¯ä¸€ä¸ªä¸“é—¨æ”¯æŒåœ¨ Apple è®¾å¤‡ä¸Šè¿è¡Œ LLM çš„æ¡†æ¶ï¼Œå……åˆ†åˆ©ç”¨ Metal åŠ é€Ÿè®¡ç®—ï¼Œå¹¶æä¾›ç®€å•æ˜“ç”¨çš„ APIï¼Œæ–¹ä¾¿å¼€å‘è€…å°† LLM é›†æˆåˆ° iOS åº”ç”¨ä¸­.&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ç›¸ä¼¼çš„åº”ç”¨ç¨‹åºæ¥å£&lt;/strong>ï¼šMLX çš„ Python API ä¸ NumPy éå¸¸ç›¸ä¼¼ã€‚MLX è¿˜æ‹¥æœ‰åŠŸèƒ½é½å…¨çš„ C++ã€C å’Œ Swift APIï¼Œè¿™äº› API ä¸ Python API éå¸¸ç›¸ä¼¼ã€‚MLX æ‹¥æœ‰æ›´é«˜çº§åˆ«çš„è½¯ä»¶åŒ…ï¼Œå¦‚ &lt;code>mlx.nn&lt;/code> å’Œ &lt;code>mlx.optimizers&lt;/code> ï¼Œå…¶ API ä¸ PyTorch éå¸¸æ¥è¿‘ï¼Œå¯ç®€åŒ–æ›´å¤æ‚æ¨¡å‹çš„æ„å»ºã€‚&lt;/li>
&lt;li>&lt;strong>å¯ç»„åˆå‡½æ•°å˜æ¢&lt;/strong>ï¼šMLX æ”¯æŒç”¨äºè‡ªåŠ¨å¾®åˆ†ã€è‡ªåŠ¨çŸ¢é‡åŒ–å’Œè®¡ç®—å›¾ä¼˜åŒ–çš„å¯ç»„åˆå‡½æ•°å˜æ¢ã€‚&lt;/li>
&lt;li>&lt;strong>æ‡’è®¡ç®—&lt;/strong>ï¼šMLX ä¸­çš„è®¡ç®—åªæœ‰åœ¨éœ€è¦æ—¶æ‰å°†æ•°ç»„å®ä½“åŒ–ã€‚&lt;/li>
&lt;li>&lt;strong>åŠ¨æ€å›¾æ„å»º&lt;/strong>ï¼šMLX ä¸­çš„è®¡ç®—å›¾å½¢æ˜¯åŠ¨æ€æ„å»ºçš„ã€‚æ”¹å˜å‡½æ•°å‚æ•°çš„å½¢çŠ¶ä¸ä¼šå¯¼è‡´ç¼–è¯‘é€Ÿåº¦å˜æ…¢ï¼Œè€Œä¸”è°ƒè¯•ç®€å•ç›´è§‚ã€‚&lt;/li>
&lt;li>&lt;strong>å¤šè®¾å¤‡&lt;/strong>ï¼šæ“ä½œå¯åœ¨ä»»ä½•æ”¯æŒçš„è®¾å¤‡ï¼ˆç›®å‰æ˜¯ CPU å’Œ GPUï¼‰ä¸Šè¿è¡Œã€‚&lt;/li>
&lt;li>&lt;strong>ç»Ÿä¸€å†…å­˜&lt;/strong>ï¼šç»Ÿä¸€å†…å­˜æ¨¡å‹æ˜¯ MLX ä¸å…¶ä»–æ¡†æ¶çš„ä¸€ä¸ªæ˜¾è‘—åŒºåˆ«ã€‚MLX ä¸­çš„é˜µåˆ—ä½äºå…±äº«å†…å­˜ä¸­ã€‚å¯¹ MLX æ•°ç»„çš„æ“ä½œå¯åœ¨ä»»ä½•æ”¯æŒçš„è®¾å¤‡ç±»å‹ä¸Šæ‰§è¡Œï¼Œè€Œæ— éœ€ä¼ è¾“æ•°æ®ã€‚&lt;/li>
&lt;/ul>
&lt;p>MLX æ˜¯æœºå™¨å­¦ä¹ ç ”ç©¶äººå‘˜ä¸ºæœºå™¨å­¦ä¹ ç ”ç©¶äººå‘˜è®¾è®¡çš„ã€‚è¯¥æ¡†æ¶æ—¨åœ¨æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œä½†ä»èƒ½é«˜æ•ˆåœ°è®­ç»ƒå’Œéƒ¨ç½²æ¨¡å‹ã€‚æ¡†æ¶æœ¬èº«çš„è®¾è®¡æ¦‚å¿µä¹Ÿå¾ˆç®€å•ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®©ç ”ç©¶äººå‘˜èƒ½å¤Ÿè½»æ¾æ‰©å±•å’Œæ”¹è¿› MLXï¼Œä»è€Œå¿«é€Ÿæ¢ç´¢æ–°æ€è·¯ã€‚æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/ml-explore/mlx" target="_blank" rel="noopener" >MLX
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="llamacpp">
&lt;a href="#llamacpp" class="header-anchor">#&lt;/a>
Llama.cpp
&lt;/h3>
&lt;p>Llama.cpp æ˜¯ä½¿ç”¨ C++ å®ç°çš„ Llama æ¨¡å‹æ¨ç†å¼•æ“ï¼Œå¯ä»¥åœ¨ CPU ä¸Šé«˜æ•ˆè¿è¡Œï¼Œå¹¶æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶å¹³å°ï¼Œæ–¹ä¾¿å¼€å‘è€…åœ¨èµ„æºå—é™çš„è®¾å¤‡ä¸Šè¿è¡Œ LLMã€‚&lt;/p>
&lt;a href="https://github.com/ggerganov/llama.cpp" target="_blank" class="card-github fetch-waiting no-styling"
repo="ggerganov/llama.cpp" id="repo-iGJUFRAS41lXeCjG-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-iGJUFRAS41lXeCjG-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">ggerganov&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">llama.cpp&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-iGJUFRAS41lXeCjG-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-iGJUFRAS41lXeCjG-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-iGJUFRAS41lXeCjG-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-iGJUFRAS41lXeCjG-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-iGJUFRAS41lXeCjG-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-iGJUFRAS41lXeCjG-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/ggerganov\/llama.cpp', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-iGJUFRAS41lXeCjG-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-iGJUFRAS41lXeCjG-language').innerText = data.language;
document.getElementById('repo-iGJUFRAS41lXeCjG-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-iGJUFRAS41lXeCjG-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-iGJUFRAS41lXeCjG-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-iGJUFRAS41lXeCjG-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-iGJUFRAS41lXeCjG-license').classList.add = "no-license"
};
document.getElementById('repo-iGJUFRAS41lXeCjG-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for ggerganov\/llama.cpp.")
}).catch(err => {
const c = document.getElementById('repo-iGJUFRAS41lXeCjG-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for ggerganov\/llama.cpp.")
})
&lt;/script>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>CPU æ¨ç†:&lt;/strong> é’ˆå¯¹ CPU å¹³å°è¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥åœ¨æ²¡æœ‰ GPU çš„è®¾å¤‡ä¸Šè¿è¡Œ LLMã€‚&lt;/li>
&lt;li>&lt;strong>è·¨å¹³å°æ”¯æŒ:&lt;/strong> æ”¯æŒ Linux, macOS, Windows ç­‰å¤šç§æ“ä½œç³»ç»Ÿï¼Œæ–¹ä¾¿ç”¨æˆ·åœ¨ä¸åŒå¹³å°ä¸Šä½¿ç”¨ã€‚&lt;/li>
&lt;li>&lt;strong>è½»é‡çº§éƒ¨ç½²:&lt;/strong> ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶ä½“ç§¯å°ï¼Œæ–¹ä¾¿ç”¨æˆ·éƒ¨ç½²å’Œä½¿ç”¨.&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/ggerganov/llama.cpp" target="_blank" rel="noopener" >Llama.cpp
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="ollama">
&lt;a href="#ollama" class="header-anchor">#&lt;/a>
Ollama
&lt;/h3>
&lt;a href="https://github.com/ollama/ollama" target="_blank" class="card-github fetch-waiting no-styling"
repo="ollama/ollama" id="repo-bUWgs9BSLSNp0JsJ-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-bUWgs9BSLSNp0JsJ-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">ollama&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">ollama&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-bUWgs9BSLSNp0JsJ-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-bUWgs9BSLSNp0JsJ-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-bUWgs9BSLSNp0JsJ-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-bUWgs9BSLSNp0JsJ-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-bUWgs9BSLSNp0JsJ-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-bUWgs9BSLSNp0JsJ-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/ollama\/ollama', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-bUWgs9BSLSNp0JsJ-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-bUWgs9BSLSNp0JsJ-language').innerText = data.language;
document.getElementById('repo-bUWgs9BSLSNp0JsJ-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-bUWgs9BSLSNp0JsJ-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-bUWgs9BSLSNp0JsJ-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-bUWgs9BSLSNp0JsJ-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-bUWgs9BSLSNp0JsJ-license').classList.add = "no-license"
};
document.getElementById('repo-bUWgs9BSLSNp0JsJ-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for ollama\/ollama.")
}).catch(err => {
const c = document.getElementById('repo-bUWgs9BSLSNp0JsJ-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for ollama\/ollama.")
})
&lt;/script>
&lt;p>åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/ollama/" >ã€Ollamaï¼šä»å…¥é—¨åˆ°è¿›é˜¶ã€‘
&lt;/a>
ä¸€æ–‡ä¸­ä»‹ç»è¿‡ï¼ŒOllama æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºå¤§å‹è¯­è¨€æ¨¡å‹åº”ç”¨çš„å·¥å…·ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç®€æ´æ˜“ç”¨çš„å‘½ä»¤è¡Œç•Œé¢å’ŒæœåŠ¡å™¨ï¼Œè®©ä½ èƒ½å¤Ÿè½»æ¾ä¸‹è½½ã€è¿è¡Œå’Œç®¡ç†å„ç§å¼€æº LLMã€‚ä¸éœ€è¦å¤æ‚é…ç½®å’Œå¼ºå¤§ç¡¬ä»¶çš„ä¼ ç»Ÿ LLM ä¸åŒï¼ŒOllama è®©ä½ èƒ½å¤Ÿæ–¹ä¾¿åœ°åƒä½¿ç”¨æ‰‹æœº App ä¸€æ ·ä½“éªŒ LLM çš„å¼ºå¤§åŠŸèƒ½ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ç®€å•æ˜“ç”¨&lt;/strong>ï¼šOllama æä¾›äº†ä¸€ä¸ªç®€æ´æ˜“ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ–¹ä¾¿ç”¨æˆ·ä¸‹è½½ã€è¿è¡Œå’Œç®¡ç† LLMã€‚&lt;/li>
&lt;li>&lt;strong>å¤šç§æ¨¡å‹&lt;/strong>ï¼šOllama æ”¯æŒå¤šç§å¼€æº LLMï¼ŒåŒ…æ‹¬ Qwen2ã€Llama3ã€Mistral ç­‰ã€‚&lt;/li>
&lt;li>&lt;strong>å…¼å®¹ OpenAI æ¥å£&lt;/strong>ï¼šOllama æ”¯æŒ OpenAI API æ¥å£ï¼Œä¾¿äºåˆ‡æ¢åŸæœ‰åº”ç”¨åˆ° Ollama ä¸Šã€‚&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/ollama/ollama" target="_blank" rel="noopener" >Ollama
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h2 id="agent-åŠ-rag-æ¡†æ¶">
&lt;a href="#agent-%e5%8f%8a-rag-%e6%a1%86%e6%9e%b6" class="header-anchor">#&lt;/a>
Agent åŠ RAG æ¡†æ¶
&lt;/h2>
&lt;p>å°† LLM ä¸å¤–éƒ¨æ•°æ®å’Œå·¥å…·ç»“åˆï¼Œå¯ä»¥æ„å»ºæ›´å¼ºå¤§çš„åº”ç”¨ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ Agent åŠ RAG æ¡†æ¶ï¼š&lt;/p>
&lt;h3 id="llamaindex">
&lt;a href="#llamaindex" class="header-anchor">#&lt;/a>
LlamaIndex
&lt;/h3>
&lt;a href="https://github.com/run-llama/llama_index" target="_blank" class="card-github fetch-waiting no-styling"
repo="run-llama/llama_index" id="repo-MEkQjtuEX0QoWZVm-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-MEkQjtuEX0QoWZVm-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">run-llama&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">llama_index&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-MEkQjtuEX0QoWZVm-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-MEkQjtuEX0QoWZVm-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-MEkQjtuEX0QoWZVm-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-MEkQjtuEX0QoWZVm-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-MEkQjtuEX0QoWZVm-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-MEkQjtuEX0QoWZVm-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/run-llama\/llama_index', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-MEkQjtuEX0QoWZVm-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-MEkQjtuEX0QoWZVm-language').innerText = data.language;
document.getElementById('repo-MEkQjtuEX0QoWZVm-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-MEkQjtuEX0QoWZVm-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-MEkQjtuEX0QoWZVm-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-MEkQjtuEX0QoWZVm-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-MEkQjtuEX0QoWZVm-license').classList.add = "no-license"
};
document.getElementById('repo-MEkQjtuEX0QoWZVm-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for run-llama\/llama_index.")
}).catch(err => {
const c = document.getElementById('repo-MEkQjtuEX0QoWZVm-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for run-llama\/llama_index.")
})
&lt;/script>
&lt;p>LlamaIndexï¼ˆGPT ç´¢å¼•ï¼‰æ˜¯ç”¨äº LLM åº”ç”¨ç¨‹åºçš„æ•°æ®æ¡†æ¶ã€‚ä½¿ç”¨ LlamaIndex æ„å»ºåº”ç”¨ç¨‹åºé€šå¸¸éœ€è¦ä½¿ç”¨ LlamaIndex æ ¸å¿ƒå’Œä¸€ç»„é€‰å®šçš„é›†æˆï¼ˆæˆ–æ’ä»¶ï¼‰ã€‚åœ¨ Python ä¸­ä½¿ç”¨ LlamaIndex æ„å»ºåº”ç”¨ç¨‹åºæœ‰ä¸¤ç§æ–¹æ³•ï¼š&lt;/p>
&lt;ul>
&lt;li>å¯åŠ¨å™¨ï¼š &lt;code>llama-index&lt;/code> ( &lt;a class="link" href="https://pypi.org/project/llama-index/" target="_blank" rel="noopener" >https://pypi.org/project/llama-index/
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
)ã€‚Python å…¥é—¨åŒ…ï¼ŒåŒ…æ‹¬æ ¸å¿ƒ LlamaIndex ä»¥åŠéƒ¨åˆ†é›†æˆã€‚&lt;/li>
&lt;li>å®šåˆ¶åŒ–ï¼š&lt;code>llama-index-core&lt;/code> ( &lt;a class="link" href="https://pypi.org/project/llama-index-core/" target="_blank" rel="noopener" >https://pypi.org/project/llama-index-core/
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
)ã€‚å®‰è£…æ ¸å¿ƒ LlamaIndexï¼Œå¹¶åœ¨ LlamaHub ä¸Šæ·»åŠ åº”ç”¨ç¨‹åºæ‰€éœ€çš„ LlamaIndex é›†æˆåŒ…ã€‚ç›®å‰æœ‰ 300 å¤šä¸ª LlamaIndex é›†æˆåŒ…å¯ä¸æ ¸å¿ƒæ— ç¼åä½œï¼Œè®©ä½ å¯ä»¥ä½¿ç”¨è‡ªå·±å–œæ¬¢çš„ LLMã€åµŒå…¥å’Œå‘é‡å­˜å‚¨æ•°æ®åº“è¿›è¡Œæ„å»º&lt;/li>
&lt;/ul>
&lt;p>LlamaIndex Python åº“æ˜¯ä»¥åå­—å‘½åçš„ï¼Œå› æ­¤åŒ…å« &lt;code>core&lt;/code> çš„å¯¼å…¥è¯­å¥æ„å‘³ç€ä½¿ç”¨çš„æ˜¯æ ¸å¿ƒåŒ…ã€‚ç›¸åï¼Œé‚£äº›ä¸å« &lt;code>core&lt;/code> çš„è¯­å¥åˆ™æ„å‘³ç€ä½¿ç”¨çš„æ˜¯é›†æˆåŒ…ã€‚&lt;/p>
&lt;pre>&lt;code class="language-python"># typical pattern
from llama_index.core.xxx import ClassABC # core submodule xxx
from llama_index.xxx.yyy import (
SubclassABC,
) # integration yyy for submodule xxx
# concrete example
from llama_index.core.llms import LLM
from llama_index.llms.openai import OpenAI
&lt;/code>&lt;/pre>
&lt;h3 id="crewai">
&lt;a href="#crewai" class="header-anchor">#&lt;/a>
CrewAI
&lt;/h3>
&lt;a href="https://github.com/joaomdmoura/crewAI" target="_blank" class="card-github fetch-waiting no-styling"
repo="joaomdmoura/crewAI" id="repo-ZzrTdoh8xSURTxQu-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-ZzrTdoh8xSURTxQu-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">joaomdmoura&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">crewAI&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-ZzrTdoh8xSURTxQu-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-ZzrTdoh8xSURTxQu-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-ZzrTdoh8xSURTxQu-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-ZzrTdoh8xSURTxQu-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-ZzrTdoh8xSURTxQu-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-ZzrTdoh8xSURTxQu-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/joaomdmoura\/crewAI', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-ZzrTdoh8xSURTxQu-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-ZzrTdoh8xSURTxQu-language').innerText = data.language;
document.getElementById('repo-ZzrTdoh8xSURTxQu-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-ZzrTdoh8xSURTxQu-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-ZzrTdoh8xSURTxQu-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-ZzrTdoh8xSURTxQu-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-ZzrTdoh8xSURTxQu-license').classList.add = "no-license"
};
document.getElementById('repo-ZzrTdoh8xSURTxQu-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for joaomdmoura\/crewAI.")
}).catch(err => {
const c = document.getElementById('repo-ZzrTdoh8xSURTxQu-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for joaomdmoura\/crewAI.")
})
&lt;/script>
&lt;p>CrewAI æ˜¯ä¸€ä¸ªæ„å»º AI Agent çš„æ¡†æ¶ï¼Œå¯ä»¥å°† LLM ä¸å…¶ä»–å·¥å…·å’Œ API é›†æˆï¼Œå®ç°æ›´å¤æ‚çš„ä»»åŠ¡ï¼Œä¾‹å¦‚è‡ªåŠ¨æ‰§è¡Œç½‘é¡µæ“ä½œã€ç”Ÿæˆä»£ç ç­‰ã€‚&lt;/p>
&lt;p>&lt;strong>ä¸»è¦ç‰¹ç‚¹ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>åŸºäºè§’è‰²çš„æ™ºèƒ½ä½“è®¾è®¡&lt;/strong>ï¼šä½ å¯ä»¥ä½¿ç”¨ç‰¹å®šçš„è§’è‰²ã€ç›®æ ‡å’Œå·¥å…·æ¥è‡ªå®šä¹‰æ™ºèƒ½ä½“ã€‚&lt;/li>
&lt;li>&lt;strong>è‡ªä¸»æ™ºèƒ½ä½“é—´å§”æ‰˜&lt;/strong>ï¼šæ™ºèƒ½ä½“å¯ä»¥è‡ªä¸»åœ°å°†ä»»åŠ¡å§”æ‰˜ç»™å…¶ä»–æ™ºèƒ½ä½“ï¼Œå¹¶ç›¸äº’æŸ¥è¯¢ä¿¡æ¯ï¼Œä»è€Œæé«˜è§£å†³é—®é¢˜çš„æ•ˆç‡ã€‚&lt;/li>
&lt;li>&lt;strong>çµæ´»çš„ä»»åŠ¡ç®¡ç†&lt;/strong>ï¼šå¯ä»¥ä½¿ç”¨å¯å®šåˆ¶çš„å·¥å…·æ¥å®šä¹‰ä»»åŠ¡ï¼Œå¹¶åŠ¨æ€åœ°å°†ä»»åŠ¡åˆ†é…ç»™æ™ºèƒ½ä½“ã€‚&lt;/li>
&lt;li>&lt;strong>æµç¨‹é©±åŠ¨&lt;/strong>ï¼šè¯¥ç³»ç»Ÿä»¥æµç¨‹ä¸ºä¸­å¿ƒï¼Œç›®å‰æ”¯æŒæŒ‰é¡ºåºæ‰§è¡Œä»»åŠ¡å’Œåˆ†å±‚æµç¨‹ã€‚æœªæ¥è¿˜ä¼šæ”¯æŒæ›´å¤æ‚çš„æµç¨‹ï¼Œä¾‹å¦‚åå•†å’Œè‡ªä¸»æµç¨‹ã€‚&lt;/li>
&lt;li>&lt;strong>ä¿å­˜è¾“å‡ºä¸ºæ–‡ä»¶&lt;/strong>ï¼šå¯ä»¥å°†å•ä¸ªä»»åŠ¡çš„è¾“å‡ºä¿å­˜ä¸ºæ–‡ä»¶ï¼Œä»¥ä¾¿ä»¥åä½¿ç”¨ã€‚&lt;/li>
&lt;li>&lt;strong>å°†è¾“å‡ºè§£æä¸º Pydantic æˆ– Json&lt;/strong>ï¼šå¯ä»¥å°†å•ä¸ªä»»åŠ¡çš„è¾“å‡ºè§£æä¸º Pydantic æ¨¡å‹æˆ– Json æ ¼å¼ï¼Œä»¥ä¾¿äºåç»­å¤„ç†å’Œåˆ†æã€‚&lt;/li>
&lt;li>&lt;strong>æ”¯æŒå¼€æºæ¨¡å‹&lt;/strong>ï¼šå¯ä»¥ä½¿ç”¨ OpenAI æˆ–å…¶ä»–å¼€æºæ¨¡å‹æ¥è¿è¡Œæ‚¨çš„æ™ºèƒ½ä½“å›¢é˜Ÿã€‚æ›´å¤šå…³äºé…ç½®æ™ºèƒ½ä½“ä¸æ¨¡å‹è¿æ¥çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¦‚ä½•è¿æ¥åˆ°æœ¬åœ°è¿è¡Œçš„æ¨¡å‹ï¼Œè¯·å‚é˜…&lt;a class="link" href="https://docs.crewai.com/how-to/LLM-Connections/" target="_blank" rel="noopener" >å°† crewAI è¿æ¥åˆ°å¤§å‹è¯­è¨€æ¨¡å‹
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
ã€‚&lt;/li>
&lt;/ul>
&lt;p>æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/joaomdmoura/crewAI" target="_blank" rel="noopener" >CrewAI
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="opendevin">
&lt;a href="#opendevin" class="header-anchor">#&lt;/a>
OpenDevin
&lt;/h3>
&lt;a href="https://github.com/opendevin/opendevin" target="_blank" class="card-github fetch-waiting no-styling"
repo="opendevin/opendevin" id="repo-W6azPw78qwEJwqQM-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-W6azPw78qwEJwqQM-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">opendevin&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">opendevin&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-W6azPw78qwEJwqQM-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-W6azPw78qwEJwqQM-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-W6azPw78qwEJwqQM-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-W6azPw78qwEJwqQM-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-W6azPw78qwEJwqQM-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-W6azPw78qwEJwqQM-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/opendevin\/opendevin', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-W6azPw78qwEJwqQM-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-W6azPw78qwEJwqQM-language').innerText = data.language;
document.getElementById('repo-W6azPw78qwEJwqQM-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-W6azPw78qwEJwqQM-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-W6azPw78qwEJwqQM-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-W6azPw78qwEJwqQM-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-W6azPw78qwEJwqQM-license').classList.add = "no-license"
};
document.getElementById('repo-W6azPw78qwEJwqQM-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for opendevin\/opendevin.")
}).catch(err => {
const c = document.getElementById('repo-W6azPw78qwEJwqQM-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for opendevin\/opendevin.")
})
&lt;/script>
&lt;p>OpenDevin æ˜¯ä¸€ä¸ªç”±äººå·¥æ™ºèƒ½å’Œ LLMs é©±åŠ¨çš„è‡ªä¸»è½¯ä»¶å·¥ç¨‹å¸ˆå¹³å°ã€‚&lt;/p>
&lt;p>OpenDevin æ™ºèƒ½ä½“ä¸äººç±»å¼€å‘äººå‘˜åˆä½œç¼–å†™ä»£ç ã€ä¿®å¤é”™è¯¯å’Œå‘å¸ƒåŠŸèƒ½ã€‚&lt;/p>
&lt;p>è¯¦ç»†ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a class="link" href="https://github.com/opendevin/opendevin" target="_blank" rel="noopener" >OpenDevin
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
çš„é¡¹ç›®ä¸»é¡µã€‚&lt;/p>
&lt;h2 id="æ¨¡å‹è¯„æµ‹">
&lt;a href="#%e6%a8%a1%e5%9e%8b%e8%af%84%e6%b5%8b" class="header-anchor">#&lt;/a>
æ¨¡å‹è¯„æµ‹
&lt;/h2>
&lt;p>ä¸ºäº†é€‰æ‹©åˆé€‚çš„ LLM å¹¶è¯„ä¼°å…¶æ€§èƒ½ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ¨¡å‹è¯„æµ‹ï¼š&lt;/p>
&lt;h3 id="lmsys">
&lt;a href="#lmsys" class="header-anchor">#&lt;/a>
LMSys
&lt;/h3>
&lt;p>LMSys Org æ˜¯ç”±åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡çš„å­¦ç”Ÿå’Œæ•™å¸ˆä¸åŠ å·å¤§å­¦åœ£åœ°äºšå“¥åˆ†æ ¡ä»¥åŠå¡å†…åŸºæ¢…éš†å¤§å­¦åˆä½œæˆç«‹çš„å¼€æ”¾å¼ç ”ç©¶ç»„ç»‡ã€‚&lt;/p>
&lt;p>ç›®æ ‡æ˜¯é€šè¿‡å…±åŒå¼€å‘å¼€æ”¾æ¨¡å‹ã€æ•°æ®é›†ã€ç³»ç»Ÿå’Œè¯„ä¼°å·¥å…·ï¼Œä½¿å¤§å‹æ¨¡å‹å¯¹æ¯ä¸ªäººéƒ½å¯è®¿é—®ã€‚è®­ç»ƒå¤§å‹è¯­è¨€æ¨¡å‹å¹¶å¹¿æ³›æä¾›å®ƒä»¬çš„åº”ç”¨ï¼ŒåŒæ—¶ä¹Ÿåœ¨å¼€å‘åˆ†å¸ƒå¼ç³»ç»Ÿä»¥åŠ é€Ÿå®ƒä»¬çš„è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹ã€‚&lt;/p>
&lt;p>ç›®å‰ï¼ŒLMSys Chatbot Area æ˜¯æœ€è¢«è®¤å¯çš„å¤§æ¨¡å‹æ’è¡Œæ¦œä¹‹ä¸€ï¼Œå—å¤šå®¶å…¬å¸å’Œç ”ç©¶æœºæ„çš„è®¤å¯ã€‚&lt;/p>
&lt;p>æ’è¡Œæ¦œåœ°å€ï¼š&lt;a class="link" href="https://arena.lmsys.org/" target="_blank" rel="noopener" >https://arena.lmsys.org/
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;h3 id="opencompass">
&lt;a href="#opencompass" class="header-anchor">#&lt;/a>
OpenCompass
&lt;/h3>
&lt;p>OpenCompass æ˜¯ä¸€ä¸ª LLM è¯„ä¼°å¹³å°ï¼Œæ”¯æŒ 100 å¤šä¸ªæ•°æ®é›†ä¸Šçš„å„ç§æ¨¡å‹ï¼ˆLlama3ã€Mistralã€InternLM2ã€GPT-4ã€LLaMa2ã€Qwenã€GLMã€Claude ç­‰ï¼‰ã€‚&lt;/p>
&lt;a href="https://github.com/open-compass/opencompass" target="_blank" class="card-github fetch-waiting no-styling"
repo="open-compass/opencompass" id="repo-3ZVKIUueeH2IvoQR-card">
&lt;div class="gc-titlebar">
&lt;div class="gc-titlebar-left">
&lt;div class="gc-owner">
&lt;div id="repo-3ZVKIUueeH2IvoQR-avatar" class="gc-avatar">&lt;/div>
&lt;div class="gc-user">open-compass&lt;/div>
&lt;/div>
&lt;div class="gc-divider">/&lt;/div>
&lt;div class="gc-repo">opencompass&lt;/div>
&lt;/div>
&lt;div class="github-logo">&lt;/div>
&lt;/div>
&lt;div id="repo-3ZVKIUueeH2IvoQR-description" class="gc-description">Waiting for api.github.com...&lt;/div>
&lt;div class="gc-infobar">
&lt;div id="repo-3ZVKIUueeH2IvoQR-stars" class="gc-stars">0&lt;/div>
&lt;div id="repo-3ZVKIUueeH2IvoQR-forks" class="gc-forks">0&lt;/div>
&lt;div id="repo-3ZVKIUueeH2IvoQR-license" class="gc-license">unkown&lt;/div>
&lt;div id="repo-3ZVKIUueeH2IvoQR-language" class="gc-language">Waiting...&lt;/div>
&lt;/div>
&lt;/a>
&lt;script id="repo-3ZVKIUueeH2IvoQR-script" type="text/javascript" defer>
fetch('https://api.cuterwrite.top/api/repos/open-compass\/opencompass', {
referrerPolicy: "no-referrer"
})
.then(response => response.json())
.then(data => {
document.getElementById('repo-3ZVKIUueeH2IvoQR-description').innerText = data.description.replace(
/:[a-zA-Z0-9_]+:/g, '');
document.getElementById('repo-3ZVKIUueeH2IvoQR-language').innerText = data.language;
document.getElementById('repo-3ZVKIUueeH2IvoQR-forks').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.forks).replaceAll("\u202f", '');
document.getElementById('repo-3ZVKIUueeH2IvoQR-stars').innerText = Intl.NumberFormat('en-us', {
notation: "compact",
maximumFractionDigits: 1
}).format(data.stargazers_count).replaceAll("\u202f", '');
const avatarEl = document.getElementById('repo-3ZVKIUueeH2IvoQR-avatar');
avatarEl.style.backgroundImage = 'url(' + data.owner.avatar_url + ')';
avatarEl.style.backgroundColor = 'transparent';
if (data.license?.spdx_id) {
document.getElementById('repo-3ZVKIUueeH2IvoQR-license').innerText = data.license.spdx_id
} else {
document.getElementById('repo-3ZVKIUueeH2IvoQR-license').classList.add = "no-license"
};
document.getElementById('repo-3ZVKIUueeH2IvoQR-card').classList.remove("fetch-waiting");
console.log("[GITHUB-CARD] Loaded card for open-compass\/opencompass.")
}).catch(err => {
const c = document.getElementById('repo-3ZVKIUueeH2IvoQR-card');
c.classList.add("fetch-error");
console.warn("[GITHUB-CARD] (Error) Loading card for open-compass\/opencompass.")
})
&lt;/script>
&lt;h3 id="open-llm-leaderboard">
&lt;a href="#open-llm-leaderboard" class="header-anchor">#&lt;/a>
Open LLM Leaderboard
&lt;/h3>
&lt;p>Open LLM Leaderboard æ˜¯ä¸€ä¸ªæŒç»­æ›´æ–°çš„ LLM æ’è¡Œæ¦œï¼Œæ ¹æ®å¤šä¸ªè¯„æµ‹æŒ‡æ ‡å¯¹ä¸åŒæ¨¡å‹è¿›è¡Œæ’åï¼Œæ–¹ä¾¿å¼€å‘è€…äº†è§£æœ€æ–°çš„æ¨¡å‹æ€§èƒ½å’Œå‘å±•è¶‹åŠ¿ã€‚&lt;/p>
&lt;p>æ’è¡Œæ¦œåœ°å€ï¼š&lt;a class="link" href="https://huggingface.co/spaces/open-llm-leaderboard/open_llm_leaderboard" target="_blank" rel="noopener" >https://huggingface.co/spaces/open-llm-leaderboard/open_llm_leaderboard
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;h2 id="æ€»ç»“">
&lt;a href="#%e6%80%bb%e7%bb%93" class="header-anchor">#&lt;/a>
æ€»ç»“
&lt;/h2>
&lt;p>LLM ç”Ÿæ€æ­£åœ¨è“¬å‹ƒå‘å±•ï¼Œæ¶µç›–äº†ä»æ¨¡å‹è®­ç»ƒåˆ°åº”ç”¨è½åœ°çš„å„ä¸ªç¯èŠ‚ã€‚ç›¸ä¿¡éšç€æŠ€æœ¯çš„ä¸æ–­è¿›æ­¥ï¼ŒLLM å°†ä¼šåœ¨æ›´å¤šé¢†åŸŸå‘æŒ¥é‡è¦ä½œç”¨ï¼Œä¸ºæˆ‘ä»¬å¸¦æ¥æ›´åŠ æ™ºèƒ½çš„åº”ç”¨ä½“éªŒã€‚&lt;/p></description></item><item><title>RDMA ä¹‹ Memory Window</title><link>https://cuterwrite.top/p/rdma-memory-window/</link><pubDate>Wed, 26 Jun 2024 23:55:00 +0000</pubDate><guid>https://cuterwrite.top/p/rdma-memory-window/</guid><description>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-16_116373724_p0_master1200.webp" alt="Featured image of post RDMA ä¹‹ Memory Window" />&lt;h1 id="rdma-ä¹‹-memory-window">
&lt;a href="#rdma-%e4%b9%8b-memory-window" class="header-anchor">#&lt;/a>
RDMA ä¹‹ Memory Window
&lt;/h1>
&lt;p>&lt;strong>æœ¬æ–‡æ¬¢è¿éå•†ä¸šè½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>å£°æ˜ï¼šä»…ç”¨äºæ”¶è—ï¼Œä¾¿äºé˜…è¯»&lt;/p>&lt;span class="cite">&lt;span>â€• &lt;/span>&lt;span>Savir, &lt;/span>&lt;a href="https://zhuanlan.zhihu.com/p/353590347">&lt;cite>çŸ¥ä¹ä¸“æ ï¼š14. RDMA ä¹‹ Memory Window&lt;/cite>&lt;/a>&lt;/span>&lt;/blockquote>
&lt;p>&lt;strong>æœ¬æ–‡æ˜¯â€œRDMA æ‚è°ˆâ€ä¸“æ æ–‡ç« çš„ç¬¬ 14 ç¯‡ï¼Œæ¬¢è¿è½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„&lt;/strong>&lt;/p>
&lt;p>æˆ‘ä»¬åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-mr/" >ã€RDMA ä¹‹ Memory Regionã€‘
&lt;/a>
ä¸€æ–‡ä¸­ä»‹ç»è¿‡ Memory Regionï¼Œå®ƒæ˜¯ä¸€ç‰‡ç”±ç”¨æˆ·æ³¨å†Œçš„ç‰¹æ®Šçš„å†…å­˜åŒºåŸŸï¼šä¸€æ–¹é¢å…¶ä¸­çš„å†…å®¹ä¸ä¼šè¢«æ¢é¡µåˆ°ç¡¬ç›˜ä¸­ï¼Œå¦ä¸€æ–¹é¢ RDMA ç½‘å¡ä¸­è®°å½•äº†å®ƒçš„åœ°å€è½¬æ¢å…³ç³»ï¼Œä½¿å¾—ç¡¬ä»¶æ‹¿åˆ°ç”¨æˆ·æŒ‡å®šåœ¨ WR ä¸­çš„è™šæ‹Ÿåœ°å€ä¹‹åæ‰¾åˆ°å¯¹åº”çš„ç‰©ç†åœ°å€ã€‚&lt;/p>
&lt;p>æœ¬æ–‡æˆ‘ä»¬æ¥è®²è§£ Memory Window çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº Memory Region çš„ã€æ›´çµæ´»çš„å†…å­˜ç®¡ç†å•å…ƒã€‚é™¤äº† MW çš„æ¦‚å¿µä¹‹å¤–ï¼Œæœ¬æ–‡ä¹Ÿä¼šæ›´è¯¦ç»†çš„ä»‹ç»ä¸€äº› RDMA é¢†åŸŸçš„å†…å­˜ç›¸å…³æ¦‚å¿µï¼Œæ¯”å¦‚ L_Key/R_Key ç­‰ã€‚æœ¬æ–‡é…åˆ &lt;a class="link" href="https://cuterwrite.top/p/rdma-mr/" >ã€RDMA ä¹‹ Memory Regionã€‘
&lt;/a>
é˜…è¯»æ•ˆæœæ›´ä½³ï¼Œå»ºè®®å…ˆè¯»è€…æ¸©ä¹ ä¸€ä¸‹ã€‚&lt;/p>
&lt;h2 id="memory-window-æ˜¯ä»€ä¹ˆ">
&lt;a href="#memory-window-%e6%98%af%e4%bb%80%e4%b9%88" class="header-anchor">#&lt;/a>
Memory Window æ˜¯ä»€ä¹ˆ
&lt;/h2>
&lt;p>Memory Window ç®€ç§° MWï¼Œä¸­æ–‡å°±ç¿»è¯‘æˆå†…å­˜çª—å£å§ã€‚æ˜¯ä¸€ç§ç”±ç”¨æˆ·ç”³è¯·çš„ï¼Œç”¨äºè®©è¿œç«¯èŠ‚ç‚¹è®¿é—®æœ¬ç«¯å†…å­˜åŒºåŸŸçš„ RDMA èµ„æºã€‚æ¯ä¸ª MW éƒ½ä¼šç»‘å®šï¼ˆç§°ä¸º bindï¼‰åœ¨ä¸€ä¸ªå·²ç»æ³¨å†Œçš„ MR ä¸Šï¼Œä½†æ˜¯å®ƒç›¸æ¯”äº MR å¯ä»¥æä¾›æ›´çµæ´»çš„æƒé™æ§åˆ¶ã€‚MW å¯ä»¥ç²—ç•¥ç†è§£ä¸ºæ˜¯ MR çš„å­é›†ï¼Œä¸€ä¸ª MR ä¸Šå¯ä»¥åˆ’åˆ†å‡ºå¾ˆå¤š MWï¼Œæ¯ä¸ª MW éƒ½å¯ä»¥è®¾ç½®è‡ªå·±çš„æƒé™ã€‚MW å’Œ MR çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_12_1.webp"
alt="2024-06-28_12_1" width="30%" loading="lazy">&lt;figcaption>
&lt;h4>MR ä¸ MW çš„å…³ç³»&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="å†…å­˜çš„è®¿é—®æƒé™æ§åˆ¶">
&lt;a href="#%e5%86%85%e5%ad%98%e7%9a%84%e8%ae%bf%e9%97%ae%e6%9d%83%e9%99%90%e6%8e%a7%e5%88%b6" class="header-anchor">#&lt;/a>
å†…å­˜çš„è®¿é—®æƒé™æ§åˆ¶
&lt;/h2>
&lt;p>ä¸ºäº†åæ–‡è¯´æ˜ä¸ºä½•è®¾è®¡ MWï¼Œæˆ‘ä»¬å…ˆæ¥æŠŠ MR å’Œ MW éƒ½æ¶‰åŠçš„æƒé™æ§åˆ¶è®²è§£ä¸€ä¸‹ã€‚&lt;/p>
&lt;h3 id="mrmw-çš„æƒé™é…ç½®">
&lt;a href="#mrmw-%e7%9a%84%e6%9d%83%e9%99%90%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
MR/MW çš„æƒé™é…ç½®
&lt;/h3>
&lt;p>è¿™é‡Œçš„æƒé™ï¼ŒæŒ‡çš„æ˜¯æœ¬ç«¯/å¯¹ç«¯èŠ‚ç‚¹ï¼Œå¯¹äºæœ¬ç«¯å†…å­˜çš„è¯»/å†™æƒé™ï¼Œå®ƒä»¬ä¸¤ä¸¤ç»„åˆå½¢æˆäº†å››ç§æƒé™ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">&lt;/th>
&lt;th style="text-align: left">æœ¬ç«¯&lt;/th>
&lt;th style="text-align: left">å¯¹ç«¯&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">è¯»&lt;/td>
&lt;td style="text-align: left">Local Read&lt;/td>
&lt;td style="text-align: left">Remote Read&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">å†™&lt;/td>
&lt;td style="text-align: left">Local Write&lt;/td>
&lt;td style="text-align: left">Remote Write&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>é™¤äº†è¿™å››ç§æƒé™ä¹‹å¤–ï¼Œè¿˜æœ‰ Atomic æƒé™ç­‰ï¼Œä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´å†…ã€‚&lt;/p>
&lt;p>ä¸Šè¡¨ä¸­è¿™å››ç§æƒé™ä¸­æœ€ä½çš„æ˜¯æœ¬åœ°è¯»ï¼ˆLocal Readï¼‰ï¼Œæ˜¯ç”¨æˆ·å¿…é¡»èµ‹äºˆ MR/MW çš„æƒé™ï¼Œå› ä¸ºå¦‚æœä¸€å—å†…å­˜æœ¬åœ°çš„ç”¨æˆ·éƒ½æ— æ³•è®¿é—®çš„è¯ï¼Œé‚£å°±å¤±å»æ„ä¹‰äº†ï¼›å¦å¤–è¿˜æœ‰ä¸ªé™åˆ¶ï¼Œå¦‚æœæŸä¸ª MR éœ€è¦é…ç½®è¿œç«¯å†™ï¼ˆRemote Writeï¼‰æˆ–è€…è¿˜æ²¡ä»‹ç»çš„è¿œç«¯åŸå­æ“ä½œæƒé™ï¼ˆRemote Atomicï¼‰ï¼Œé‚£ä¹ˆä¹Ÿä¸€å®šè¦é…ç½®æœ¬åœ°å†™ï¼ˆLocal Writeï¼‰æƒé™ã€‚åœ¨æ­¤çº¦æŸä¹‹ä¸‹ï¼Œæ¯ä¸ª MR æˆ–è€… MW éƒ½å¯ä»¥æŒ‰éœ€é…ç½®æƒé™ï¼Œæ¯”å¦‚æˆ‘ä»¬æ³¨å†Œçš„ä¸€ä¸ª MR éœ€è¦å…è®¸è¿œç«¯èŠ‚ç‚¹å†™å…¥æ•°æ®ï¼Œè€Œä¸å…è®¸è¯»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ‰“å¼€ Remote Write æƒé™ï¼Œå…³é—­ Remote Read æƒé™ã€‚è¿™æ · HCAï¼ˆç½‘å¡ï¼‰æ”¶åˆ°å¯¹ç«¯å‘èµ·çš„å¯¹è¿™ä¸ª MR èŒƒå›´å†…çš„æŸä¸ªåœ°å€çš„ WRITE è¯·æ±‚ä¹‹åï¼Œå°±å¯ä»¥äºˆä»¥æ”¾è¡Œï¼›è€Œ HCA æ”¶åˆ°å¯¹ç«¯å¯¹è¿™ä¸ª MR çš„ READ æ“ä½œæ—¶ï¼Œå°±ä¼šæ‹’ç»è¿™ä¸ªè¯·æ±‚ï¼Œå¹¶è¿”å›é”™è¯¯ä¿¡æ¯ç»™å¯¹ç«¯ã€‚&lt;/p>
&lt;h3 id="memory-key">
&lt;a href="#memory-key" class="header-anchor">#&lt;/a>
Memory Key
&lt;/h3>
&lt;p>ä¸Šè¿°çš„è®¿é—®æƒé™é…ç½®ï¼Œå¹¶ä¸èƒ½æœç»æ¶æ„ç”¨æˆ·å¯¹äºæœ¬åœ°æˆ–è€…è¿œç«¯å†…å­˜çš„è®¿é—®ã€‚æ¯”å¦‚æŸä¸ªèŠ‚ç‚¹ç»™äº†ä¸€å—å†…å­˜åŒºåŸŸçš„ Remote Write æƒé™ï¼Œé‚£ä¹ˆå²‚ä¸æ˜¯ä»»æ„è¿œç«¯èŠ‚ç‚¹ï¼ˆè¿›ç¨‹ï¼‰åªè¦ä¼ å…¥äº†åˆæ³•çš„åœ°å€ä¿¡æ¯ï¼Œéƒ½å¯ä»¥å¯¹è¿™ç‰‡åŒºåŸŸè¿›è¡Œå†™å…¥äº†ï¼Ÿå› æ­¤ï¼ŒIB è§„èŒƒè®¾è®¡äº† Memory Keyï¼Œç®€å•ç†è§£å®ƒå°±æ˜¯è®¿é—® MR çš„é’¥åŒ™æœºåˆ¶ï¼Œåªæœ‰æŒæœ‰æ­£ç¡®çš„é’¥åŒ™ï¼Œæ‰èƒ½æ‰“å¼€ MR/MW çš„å¤§é—¨ã€‚&lt;/p>
&lt;p>Key æ˜¯ä¸€ä¸²æ•°å­—ï¼Œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š24bit çš„ Index ä»¥åŠ 8bit çš„ Keyï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_12_2.webp"
alt="2024-06-28_12_2" width="60%" loading="lazy">&lt;figcaption>
&lt;h4>L_Key/R_Key çš„ç»„æˆ&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å…¶ä¸­ï¼ŒIndex ç”¨äº HCA å¿«é€Ÿç´¢å¼•åˆ°æœ¬åœ°çš„è™šæ‹Ÿ-ç‰©ç†åœ°å€è½¬æ¢è¡¨ç­‰ MR ç›¸å…³çš„ä¿¡æ¯ï¼Œè€Œ Key ç”¨äºæ ¡éªŒæ•´ä¸ªå­—æ®µçš„åˆæ³•æ€§ï¼Œä»¥é˜²æ­¢æœªæˆæƒçš„ç”¨æˆ·ä»»æ„ä¼ é€’ Indexã€‚&lt;/p>
&lt;p>Memory Key æŒ‰ç…§ç”¨é€”åˆ†ä¸ºä¸¤ç§ï¼ŒLocal Key å’Œ Remote Keyï¼š&lt;/p>
&lt;h4 id="l_key">
&lt;a href="#l_key" class="header-anchor">#&lt;/a>
L_Key
&lt;/h4>
&lt;p>å³ Local Keyï¼Œå…³è”åˆ°ä¸€ä¸ª MR ä¸Šï¼Œç”¨äº HCA è®¿é—®æœ¬ç«¯å†…å­˜ã€‚å½“æœ¬ç«¯çš„æŸä¸ªè¿›ç¨‹è¯•å›¾ä½¿ç”¨ä¸€ä¸ªå·²ç»æ³¨å†Œçš„ MR çš„å†…å­˜æ—¶ï¼ŒHCA ä¼šæ ¡éªŒå…¶ä¼ é€’çš„ L_Keyã€‚å¹¶ä¸”åˆ©ç”¨ L_Key ä¸­çš„ç´¢å¼•æŸ¥æ‰¾åœ°å€è½¬æ¢è¡¨ï¼ŒæŠŠè™šæ‹Ÿåœ°å€ç¿»è¯‘æˆç‰©ç†åœ°å€ç„¶åè®¿é—®å†…å­˜ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-shared-receive-queue/" >ã€RDMA ä¹‹ Shared Receive Queueã€‘
&lt;/a>
ä¸€æ–‡ä¸­æè¿°è¿‡ sgeï¼Œsge ç”±èµ·å§‹åœ°å€ã€é•¿åº¦å’Œç§˜é’¥ç»„æˆã€‚ç”¨æˆ·åœ¨å¡«å†™ WR æ—¶ï¼Œå¦‚æœéœ€è¦ HCA è®¿é—®æœ¬ç«¯å†…å­˜ï¼Œé‚£ä¹ˆå°±éœ€è¦é€šè¿‡ä¸€ä¸ª sge çš„é“¾è¡¨ï¼ˆsglï¼‰æ¥æè¿°å†…å­˜å—ï¼Œè¿™é‡Œ sge çš„ç§˜é’¥å¡«çš„å°±æ˜¯ L_Keyï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾ä¸­çš„ key1 å’Œ key3ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ MR1 çš„ L_Key å’Œ MR2 çš„ L_Keyã€‚å¦‚æœæ²¡æœ‰ L_Keyï¼Œé‚£ä¹ˆä»»ä½•ä¸€ä¸ªæœ¬åœ°ç”¨æˆ·è¿›ç¨‹éƒ½å¯ä»¥æŒ‡æŒ¥ç¡¬ä»¶è®¿é—®å…¶ä»–æœ¬åœ°ç”¨æˆ·æ³¨å†Œçš„ MR çš„å†…å®¹ï¼Œç¡¬ä»¶ä¹Ÿéš¾ä»¥é«˜æ•ˆçš„å°†è™šæ‹Ÿåœ°å€ç¿»è¯‘æˆç‰©ç†åœ°å€ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_12_3.webp"
alt="2024-06-28_12_3" width="50%" loading="lazy">&lt;figcaption>
&lt;h4>L_Key çš„ä½œç”¨&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h4 id="r_key">
&lt;a href="#r_key" class="header-anchor">#&lt;/a>
R_Key
&lt;/h4>
&lt;p>å³ Remote Keyï¼Œå…³è”åˆ°ä¸€ä¸ª MR æˆ–è€… MW ä¸Šï¼Œç”¨äºè¿œç«¯èŠ‚ç‚¹è®¿é—®æœ¬ç«¯å†…å­˜ã€‚å½“è¿œç«¯èŠ‚ç‚¹è¯•å›¾è®¿é—®æœ¬ç«¯çš„å†…å­˜æ—¶ï¼Œä¸€æ–¹é¢æœ¬ç«¯çš„ HCA ä¼šæ ¡éªŒ R_Key æ˜¯å¦åˆæ³•ï¼Œå¦ä¸€æ–¹é¢ä¼šåˆ©ç”¨ R_Key ä¸­çš„ç´¢å¼•æŸ¥åœ°å€è½¬æ¢è¡¨ï¼ŒæŠŠè™šæ‹Ÿåœ°å€ç¿»è¯‘æˆç‰©ç†åœ°å€ç„¶åè®¿é—®å†…å­˜ã€‚&lt;/p>
&lt;p>å‡¡æ˜¯ RDMA æ“ä½œï¼ˆå³ Write/Read/Atomicï¼‰ï¼Œç”¨æˆ·éƒ½è¦åœ¨ WR ä¸­æºå¸¦è¿œç«¯å†…å­˜åŒºåŸŸçš„ R_Keyã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_12_4.webp"
alt="2024-06-28_12_4" width="70%" loading="lazy">&lt;figcaption>
&lt;h4>R_Key çš„ä½œç”¨&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>IB è§„èŒƒé€šè¿‡ä¸Šè¿°ä¸¤ç§æœºåˆ¶ï¼Œæ¥ç¡®ä¿ MR å¯ä»¥æŒ‰ç…§ç”¨æˆ·çš„æœŸæœ›è¢«æ­£ç¡®ä¸”å®‰å…¨çš„è®¿é—®ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªæ¯”å–»æ¥æ€»ç»“ä¸‹ MR/MW æƒé™æ§åˆ¶ç›¸å…³çš„å†…å®¹ï¼š&lt;/p>
&lt;p>A ç»™è‡ªå·±çš„æˆ¿é—´ï¼ˆMRï¼‰é…äº†ä¸¤æŠŠé’¥åŒ™ï¼ˆMemory Keyï¼‰ï¼Œä¸€æŠŠç•™ä½œè‡ªç”¨ï¼ˆL_Keyï¼‰ï¼Œå¦ä¸€æŠŠé’¥åŒ™ï¼ˆR_Keyï¼‰é‚®å¯„ï¼ˆå¯ä»¥æ˜¯ä»»ä½•é€šä¿¡æ–¹å¼ï¼‰ç»™äº† Bã€‚B å¯ä»¥åœ¨ A ä¸åœ¨å®¶çš„æ—¶å€™ï¼ˆæœ¬ç«¯ CPU ä¸æ„ŸçŸ¥è¿œç«¯èŠ‚ç‚¹å¯¹æœ¬åœ°å†…å­˜çš„ RDMA æ“ä½œï¼‰ï¼Œé€šè¿‡é’¥åŒ™ï¼ˆR_Keyï¼‰æ‰“å¼€é—¨ã€‚æ‰“å¼€é—¨ä¹‹åï¼Œå¯èƒ½ B åªèƒ½éš”ç€ç»ç’ƒæŸ¥çœ‹æˆ¿é—´çš„æ‘†è®¾ï¼ˆA åªç»™äº†è¿™ä¸ª MR è¿œç¨‹è¯»æƒé™ï¼‰ï¼Œæˆ–è€…è¿›å…¥æˆ¿é—´å†…å‘ç°æ¼†é»‘ä¸€ç‰‡ä»€ä¹ˆä¹Ÿçœ‹ä¸åˆ°ï¼Œä½†æ˜¯å¯ä»¥å‘æˆ¿é—´é‡Œæ”¾ç‰©å“ï¼ˆA åªç»™äº†è¿™ä¸ª MR è¿œç¨‹å†™æƒé™ï¼‰ï¼Œå½“ç„¶ä¹Ÿæœ‰å¯èƒ½æ²¡æœ‰ç»ç’ƒä¹Ÿå¼€äº†ç¯ï¼ˆåŒæ—¶ç»™äº†è¿œç¨‹è¯»å†™æƒé™ï¼‰ã€‚&lt;/p>
&lt;h2 id="ä¸ºä»€ä¹ˆè¦æœ‰-mw">
&lt;a href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e6%9c%89-mw" class="header-anchor">#&lt;/a>
ä¸ºä»€ä¹ˆè¦æœ‰ MW
&lt;/h2>
&lt;p>ç®€è€Œè¨€ä¹‹ï¼Œè®¾è®¡ MW çš„ç›®çš„å°±æ˜¯æƒ³æ›´çµæ´»çš„æ§åˆ¶å†…å­˜çš„è¿œç¨‹è®¿é—®æƒé™ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://cuterwrite.top/p/rdma-mr/" >ã€RDMA ä¹‹ Memory Regionã€‘
&lt;/a>
ä¸€æ–‡ä¸­æˆ‘ä»¬ä»‹ç»è¿‡ç”¨æˆ·æ³¨å†Œ MR çš„è¿‡ç¨‹ï¼Œéœ€è¦ä»ç”¨æˆ·æ€é™·å…¥å†…æ ¸æ€ï¼Œè°ƒç”¨å†…æ ¸æä¾›çš„å‡½æ•° pin ä½å†…å­˜ï¼ˆé˜²æ­¢æ¢é¡µï¼‰ï¼Œç„¶ååˆ¶ä½œè™šæ‹Ÿ-ç‰©ç†åœ°å€æ˜ å°„è¡¨å¹¶ä¸‹å‘ç»™ç¡¬ä»¶ã€‚&lt;/p>
&lt;p>å› ä¸º MR æ˜¯ç”±å†…æ ¸ç®¡ç†çš„ï¼Œå¦‚æœç”¨æˆ·æƒ³ä¿®æ”¹ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ MR çš„ä¿¡æ¯ï¼Œæ¯”å¦‚æˆ‘æƒ³æ”¶å›æŸä¸ª MR çš„è¿œç«¯å†™æƒé™ï¼Œåªä¿ç•™è¿œç«¯è¯»æƒé™ï¼›æˆ–è€…æƒ³è¦ä½¿ä¸€ä¸ªä¹‹å‰å·²ç»æˆæƒç»™è¿œç«¯èŠ‚ç‚¹çš„ R_Key å¤±æ•ˆï¼Œé‚£ä¹ˆç”¨æˆ·éœ€è¦é€šè¿‡é‡æ³¨å†Œ MRï¼ˆReregister MRï¼‰æ¥å£æ¥è¿›è¡Œä¿®æ”¹ï¼Œè¯¥æ¥å£ç­‰ä»·äºå…ˆå–æ¶ˆæ³¨å†Œ MRï¼ˆDeregister MRï¼‰ï¼Œç„¶åæ³¨å†Œ MRï¼ˆRegister MRï¼‰ã€‚&lt;strong>ä¸Šè¿°æµç¨‹éœ€è¦é™·å…¥å†…æ ¸æ€æ¥å®Œæˆï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹æ˜¯è€—æ—¶è¾ƒé•¿çš„&lt;/strong>ã€‚&lt;/p>
&lt;p>ä¸åŒäºéœ€è¦é€šè¿‡æ§åˆ¶è·¯å¾„ä¿®æ”¹æƒé™çš„ MRï¼Œ&lt;strong>MW åœ¨åˆ›å»ºå¥½ä¹‹åï¼Œå¯ä»¥é€šè¿‡æ•°æ®è·¯å¾„ï¼ˆå³é€šè¿‡ç”¨æˆ·æ€ç›´æ¥ä¸‹å‘ WR åˆ°ç¡¬ä»¶çš„æ–¹å¼ï¼‰åŠ¨æ€çš„ç»‘å®šåˆ°ä¸€ä¸ªå·²ç»æ³¨å†Œçš„ MR ä¸Šï¼Œå¹¶åŒæ—¶è®¾ç½®æˆ–è€…æ›´æ”¹å…¶è®¿é—®æƒé™ï¼Œè¿™ä¸ªè¿‡ç¨‹çš„é€Ÿåº¦è¿œè¿œè¶…è¿‡é‡æ–°æ³¨å†Œ MR çš„è¿‡ç¨‹&lt;/strong>ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆç°åœ¨ä¸ºäº†ä½¿ä¸€ç‰‡å†…å­˜èƒ½å¤Ÿè¢«è¿œç«¯èŠ‚ç‚¹è¿›è¡Œ RDMA WRITE/READ æ“ä½œï¼Œæˆ‘ä»¬å°±æ‹¥æœ‰äº†æ³¨å†Œ MR ä»¥åŠæ³¨å†Œ MW ç„¶åç»‘å®šåˆ°ä¸€ä¸ªå·²æ³¨å†Œçš„ MR ä¸¤ç§æ–¹å¼ï¼Œå®ƒä»¬éƒ½ä¼šäº§ç”Ÿä¸€ä¸ª R_Key æ¥æä¾›ç»™è¿œç«¯èŠ‚ç‚¹ã€‚å‰ä¸€ç§æ–¹å¼å‡†å¤‡é˜¶æ®µçš„æ­¥éª¤ç®€å•ï¼Œä½†æ˜¯ä¸å¤Ÿçµæ´»ï¼Œä¸€æ—¦æ³¨å†Œä¹‹åä¿®æ”¹èµ·æ¥ä¼šæ¯”è¾ƒéº»çƒ¦ï¼›åä¸€ç§æ–¹å¼ç›¸æ¯”å‰ä¸€ç§å¤šäº†æ³¨å†Œ MW å’Œç»‘å®š MW åˆ° MR ä¸¤ç§æ“ä½œï¼Œä½†æ˜¯å¯ä»¥æ–¹ä¾¿è¿…é€Ÿçš„æ§åˆ¶è¿œç«¯è®¿é—®æƒé™ã€‚&lt;/p>
&lt;h2 id="mw-å’Œ-mr-æƒé™çš„å…³ç³»">
&lt;a href="#mw-%e5%92%8c-mr-%e6%9d%83%e9%99%90%e7%9a%84%e5%85%b3%e7%b3%bb" class="header-anchor">#&lt;/a>
MW å’Œ MR æƒé™çš„å…³ç³»
&lt;/h2>
&lt;p>ä¹Ÿè®¸æœ‰çš„è¯»è€…ä¼šæƒ³åˆ°ï¼ŒMR ç”³è¯·æ—¶é…ç½®äº†è‡ªå·±çš„æƒé™ï¼ŒMW ç»‘å®šåˆ° MR æ—¶ä¹Ÿä¼šé…ç½®è‡ªå·±çš„æƒé™ï¼Œè¿™ä¸¤è€…çš„æƒé™æ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼ŸIB è§„èŒƒåœ¨ 10.6.7.2.2 èŠ‚æœ‰ä¸“é—¨ä»‹ç»ï¼š&lt;/p>
&lt;blockquote>
&lt;p>When binding a Memory Window, a Consumer can request any combination of remote access rights for the Window. However, if the associated Region does not have local write access enabled and the Consumer requests remote write or remote atomic access for the Window, the Channel Interface must return an error either at bind time or access time.&lt;/p>
&lt;/blockquote>
&lt;p>æ€»ç»“æ¥è¯´ï¼Œ&lt;strong>å¦‚æœæƒ³è¦ç»™ MW é…ç½®è¿œç¨‹å†™æˆ–è€…è¿œç¨‹åŸå­æ“ä½œï¼ˆAtomicï¼‰æƒé™ï¼Œé‚£ä¹ˆå®ƒç»‘å®šåˆ°çš„ MR å¿…é¡»æœ‰æœ¬åœ°å†™æƒé™ï¼Œå…¶ä»–æƒ…å†µä¸‹ä¸¤è€…æƒé™äº’ä¸å¹²æ‰°&lt;/strong>ï¼šè¿œç«¯ç”¨æˆ·ç”¨ MWï¼Œå°±è¦éµå¾ª MW çš„æƒé™é…ç½®ï¼›è¿œç«¯ç”¨æˆ·ç”¨ MRï¼Œå°±è¦éµå¾ª MR çš„æƒé™é…ç½®ã€‚&lt;/p>
&lt;h2 id="ç”¨æˆ·æ¥å£">
&lt;a href="#%e7%94%a8%e6%88%b7%e6%8e%a5%e5%8f%a3" class="header-anchor">#&lt;/a>
ç”¨æˆ·æ¥å£
&lt;/h2>
&lt;p>è€æ ·å­ï¼Œç”¨æˆ·æ¥å£æ—¶æˆ‘ä»¬æŒ‰ç…§æ§åˆ¶è·¯å¾„å’Œæ•°æ®è·¯å¾„æ¥åˆ†ç±»ï¼š&lt;/p>
&lt;h3 id="æ§åˆ¶è·¯å¾„">
&lt;a href="#%e6%8e%a7%e5%88%b6%e8%b7%af%e5%be%84" class="header-anchor">#&lt;/a>
æ§åˆ¶è·¯å¾„
&lt;/h3>
&lt;p>MW æ”¯æŒå¢ã€åˆ å’ŒæŸ¥ï¼Œä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼š&lt;/p>
&lt;h4 id="åˆ›å»ºallocate-mw">
&lt;a href="#%e5%88%9b%e5%bb%baallocate-mw" class="header-anchor">#&lt;/a>
åˆ›å»ºâ€”â€”Allocate MW
&lt;/h4>
&lt;p>ç”³è¯· MWï¼Œä¸»è¦æ˜¯åˆ›å»º MW ç›¸å…³çš„è½¯ä»¶ç»“æ„å’Œè®©ç¡¬ä»¶åšå¥½å‡†å¤‡ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šåæ–‡ä¸­ä»‹ç»çš„ MW çš„ç±»å‹ã€‚è¿™ä¸ªæ¥å£ä¼šäº§ç”Ÿä¸€ä¸ª Memory Window çš„å¥æŸ„ï¼Œç”¨æˆ·ä»¥åå¯ä»¥ç”¨è¿™ä¸ªå¥æŸ„æŒ‡ä»£è¿™ä¸ª MWã€‚&lt;/p>
&lt;p>æ³¨æ„æ­¤æ—¶ MW æ²¡æœ‰ç»‘å®šåˆ° MR ä¸Šï¼Œå¤„äºä¸å¯ä»è¿œç«¯è®¿é—®çš„çŠ¶æ€ã€‚&lt;/p>
&lt;h4 id="åˆ é™¤deallocate-mw">
&lt;a href="#%e5%88%a0%e9%99%a4deallocate-mw" class="header-anchor">#&lt;/a>
åˆ é™¤â€”â€”Deallocate MW
&lt;/h4>
&lt;p>å–æ¶ˆæ³¨å†Œ MWã€‚å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯é”€æ¯ç›¸å…³èµ„æºã€‚&lt;/p>
&lt;h4 id="æŸ¥è¯¢query-mw">
&lt;a href="#%e6%9f%a5%e8%af%a2query-mw" class="header-anchor">#&lt;/a>
æŸ¥è¯¢â€”â€”Query MW
&lt;/h4>
&lt;p>æŸ¥è¯¢ MW çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ R_Key åŠå…¶çŠ¶æ€ã€MW ç±»å‹ä»¥åŠ PD ç­‰ã€‚&lt;/p>
&lt;p>éœ€è¦å†æ¬¡å¼ºè°ƒçš„æ˜¯ï¼Œè™½ç„¶è¿™ä¸ª Verbs åœ¨ IB è§„èŒƒä¸­æœ‰æè¿°ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰åœ¨ RDMA è½¯ä»¶æ ˆä¸­å®ç°ç›¸å…³çš„ APIã€‚ç±»ä¼¼æƒ…å†µçš„ Verbs æ¥å£è¿˜æœ‰ä¸å°‘ï¼ŒRDMA è½¯ä»¶æ ˆä»¥å®ç”¨ä¸ºåŸåˆ™ï¼Œæ²¡æœ‰ç”¨æˆ·éœ€æ±‚çš„æ¥å£ä¸€èˆ¬éƒ½æ²¡æœ‰å®ç°ã€‚&lt;/p>
&lt;h3 id="æ•°æ®è·¯å¾„">
&lt;a href="#%e6%95%b0%e6%8d%ae%e8%b7%af%e5%be%84" class="header-anchor">#&lt;/a>
æ•°æ®è·¯å¾„
&lt;/h3>
&lt;p>MW åœ¨æ•°æ®è·¯å¾„æœ‰ä¸€å¥—ç‹¬ç‰¹çš„æ¥å£ï¼Œåˆ†ä¸º Bind å’Œ Invalidate ä¸¤ç±»ï¼š&lt;/p>
&lt;h4 id="ç»‘å®šbind">
&lt;a href="#%e7%bb%91%e5%ae%9abind" class="header-anchor">#&lt;/a>
ç»‘å®šâ€”â€”Bind
&lt;/h4>
&lt;p>Bind(ing)æ„ä¸ºâ€œç»‘å®šâ€ï¼ŒæŒ‡çš„æ˜¯å°†ä¸€ä¸ª MWâ€œå…³è”â€åˆ°ä¸€ä¸ªå·²ç»æ³¨å†Œçš„ MR çš„æŒ‡å®šèŒƒå›´ä¸Šï¼Œå¹¶é…ç½®ä¸€å®šçš„è¯»å†™æƒé™ã€‚ç»‘å®šçš„ç»“æœä¼šäº§ç”Ÿä¸€ä¸ª R_keyï¼Œç”¨æˆ·å¯ä»¥æŠŠè¿™ä¸ª R_Key ä¼ é€’ç»™è¿œç«¯èŠ‚ç‚¹ç”¨äºè¿œç¨‹è®¿é—®ã€‚æ³¨æ„ä¸€ä¸ª MW å¯ä»¥è¢«å¤šæ¬¡ç»‘å®šï¼Œä¸€ä¸ª MR ä¸Šä¹Ÿå¯ä»¥ç»‘å®šå¤šä¸ª MWã€‚å¦‚æœä¸€ä¸ª MR è¿˜æœ‰è¢«ç»‘å®šçš„ MWï¼Œé‚£ä¹ˆè¿™ä¸ª MR æ˜¯ä¸èƒ½è¢«å–æ¶ˆæ³¨å†Œçš„ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_12_5.webp"
alt="2024-06-28_12_5" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>Bind çš„è½¯ç¡¬ä»¶äº¤äº’&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>Bind æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯è°ƒç”¨ Post Send æ¥å£ä¸‹å‘ Bind MW WRï¼Œä¸€ç§æ˜¯è°ƒç”¨ Bind MW æ¥å£ã€‚&lt;/p>
&lt;ul>
&lt;li>Post Send Bind MW WR&lt;/li>
&lt;/ul>
&lt;p>å‰æ–‡æˆ‘ä»¬è®²è¿‡ï¼Œç›¸æ¯”äº MRï¼ŒMW æœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥ä»æ•°æ®è·¯å¾„å¿«é€Ÿçš„é…ç½®æƒé™ã€‚Post Send Bind MW WR æ“ä½œï¼ŒæŒ‡çš„å°±æ˜¯ç”¨æˆ·é€šè¿‡ post send æ¥å£ï¼ˆæ¯”å¦‚ ibv_post_send()ï¼‰ä¸‹å‘ä¸€ä¸ª WR åˆ° SQ ä¸­ï¼Œè¿™ä¸ª WR çš„æ“ä½œç±»å‹ï¼ˆæ¯”å¦‚ SEND/RDMA WRITE/RDMA READï¼‰è¢«æŒ‡å®šä¸º BIND MWï¼Œæ­¤å¤– WR ä¸­è¿˜æºå¸¦æœ‰æƒé™å’Œè¦ç»‘å®šåˆ°çš„ MR çš„èŒƒå›´ä¿¡æ¯ã€‚ä¸å…¶ä»– WR ä¸åŒï¼Œä¸‹å‘ Bind MW çš„ WR ä¹‹åï¼Œç¡¬ä»¶å¹¶ä¸ä¼šå‘é€ä»»ä½•æ•°æ®åŒ…ï¼Œè€Œæ˜¯å°† MW ç»‘å®šåˆ°äº†æŒ‡å®š MR ä¸Šã€‚&lt;/p>
&lt;p>è¿™ç§æ–¹å¼ä»…é€‚ç”¨äºåæ–‡ä»‹ç»çš„ Type 2 çš„ MWã€‚&lt;/p>
&lt;ul>
&lt;li>Bind MW&lt;/li>
&lt;/ul>
&lt;p>è™½ç„¶è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ¥å£ï¼Œä½†æ˜¯å®é™…æ˜¯åœ¨ Post Send Bind MW WR å¤–é¢åˆå°è£…äº†ä¸€å±‚ã€‚ç”¨æˆ·ä¼ å…¥ MW ç»‘å®šçš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬æƒé™åŠè¦ç»‘å®šçš„ MR çš„ä¿¡æ¯ï¼Œé©±åŠ¨ç¨‹åºè´Ÿè´£ç»„è£…å’Œä¸‹å‘ WR åˆ°ç¡¬ä»¶ä¸­ã€‚è¯¥æ¥å£æˆåŠŸåï¼Œä¼šå°†æ–°ç”Ÿæˆçš„ R_Key è¿”å›ç»™ç”¨æˆ·ã€‚&lt;/p>
&lt;p>è¿™ç§æ–¹å¼ä»…é€‚ç”¨äºåæ–‡ä»‹ç»çš„ Type 1 çš„ MWã€‚&lt;/p>
&lt;p>ä¸Šè¿°ä¸¤ç§æ“ä½œçš„å…³ç³»æ˜¯è¿™æ ·çš„ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_12_6.webp"
alt="2024-06-28_12_6" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>ä¸¤ç§ Bind æ“ä½œçš„å…³ç³»&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h4 id="æ— æ•ˆåŒ–invalidate">
&lt;a href="#%e6%97%a0%e6%95%88%e5%8c%96invalidate" class="header-anchor">#&lt;/a>
æ— æ•ˆåŒ–â€”â€”Invalidate
&lt;/h4>
&lt;p>Invalidate æ„ä¸ºæ— æ•ˆåŒ–ï¼ŒæŒ‡çš„æ˜¯ç”¨æˆ·é€šè¿‡ä¸‹å‘ä¸€ä¸ªå¸¦æœ‰ Invalidate æ“ä½œç çš„ WR åˆ°ç¡¬ä»¶è€Œä½¿ä¸€ä¸ª R_Key æ— æ•ˆçš„æ“ä½œã€‚&lt;/p>
&lt;p>&lt;strong>éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼ŒInvalidate æ“ä½œçš„å¯¹è±¡æ˜¯ R_Key è€Œä¸æ˜¯ MW æœ¬èº«ï¼Œå³ Invalidate ä¹‹åçš„æ•ˆæœæ˜¯ï¼šè¿œç«¯ç”¨æˆ·æ— æ³•å†ä½¿ç”¨è¿™ä¸ª R_Key è®¿é—®å¯¹åº”çš„ MWï¼Œè€Œ MW èµ„æºä»ç„¶å­˜åœ¨ï¼Œä»¥åä»ç„¶å¯ä»¥ç”Ÿæˆæ–°çš„ R_Key ç»™è¿œç«¯ä½¿ç”¨ã€‚&lt;/strong>&lt;/p>
&lt;p>Invalidate æ“ä½œåªèƒ½ç”¨äºä¸‹æ–‡ä»‹ç»çš„ Type 2 çš„ MWã€‚&lt;/p>
&lt;p>æŒ‰ç…§ Invalidate æ“ä½œçš„å‘èµ·æ–¹ä¸åŒï¼Œåˆå¯ä»¥è¿›ä¸€æ­¥åˆ†æˆä¸¤ç§ï¼š&lt;/p>
&lt;ul>
&lt;li>Local Invalidate&lt;/li>
&lt;/ul>
&lt;p>æœ¬åœ°æ— æ•ˆæ“ä½œã€‚ä¸Šå±‚ç”¨æˆ·å¦‚æœæƒ³åœ¨ä¸å›æ”¶ MW èµ„æºçš„æƒ…å†µä¸‹ï¼Œæ”¶å›æŸä¸ªè¿œç«¯çš„ç”¨æˆ·çš„ R_Key çš„æƒé™ã€‚é‚£ä¹ˆå°±å¯ä»¥ä¸‹å‘ä¸€ä¸ª Local Invalidate æ“ä½œåˆ° SQ ä¸­ï¼Œç¡¬ä»¶æ”¶åˆ°ä¹‹åä¼šå¯¹ç›¸åº”çš„ MR çš„é…ç½®è¿›è¡Œä¿®æ”¹ã€‚æˆåŠŸæ‰§è¡Œä¹‹åï¼Œå¦‚æœæŒæœ‰è¿™ä¸ª R_Key çš„è¿œç«¯ç”¨æˆ·æƒ³è¦å¯¹ MW è¿›è¡Œ RDMA æ“ä½œï¼Œå°†ä¼šè¢«æœ¬åœ°çš„ç¡¬ä»¶æ‹’ç»å¹¶è¿”å›é”™è¯¯ã€‚&lt;/p>
&lt;p>å› ä¸ºæ˜¯æœ¬åœ°æ“ä½œï¼Œæ‰€ä»¥ç¡¬ä»¶æ”¶åˆ°è¿™ä¸ª WR ä¹‹åä¹Ÿä¸ä¼šå‘é€æ¶ˆæ¯åˆ°é“¾è·¯ä¸Šã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_12_7.webp"
alt="2024-06-28_12_7" width="60%" loading="lazy">&lt;figcaption>
&lt;h4>Local Invalidate æ“ä½œçš„è½¯ç¡¬ä»¶äº¤äº’&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;ul>
&lt;li>Remote Invalidate&lt;/li>
&lt;/ul>
&lt;p>è¿œç«¯æ— æ•ˆæ“ä½œã€‚å½“ä¸€ä¸ªè¿œç«¯ç”¨æˆ·ä¸å†ä½¿ç”¨ä¸€ä¸ª R_Key ä¹‹åï¼Œå¯ä»¥ä¸»åŠ¨å‘é€æ¶ˆæ¯ï¼Œè®©æœ¬ç«¯å›æ”¶è¿™ä¸ª R_Keyã€‚è¿œç«¯ç”¨æˆ·ä¸‹å‘ä¸€ä¸ªå¸¦æœ‰æ­¤æ“ä½œç çš„ WR åˆ° SQ ä¸­ï¼Œå…¶ç¡¬ä»¶æ”¶åˆ°åï¼Œå°†ä¼šç»„è£…ä¸€ä¸ªæŠ¥æ–‡å¹¶å‘é€åˆ°æœ¬ç«¯ã€‚æœ¬ç«¯ç¡¬ä»¶æ”¶åˆ°è¿œç«¯çš„ Remote Invalidate æ“ä½œä¹‹åï¼Œå°†ä¼šæŠŠå¯¹åº”çš„ R_Key ç½®ä¸ºä¸å¯ç”¨çŠ¶æ€ã€‚åŒ Local Invalidate ä¸€æ ·ï¼Œæ­¤åå¯¹ç«¯å°†æ— æ³•ä½¿ç”¨è¿™ä¸ª R_Key å¯¹å¯¹åº”çš„ MW è¿›è¡Œ RDMA æ“ä½œã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_12_8.webp"
alt="2024-06-28_12_8" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>Remote Invalidate æ“ä½œçš„è½¯ç¡¬ä»¶äº¤äº’&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="mw-çš„ç±»å‹">
&lt;a href="#mw-%e7%9a%84%e7%b1%bb%e5%9e%8b" class="header-anchor">#&lt;/a>
MW çš„ç±»å‹
&lt;/h2>
&lt;p>æ ¹æ®å®ç°å’Œåº”ç”¨åœºæ™¯çš„ä¸åŒï¼ŒIB è§„èŒƒå¯¹ MW è¿›è¡Œäº†åˆ†ç±»ï¼š&lt;/p>
&lt;h3 id="type-1">
&lt;a href="#type-1" class="header-anchor">#&lt;/a>
Type 1
&lt;/h3>
&lt;p>Type 1 çš„ MW é€šè¿‡ PD å’Œä¸€ä¸ª QP å…³è”ï¼Œä¸ä¼šç»‘å®šåˆ°ä¸€ä¸ª QP ä¸Šï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šå½±å“é”€æ¯åŒä¸€ä¸ª PD ä¸‹çš„ QPã€‚&lt;/p>
&lt;p>Type 1 çš„ MW çš„ R_Key çš„ key åŸŸæ®µç”±é©±åŠ¨å’Œç¡¬ä»¶æŒæ¡ï¼Œè¿™é‡Œâ€œæŒæ¡â€çš„æ„æ€æ˜¯ï¼Œç”±é©±åŠ¨å’Œç¡¬ä»¶åˆ†é… keyï¼Œè€Œä¸æ˜¯ä¸Šå±‚ç”¨æˆ·ã€‚è¿™ä¹Ÿæ˜¯å‰æ–‡ä¸­è¯´ Type 1 çš„ MW ä¸èƒ½è¢«æ‰§è¡Œ Invalidate æ“ä½œçš„åŸå› ã€‚å¦‚æœ Type 1 MW çš„ç”¨æˆ·æƒ³è¦ä½¿ä¸€ä¸ª R_Key å¤±æ•ˆï¼Œé‚£ä¹ˆé‡æ–°é€šè¿‡ Bind MW æ¥å£ç»‘å®šä¸€æ¬¡è¿™ä¸ª MWï¼Œç¡¬ä»¶æˆ–è€…é©±åŠ¨å°±å›è‡ªåŠ¨åˆ†é…ä¸€ä¸ªæ–°çš„ R_Key çš„ key åŸŸæ®µï¼ŒåŸæœ‰çš„ R_Key ä¹Ÿå°±å¤±æ•ˆäº†ã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼Œå¦‚æœç”¨æˆ·æš‚æ—¶æƒ³è¦ä½¿ä¸€ä¸ª MW ä¸å†ç»‘å®šåˆ°ä»»ä½• MRï¼Œä½†æ˜¯åˆæƒ³ä¿ç•™ç›¸å…³çš„èµ„æºè€Œä¸æ˜¯é”€æ¯è¿™ä¸ª MWï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡è°ƒç”¨ Bind MW æ¥å£ï¼Œå¹¶å°† MW é•¿åº¦è®¾ç½®ä¸º 0 æ¥å®ç°ã€‚&lt;/p>
&lt;p>IB è§„èŒƒå…è®¸å¤šä¸ª Type 1 MW ç»‘å®šåˆ°åŒä¸€ä¸ª MR ä¸Šï¼ŒèŒƒå›´å¯ä»¥ç›¸äº’è¦†ç›–ã€‚&lt;/p>
&lt;h3 id="type-2">
&lt;a href="#type-2" class="header-anchor">#&lt;/a>
Type 2
&lt;/h3>
&lt;p>Type 2 çš„ MW èµ‹äºˆäº†ç”¨æˆ·æ›´å¤§çš„è‡ªç”±åº¦ï¼Œå…¶ R_Key çš„ key åŸŸæ®µç”±ç”¨æˆ·æŒæ¡ï¼Œå³ç”¨æˆ·æƒ³æ€ä¹ˆåˆ†é…å°±æ€ä¹ˆåˆ†é…ã€‚å‰æ–‡å·²ç»è®²è¿‡ï¼Œç”¨æˆ·é€šè¿‡ Post Send Bind MW WR æ“ä½œæ¥è¿›è¡Œç»‘å®šï¼Œè¿™ä¸ªè¿‡ç¨‹å¹¶ä¸ä¼šè¿”å› R_Keyã€‚ç”¨æˆ·å¿…é¡»è®°ä½ Allocate MW æ—¶çš„ indexï¼Œå¹¶ä¸”å’Œå…¶é€‰æ‹©çš„ 8 bit key ç»„æˆ R_Key å¹¶å‘é€ç»™å¯¹ç«¯ã€‚&lt;/p>
&lt;p>ç”¨æˆ·å¯ä»¥é€šè¿‡å‰æ–‡ä»‹ç»è¿‡çš„ Invalidate æ“ä½œæ¥ä½¿ä¸€ä¸ª R_Key æ— æ•ˆï¼Œå¦‚æœæƒ³è¦åˆ†é…ä¸€ä¸ªæ–°çš„ R_Key åˆ° MW ä¸Šï¼Œå¿…é¡»å…ˆé€šè¿‡ Invalidate æ“ä½œæ— æ•ˆä¹‹å‰çš„ R_Keyã€‚&lt;/p>
&lt;p>ä¸ Type 1 ä¸åŒï¼ŒType 2 çš„ MW ä¸æ”¯æŒ 0 é•¿åº¦çš„ç»‘å®šã€‚&lt;/p>
&lt;p>IB è§„èŒƒåŒæ ·ä¹Ÿå…è®¸å¤šä¸ª Type 2 ç»‘å®šåˆ°åŒä¸€ä¸ª MR ä¸Šï¼ŒèŒƒå›´å¯ä»¥ç›¸äº’è¦†ç›–ã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼Œæ ¹æ®ç»‘å®šå…³ç³»ä¸åŒï¼ŒType 2 è¿˜å¯ä»¥åˆ†ä¸ºä¸¤ç§å®ç°æ–¹å¼ï¼Œå®ƒä»¬çš„å·®å¼‚ä»…åœ¨äºå’Œ QP çš„ç»‘å®šå…³ç³»ä¸Šã€‚&lt;/p>
&lt;h4 id="type-2a">
&lt;a href="#type-2a" class="header-anchor">#&lt;/a>
Type 2A
&lt;/h4>
&lt;p>é€šè¿‡ QPN å’Œä¸€ä¸ª QP å…³è”ï¼Œä¹Ÿå°±æ˜¯è¯´è¿œç«¯è®¿é—®è¿™ä¸ª MW èŒƒå›´å†…çš„å†…å­˜æ—¶å€™ï¼Œé™¤äº† R_Key ä¹‹å¤–ï¼Œè¿˜å¿…é¡»æŒ‡å®šæ­£ç¡®çš„ QPNã€‚å¦‚æœä¸€ä¸ª QP ä¸Šè¿˜æœ‰ç»‘å®šçš„ Type 2A çš„ MWï¼Œé‚£ä¹ˆè¿™ä¸ª QP ä¸å¯ä»¥è¢«é”€æ¯ã€‚&lt;/p>
&lt;h4 id="type-2b">
&lt;a href="#type-2b" class="header-anchor">#&lt;/a>
Type 2B
&lt;/h4>
&lt;p>é€šè¿‡ QPN å’Œ PD ä¸ä¸€ä¸ª QP å…³è”ï¼Œæ¯” Type 2A å¤šäº†ä¸ª PD çš„æ ¡éªŒï¼Œå³è¿œç«¯é€šè¿‡ RDMA æ“ä½œè®¿é—® MW çš„å†…å­˜æ—¶ï¼Œé™¤äº† QPN è¦æ­£ç¡®ä¹‹å¤–ï¼Œå…¶æŒ‡å®šçš„æœ¬ç«¯ QP çš„ PD è¦ä¸ç»‘å®šè¿™ä¸ª MW æ—¶çš„ PD ç›¸åŒã€‚å¦å¤–ï¼Œä¸ Type 2A ä¸åŒï¼ŒQP å¦‚æœè¿˜æœ‰ Type 2B MW ç»‘å®šå…³ç³»æ—¶æ˜¯å¯ä»¥è¢«é”€æ¯çš„ã€‚&lt;/p>
&lt;p>è¿™é‡Œ IB è§„èŒƒä¸­åŸæœ‰çš„ä»‹ç»å°±æ¯”è¾ƒåˆ†æ•£ï¼Œæˆ‘ä»¬æ¥ç®€å•æ€»ç»“ä¸€ä¸‹å‡ ç§ MW çš„å¼‚åŒï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">&lt;/th>
&lt;th style="text-align: left">Type 1&lt;/th>
&lt;th style="text-align: left">Type 2A&lt;/th>
&lt;th style="text-align: left">Type 2B&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">å…³è”å…³ç³»&lt;/td>
&lt;td style="text-align: left">PD&lt;/td>
&lt;td style="text-align: left">QP&lt;/td>
&lt;td style="text-align: left">PD + QP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">R_Key çš„ key åŸŸå½’å±&lt;/td>
&lt;td style="text-align: left">é©±åŠ¨+ç¡¬ä»¶&lt;/td>
&lt;td style="text-align: left">ç”¨æˆ·&lt;/td>
&lt;td style="text-align: left">ç”¨æˆ·&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">ç»‘å®šæ–¹å¼&lt;/td>
&lt;td style="text-align: left">Bind MW ç»‘å®šåä¹‹å‰çš„ R_Key è‡ªåŠ¨å¤±æ•ˆ&lt;/td>
&lt;td style="text-align: left">Post Send Bind MWWR ç»‘å®šå‰éœ€è¦å…ˆä½¿ä¹‹å‰çš„ R_Key æ— æ•ˆåŒ–&lt;/td>
&lt;td style="text-align: left">Post Send Bind MWWR ç»‘å®šå‰éœ€è¦å…ˆä½¿ä¹‹å‰çš„ R_Key æ— æ•ˆåŒ–&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">æ˜¯å¦æ”¯æŒé›¶é•¿åº¦&lt;/td>
&lt;td style="text-align: left">æ˜¯&lt;/td>
&lt;td style="text-align: left">å¦&lt;/td>
&lt;td style="text-align: left">å¦&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">æ˜¯å¦æ”¯æŒ Invalidate&lt;/td>
&lt;td style="text-align: left">å¦&lt;/td>
&lt;td style="text-align: left">æ˜¯&lt;/td>
&lt;td style="text-align: left">æ˜¯&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">å…³è”çš„ QP æ˜¯å¦å¯ä»¥è¢«é”€æ¯&lt;/td>
&lt;td style="text-align: left">-&lt;/td>
&lt;td style="text-align: left">å¦&lt;/td>
&lt;td style="text-align: left">æ˜¯&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>æ­¤å¤–ï¼ŒIB è§„èŒƒä¸­å¯¹ä¸Šè¿°å‡ ç§ç±»å‹è¿˜æœ‰å¦‚ä¸‹æè¿°ï¼šHCA å¿…é¡»å®ç° Type 1 çš„ MWï¼Œå¦å¤–å¯ä»¥ä»…é€‰æ‹©å®ç° Type 2A å’Œ 2B ä¸­çš„ä¸€ç§ã€‚Type 1 å’Œ Type 2 çš„ MW å¯ä»¥åŒæ—¶å…³è”åˆ°åŒä¸€ä¸ª MR ä¸Šã€‚å› ä¸ºæˆ‘äº†è§£åˆ°çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ MW çš„æƒ…å†µä¸å¤šï¼Œæ‰€ä»¥å…·ä½“åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹åº”è¯¥ä½¿ç”¨å“ªç§ MW ä¹Ÿè¯´ä¸å‡ºæ‰€ä»¥ç„¶æ¥ï¼Œå¦‚æœè¯»è€…æœ‰å¯¹è¿™æ–¹é¢çš„äº†è§£æ¬¢è¿ä¸€èµ·äº¤æµã€‚&lt;/p>
&lt;p>å¥½äº†ï¼ŒMW å°±è®²åˆ°è¿™é‡Œï¼Œåˆ°æ­¤ä¸ºæ­¢ RDMA æŠ€æœ¯ä¸­å¸¸è§çš„èµ„æºå°±éƒ½ä»‹ç»å®Œäº†ã€‚&lt;/p>
&lt;p>é‰´äºä¸€èˆ¬æ”¯æŒ RDMA çš„è®¾å¤‡éƒ½æ¯”è¾ƒæ˜‚è´µï¼Œä¸‹ä¸€ç¯‡æˆ‘å°†ä»‹ç»å¦‚ä½•é€šè¿‡è½¯ä»¶æ¨¡æ‹Ÿè®¾å¤‡çš„æ–¹å¼â€”â€”å³ Soft-RoCE è¿›è¡Œä¸€äº›ç¼–ç¨‹å®éªŒã€‚&lt;/p>
&lt;h2 id="ib-è§„èŒƒç›¸å…³ç« èŠ‚">
&lt;a href="#ib-%e8%a7%84%e8%8c%83%e7%9b%b8%e5%85%b3%e7%ab%a0%e8%8a%82" class="header-anchor">#&lt;/a>
IB è§„èŒƒç›¸å…³ç« èŠ‚
&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>3.5.3 Memory Keys ä»‹ç»&lt;/p>
&lt;/li>
&lt;li>
&lt;p>9.4.1.1 Invalidate æ“ä½œ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.6.7 æƒé™ç®¡ç†&lt;/p>
&lt;/li>
&lt;li>
&lt;p>11.2.10.9~12 ç›¸å…³ Verbs ä»‹ç»&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="å‚è€ƒæ–‡æ¡£">
&lt;a href="#%e5%8f%82%e8%80%83%e6%96%87%e6%a1%a3" class="header-anchor">#&lt;/a>
å‚è€ƒæ–‡æ¡£
&lt;/h2>
&lt;p>[1] IB Specification Vol 1-Release-1.4&lt;/p>
&lt;p>[2] Linux Kernel Networking - Implementation and Theory. Chapter 13&lt;/p></description></item><item><title>RDMA ä¹‹ Shared Receive Queue</title><link>https://cuterwrite.top/p/rdma-shared-receive-queue/</link><pubDate>Wed, 26 Jun 2024 23:34:00 +0000</pubDate><guid>https://cuterwrite.top/p/rdma-shared-receive-queue/</guid><description>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-16_116373922_p0_master1200.webp" alt="Featured image of post RDMA ä¹‹ Shared Receive Queue" />&lt;h1 id="rdma-ä¹‹-shared-receive-queue">
&lt;a href="#rdma-%e4%b9%8b-shared-receive-queue" class="header-anchor">#&lt;/a>
RDMA ä¹‹ Shared Receive Queue
&lt;/h1>
&lt;p>&lt;strong>æœ¬æ–‡æ¬¢è¿éå•†ä¸šè½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>å£°æ˜ï¼šä»…ç”¨äºæ”¶è—ï¼Œä¾¿äºé˜…è¯»&lt;/p>&lt;span class="cite">&lt;span>â€• &lt;/span>&lt;span>Savir, &lt;/span>&lt;a href="https://zhuanlan.zhihu.com/p/279904125">&lt;cite>çŸ¥ä¹ä¸“æ ï¼š11. RDMA ä¹‹ Shared Receive Queue&lt;/cite>&lt;/a>&lt;/span>&lt;/blockquote>
&lt;p>æˆ‘ä»¬æ›¾åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-element/" >ã€3. RDMA åŸºæœ¬å…ƒç´ ã€‘
&lt;/a>
ä¸­ç®€å•ä»‹ç»äº† SRQ çš„æ¦‚å¿µï¼Œæœ¬æ–‡å°†å¸¦å¤§å®¶äº†è§£æ›´å¤šå…³äº SRQ çš„ç»†èŠ‚ã€‚&lt;/p>
&lt;h2 id="åŸºæœ¬æ¦‚å¿µ">
&lt;a href="#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" class="header-anchor">#&lt;/a>
åŸºæœ¬æ¦‚å¿µ
&lt;/h2>
&lt;h3 id="ä»€ä¹ˆæ˜¯-srq">
&lt;a href="#%e4%bb%80%e4%b9%88%e6%98%af-srq" class="header-anchor">#&lt;/a>
ä»€ä¹ˆæ˜¯ SRQ
&lt;/h3>
&lt;p>å…¨ç§°ä¸º Shared Receive Queueï¼Œç›´è¯‘ä¸ºå…±äº«æ¥æ”¶é˜Ÿåˆ—ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒRDMA é€šä¿¡çš„åŸºæœ¬å•ä½æ˜¯ QPï¼Œæ¯ä¸ª QP éƒ½ç”±ä¸€ä¸ªå‘é€é˜Ÿåˆ— SQ å’Œæ¥æ”¶é˜Ÿåˆ— RQ ç»„æˆã€‚&lt;/p>
&lt;p>SRQ æ˜¯ IB åè®®ä¸ºäº†ç»™æ¥æ”¶ç«¯èŠ‚çœèµ„æºè€Œè®¾è®¡çš„ã€‚æˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ª RQ å…±äº«ç»™æ‰€æœ‰å…³è”çš„ QP ä½¿ç”¨ï¼Œè¿™ä¸ªå…¬ç”¨çš„ RQ å°±ç§°ä¸º SRQã€‚å½“ä¸å…¶å…³è”çš„ QP æƒ³è¦ä¸‹å‘æ¥æ”¶ WQE æ—¶ï¼Œéƒ½å¡«å†™åˆ°è¿™ä¸ª SRQ ä¸­ã€‚ç„¶åæ¯å½“ç¡¬ä»¶æ¥æ”¶åˆ°æ•°æ®åï¼Œå°±æ ¹æ® SRQ ä¸­çš„ä¸‹ä¸€ä¸ª WQE çš„å†…å®¹æŠŠæ•°æ®å­˜æ”¾åˆ°æŒ‡å®šä½ç½®ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_11_1.webp"
alt="2024-06-28_11_1" width="80%" loading="lazy">
&lt;/figure>
&lt;h3 id="ä¸ºä»€ä¹ˆè¦ç”¨-srq">
&lt;a href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e7%94%a8-srq" class="header-anchor">#&lt;/a>
ä¸ºä»€ä¹ˆè¦ç”¨ SRQ
&lt;/h3>
&lt;p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å‘ SQ ä¸­ä¸‹ä»»åŠ¡çš„æ•°é‡è¦è¿œè¿œè¶…è¿‡å‘ RQ ä¸­ä¸‹å‘ä»»åŠ¡çš„æ•°é‡ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¯·å…ˆå›å¿†ä¸€ä¸‹å“ªäº›æ“ä½œç±»å‹ä¼šç”¨åˆ° SQï¼Œå“ªäº›åˆä¼šç”¨åˆ° RQã€‚&lt;/p>
&lt;p>SEND/WRITE/READ éƒ½éœ€è¦é€šä¿¡å‘èµ·æ–¹å‘ SQ ä¸­ä¸‹å‘ä¸€ä¸ª WRï¼Œè€Œåªæœ‰å’Œ SEND é…åˆçš„ RECV æ“ä½œæ‰éœ€è¦é€šä¿¡å“åº”æ–¹ä¸‹å‘ WR åˆ° RQ ä¸­ï¼ˆå¸¦ç«‹å³æ•°çš„ Write æ“ä½œä¹Ÿä¼šæ¶ˆè€— Receive WRï¼Œæˆ‘ä»¬è¿˜æ²¡è®²åˆ°ï¼‰ã€‚è€Œæˆ‘ä»¬åˆçŸ¥é“ï¼ŒSEND-RECV è¿™ä¸€å¯¹æ“ä½œé€šå¸¸éƒ½æ˜¯ç”¨äºä¼ é€’æ§åˆ¶ä¿¡æ¯ï¼ŒWRITE å’Œ READ æ‰æ˜¯è¿›è¡Œå¤§é‡è¿œç«¯å†…å­˜è¯»å†™æ“ä½œæ—¶çš„ä¸»è§’ï¼Œæ‰€ä»¥è‡ªç„¶ SQ çš„ä½¿ç”¨ç‡æ˜¯è¿œè¿œé«˜äº RQ çš„ã€‚&lt;/p>
&lt;p>æ¯ä¸ªé˜Ÿåˆ—éƒ½æ˜¯æœ‰å®ä½“çš„ï¼Œå ç”¨ç€å†…å­˜ä»¥åŠç½‘å¡çš„ç‰‡ä¸Šå­˜å‚¨ç©ºé—´ã€‚åœ¨å•†ç”¨åœºæ™¯ä¸‹ï¼ŒQP çš„æ•°é‡æ˜¯å¯èƒ½è¾¾åˆ°åä¸‡çº§ç”šè‡³æ›´é«˜çš„ï¼Œå¯¹å†…å­˜å®¹é‡æå‡ºäº†å¾ˆé«˜çš„è¦æ±‚ï¼Œå†…å­˜éƒ½æ˜¯ç™½èŠ±èŠ±çš„é“¶å­ä¹°çš„ï¼ŒSRQ å°±æ˜¯ IB åè®®ä¸ºäº†èŠ‚çœç”¨æˆ·çš„å†…å­˜è€Œè®¾è®¡çš„ä¸€ç§æœºåˆ¶ã€‚&lt;/p>
&lt;p>æ¥çœ‹ä¸€ä¸‹åè®®ä¸­å¯¹ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ SRQ çš„å®˜æ–¹è§£é‡Šï¼ˆ10.2.9.1 ç« èŠ‚ï¼‰ï¼š&lt;/p>
&lt;blockquote>
&lt;p>Without SRQ, an RC, UC or UD Consumer must post the number of receive WRs necessary to handle incoming receives on a given QP. If the Consumer cannot predict the incoming rate on a given QP, because, for example, the connection has a bursty nature, the Consumer must either: post a sufficient number of RQ WRs to handle the highest incoming rate for each connection, or, for RC, let message flow control cause the remote sender to back off until local Consumer posts more WRs.&lt;/p>
&lt;p>â€¢ Posting sufficient WRs on each QP to hold the possible incoming rate, wastes WQEs, and the associated Data Segments, when the Receive Queue is inactive. Furthermore, the HCA doesnâ€™t provide a way of reclaiming these WQEs for use on other connections.&lt;/p>
&lt;p>â€¢ Letting the RC message flow control cause the remote sender to back off can add unnecessary latencies, specially if the local Consumer is unaware that the RQ is starving.&lt;/p>
&lt;/blockquote>
&lt;p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æ²¡æœ‰ SRQ çš„æƒ…å†µä¸‹ï¼Œå› ä¸º RC/UC/UD çš„æ¥æ”¶æ–¹ä¸çŸ¥é“å¯¹ç«¯ä»€ä¹ˆæ—¶å€™ä¼šå‘é€è¿‡æ¥å¤šå°‘æ•°æ®ï¼Œæ‰€ä»¥å¿…é¡»åšå¥½æœ€åçš„æ‰“ç®—ï¼Œåšå¥½çªå‘æ€§æ”¶åˆ°å¤§é‡æ•°æ®çš„å‡†å¤‡ï¼Œä¹Ÿå°±æ˜¯å‘ RQ ä¸­ä¸‹å‘è¶³é‡çš„æ¥æ”¶ WQEï¼›å¦å¤– RC æœåŠ¡ç±»å‹å¯ä»¥åˆ©ç”¨æµæ§æœºåˆ¶æ¥åå‹å‘é€æ–¹ï¼Œä¹Ÿå°±æ˜¯å‘Šè¯‰å¯¹ç«¯â€æˆ‘è¿™è¾¹ RQ WQE ä¸å¤Ÿäº†â€œï¼Œè¿™æ ·å‘é€ç«¯å°±ä¼šæš‚æ—¶æ”¾ç¼“æˆ–åœæ­¢å‘é€æ•°æ®ã€‚&lt;/p>
&lt;p>ä½†æ˜¯æ­£å¦‚æˆ‘ä»¬å‰æ–‡æ‰€è¯´ï¼Œç¬¬ä¸€ç§æ–¹æ³•ç”±äºæ˜¯ä¸ºæœ€åæƒ…å†µå‡†å¤‡çš„ï¼Œå¤§éƒ¨åˆ†æ—¶å€™æœ‰å¤§é‡çš„ RQ WQE å¤„äºç©ºé—²çŠ¶æ€æœªè¢«ä½¿ç”¨ï¼Œè¿™å¯¹å†…å­˜æ˜¯ä¸€ç§æå¤§åœ°æµªè´¹ï¼›ç¬¬äºŒç§æ–¹æ³•è™½ç„¶ä¸ç”¨ä¸‹å‘é‚£ä¹ˆå¤š RQ WQE äº†ï¼Œä½†æ˜¯æµæ§æ˜¯æœ‰ä»£ä»·çš„ï¼Œå³ä¼šå¢åŠ é€šä¿¡æ—¶å»¶ã€‚&lt;/p>
&lt;p>è€Œ SRQ é€šè¿‡å…è®¸å¾ˆå¤š QP å…±äº«æ¥æ”¶ WQEï¼ˆä»¥åŠç”¨äºå­˜æ”¾æ•°æ®çš„å†…å­˜ç©ºé—´ï¼‰æ¥è§£å†³äº†ä¸Šé¢çš„é—®é¢˜ã€‚å½“ä»»ä½•ä¸€ä¸ª QP æ”¶åˆ°æ¶ˆæ¯åï¼Œç¡¬ä»¶ä¼šä» SRQ ä¸­å–å‡ºä¸€ä¸ª WQEï¼Œæ ¹æ®å…¶å†…å®¹å­˜æ”¾æ¥æ”¶åˆ°çš„æ•°æ®ï¼Œç„¶åç¡¬ä»¶é€šè¿‡ Completion Queue æ¥è¿”å›æ¥æ”¶ä»»åŠ¡çš„å®Œæˆä¿¡æ¯ç»™å¯¹åº”çš„ä¸Šå±‚ç”¨æˆ·ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä½¿ç”¨ SRQ æ¯”ä½¿ç”¨æ™®é€šçš„ RQ å¯ä»¥èŠ‚çœå¤šå°‘å†…å­˜&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>ï¼š&lt;/p>
&lt;p>å‡è®¾æ¥å—æ•°æ®çš„èŠ‚ç‚¹ä¸Šæœ‰ N å¯¹ QPï¼Œå¹¶ä¸”æ¯ä¸ª QP éƒ½å¯èƒ½åœ¨éšæœºçš„æ—¶é—´æ”¶åˆ°è¿ç»­çš„ M ä¸ªæ¶ˆæ¯ï¼ˆæ¯ä¸ªæ¶ˆæ¯éƒ½éœ€è¦æ¶ˆè€—ä¸€ä¸ª RQ ä¸­çš„ WQEï¼‰ï¼Œ&lt;/p>
&lt;ul>
&lt;li>å¦‚æœä¸ä½¿ç”¨ SRQ çš„è¯ï¼Œç”¨æˆ·ä¸€å…±éœ€è¦ä¸‹å‘ N * M ä¸ª RQ WQEã€‚&lt;/li>
&lt;li>å¦‚æœä½¿ç”¨ SRQ çš„è¯ï¼Œç”¨æˆ·åªéœ€è¦ä¸‹å‘ K * M ä¸ª RQ WQEï¼Œè€Œ K è¿œå°äº Nã€‚&lt;/li>
&lt;/ul>
&lt;p>è¿™ä¸ª K æ˜¯å¯ä»¥ç”±ç”¨æˆ·æ ¹æ®ä¸šåŠ¡æ¥é…ç½®çš„ï¼Œå¦‚æœå­˜åœ¨å¤§é‡çš„å¹¶å‘æ¥æ”¶çš„æƒ…å†µï¼Œé‚£ä¹ˆå°±æŠŠ K è®¾ç½®å¤§ä¸€ç‚¹ï¼Œå¦åˆ™ K è®¾ç½®æˆä¸ªä½æ•°å°±è¶³å¤Ÿåº”ä»˜ä¸€èˆ¬çš„æƒ…å†µäº†ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬ä¸€å…±èŠ‚çœäº† (N - K) * M ä¸ª RQ WQEï¼ŒRQ WQE æœ¬èº«å…¶å®ä¸æ˜¯å¾ˆå¤§ï¼Œå¤§çº¦åœ¨å‡ ä¸ª KB çš„æ ·å­ï¼Œçœ‹èµ·æ¥å¥½åƒå ä¸äº†å¤šå°‘å†…å­˜ã€‚ä½†æ˜¯å¦‚å‰æ–‡æ‰€è¯´ï¼Œå®é™…ä¸ŠèŠ‚çœçš„è¿˜æœ‰ç”¨äº&lt;strong>å­˜æ”¾æ•°æ®çš„å†…å­˜ç©ºé—´&lt;/strong>ï¼Œè¿™å¯æ˜¯å¾ˆå¤§ä¸€å—å†…å­˜äº†ï¼Œæˆ‘ä»¬ç”¨å›¾æ¥è¯´æ˜ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_11_2.webp"
alt="2024-06-28_11_2" width="80%" loading="lazy">
&lt;/figure>
&lt;p>ä¸Šå›¾ä¸­çš„ SRQ ä¸­æœ‰ä¸¤ä¸ª RQ WQEï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ RQ WQE çš„å†…å®¹ï¼Œå®ƒä»¬æ˜¯ç”±æ•°ä¸ª sgeï¼ˆScatter/Gather Elementï¼‰ç»„æˆçš„ï¼Œæ¯ä¸ª sge ç”±ä¸€ä¸ªå†…å­˜åœ°å€ï¼Œé•¿åº¦å’Œç§˜é’¥ç»„æˆã€‚æœ‰äº†èµ·å§‹åœ°å€å’Œé•¿åº¦ï¼Œsge å°±å¯ä»¥æŒ‡å‘ä¸€å—è¿ç»­çš„å†…å­˜åŒºåŸŸï¼Œé‚£ä¹ˆå¤šä¸ª sge å°±å¯ä»¥è¡¨ç¤ºå¤šä¸ªå½¼æ­¤ç¦»æ•£çš„è¿ç»­å†…å­˜å—ï¼Œæˆ‘ä»¬ç§°å¤šä¸ª sge ä¸º sglï¼ˆScatter/Gather Listï¼‰ã€‚sge åœ¨ IB è½¯ä»¶åè®®æ ˆä¸­éšå¤„å¯è§ï¼ˆå…¶å®åœ¨æ•´ä¸ª Linux éƒ½å¾ˆå¸¸è§ï¼‰ï¼Œå¯ä»¥ç”¨éå¸¸å°‘çš„ç©ºé—´è¡¨ç¤ºéå¸¸å¤§çš„å†…å­˜åŒºåŸŸï¼ŒIB çš„ç”¨æˆ·éƒ½ä½¿ç”¨ sge æ¥æŒ‡å®šå‘é€å’Œæ¥æ”¶åŒºåŸŸçš„ã€‚&lt;/p>
&lt;p>å¯ä»¥ç®€å•ä¼°ç®—ä¸‹æ¯ä¸ª sge å¯ä»¥æŒ‡å‘å¤šå¤§çš„å†…å­˜åŒºåŸŸï¼Œlength æ˜¯ä¸€ä¸ª 32bit çš„æ— ç¬¦å·æ•´å‹ï¼Œå¯ä»¥è¡¨ç¤º 4GB çš„ç©ºé—´ã€‚å‡è®¾ä¸€ä¸ª RQ WQE æœ€å¤§å¯ä»¥å­˜æ”¾ 256 ä¸ª sgeï¼Œé‚£ä¹ˆä¸€ä¸ª RQ WQE ä¸€å…±å°±æ˜¯ 1TBã€‚å½“ç„¶å®é™…ä¸Šä¸å¯èƒ½è¿™ä¹ˆå¤§ï¼Œè¿™é‡Œåªæ˜¯æƒ³ç›´è§‚çš„å‘Šè¯‰è¯»è€… RQ WQE èƒŒåå¯èƒ½å ç”¨ç€å¤šå¤§çš„å†…å­˜ç©ºé—´ã€‚&lt;/p>
&lt;h3 id="srqc">
&lt;a href="#srqc" class="header-anchor">#&lt;/a>
SRQC
&lt;/h3>
&lt;p>å³ SRQ Contextã€‚åŒ QPC ä¸€æ ·ï¼ŒSRQC æ˜¯ç”¨æ¥å‘ŠçŸ¥ç¡¬ä»¶è·Ÿ SRQ æœ‰å…³çš„å±æ€§çš„ï¼ŒåŒ…æ‹¬æ·±åº¦ã€WQE å¤§å°ç­‰ä¿¡æ¯ï¼Œæœ¬æ–‡ä¸å†èµ˜è¿°äº†ã€‚&lt;/p>
&lt;h3 id="srqn">
&lt;a href="#srqn" class="header-anchor">#&lt;/a>
SRQN
&lt;/h3>
&lt;p>å³ SRQ Numberã€‚åŒ QP ä¸€æ ·ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸­å¯èƒ½å­˜åœ¨å¤šä¸ª SRQï¼Œä¸ºäº†æ ‡è¯†å’ŒåŒºåˆ†è¿™äº› SRQï¼Œæ¯ä¸ª SRQ éƒ½æœ‰ä¸€ä¸ªåºå·ï¼Œç§°ä¸º SRQNã€‚&lt;/p>
&lt;h3 id="srq-çš„-pd">
&lt;a href="#srq-%e7%9a%84-pd" class="header-anchor">#&lt;/a>
SRQ çš„ PD
&lt;/h3>
&lt;p>æˆ‘ä»¬åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-protection-domain/" >ã€7. RDMA ä¹‹ Protection Domainã€‘
&lt;/a>
ä¸­ä»‹ç»è¿‡ Protection Domain çš„æ¦‚å¿µï¼Œå®ƒç”¨æ¥éš”ç¦»ä¸åŒçš„ RDMA èµ„æºã€‚æ¯ä¸ª SRQ éƒ½å¿…é¡»æŒ‡å®šä¸€ä¸ªè‡ªå·±çš„ PDï¼Œå¯ä»¥è·Ÿè‡ªå·±å…³è”çš„ QP çš„ PD ç›¸åŒï¼Œä¹Ÿå¯ä»¥ä¸åŒï¼›SRQ ä¹‹é—´ä¹Ÿå¯ä»¥ä½¿ç”¨ç›¸åŒçš„ PDã€‚&lt;/p>
&lt;p>å¦‚æœåœ¨ä½¿ç”¨ SRQ çš„æ—¶å€™ï¼Œæ”¶åˆ°äº†æ•°æ®åŒ…ï¼Œé‚£ä¹ˆåªæœ‰åœ¨è¦è®¿é—®çš„ MR å’Œ SRQ å¤„äºåŒä¸€ä¸ª PD ä¸‹ï¼Œæ‰ä¼šæ­£å¸¸æ¥æ”¶è¿™ä¸ªæ•°æ®åŒ…ï¼Œå¦åˆ™ä¼šäº§ç”Ÿç«‹å³é”™è¯¯ã€‚&lt;/p>
&lt;h2 id="å¼‚æ­¥äº‹ä»¶">
&lt;a href="#%e5%bc%82%e6%ad%a5%e4%ba%8b%e4%bb%b6" class="header-anchor">#&lt;/a>
å¼‚æ­¥äº‹ä»¶
&lt;/h2>
&lt;p>æˆ‘ä»¬åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-completion-queue/" >ã€10. RDMA ä¹‹ Completion Queueã€‘
&lt;/a>
ä¸€æ–‡ä¸­ä»‹ç»è¿‡ï¼ŒIB åè®®æ ¹æ®é”™è¯¯çš„ä¸ŠæŠ¥æ–¹å¼å°†é”™è¯¯ç±»å‹åˆ†ä¸ºç«‹å³é”™è¯¯ï¼Œå®Œæˆé”™è¯¯å’Œå¼‚æ­¥é”™è¯¯ã€‚å…¶ä¸­çš„å¼‚æ­¥é”™è¯¯ç±»ä¼¼äºä¸­æ–­/äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰æ—¶å€™ä¹Ÿç§°å…¶ä¸ºå¼‚æ­¥äº‹ä»¶ã€‚æ¯ä¸ª HCA éƒ½ä¼šæ³¨å†Œä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ä¸“é—¨ç”¨æ¥å¤„ç†å¼‚æ­¥äº‹ä»¶ï¼Œæ”¶åˆ°å¼‚æ­¥äº‹ä»¶åï¼Œé©±åŠ¨ç¨‹åºä¼šå¯¹å…¶è¿›è¡Œå¿…è¦çš„å¤„ç†å’Œè¿›ä¸€æ­¥ä¸ŠæŠ¥ç»™ç”¨æˆ·ã€‚&lt;/p>
&lt;p>å…³äº SRQ æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å¼‚æ­¥äº‹ä»¶ï¼Œç”¨æ¥åŠæ—¶é€šçŸ¥ä¸Šå±‚ç”¨æˆ· SRQ çš„çŠ¶æ€ï¼Œå³ SRQ Limit Reached äº‹ä»¶ã€‚&lt;/p>
&lt;h3 id="srq-limit">
&lt;a href="#srq-limit" class="header-anchor">#&lt;/a>
SRQ Limit
&lt;/h3>
&lt;p>SRQ å¯ä»¥è®¾ç½®ä¸€ä¸ªæ°´çº¿/é˜ˆå€¼ï¼Œå½“é˜Ÿåˆ—ä¸­å‰©ä½™çš„ WQE æ•°é‡å°äºæ°´çº¿æ—¶ï¼Œè¿™ä¸ª SRQ ä¼šå°±ä¸ŠæŠ¥ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶ã€‚æé†’ç”¨æˆ·â€œé˜Ÿåˆ—ä¸­çš„ WQE å¿«ç”¨å®Œäº†ï¼Œè¯·ä¸‹å‘æ›´å¤š WQE ä»¥é˜²æ²¡æœ‰åœ°æ–¹æ¥æ”¶æ–°çš„æ•°æ®â€ã€‚è¿™ä¸ªæ°´çº¿/é˜ˆå€¼å°±è¢«ç§°ä¸º SRQ Limitï¼Œè¿™ä¸ªä¸ŠæŠ¥çš„äº‹ä»¶å°±è¢«ç§°ä¸º SRQ Limit Reachedã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_11_3.webp"
alt="2024-06-28_11_3" width="30%" loading="lazy">
&lt;/figure>
&lt;p>å› ä¸º SRQ æ˜¯å¤šä¸ª QP å…±äº«çš„ï¼Œæ‰€ä»¥å¦‚æœæ·±åº¦æ¯”è¾ƒå°çš„æƒ…å†µä¸‹ï¼Œå¾ˆæœ‰å¯èƒ½çªç„¶é‡Œé¢çš„ WQE å°±ç”¨å®Œäº†ã€‚æ‰€ä»¥åè®®è®¾è®¡äº†è¿™ç§æœºåˆ¶ï¼Œæ¥ä¿è¯ç”¨æˆ·èƒ½å¤ŸåŠæ—¶å¹²é¢„ WQE ä¸å¤Ÿçš„æƒ…å†µã€‚&lt;/p>
&lt;p>ä¸ŠæŠ¥å¼‚æ­¥äº‹ä»¶ä¹‹åï¼ŒSRQ Limit çš„å€¼ä¼šè¢«ç¡¬ä»¶é‡æ–°è®¾ç½®ä¸º 0ï¼ˆåº”è¯¥æ˜¯ä¸ºäº†é˜²æ­¢ä¸€ç›´ä¸ŠæŠ¥å¼‚æ­¥äº‹ä»¶ç»™ä¸Šå±‚ï¼‰ã€‚å½“ç„¶ç”¨æˆ·å¯ä»¥ä¸ä½¿ç”¨è¿™ä¸ªæœºåˆ¶ï¼Œåªéœ€è¦å°† SRQ Limit çš„å€¼è®¾ä¸º 0 å³å¯ã€‚&lt;/p>
&lt;h2 id="ç”¨æˆ·æ¥å£">
&lt;a href="#%e7%94%a8%e6%88%b7%e6%8e%a5%e5%8f%a3" class="header-anchor">#&lt;/a>
ç”¨æˆ·æ¥å£
&lt;/h2>
&lt;h3 id="æ§åˆ¶é¢">
&lt;a href="#%e6%8e%a7%e5%88%b6%e9%9d%a2" class="header-anchor">#&lt;/a>
æ§åˆ¶é¢
&lt;/h3>
&lt;p>è¿˜æ˜¯è€å››æ ·â€”â€”â€œå¢ã€åˆ ã€æ”¹ã€æŸ¥â€ï¼š&lt;/p>
&lt;ul>
&lt;li>åˆ›å»ºâ€”â€”Create SRQ&lt;/li>
&lt;/ul>
&lt;p>åˆ›å»º SRQ çš„æ—¶å€™ï¼Œè·Ÿ QP ä¸€æ ·ä¼šç”³è¯·æ‰€æœ‰ SRQ ç›¸å…³çš„è½¯ç¡¬ä»¶èµ„æºï¼Œæ¯”å¦‚é©±åŠ¨ç¨‹åºä¼šç”³è¯· SRQNï¼Œç”³è¯· SRQC çš„ç©ºé—´å¹¶å‘å…¶ä¸­å¡«å†™é…ç½®ã€‚åˆ›å»º SRQ æ—¶è¿˜å¿…é¡»æŒ‡å®šæ¯ä¸ª SRQ çš„æ·±åº¦ï¼ˆèƒ½å­˜æ”¾å¤šå°‘ WQEï¼‰ä»¥åŠæ¯ä¸ª WQE çš„æœ€å¤§ sge æ•°é‡ã€‚&lt;/p>
&lt;ul>
&lt;li>é”€æ¯â€”â€”Destroy SRQ&lt;/li>
&lt;/ul>
&lt;p>é”€æ¯ SRQ çš„æ‰€æœ‰ç›¸å…³è½¯ç¡¬ä»¶èµ„æºã€‚&lt;/p>
&lt;ul>
&lt;li>ä¿®æ”¹â€”â€”Modify SRQ&lt;/li>
&lt;/ul>
&lt;p>é™¤äº† SRQ æ·±åº¦ç­‰å±æ€§å¤–ï¼ŒSRQ Limit çš„å€¼ä¹Ÿæ˜¯é€šè¿‡è¿™ä¸ªæ¥å£è®¾ç½®çš„ã€‚å› ä¸ºæ¯æ¬¡äº§ç”Ÿ SRQ Limit Reached äº‹ä»¶ä¹‹åï¼Œæ°´çº¿çš„å€¼éƒ½ä¼šè¢«æ¸…é›¶ï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½éœ€è¦ç”¨æˆ·è°ƒç”¨ Modify SRQ é‡æ–°è®¾ç½®æ°´çº¿ã€‚&lt;/p>
&lt;ul>
&lt;li>æŸ¥è¯¢â€”â€”Query SRQ&lt;/li>
&lt;/ul>
&lt;p>é€šå¸¸æ˜¯ç”¨æ¥æŸ¥è¯¢æ°´çº¿çš„é…ç½®çš„ã€‚&lt;/p>
&lt;h3 id="æ•°æ®é¢">
&lt;a href="#%e6%95%b0%e6%8d%ae%e9%9d%a2" class="header-anchor">#&lt;/a>
æ•°æ®é¢
&lt;/h3>
&lt;h3 id="post-srq-receive">
&lt;a href="#post-srq-receive" class="header-anchor">#&lt;/a>
Post SRQ Receive
&lt;/h3>
&lt;p>è·Ÿ Post Receive ä¸€æ ·ï¼Œå°±æ˜¯å‘ SRQ ä¸­ä¸‹å‘æ¥æ”¶ WQEï¼Œé‡Œé¢åŒ…å«äº†ä½œä¸ºæ¥æ”¶ç¼“å†²åŒºçš„å†…å­˜å—çš„ä¿¡æ¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ&lt;strong>ä¸»è¯­æ˜¯ SRQï¼Œä¸ QP æ²¡æœ‰ä»»ä½•å…³ç³»&lt;/strong>ï¼Œç°åœ¨ç”¨æˆ·æ˜¯ä¸å…³å¿ƒè¿™ä¸ª SRQ è¢«å“ªäº› QP å…³è”çš„ã€‚&lt;/p>
&lt;h2 id="srq-å’Œ-rq-çš„åŒºåˆ«">
&lt;a href="#srq-%e5%92%8c-rq-%e7%9a%84%e5%8c%ba%e5%88%ab" class="header-anchor">#&lt;/a>
SRQ å’Œ RQ çš„åŒºåˆ«
&lt;/h2>
&lt;p>ä»åŠŸèƒ½ä¸Šæ¥è¯´ï¼ŒSRQ å’Œ RQ ä¸€æ ·éƒ½æ˜¯ç”¨æ¥å‚¨å­˜æ¥æ”¶ä»»åŠ¡ä¹¦çš„ï¼Œä½†æ˜¯ç”±äº SRQ çš„å…±äº«æ€§ï¼Œæ‰€ä»¥å…¶å’Œ RQ æœ‰ä¸€äº›å·®å¼‚ã€‚&lt;/p>
&lt;h3 id="çŠ¶æ€æœº">
&lt;a href="#%e7%8a%b6%e6%80%81%e6%9c%ba" class="header-anchor">#&lt;/a>
çŠ¶æ€æœº
&lt;/h3>
&lt;p>æˆ‘ä»¬åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-queue-pair/" >ã€9. RDMA ä¹‹ Queue Pairã€‘
&lt;/a>
ä¸­ä»‹ç»è¿‡ï¼ŒQP æœ‰ç€å¤æ‚çš„çŠ¶æ€æœºï¼Œä¸åŒçš„çŠ¶æ€ä¸‹ QP çš„æ”¶å‘èƒ½åŠ›å­˜åœ¨å·®å¼‚ã€‚è€Œ SRQ åªæœ‰éé”™è¯¯å’Œé”™è¯¯ä¸¤ç§çŠ¶æ€ï¼š&lt;/p>
&lt;p>æ— è®ºæ˜¯å“ªç§çŠ¶æ€ä¸‹ï¼Œç”¨æˆ·éƒ½å¯ä»¥å‘ SRQ ä¸­ä¸‹å‘ WQEï¼Œä½†æ˜¯åœ¨é”™è¯¯çŠ¶æ€ä¸‹ï¼Œç›¸å…³è”çš„ QP ä¸èƒ½ä»è¿™ä¸ª SRQ ä¸­è·å¾—æ”¶åˆ°çš„æ•°æ®ã€‚å¦å¤–åœ¨é”™è¯¯çŠ¶æ€ä¸‹ï¼Œç”¨æˆ·ä¹Ÿæ— æ³•æŸ¥è¯¢å’Œä¿®æ”¹ SRQ çš„å±æ€§ã€‚&lt;/p>
&lt;p>QP å¤„äºé”™è¯¯çŠ¶æ€æ—¶ï¼Œå¯ä»¥é€šè¿‡ Modify QP æ¥ä½¿å…¶å›åˆ° RESET çŠ¶æ€ï¼Œä½†æ˜¯å¯¹ SRQ æ¥è¯´ï¼Œåªèƒ½é€šè¿‡é”€æ¯å®ƒæ¥é€€å‡ºé”™è¯¯çŠ¶æ€ã€‚&lt;/p>
&lt;h3 id="æ¥æ”¶æµç¨‹">
&lt;a href="#%e6%8e%a5%e6%94%b6%e6%b5%81%e7%a8%8b" class="header-anchor">#&lt;/a>
æ¥æ”¶æµç¨‹
&lt;/h3>
&lt;p>å¯¹äºä¸€ä¸ª QP æ¥è¯´ï¼ŒRQ å’Œ SRQ ä¸èƒ½åŒæ—¶ä½¿ç”¨ï¼Œä¸¤è€…éœ€é€‰å…¶ä¸€ï¼Œå¦‚æœå¯¹ä¸€ä¸ªå·²ç»å…³è” SRQ çš„ QP çš„ RQ ä¸‹å‘ WQEï¼Œé‚£ä¹ˆä¼šè¿”å›ä¸€ä¸ªç«‹å³é”™è¯¯ã€‚&lt;/p>
&lt;p>ä¸‹é¢æˆ‘ä»¬æ¥å¯¹æ¯”çœ‹ä¸€ä¸‹ SRQ å’Œ RQ çš„æ¥æ”¶æµç¨‹ã€‚æœ¬å°ç»“çš„å†…å®¹æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œç›¸ä¿¡è¯»è€…çœ‹è¿‡ä¹‹åï¼Œå°±å¯¹ SRQ çš„æœºåˆ¶æœ‰æ¯”è¾ƒå®Œæ•´çš„äº†è§£äº†ã€‚&lt;/p>
&lt;h3 id="rq-çš„æ¥æ”¶æµç¨‹">
&lt;a href="#rq-%e7%9a%84%e6%8e%a5%e6%94%b6%e6%b5%81%e7%a8%8b" class="header-anchor">#&lt;/a>
RQ çš„æ¥æ”¶æµç¨‹
&lt;/h3>
&lt;p>é¦–å…ˆï¼Œæˆ‘ä»¬é‡æ¸©ä¸€ä¸‹æ™®é€š RQ çš„æ¥æ”¶æµç¨‹ï¼ˆç»“åˆå‘é€ç«¯çš„å®Œæ•´æµç¨‹è¯·é˜…è¯» &lt;a class="link" href="https://cuterwrite.top/p/rdma-op/" >ã€4. RDMA æ“ä½œç±»å‹ã€‘
&lt;/a>
ï¼‰ä¸€æ–‡ï¼‰ï¼š&lt;/p>
&lt;ol start="0">
&lt;li>
&lt;p>åˆ›å»º QPã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é€šè¿‡ Post Recv æ¥å£ï¼Œç”¨æˆ·åˆ†åˆ«å‘ QP2 å’Œ QP3 çš„ RQ ä¸‹å‘æ¥æ”¶ WQEï¼ŒWQE ä¸­åŒ…å«æ¥æ”¶åˆ°æ•°æ®åæ”¾åˆ°å“ªå—å†…å­˜åŒºåŸŸçš„ä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶æ”¶åˆ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç°æ˜¯å‘ç»™ QP3 çš„ï¼Œé‚£ä¹ˆä» QP3 çš„ RQ ä¸­å–å‡º WQE1ï¼Œå°†æ¥æ”¶åˆ°çš„æ•°æ®æ”¾åˆ° WQE1 æŒ‡å®šçš„å†…å­˜åŒºåŸŸã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å®Œæˆæ•°æ®å­˜æ”¾åï¼Œå‘ QP3 çš„ RQ å…³è”çš„ CQ3 äº§ç”Ÿä¸€ä¸ª CQEï¼Œä¸ŠæŠ¥ä»»åŠ¡å®Œæˆä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”¨æˆ·ä» CQ3 ä¸­å–å‡º WCï¼ˆCQEï¼‰ï¼Œç„¶åä»æŒ‡å®šå†…å­˜åŒºåŸŸå–èµ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶æ”¶åˆ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç°æ˜¯å‘é€ç»™ QP2 çš„ï¼Œé‚£ä¹ˆä» QP2 çš„ RQ ä¸­å–å‡º WQE1ï¼Œå°†æ¥æ”¶åˆ°çš„æ•°æ®æ”¾åˆ° WQE1 æŒ‡å®šçš„å†…å­˜åŒºåŸŸã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å®Œæˆæ•°æ®å­˜æ”¾åï¼Œå‘ QP2 çš„ RQ å…³è”çš„ CQ2 äº§ç”Ÿä¸€ä¸ª CQEï¼Œä¸ŠæŠ¥ä»»åŠ¡å®Œæˆä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”¨æˆ·ä» CQ2 ä¸­å–å‡º WCï¼ˆCQEï¼‰ï¼Œç„¶åä»æŒ‡å®šå†…å­˜åŒºåŸŸå–èµ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_11_4.webp"
alt="2024-06-28_11_4" width="90%" loading="lazy">
&lt;/figure>
&lt;h3 id="srq-çš„æ¥æ”¶æµç¨‹">
&lt;a href="#srq-%e7%9a%84%e6%8e%a5%e6%94%b6%e6%b5%81%e7%a8%8b" class="header-anchor">#&lt;/a>
SRQ çš„æ¥æ”¶æµç¨‹
&lt;/h3>
&lt;p>è€Œ SRQ çš„æ¥æ”¶æµç¨‹æœ‰ä¸€äº›åŒºåˆ«ï¼š&lt;/p>
&lt;ol start="0">
&lt;li>
&lt;p>åˆ›å»º SRQ1ï¼Œå¹¶åˆ›å»º QP2 å’Œ QP3ï¼Œéƒ½å…³è”åˆ° SRQ1 ä¸Šã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é€šè¿‡ Post SRQ Recv æ¥å£ï¼Œç”¨æˆ·å‘ SRQ1 ä¸­ä¸‹å‘ä¸¤ä¸ªæ¥æ”¶ WQEï¼ŒWQE ä¸­åŒ…å«æ¥æ”¶åˆ°æ•°æ®åæ”¾åˆ°å“ªå—å†…å­˜åŒºåŸŸçš„ä¿¡æ¯ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶æ”¶åˆ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç°æ˜¯å‘ç»™ QP3 çš„ï¼Œä» SRQ1 ä¸­å–å‡ºç¬¬ä¸€ä¸ª WQEï¼ˆç°åœ¨æ˜¯ WQE1ï¼‰ï¼Œæ ¹æ® WQE å†…å®¹å­˜æ”¾æ”¶åˆ°çš„æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>SRQ ä¸­çš„æ¯ä¸ª WQE æ˜¯â€œæ— ä¸»çš„â€œï¼Œä¸å…³è”åˆ°ä»»ä½•ä¸€ä¸ª QPï¼Œç¡¬ä»¶æŒ‰é˜Ÿåˆ—é¡ºåºä¾æ¬¡å–å‡º WQE å°±æŠŠæ•°æ®æ”¾åˆ°é‡Œé¢äº†ã€‚&lt;/p>
&lt;/blockquote>
&lt;ol start="4">
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç° QP3 çš„ RQ å…³è”çš„ CQ æ˜¯ CQ3ï¼Œæ‰€ä»¥å‘å…¶ä¸­äº§ç”Ÿä¸€ä¸ª CQEã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”¨æˆ·ä» CQ3 ä¸­å–å‡º CQEï¼Œä»æŒ‡å®šå†…å­˜åŒºåŸŸå–èµ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;blockquote>
&lt;p>ç»†å¿ƒåœ°è¯»è€…å¯èƒ½ä¼šé—®ï¼Œç”¨æˆ·ä¸‹å‘ WR æ—¶ï¼Œæ¯ä¸ª WR éƒ½æŒ‡å®šäº†ä¸€äº›æœªæ¥ç”¨æ¥å­˜æ”¾æ•°æ®çš„å†…å­˜åŒºåŸŸã€‚ä½†æ˜¯ SRQ æ˜¯ä¸€ä¸ªæ± å­ï¼Œé‡Œé¢æ¯ä¸ª WQE éƒ½æŒ‡å‘äº†ä¸åŒçš„è‹¥å¹²æ®µå†…å­˜åŒºåŸŸã€‚ç”¨æˆ·æ”¶åˆ°æŸä¸ª QP å¯¹åº”çš„ CQ ä¸­çš„ WC åå¦‚ä½•çŸ¥é“æ¥æ”¶åˆ°çš„æ•°æ®å­˜æ”¾åˆ°å“ªé‡Œäº†å‘¢ï¼Ÿ&lt;/p>
&lt;p>WC ä¸­å…¶å®æœ‰ wr_id ä¿¡æ¯ï¼Œå‘ŠçŸ¥ç”¨æˆ·æ•°æ®æ”¾åˆ°å“ªä¸ª WRï¼ˆWQEï¼‰æŒ‡å®šçš„å†…å­˜åŒºåŸŸäº†ï¼Œæ—¢ç„¶ WR æ˜¯ç”¨æˆ·ä¸‹å‘çš„ï¼Œç”¨æˆ·è‡ªç„¶çŸ¥é“å…¶æŒ‡å‘çš„å…·ä½“ä½ç½®ã€‚&lt;/p>
&lt;/blockquote>
&lt;ol start="6">
&lt;li>
&lt;p>ç¡¬ä»¶æ”¶åˆ°æ•°æ®&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç°æ˜¯å‘ç»™ QP2 çš„ï¼Œä» SRQ1 ä¸­å–å‡ºç¬¬ä¸€ä¸ª WQEï¼ˆç°åœ¨æ˜¯ WQE2ï¼‰ï¼Œæ ¹æ® WQE å†…å®¹å­˜æ”¾æ”¶åˆ°çš„æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç¡¬ä»¶å‘ç° QP2 çš„ RQ å…³è”çš„ CQ æ˜¯ CQ2ï¼Œæ‰€ä»¥å‘å…¶ä¸­äº§ç”Ÿä¸€ä¸ª CQEã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç”¨æˆ·ä» CQ2 ä¸­å–å‡º CQEï¼Œä»æŒ‡å®šå†…å­˜åŒºåŸŸå–èµ°æ•°æ®ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-28_11_5.webp"
alt="2024-06-28_11_5" width="90%" loading="lazy">
&lt;/figure>
&lt;h2 id="æ€»ç»“">
&lt;a href="#%e6%80%bb%e7%bb%93" class="header-anchor">#&lt;/a>
æ€»ç»“
&lt;/h2>
&lt;p>æœ¬æ–‡é¦–å…ˆä»‹ç»äº† SRQ çš„åŸºæœ¬æ¦‚å¿µï¼Œç„¶åæ˜¯å…¶è®¾è®¡åˆè¡·ã€ç›¸å…³æœºåˆ¶å’Œç”¨æˆ·æ¥å£ï¼Œæœ€åå¯¹æ¯” RQ æè¿°äº† SRQ çš„æ¥æ”¶æµç¨‹ã€‚åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼ŒSRQ çš„ä½¿ç”¨ç‡è¿˜æ˜¯è›®é«˜çš„ï¼Œå¸Œæœ›è¯»è€…èƒ½å¤Ÿæ·±å…¥ç†è§£ã€‚&lt;/p>
&lt;p>å°±å†™åˆ°è¿™é‡Œå§ï¼Œæ„Ÿè°¢é˜…è¯»ã€‚ä¸‹ä¸€ç¯‡æˆ‘å°†ç»™å¤§å®¶ä»‹ç»ä¸‹ Memeory Windowã€‚&lt;/p>
&lt;h2 id="åè®®ç›¸å…³ç« èŠ‚">
&lt;a href="#%e5%8d%8f%e8%ae%ae%e7%9b%b8%e5%85%b3%e7%ab%a0%e8%8a%82" class="header-anchor">#&lt;/a>
åè®®ç›¸å…³ç« èŠ‚
&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>10.2.9 SRQ çš„è®¾è®¡æ€æƒ³ä»¥åŠç›¸å…³æ“ä½œ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.2.3 SRQ å’Œ QP çš„ PD&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.8.2 å…³è” SRQ çš„ QP å’Œä¸ä½¿ç”¨ SRQ çš„ QP çš„å…³ç³»&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.8.5 SRQ ç›¸å…³çš„è¿”å› WC&lt;/p>
&lt;/li>
&lt;li>
&lt;p>11.5.2.4 å¼‚æ­¥äº‹ä»¶&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="å…¶ä»–å‚è€ƒèµ„æ–™">
&lt;a href="#%e5%85%b6%e4%bb%96%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99" class="header-anchor">#&lt;/a>
å…¶ä»–å‚è€ƒèµ„æ–™
&lt;/h2>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Linux Kernel Networking - Implement and Theory. Chapter 13. Shared Receive Queue&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>RDMA ä¹‹ Completion Queue</title><link>https://cuterwrite.top/p/rdma-completion-queue/</link><pubDate>Wed, 26 Jun 2024 23:11:00 +0000</pubDate><guid>https://cuterwrite.top/p/rdma-completion-queue/</guid><description>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-16_116903369_p0_master1200.webp" alt="Featured image of post RDMA ä¹‹ Completion Queue" />&lt;h1 id="rdma-ä¹‹-completion-queue">
&lt;a href="#rdma-%e4%b9%8b-completion-queue" class="header-anchor">#&lt;/a>
RDMA ä¹‹ Completion Queue
&lt;/h1>
&lt;p>&lt;strong>æœ¬æ–‡æ¬¢è¿éå•†ä¸šè½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>å£°æ˜ï¼šä»…ç”¨äºæ”¶è—ï¼Œä¾¿äºé˜…è¯»&lt;/p>&lt;span class="cite">&lt;span>â€• &lt;/span>&lt;span>Savir, &lt;/span>&lt;a href="https://zhuanlan.zhihu.com/p/259650980">&lt;cite>çŸ¥ä¹ä¸“æ ï¼š10. RDMA ä¹‹ Completion Queue&lt;/cite>&lt;/a>&lt;/span>&lt;/blockquote>
&lt;p>æˆ‘ä»¬æ›¾ç»åœ¨å‰é¢çš„æ–‡ç« ä¸­ç®€å•ä»‹ç»è¿‡ CQï¼Œæœ¬æ–‡å°†æ›´æ·±å…¥çš„è®²è§£å…³äºå®ƒçš„ä¸€äº›ç»†èŠ‚ã€‚é˜…è¯»æœ¬æ–‡å‰ï¼Œè¯»è€…å¯ä»¥å…ˆæ¸©ä¹ ä¸€ä¸‹è¿™ç¯‡æ–‡ç« ï¼š &lt;a class="link" href="https://cuterwrite.top/p/rdma-element/" >ã€â€œ3. RDMA åŸºæœ¬å…ƒç´ â€ã€‘
&lt;/a>
ã€‚&lt;/p>
&lt;h2 id="åŸºæœ¬æ¦‚å¿µ">
&lt;a href="#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" class="header-anchor">#&lt;/a>
åŸºæœ¬æ¦‚å¿µ
&lt;/h2>
&lt;p>æˆ‘ä»¬å…ˆå›é¡¾ä¸‹ CQ çš„ä½œç”¨ã€‚CQ æ„ä¸ºå®Œæˆé˜Ÿåˆ—ï¼Œå®ƒçš„ä½œç”¨å’Œ WQï¼ˆSQ å’Œ RQï¼‰ç›¸åï¼Œç¡¬ä»¶é€šè¿‡ CQ ä¸­çš„ CQE/WC æ¥å‘Šè¯‰è½¯ä»¶æŸä¸ª WQE/WR çš„å®Œæˆæƒ…å†µã€‚å†æ¬¡æé†’è¯»è€…ï¼Œå¯¹äºä¸Šå±‚ç”¨æˆ·æ¥è¯´ä¸€èˆ¬ç”¨ WCï¼Œå¯¹äºé©±åŠ¨ç¨‹åºæ¥è¯´ï¼Œä¸€èˆ¬ç§°ä¸º CQEï¼Œæœ¬æ–‡ä¸å¯¹ä¸¤è€…è¿›è¡ŒåŒºåˆ†ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-27_10_1.webp"
alt="2024-06-27_10_1" width="80%" loading="lazy">
&lt;/figure>
&lt;p>CQE å¯ä»¥çœ‹ä½œä¸€ä»½â€œæŠ¥å‘Šâ€ï¼Œå…¶ä¸­å†™æ˜äº†æŸä¸ªä»»åŠ¡çš„æ‰§è¡Œæƒ…å†µï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š&lt;/p>
&lt;ul>
&lt;li>æœ¬æ¬¡å®Œæˆäº†å“ªä¸ª QP çš„å“ªä¸€ä¸ª WQE æŒ‡å®šçš„ä»»åŠ¡ï¼ˆQP Number å’Œ WR IDï¼‰&lt;/li>
&lt;li>æœ¬æ¬¡ä»»åŠ¡æ‰§è¡Œäº†ä»€ä¹ˆæ“ä½œï¼ˆOpcode æ“ä½œç±»å‹ï¼‰&lt;/li>
&lt;li>æœ¬æ¬¡ä»»åŠ¡æ‰§è¡ŒæˆåŠŸ/å¤±è´¥ï¼Œå¤±è´¥åŸå› æ˜¯ XXXï¼ˆStatus çŠ¶æ€å’Œé”™è¯¯ç ï¼‰&lt;/li>
&lt;li>&amp;hellip;&lt;/li>
&lt;/ul>
&lt;p>æ¯å½“ç¡¬ä»¶å¤„ç†å®Œä¸€ä¸ª WQE ä¹‹åï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ª CQE æ”¾åœ¨ CQ é˜Ÿåˆ—ä¸­ã€‚å¦‚æœä¸€ä¸ª WQE å¯¹åº”çš„ CQE æ²¡æœ‰äº§ç”Ÿï¼Œé‚£ä¹ˆè¿™ä¸ª WQE å°±ä¼šä¸€ç›´è¢«è®¤ä¸ºè¿˜æœªå¤„ç†å®Œï¼Œè¿™æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p>
&lt;ul>
&lt;li>æ¶‰åŠä»å†…å­˜ä¸­å–æ•°æ®çš„æ“ä½œï¼ˆSEND å’Œ WRITEï¼‰&lt;/li>
&lt;/ul>
&lt;p>åœ¨äº§ç”Ÿ CQE ä¹‹å‰ï¼Œç¡¬ä»¶å¯èƒ½è¿˜æœªå‘é€æ¶ˆæ¯ï¼Œå¯èƒ½æ­£åœ¨å‘é€æ¶ˆæ¯ï¼Œå¯èƒ½å¯¹ç«¯æœ‰æ¥æ”¶åˆ°æ­£ç¡®çš„æ¶ˆæ¯ã€‚ç”±äºå†…å­˜åŒºåŸŸæ˜¯åœ¨å‘é€å‰ç”³è¯·å¥½çš„ï¼Œæ‰€ä»¥ä¸Šå±‚è½¯ä»¶æ”¶åˆ°å¯¹åº”çš„ CQE ä¹‹å‰ï¼Œå…¶å¿…é¡»è®¤ä¸ºè¿™ç‰‡å†…å­˜åŒºåŸŸä»åœ¨ä½¿ç”¨ä¸­ï¼Œä¸èƒ½å°†æ‰€æœ‰ç›¸å…³çš„å†…å­˜èµ„æºè¿›è¡Œé‡Šæ”¾ã€‚&lt;/p>
&lt;ul>
&lt;li>æ¶‰åŠå‘å†…å­˜ä¸­å­˜æ”¾æ•°æ®çš„æ“ä½œï¼ˆRECV å’Œ READï¼‰&lt;/li>
&lt;/ul>
&lt;p>åœ¨äº§ç”Ÿ CQE ä¹‹å‰ï¼Œæœ‰å¯èƒ½ç¡¬ä»¶è¿˜æ²¡æœ‰å¼€å§‹å†™å…¥æ•°æ®ï¼Œæœ‰å¯èƒ½æ•°æ®æ‰å†™äº†ä¸€åŠï¼Œä¹Ÿæœ‰å¯èƒ½æ•°æ®æ ¡éªŒå‡ºé”™ã€‚æ‰€ä»¥ä¸Šå±‚è½¯ä»¶åœ¨è·å¾— CQE ä¹‹å‰ï¼Œè¿™æ®µç”¨äºå­˜æ”¾æ¥æ”¶æ•°æ®çš„å†…å­˜åŒºåŸŸä¸­çš„å†…å®¹æ˜¯ä¸å¯ä¿¡çš„ã€‚&lt;/p>
&lt;p>æ€»ä¹‹ï¼Œç”¨æˆ·å¿…é¡»è·å–åˆ° CQE å¹¶ç¡®è®¤å…¶å†…å®¹ä¹‹åæ‰èƒ½è®¤ä¸ºæ¶ˆæ¯æ”¶å‘ä»»åŠ¡å·²ç»å®Œæˆã€‚&lt;/p>
&lt;h3 id="ä½•æ—¶äº§ç”Ÿ">
&lt;a href="#%e4%bd%95%e6%97%b6%e4%ba%a7%e7%94%9f" class="header-anchor">#&lt;/a>
ä½•æ—¶äº§ç”Ÿ
&lt;/h3>
&lt;p>æˆ‘ä»¬å°†æŒ‰ç…§æœåŠ¡ç±»å‹ï¼ˆæœ¬ç¯‡åªè®² RC å’Œ UDï¼‰å’Œæ“ä½œç±»å‹æ¥åˆ†åˆ«è¯´æ˜ï¼Œå› ä¸ºä¸åŒçš„æƒ…å†µäº§ç”Ÿ CQE çš„æ—¶æœºå’Œå«ä¹‰éƒ½ä¸åŒï¼Œå»ºè®®è¯»è€…å›é¡¾ç¬¬ 4 ç¯‡&lt;a class="link" href="https://cuterwrite.top/p/rdma-op/" >ã€â€œ4. RDMA åŸºæœ¬æ“ä½œâ€ã€‘
&lt;/a>
å’Œç¬¬ 5 ç¯‡&lt;a class="link" href="https://cuterwrite.top/p/rdma-service-types/" >ã€â€œ5. RDMA åŸºæœ¬æœåŠ¡ç±»å‹â€ã€‘
&lt;/a>
ã€‚&lt;/p>
&lt;ul>
&lt;li>å¯é æœåŠ¡ç±»å‹ï¼ˆRCï¼‰&lt;/li>
&lt;/ul>
&lt;p>å‰é¢çš„æ–‡ç« è¯´è¿‡ï¼Œ&lt;strong>å¯é æ„å‘³ç€æœ¬ç«¯å…³å¿ƒå‘å‡ºçš„æ¶ˆæ¯èƒ½å¤Ÿè¢«å¯¹ç«¯å‡†ç¡®çš„æ¥æ”¶&lt;/strong>ï¼Œè¿™æ˜¯é€šè¿‡ ACKã€æ ¡éªŒå’Œé‡ä¼ ç­‰æœºåˆ¶ä¿è¯çš„ã€‚&lt;/p>
&lt;ul>
&lt;li>SEND&lt;/li>
&lt;/ul>
&lt;p>SEND æ“ä½œéœ€è¦ç¡¬ä»¶ä»å†…å­˜ä¸­è·å–æ•°æ®ï¼Œç„¶åç»„è£…æˆæ•°æ®åŒ…é€šè¿‡ç‰©ç†é“¾è·¯å‘é€åˆ°å¯¹ç«¯ã€‚å¯¹ SEND æ¥è¯´ï¼ŒClient ç«¯äº§ç”Ÿ CQE è¡¨ç¤º&lt;strong>å¯¹ç«¯å·²å‡†ç¡®æ— è¯¯çš„æ”¶åˆ°æ•°æ®&lt;/strong>ï¼Œå¯¹ç«¯ç¡¬ä»¶æ”¶åˆ°æ•°æ®å¹¶æ ¡éªŒä¹‹åï¼Œä¼šå›å¤ ACK åŒ…ç»™å‘é€æ–¹ã€‚å‘é€æ–¹æ”¶åˆ°è¿™ ACK ä¹‹åæ‰ä¼šäº§ç”Ÿ CQEï¼Œä»è€Œå‘Šè¯‰ç”¨æˆ·è¿™ä¸ªä»»åŠ¡æˆåŠŸæ‰§è¡Œäº†ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œå·¦ä¾§ Client ç«¯åœ¨çº¢ç‚¹çš„ä½ç½®äº§ç”Ÿäº†æœ¬æ¬¡ä»»åŠ¡çš„ CQEã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-27_10_2.webp"
alt="2024-06-27_10_2" width="50%" loading="lazy">
&lt;/figure>
&lt;ul>
&lt;li>RECV&lt;/li>
&lt;/ul>
&lt;p>RECV æ“ä½œéœ€è¦ç¡¬ä»¶å°†æ”¶åˆ°çš„æ•°æ®æ”¾åˆ°ç”¨æˆ· WQE ä¸­æŒ‡å®šçš„å†…å­˜åŒºåŸŸï¼Œå®Œæˆæ ¡éªŒå’Œæ•°æ®å­˜æ”¾åŠ¨ä½œåï¼Œç¡¬ä»¶å°±ä¼šäº§ç”Ÿ CQEã€‚å¦‚ä¸Šå›¾å³ä¾§ Server ç«¯æ‰€ç¤ºã€‚&lt;/p>
&lt;ul>
&lt;li>WRITE&lt;/li>
&lt;/ul>
&lt;p>å¯¹äº Client ç«¯æ¥è¯´ï¼ŒWRITE æ“ä½œå’Œ SEND æ“ä½œæ˜¯ä¸€æ ·çš„ï¼Œç¡¬ä»¶ä¼šä»å†…å­˜ä¸­å–å‡ºæ•°æ®ï¼Œå¹¶ç­‰å¾…å¯¹ç«¯å›å¤ ACK åï¼Œæ‰ä¼šäº§ç”Ÿ CQEã€‚å·®åˆ«åœ¨äºï¼Œå› ä¸º WRITE æ˜¯ RDMA æ“ä½œï¼Œå¯¹ç«¯ CPU ä¸æ„ŸçŸ¥ï¼Œè‡ªç„¶ç”¨æˆ·ä¹Ÿä¸æ„ŸçŸ¥ï¼Œæ‰€ä»¥ä¸Šé¢çš„å›¾å˜æˆäº†è¿™æ ·ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-27_10_3.webp"
alt="2024-06-27_10_3" width="50%" loading="lazy">
&lt;/figure>
&lt;ul>
&lt;li>READ&lt;/li>
&lt;/ul>
&lt;p>READ å’Œ RECV æœ‰ç‚¹åƒï¼ŒClient ç«¯å‘èµ· READ æ“ä½œåï¼Œå¯¹ç«¯ä¼šå›å¤æˆ‘ä»¬æƒ³è¯»å–çš„æ•°æ®ï¼Œç„¶åæœ¬ç«¯æ ¡éªŒæ²¡é—®é¢˜åï¼Œä¼šæŠŠæ•°æ®æ”¾åˆ° WQE ä¸­æŒ‡å®šçš„ä½ç½®ã€‚å®Œæˆä¸Šè¿°åŠ¨ä½œåï¼Œæœ¬ç«¯ä¼šäº§ç”Ÿ CQEã€‚READ åŒæ ·æ˜¯ RDMA æ“ä½œï¼Œå¯¹ç«¯ç”¨æˆ·ä¸æ„ŸçŸ¥ï¼Œè‡ªç„¶ä¹Ÿæ²¡æœ‰ CQE äº§ç”Ÿã€‚è¿™ç§æƒ…å†µä¸Šå›¾å˜æˆäº†è¿™æ ·ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-27_10_4.webp"
alt="2024-06-27_10_4" width="50%" loading="lazy">
&lt;/figure>
&lt;ul>
&lt;li>ä¸å¯é æœåŠ¡ç±»å‹ï¼ˆUDï¼‰&lt;/li>
&lt;/ul>
&lt;p>å› ä¸ºä¸å¯é çš„æœåŠ¡ç±»å‹æ²¡æœ‰é‡ä¼ å’Œç¡®è®¤æœºåˆ¶ï¼Œæ‰€ä»¥äº§ç”Ÿ CQE è¡¨ç¤ºç¡¬ä»¶&lt;strong>å·²ç»å°†å¯¹åº” WQE æŒ‡å®šçš„æ•°æ®å‘é€å‡ºå»äº†&lt;/strong>ã€‚ä»¥å‰è¯´è¿‡ UD åªæ”¯æŒ SEND-RECV æ“ä½œï¼Œä¸æ”¯æŒ RDMA æ“ä½œã€‚æ‰€ä»¥å¯¹äº UD æœåŠ¡çš„ä¸¤ç«¯ï¼ŒCQE äº§ç”Ÿæ—¶æœºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-27_10_5.webp"
alt="2024-06-27_10_5" width="50%" loading="lazy">
&lt;/figure>
&lt;h3 id="wq-å’Œ-cq-çš„å¯¹åº”å…³ç³»">
&lt;a href="#wq-%e5%92%8c-cq-%e7%9a%84%e5%af%b9%e5%ba%94%e5%85%b3%e7%b3%bb" class="header-anchor">#&lt;/a>
WQ å’Œ CQ çš„å¯¹åº”å…³ç³»
&lt;/h3>
&lt;p>&lt;strong>æ¯ä¸ª WQ éƒ½å¿…é¡»å…³è”ä¸€ä¸ª CQï¼Œè€Œæ¯ä¸ª CQ å¯ä»¥å…³è”å¤šä¸ª SQ å’Œ RQã€‚&lt;/strong>&lt;/p>
&lt;p>è¿™é‡Œçš„æ‰€è°“â€œå…³è”â€ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ª WQ çš„æ‰€æœ‰ WQE å¯¹åº”çš„ CQEï¼Œéƒ½ä¼šè¢«ç¡¬ä»¶æ”¾åˆ°ç»‘å®šçš„ CQ ä¸­ï¼Œéœ€è¦æ³¨æ„åŒå±äºä¸€ä¸ª QP çš„ SQ å’Œ RQ å¯ä»¥å„è‡ªå…³è”ä¸åŒçš„ CQã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒQP1 çš„ SQ å’Œ RQ éƒ½å…³è”äº† CQ1ï¼ŒQP2 çš„ RQ å…³è”åˆ°äº† CQ1ã€SQ å…³è”åˆ°äº† CQ2ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-27_10_6.webp"
alt="2024-06-27_10_6" width="auto" loading="lazy">
&lt;/figure>
&lt;p>å› ä¸ºæ¯ä¸ª WQ å¿…é¡»å…³è”ä¸€ä¸ª CQï¼Œæ‰€ä»¥ç”¨æˆ·åˆ›å»º QP å‰éœ€è¦æå‰åˆ›å»ºå¥½ CQï¼Œç„¶ååˆ†åˆ«æŒ‡å®š SQ å’Œ RQ å°†ä¼šä½¿ç”¨çš„ CQã€‚&lt;/p>
&lt;p>&lt;strong>åŒä¸€ä¸ª WQ ä¸­çš„ WQEï¼Œå…¶å¯¹åº”çš„ CQE é—´æ˜¯ä¿åºçš„&lt;/strong>&lt;/p>
&lt;p>ç¡¬ä»¶æ˜¯æŒ‰ç…§â€œå…ˆè¿›å…ˆå‡ºâ€çš„ FIFO é¡ºåºä»æŸä¸€ä¸ª WQï¼ˆSQ æˆ–è€… RQï¼‰ä¸­å–å‡º WQE å¹¶è¿›è¡Œå¤„ç†çš„ï¼Œè€Œå‘ WR å…³è”çš„ CQ ä¸­å­˜æ”¾ CQE æ—¶ï¼Œä¹Ÿæ˜¯éµä»è¿™äº› WQE è¢«æ”¾åˆ° WQ ä¸­çš„é¡ºåºçš„ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è°å…ˆè¢«æ”¾åˆ°é˜Ÿåˆ—é‡Œï¼Œè°å°±å…ˆè¢«å®Œæˆã€‚è¯¥è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-27_10_7.webp"
alt="2024-06-27_10_7" width="auto" loading="lazy">
&lt;/figure>
&lt;p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ SRQ çš„æƒ…å†µä»¥åŠ RD æœåŠ¡ç±»å‹çš„ RQ è¿™ä¸¤ç§æƒ…å†µæ˜¯ä¸ä¿åºçš„ï¼Œæœ¬æ–‡ä¸­ä¸å±•å¼€è®¨è®ºã€‚&lt;/p>
&lt;p>&lt;strong>ä¸åŒ WQ ä¸­çš„ WQEï¼Œå…¶å¯¹åº”çš„ CQE é—´æ˜¯ä¸ä¿åºçš„&lt;/strong>&lt;/p>
&lt;p>å‰æ–‡ä¸­æˆ‘ä»¬è¯´è¿‡ï¼Œä¸€ä¸ª CQ å¯èƒ½ä¼šè¢«å¤šä¸ª WQ å…±äº«ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ˜¯ä¸èƒ½ä¿è¯è¿™äº› WQE å¯¹åº”çš„ CQE çš„äº§ç”Ÿé¡ºåºçš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆWQE ç¼–å·è¡¨ç¤ºä¸‹å‘çš„æ¬¡åºï¼Œå³ 1 æœ€å…ˆè¢«ä¸‹å‘ï¼Œ6 æœ€åè¢«ä¸‹å‘ï¼‰ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-27_10_8.webp"
alt="2024-06-27_10_8" width="auto" loading="lazy">
&lt;/figure>
&lt;p>ä¸Šé¢çš„æè¿°å…¶å®è¿˜åŒ…å«äº†â€œåŒä¸€ä¸ª QP çš„ SQ å’Œ RQ ä¸­çš„ WQEï¼Œå…¶å¯¹åº”çš„ CQE é—´æ˜¯ä¸ä¿åºçš„â€çš„æƒ…å†µï¼Œè¿™ä¸€ç‚¹å…¶å®æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼ŒSQ å’Œ RQï¼Œä¸€ä¸ªè´Ÿè´£ä¸»åŠ¨å‘èµ·çš„ä»»åŠ¡ï¼Œä¸€ä¸ªè´Ÿè´£è¢«åŠ¨æ¥æ”¶çš„ä»»åŠ¡ï¼Œå®ƒä»¬æœ¬æ¥å°±å¯ä»¥æ˜¯è®¤ä¸ºæ˜¯ä¸¤æ¡ä¸åŒæ–¹å‘çš„é€šé“ï¼Œè‡ªç„¶ä¸åº”è¯¥ç›¸äº’å½±å“ã€‚å‡è®¾ç”¨æˆ·å¯¹åŒä¸€ä¸ª QP å…ˆä¸‹å‘äº†ä¸€ä¸ª Receive WQEï¼Œåˆä¸‹å‘ä¸€ä¸ª Send WQEï¼Œæ€»ä¸èƒ½å¯¹ç«¯ä¸ç»™æœ¬ç«¯å‘é€æ¶ˆæ¯ï¼Œæœ¬ç«¯å°±ä¸èƒ½å‘é€æ¶ˆæ¯ç»™å¯¹ç«¯äº†å§ï¼Ÿ&lt;/p>
&lt;p>æ—¢ç„¶è¿™ç§æƒ…å†µä¸‹ CQE äº§ç”Ÿçš„é¡ºåºå’Œè·å– WQE çš„é¡ºåºæ˜¯ä¸ç›¸å…³çš„ï¼Œé‚£ä¹ˆä¸Šå±‚åº”ç”¨å’Œé©±åŠ¨æ˜¯å¦‚ä½•çŸ¥é“æ”¶åˆ°çš„ CQE å…³è”çš„æ˜¯å“ªä¸ª WQE å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œ&lt;strong>CQE ä¸­æŒ‡æ˜å®ƒæ‰€å¯¹åº”çš„ WQE çš„ç¼–å·&lt;/strong>å°±å¯ä»¥äº†ã€‚&lt;/p>
&lt;p>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿åœ¨å¤šä¸ª WQ å…±ç”¨ä¸€ä¸ª CQ çš„æƒ…å†µä¸‹ï¼Œâ€œåŒä¸€ä¸ª WQ ä¸­çš„ WQEï¼Œå…¶å¯¹åº”çš„ CQE é—´æ˜¯ä¿åºçš„â€è¿™ä¸€ç‚¹ä¹Ÿæ˜¯ä¸€å®šèƒ½å¤Ÿä¿è¯çš„ï¼Œå³ä¸Šå›¾ä¸­çš„å±äº WQ1 çš„ WQE 1ã€3ã€4 å¯¹åº”çš„ CQE ä¸€å®šæ˜¯æŒ‰ç…§é¡ºåºäº§ç”Ÿçš„ï¼Œå¯¹äºå±äº WQ2 çš„ WQE 2ã€5ã€6 ä¹Ÿæ˜¯å¦‚æ­¤ã€‚&lt;/p>
&lt;h3 id="cqc">
&lt;a href="#cqc" class="header-anchor">#&lt;/a>
CQC
&lt;/h3>
&lt;p>åŒ QP ä¸€æ ·ï¼ŒCQ åªæ˜¯ä¸€æ®µå­˜æ”¾ CQE çš„é˜Ÿåˆ—å†…å­˜ç©ºé—´ã€‚ç¡¬ä»¶é™¤äº†çŸ¥é“é¦–åœ°å€ä»¥å¤–ï¼Œå¯¹äºè¿™ç‰‡åŒºåŸŸå¯ä»¥è¯´æ˜¯ä¸€æ— æ‰€çŸ¥ã€‚æ‰€ä»¥éœ€è¦æå‰è·Ÿè½¯ä»¶çº¦å®šå¥½æ ¼å¼ï¼Œç„¶åé©±åŠ¨å°†ç”³è¯·å†…å­˜ï¼Œå¹¶æŒ‰ç…§æ ¼å¼æŠŠ CQ çš„åŸºæœ¬ä¿¡æ¯å¡«å†™åˆ°è¿™ç‰‡å†…å­˜ä¸­ä¾›ç¡¬ä»¶è¯»å–ï¼Œè¿™ç‰‡å†…å­˜å°±æ˜¯ CQCã€‚CQC ä¸­åŒ…å«äº† CQ çš„å®¹é‡å¤§å°ï¼Œå½“å‰å¤„ç†çš„ CQE çš„åºå·ç­‰ç­‰ä¿¡æ¯ã€‚æ‰€ä»¥æŠŠ QPC çš„å›¾ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼Œå°±èƒ½è¡¨ç¤ºå‡º CQC å’Œ CQ çš„å…³ç³»ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-27_10_9.webp"
alt="2024-06-27_10_9" width="auto" loading="lazy">
&lt;/figure>
&lt;h3 id="cqn">
&lt;a href="#cqn" class="header-anchor">#&lt;/a>
CQN
&lt;/h3>
&lt;p>CQ Numberï¼Œå°±æ˜¯ CQ çš„ç¼–å·ï¼Œç”¨æ¥åŒºåˆ«ä¸åŒçš„ CQã€‚CQ æ²¡æœ‰åƒ QP0 å’Œ QP1 ä¸€æ ·çš„ç‰¹æ®Šä¿ç•™ç¼–å·ï¼Œæœ¬æ–‡ä¸­ä¸å†èµ˜è¿°äº†ã€‚&lt;/p>
&lt;h2 id="å®Œæˆé”™è¯¯">
&lt;a href="#%e5%ae%8c%e6%88%90%e9%94%99%e8%af%af" class="header-anchor">#&lt;/a>
å®Œæˆé”™è¯¯
&lt;/h2>
&lt;p>IB åè®®ä¸­æœ‰ä¸‰ç§é”™è¯¯ç±»å‹ï¼Œç«‹å³é”™è¯¯ï¼ˆimmediate errorï¼‰ã€å®Œæˆé”™è¯¯ï¼ˆCompletion Errorï¼‰ä»¥åŠå¼‚æ­¥é”™è¯¯ï¼ˆAsynchronous Errors)ã€‚&lt;/p>
&lt;p>ç«‹å³é”™è¯¯çš„æ˜¯â€œç«‹å³åœæ­¢å½“å‰æ“ä½œï¼Œå¹¶è¿”å›é”™è¯¯ç»™ä¸Šå±‚ç”¨æˆ·â€ï¼›å®Œæˆé”™è¯¯æŒ‡çš„æ˜¯â€œé€šè¿‡ CQE å°†é”™è¯¯ä¿¡æ¯è¿”å›ç»™ä¸Šå±‚ç”¨æˆ·â€ï¼›è€Œå¼‚æ­¥é”™è¯¯æŒ‡çš„æ˜¯â€œé€šè¿‡ä¸­æ–­äº‹ä»¶çš„æ–¹å¼ä¸ŠæŠ¥ç»™ä¸Šå±‚ç”¨æˆ·â€ã€‚å¯èƒ½è¿˜æ˜¯æœ‰ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­è¯´æ˜è¿™ä¸¤ç§é”™è¯¯éƒ½ä¼šåœ¨ä»€ä¹ˆæƒ…å†µä¸‹äº§ç”Ÿï¼š&lt;/p>
&lt;ul>
&lt;li>ç”¨æˆ·åœ¨ Post Send æ—¶ä¼ å…¥äº†éæ³•çš„æ“ä½œç ï¼Œæ¯”å¦‚æƒ³åœ¨ UD çš„æ—¶å€™ä½¿ç”¨ RDMA WRITE æ“ä½œã€‚&lt;/li>
&lt;/ul>
&lt;p>ç»“æœï¼šäº§ç”Ÿç«‹å³é”™è¯¯ï¼ˆæœ‰çš„å‚å•†åœ¨è¿™ç§æƒ…å†µä¼šäº§ç”Ÿå®Œæˆé”™è¯¯ï¼‰&lt;/p>
&lt;p>ä¸€èˆ¬è¿™ç§æƒ…å†µä¸‹ï¼Œé©±åŠ¨ç¨‹åºä¼šç›´æ¥é€€å‡º post send æµç¨‹ï¼Œå¹¶è¿”å›é”™è¯¯ç ç»™ä¸Šå±‚ç”¨æˆ·ã€‚æ³¨æ„æ­¤æ—¶ WQE è¿˜æ²¡æœ‰ä¸‹å‘åˆ°ç¡¬ä»¶å°±è¿”å›äº†ã€‚&lt;/p>
&lt;ul>
&lt;li>ç”¨æˆ·ä¸‹å‘äº†ä¸€ä¸ª WQEï¼Œæ“ä½œç±»å‹ä¸º SENDï¼Œä½†æ˜¯é•¿æ—¶é—´æ²¡æœ‰å—åˆ°å¯¹æ–¹çš„ ACKã€‚&lt;/li>
&lt;/ul>
&lt;p>ç»“æœï¼šäº§ç”Ÿå®Œæˆé”™è¯¯&lt;/p>
&lt;p>å› ä¸º WQE å·²ç»åˆ°è¾¾äº†ç¡¬ä»¶ï¼Œæ‰€ä»¥ç¡¬ä»¶ä¼šäº§ç”Ÿå¯¹åº”çš„ CQEï¼ŒCQE ä¸­åŒ…å«è¶…æ—¶æœªå“åº”çš„é”™è¯¯è¯¦æƒ…ã€‚&lt;/p>
&lt;ul>
&lt;li>ç”¨æˆ·æ€ä¸‹å‘äº†å¤šä¸ª WQEï¼Œæ‰€ä»¥ç¡¬ä»¶ä¼šäº§ç”Ÿå¤šä¸ª CQEï¼Œä½†æ˜¯è½¯ä»¶ä¸€ç›´æ²¡æœ‰ä» CQ ä¸­å–èµ° CQEï¼Œå¯¼è‡´ CQ æº¢å‡ºã€‚
ç»“æœï¼šäº§ç”Ÿå¼‚æ­¥é”™è¯¯&lt;/li>
&lt;/ul>
&lt;p>å› ä¸ºè½¯ä»¶ä¸€ç›´æ²¡å– CQEï¼Œæ‰€ä»¥è‡ªç„¶ä¸ä¼šä» CQE ä¸­å¾—åˆ°ä¿¡æ¯ã€‚æ­¤æ—¶ IB æ¡†æ¶ä¼šè°ƒç”¨è½¯ä»¶æ³¨å†Œçš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œæ¥é€šçŸ¥ç”¨æˆ·å¤„ç†å½“å‰çš„é”™è¯¯ã€‚&lt;/p>
&lt;p>ç”±æ­¤å¯è§ï¼Œå®ƒä»¬éƒ½æ˜¯åº•å±‚å‘ä¸Šå±‚ç”¨æˆ·æŠ¥å‘Šé”™è¯¯çš„æ–¹å¼ï¼Œåªæ˜¯äº§ç”Ÿçš„æ—¶æœºä¸ä¸€æ ·è€Œå·²ã€‚IB åè®®ä¸­å¯¹ä¸åŒæƒ…å†µçš„é”™è¯¯åº”è¯¥ä»¥å“ªç§æ–¹å¼ä¸ŠæŠ¥åšäº†è§„å®šï¼Œæ¯”å¦‚ä¸‹å›¾ä¸­ï¼Œå¯¹äº Modify QP è¿‡ç¨‹ä¸­ä¿®æ”¹éæ³•çš„å‚æ•°ï¼Œåº”è¯¥è¿”å›ç«‹å³é”™è¯¯ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-27_10_10.webp"
alt="2024-06-27_10_10" width="auto" loading="lazy">
&lt;/figure>
&lt;p>æœ¬æ–‡çš„é‡ç‚¹åœ¨äº CQï¼Œæ‰€ä»¥ä»‹ç»å®Œé”™è¯¯ç±»å‹ä¹‹åï¼Œæˆ‘ä»¬ç€é‡æ¥çœ‹ä¸€ä¸‹å®Œæˆé”™è¯¯ã€‚å®Œæˆé”™è¯¯æ˜¯ç¡¬ä»¶é€šè¿‡åœ¨ CQE ä¸­å¡«å†™é”™è¯¯ç æ¥å®ç°ä¸ŠæŠ¥çš„ï¼Œä¸€æ¬¡é€šä¿¡è¿‡ç¨‹éœ€è¦å‘èµ·ç«¯ï¼ˆRequesterï¼‰å’Œå“åº”ç«¯ï¼ˆResponderï¼‰å‚ä¸ï¼Œå…·ä½“çš„é”™è¯¯åŸå› ä¹Ÿåˆ†ä¸ºæœ¬ç«¯å’Œå¯¹ç«¯ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹é”™è¯¯æ£€æµ‹æ˜¯åœ¨ä»€ä¹ˆé˜¶æ®µè¿›è¡Œçš„ï¼ˆä¸‹å›¾å¯¹ IB åè®®ä¸­ Figure 118 è¿›è¡Œäº†é‡ç”»ï¼‰ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-27_10_11.webp"
alt="2024-06-27_10_11" width="auto" loading="lazy">
&lt;/figure>
&lt;p>Requester çš„é”™è¯¯æ£€æµ‹ç‚¹æœ‰ä¸¤ä¸ªï¼š&lt;/p>
&lt;ol>
&lt;li>æœ¬åœ°é”™è¯¯æ£€æµ‹&lt;/li>
&lt;/ol>
&lt;p>å³å¯¹ SQ ä¸­çš„ WQE è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœæ£€æµ‹åˆ°é”™è¯¯ï¼Œå°±ä»æœ¬åœ°é”™è¯¯æ£€æŸ¥æ¨¡å—ç›´æ¥äº§ç”Ÿ CQE åˆ° CQï¼Œä¸ä¼šå‘é€æ•°æ®åˆ°å“åº”ç«¯äº†ï¼›å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œåˆ™å‘é€æ•°æ®åˆ°å¯¹ç«¯ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>è¿œç«¯é”™è¯¯æ£€æµ‹&lt;/li>
&lt;/ol>
&lt;p>å³æ£€æµ‹å“åº”ç«¯çš„ ACK æ˜¯å¦å¼‚å¸¸ï¼ŒACK/NAK æ˜¯ç”±å¯¹ç«¯çš„æœ¬åœ°é”™è¯¯æ£€æµ‹æ¨¡å—æ£€æµ‹åäº§ç”Ÿçš„ï¼Œé‡Œé¢åŒ…å«äº†å“åº”ç«¯æ˜¯å¦æœ‰é”™è¯¯ï¼Œä»¥åŠå…·ä½“çš„é”™è¯¯ç±»å‹ã€‚æ— è®ºè¿œç«¯é”™è¯¯æ£€æµ‹çš„ç»“æœæ˜¯å¦æœ‰é—®é¢˜ï¼Œéƒ½ä¼šäº§ç”Ÿ CQE åˆ° CQ ä¸­ã€‚&lt;/p>
&lt;p>Responder çš„é”™è¯¯æ£€æµ‹ç‚¹åªæœ‰ä¸€ä¸ªï¼š&lt;/p>
&lt;ol>
&lt;li>æœ¬åœ°é”™è¯¯æ£€æµ‹&lt;/li>
&lt;/ol>
&lt;p>å®é™…ä¸Šæ£€æµ‹çš„æ˜¯å¯¹ç«¯æŠ¥æ–‡æ˜¯å¦æœ‰é—®é¢˜ï¼ŒIB åè®®ä¹Ÿå°†å…¶ç§°ä¸ºâ€œæœ¬åœ°â€é”™è¯¯æ£€æµ‹ã€‚å¦‚æœæ£€æµ‹åˆ°é”™è¯¯ï¼Œåˆ™ä¼šä½“ç°åœ¨ ACK/NAK æŠ¥æ–‡ä¸­å›å¤ç»™å¯¹ç«¯ï¼Œä»¥åŠåœ¨æœ¬åœ°äº§ç”Ÿä¸€ä¸ª CQEã€‚&lt;/p>
&lt;p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°çš„äº§ç”Ÿ ACK å’Œè¿œç«¯é”™è¯¯æ£€æµ‹åªå¯¹é¢å‘è¿æ¥çš„æœåŠ¡ç±»å‹æœ‰æ•ˆï¼Œæ— è¿æ¥çš„æœåŠ¡ç±»å‹ã€‚æ¯”å¦‚ UD ç±»å‹å¹¶ä¸å…³å¿ƒå¯¹ç«¯æ˜¯å¦æ”¶åˆ°ï¼Œæ¥æ”¶ç«¯ä¹Ÿä¸ä¼šäº§ç”Ÿ ACKï¼Œæ‰€ä»¥åœ¨ Requester çš„æœ¬åœ°é”™è¯¯æ£€æµ‹ä¹‹åå°±ä¸€å®šä¼šäº§ç”Ÿ CQEï¼Œæ— è®ºæ˜¯å¦æœ‰è¿œç«¯é”™è¯¯ã€‚&lt;/p>
&lt;p>ç„¶åæˆ‘ä»¬ç®€å•ä»‹ç»ä¸‹å‡ ç§å¸¸è§çš„å®Œæˆé”™è¯¯ï¼š&lt;/p>
&lt;ul>
&lt;li>RC æœåŠ¡ç±»å‹çš„ SQ å®Œæˆé”™è¯¯&lt;/li>
&lt;li>Local Protection Error
&lt;ul>
&lt;li>æœ¬åœ°ä¿æŠ¤åŸŸé”™è¯¯ã€‚æœ¬åœ° WQE ä¸­æŒ‡å®šçš„æ•°æ®å†…å­˜åœ°å€çš„ MR ä¸åˆæ³•ï¼Œå³ç”¨æˆ·è¯•å›¾ä½¿ç”¨ä¸€ç‰‡æœªæ³¨å†Œçš„å†…å­˜ä¸­çš„æ•°æ®ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Remote Access Error
&lt;ul>
&lt;li>è¿œç«¯æƒé™é”™è¯¯ã€‚æœ¬ç«¯æ²¡æœ‰æƒé™è¯»/å†™æŒ‡å®šçš„å¯¹ç«¯å†…å­˜åœ°å€ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Transport Retry Counter Exceeded Error
&lt;ul>
&lt;li>é‡ä¼ è¶…æ¬¡é”™è¯¯ã€‚å¯¹ç«¯ä¸€ç›´æœªå›å¤æ­£ç¡®çš„ ACKï¼Œå¯¼è‡´æœ¬ç«¯å¤šæ¬¡é‡ä¼ ï¼Œè¶…è¿‡äº†é¢„è®¾çš„æ¬¡æ•°ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>RC æœåŠ¡ç±»å‹çš„ RQ å®Œæˆé”™è¯¯&lt;/li>
&lt;li>Local Access Error
&lt;ul>
&lt;li>æœ¬åœ°è®¿é—®é”™è¯¯ã€‚è¯´æ˜å¯¹ç«¯è¯•å›¾å†™å…¥å…¶æ²¡æœ‰æƒé™å†™å…¥çš„å†…å­˜åŒºåŸŸã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Local Length Error
&lt;ul>
&lt;li>æœ¬åœ°é•¿åº¦é”™è¯¯ã€‚æœ¬åœ° RQ æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥æ¥æ”¶å¯¹ç«¯å‘é€çš„æ•°æ®ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å®Œæ•´çš„å®Œæˆé”™è¯¯ç±»å‹åˆ—è¡¨è¯·å‚è€ƒ IB åè®®çš„ 10.10.3 èŠ‚ã€‚&lt;/p>
&lt;h2 id="ç”¨æˆ·æ¥å£">
&lt;a href="#%e7%94%a8%e6%88%b7%e6%8e%a5%e5%8f%a3" class="header-anchor">#&lt;/a>
ç”¨æˆ·æ¥å£
&lt;/h2>
&lt;p>åŒ QP ä¸€æ ·ï¼Œæˆ‘ä»¬ä¾ç„¶ä»é€šä¿¡å‡†å¤‡é˜¶æ®µï¼ˆæ§åˆ¶é¢ï¼‰å’Œé€šä¿¡è¿›è¡Œé˜¶æ®µï¼ˆæ•°æ®é¢ï¼‰æ¥ä»‹ç» IB åè®®å¯¹ä¸Šå±‚æä¾›çš„å…³äº CQ çš„æ¥å£ã€‚&lt;/p>
&lt;h3 id="æ§åˆ¶é¢">
&lt;a href="#%e6%8e%a7%e5%88%b6%e9%9d%a2" class="header-anchor">#&lt;/a>
æ§åˆ¶é¢
&lt;/h3>
&lt;p>åŒ QP ä¸€æ ·ï¼Œè¿˜æ˜¯â€œå¢åˆ æ”¹æŸ¥â€å››ç§ï¼Œä½†æ˜¯å¯èƒ½å› ä¸ºå¯¹äº CQ æ¥è¯´ï¼Œä¸Šå±‚ç”¨æˆ·æ˜¯èµ„æºä½¿ç”¨è€…è€Œä¸æ˜¯ç®¡ç†è€…ï¼Œåªèƒ½ä» CQ ä¸­è¯»æ•°æ®è€Œä¸èƒ½å†™æ•°æ®ï¼Œæ‰€ä»¥å¯¹ç”¨æˆ·å¼€æ”¾çš„å¯é…çš„å‚æ•°å°±åªæœ‰â€œCQ è§„æ ¼â€ä¸€ç§ã€‚&lt;/p>
&lt;ul>
&lt;li>åˆ›å»ºâ€”â€”Create CQ&lt;/li>
&lt;/ul>
&lt;p>åˆ›å»ºçš„æ—¶å€™ç”¨æˆ·å¿…é¡»æŒ‡å®š CQ çš„è§„æ ¼ï¼Œå³èƒ½å¤Ÿå‚¨å­˜å¤šå°‘ä¸ª CQEï¼Œå¦å¤–ç”¨æˆ·è¿˜å¯ä»¥å¡«å†™ä¸€ä¸ª CQE äº§ç”Ÿåçš„å›è°ƒå‡½æ•°æŒ‡é’ˆï¼ˆä¸‹æ–‡ä¼šæ¶‰åŠï¼‰ã€‚å†…æ ¸æ€é©±åŠ¨ä¼šå°†å…¶ä»–ç›¸å…³çš„å‚æ•°é…ç½®å¥½ï¼Œå¡«å†™åˆ°è·Ÿç¡¬ä»¶çº¦å®šå¥½çš„ CQC ä¸­å‘ŠçŸ¥ç¡¬ä»¶ã€‚&lt;/p>
&lt;ul>
&lt;li>é”€æ¯â€”â€”Destroy CQ&lt;/li>
&lt;/ul>
&lt;p>é‡Šæ”¾ä¸€ä¸ª CQ è½¯ç¡¬ä»¶èµ„æºï¼ŒåŒ…å« CQ æœ¬èº«åŠ CQCï¼Œå¦å¤– CQN è‡ªç„¶ä¹Ÿå°†å¤±æ•ˆã€‚&lt;/p>
&lt;ul>
&lt;li>ä¿®æ”¹â€”â€”Resize CQ&lt;/li>
&lt;/ul>
&lt;p>è¿™é‡Œåå­—ç¨å¾®æœ‰ç‚¹åŒºåˆ«ï¼Œå› ä¸º CQ åªå…è®¸ç”¨æˆ·ä¿®æ”¹è§„æ ¼å¤§å°ï¼Œæ‰€ä»¥å°±ç”¨çš„ Resize è€Œä¸æ˜¯ Modifyã€‚&lt;/p>
&lt;ul>
&lt;li>æŸ¥è¯¢â€”â€”Query CQ&lt;/li>
&lt;/ul>
&lt;p>æŸ¥è¯¢ CQ çš„å½“å‰è§„æ ¼ï¼Œä»¥åŠç”¨äºé€šçŸ¥çš„å›è°ƒå‡½æ•°æŒ‡é’ˆã€‚&lt;/p>
&lt;blockquote>
&lt;p>é€šè¿‡å¯¹æ¯” RDMA è§„èŒƒå’Œè½¯ä»¶åè®®æ ˆï¼Œå¯ä»¥å‘ç°å¾ˆå¤š verbs æ¥å£å¹¶ä¸æ˜¯æŒ‰ç…§è§„èŒƒå®ç°çš„ã€‚æ‰€ä»¥è¯»è€…å¦‚æœå‘ç°è½¯ä»¶ API å’Œåè®®æœ‰å·®å¼‚æ—¶ä¹Ÿæ— é¡»æ„Ÿåˆ°ç–‘æƒ‘ï¼ŒRDMA æŠ€æœ¯æœ¬èº«ä¸€ç›´è¿˜åœ¨æ¼”è¿›ï¼Œè½¯ä»¶æ¡†æ¶ä¹Ÿå¤„äºæ´»è·ƒæ›´æ–°çš„çŠ¶æ€ã€‚å¦‚æœæ›´å…³å¿ƒç¼–ç¨‹å®ç°ï¼Œé‚£ä¹ˆè¯·ä»¥è½¯ä»¶åè®®æ ˆçš„ API æ–‡æ¡£ä¸ºå‡†ï¼›å¦‚æœæ›´å…³å¿ƒå­¦æœ¯ä¸Šçš„ç ”ç©¶ï¼Œé‚£ä¹ˆè¯·ä»¥ RDMA è§„èŒƒä¸ºå‡†ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="æ•°æ®é¢">
&lt;a href="#%e6%95%b0%e6%8d%ae%e9%9d%a2" class="header-anchor">#&lt;/a>
æ•°æ®é¢
&lt;/h3>
&lt;p>CQE æ˜¯ç¡¬ä»¶å°†ä¿¡æ¯ä¼ é€’ç»™è½¯ä»¶çš„åª’ä»‹ï¼Œè™½ç„¶è½¯ä»¶çŸ¥é“åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šäº§ç”Ÿ CQEï¼Œä½†æ˜¯è½¯ä»¶å¹¶ä¸çŸ¥é“å…·ä½“ä»€ä¹ˆæ—¶å€™ç¡¬ä»¶ä¼šæŠŠ CQE æ”¾åˆ° CQ ä¸­ã€‚åœ¨é€šä¿¡å’Œè®¡ç®—æœºé¢†åŸŸï¼Œæˆ‘ä»¬æŠŠè¿™ç§æ¥æ”¶æ–¹ä¸çŸ¥é“å‘é€æ–¹ä»€ä¹ˆæ—¶å€™å‘é€çš„æ¨¡å¼ç§°ä¸ºâ€œå¼‚æ­¥â€ã€‚æˆ‘ä»¬å…ˆæ¥ä¸¾ä¸€ä¸ªç½‘å¡çš„ä¾‹å­ï¼Œå†æ¥è¯´æ˜ç”¨æˆ·å¦‚ä½•é€šè¿‡æ•°æ®é¢æ¥å£è·å– CQEï¼ˆWCï¼‰ã€‚&lt;/p>
&lt;p>ç½‘å¡æ”¶åˆ°æ•°æ®åŒ…åå¦‚ä½•è®© CPU çŸ¥é“è¿™ä»¶äº‹ï¼Œå¹¶è¿›è¡Œæ•°æ®åŒ…å¤„ç†ï¼Œæœ‰ä¸¤ç§å¸¸è§çš„æ¨¡å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸­æ–­æ¨¡å¼&lt;/li>
&lt;/ul>
&lt;p>å½“æ•°æ®é‡è¾ƒå°‘ï¼Œæˆ–è€…è¯´å¶å‘çš„æ•°æ®äº¤æ¢è¾ƒå¤šæ—¶ï¼Œé€‚åˆé‡‡ç”¨ä¸­æ–­æ¨¡å¼â€”â€”å³ CPU å¹³å¸¸åœ¨åšå…¶ä»–äº‹æƒ…ï¼Œå½“ç½‘å¡æ”¶åˆ°æ•°æ®åŒ…æ—¶ï¼Œä¼šä¸ŠæŠ¥ä¸­æ–­æ‰“æ–­ CPU å½“å‰çš„ä»»åŠ¡ï¼ŒCPU è½¬è€Œæ¥å¤„ç†æ•°æ®åŒ…ï¼ˆæ¯”å¦‚ TCP/IP åè®®æ ˆçš„å„å±‚è§£æï¼‰ã€‚å¤„ç†å®Œæ•°æ®ä¹‹åï¼ŒCPU è·³å›åˆ°ä¸­æ–­å‰çš„ä»»åŠ¡ç»§ç»­æ‰§è¡Œã€‚&lt;/p>
&lt;p>æ¯æ¬¡ä¸­æ–­éƒ½éœ€è¦ä¿æŠ¤ç°åœºï¼Œä¹Ÿå°±æ˜¯æŠŠå½“å‰å„ä¸ªå¯„å­˜å™¨çš„å€¼ã€å±€éƒ¨å˜é‡çš„å€¼ç­‰ç­‰ä¿å­˜åˆ°æ ˆä¸­ï¼Œå›æ¥ä¹‹åå†æ¢å¤ç°åœºï¼ˆå‡ºæ ˆï¼‰ï¼Œè¿™æœ¬èº«æ˜¯æœ‰å¼€é”€çš„ã€‚å¦‚æœä¸šåŠ¡è´Ÿè½½è¾ƒé‡ï¼Œç½‘å¡ä¸€ç›´éƒ½åœ¨æ¥æ”¶æ•°æ®åŒ…ï¼Œé‚£ä¹ˆ CPU å°±ä¼šä¸€ç›´æ”¶åˆ°ä¸­æ–­ï¼ŒCPU å°†ä¸€ç›´å¿™äºä¸­æ–­åˆ‡æ¢ï¼Œå¯¼è‡´å…¶ä»–ä»»åŠ¡å¾—ä¸åˆ°è°ƒåº¦ã€‚&lt;/p>
&lt;ul>
&lt;li>è½®è¯¢æ¨¡å¼&lt;/li>
&lt;/ul>
&lt;p>æ‰€ä»¥é™¤äº†ä¸­æ–­æ¨¡å¼ä¹‹å¤–ï¼Œç½‘å¡è¿˜æœ‰ä¸€ç§è½®è¯¢æ¨¡å¼ï¼Œå³æ”¶åˆ°æ•°æ®åŒ…åéƒ½å…ˆæ”¾åˆ°ç¼“å†²åŒºé‡Œï¼ŒCPU æ¯éš”ä¸€æ®µæ—¶é—´ä¼šå»æ£€æŸ¥ç½‘å¡æ˜¯å¦å—åˆ°æ•°æ®ã€‚å¦‚æœæœ‰æ•°æ®ï¼Œå°±æŠŠç¼“å†²åŒºé‡Œçš„æ•°æ®ä¸€æ³¢å¸¦èµ°è¿›è¡Œå¤„ç†ï¼Œæ²¡æœ‰çš„è¯å°±æ¥ç€å¤„ç†åˆ«çš„ä»»åŠ¡ã€‚&lt;/p>
&lt;p>é€šè¿‡å¯¹æ¯”ä¸­æ–­æ¨¡å¼æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè½®è¯¢æ¨¡å¼è™½ç„¶æ¯éš”ä¸€æ®µæ—¶é—´éœ€è¦ CPU æ£€æŸ¥ä¸€æ¬¡ï¼Œå¸¦æ¥äº†ä¸€å®šçš„å¼€é”€ï¼Œä½†æ˜¯å½“ä¸šåŠ¡ç¹å¿™çš„æ—¶å€™é‡‡ç”¨è½®è¯¢æ¨¡å¼èƒ½å¤Ÿæå¤§çš„å‡å°‘ä¸­æ–­ä¸Šä¸‹æ–‡çš„åˆ‡æ¢æ¬¡æ•°ï¼Œåè€Œå‡è½»äº† CPU çš„è´Ÿæ‹…ã€‚&lt;/p>
&lt;p>ç°åœ¨çš„ç½‘å¡ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸­æ–­+è½®è¯¢çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®ä¸šåŠ¡è´Ÿè½½åŠ¨æ€åˆ‡æ¢ã€‚&lt;/p>
&lt;p>åœ¨ RDMA åè®®ä¸­ï¼ŒCQE å°±ç›¸å½“äºæ˜¯ç½‘å¡æ”¶åˆ°çš„æ•°æ®åŒ…ï¼ŒRDMA ç¡¬ä»¶æŠŠå®ƒä¼ é€’ç»™ CPU å»å¤„ç†ã€‚RDMA æ¡†æ¶å®šä¹‰äº†ä¸¤ç§å¯¹ä¸Šå±‚çš„æ¥å£ï¼Œåˆ†åˆ«æ˜¯ poll å’Œ notifyï¼Œå¯¹åº”ç€è½®è¯¢å’Œä¸­æ–­æ¨¡å¼ã€‚&lt;/p>
&lt;h3 id="poll-completion-queue">
&lt;a href="#poll-completion-queue" class="header-anchor">#&lt;/a>
Poll completion queue
&lt;/h3>
&lt;p>å¾ˆç›´ç™½ï¼Œpoll å°±æ˜¯è½®è¯¢çš„æ„æ€ã€‚ç”¨æˆ·è°ƒç”¨è¿™ä¸ªæ¥å£ä¹‹åï¼ŒCPU å°±ä¼šå®šæœŸå»æ£€æŸ¥ CQ é‡Œé¢æ˜¯å¦æœ‰æ–°é²œçš„ CQEï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå°±å–å‡ºè¿™ä¸ª CQEï¼ˆæ³¨æ„å–å‡ºä¹‹å CQE å°±è¢«â€œæ¶ˆè€—â€æ‰äº†ï¼‰ï¼Œè§£æå…¶ä¸­çš„ä¿¡æ¯å¹¶è¿”å›ç»™ä¸Šå±‚ç”¨æˆ·ã€‚&lt;/p>
&lt;h3 id="request-completion-notification">
&lt;a href="#request-completion-notification" class="header-anchor">#&lt;/a>
Request completion notification
&lt;/h3>
&lt;p>ç›´è¯‘è¿‡æ¥æ˜¯è¯·æ±‚å®Œæˆé€šçŸ¥ï¼Œç”¨æˆ·è°ƒç”¨è¿™ä¸ªæ¥å£ä¹‹åï¼Œç›¸å½“äºå‘ç³»ç»Ÿæ³¨å†Œäº†ä¸€ä¸ªä¸­æ–­ã€‚è¿™æ ·å½“ç¡¬ä»¶å°† CQE æ”¾åˆ° CQ ä¸­åï¼Œä¼šç«‹å³è§¦å‘ä¸€ä¸ªä¸­æ–­ç»™ CPUï¼ŒCPU è¿›è€Œå°±ä¼šåœæ­¢æ‰‹ä¸Šçš„å·¥ä½œå–å‡º CQEï¼Œå¤„ç†åè¿”å›ç»™ç”¨æˆ·ã€‚&lt;/p>
&lt;p>åŒæ ·çš„ï¼Œè¿™ä¸¤ç§æ¥å£ä½¿ç”¨å“ªç§ï¼Œå–å†³äºç”¨æˆ·å¯¹äºå®æ—¶æ€§çš„è¦æ±‚ï¼Œä»¥åŠå®é™…ä¸šåŠ¡çš„ç¹å¿™ç¨‹åº¦ã€‚&lt;/p>
&lt;p>æ„Ÿè°¢é˜…è¯»ï¼ŒCQ å°±ä»‹ç»åˆ°è¿™é‡Œï¼Œä¸‹ç¯‡æ‰“ç®—è¯¦ç»†è®²è®² SRQã€‚&lt;/p>
&lt;h2 id="åè®®ç›¸å…³ç« èŠ‚">
&lt;a href="#%e5%8d%8f%e8%ae%ae%e7%9b%b8%e5%85%b3%e7%ab%a0%e8%8a%82" class="header-anchor">#&lt;/a>
åè®®ç›¸å…³ç« èŠ‚
&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>9.9 CQ é”™è¯¯æ£€æµ‹å’Œæ¢å¤&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.2.6 CQ å’Œ WQ çš„å…³ç³»&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.10 é”™è¯¯ç±»å‹åŠå…¶å¤„ç†&lt;/p>
&lt;/li>
&lt;li>
&lt;p>11.2.8 CQ ç›¸å…³æ§åˆ¶é¢æ¥å£&lt;/p>
&lt;/li>
&lt;li>
&lt;p>11.4.2 CQ ç›¸å…³æ•°æ®é¢æ¥å£&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="å…¶ä»–å‚è€ƒèµ„æ–™">
&lt;a href="#%e5%85%b6%e4%bb%96%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99" class="header-anchor">#&lt;/a>
å…¶ä»–å‚è€ƒèµ„æ–™
&lt;/h2>
&lt;p>[1] Linux Kernel Networking - Implement and Theory. Chapter 13. Completion Queue&lt;/p></description></item><item><title>RDMA ä¹‹ Queue Pair</title><link>https://cuterwrite.top/p/rdma-queue-pair/</link><pubDate>Tue, 25 Jun 2024 02:21:00 +0000</pubDate><guid>https://cuterwrite.top/p/rdma-queue-pair/</guid><description>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-16_116342820_p0_master1200.webp" alt="Featured image of post RDMA ä¹‹ Queue Pair" />&lt;h1 id="rdma-ä¹‹-queue-pair">
&lt;a href="#rdma-%e4%b9%8b-queue-pair" class="header-anchor">#&lt;/a>
RDMA ä¹‹ Queue Pair
&lt;/h1>
&lt;p>&lt;strong>æœ¬æ–‡æ¬¢è¿éå•†ä¸šè½¬è½½ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚&lt;/strong>&lt;/p>
&lt;blockquote>
&lt;p>å£°æ˜ï¼šä»…ç”¨äºæ”¶è—ï¼Œä¾¿äºé˜…è¯»&lt;/p>&lt;span class="cite">&lt;span>â€• &lt;/span>&lt;span>Savir, &lt;/span>&lt;a href="https://zhuanlan.zhihu.com/p/195757767">&lt;cite>çŸ¥ä¹ä¸“æ ï¼š9. RDMA åŸºæœ¬æœåŠ¡ç±»å‹&lt;/cite>&lt;/a>&lt;/span>&lt;/blockquote>
&lt;h2 id="queue-pair">
&lt;a href="#queue-pair" class="header-anchor">#&lt;/a>
Queue Pair
&lt;/h2>
&lt;p>æˆ‘ä»¬æ›¾ç»åœ¨ &lt;a class="link" href="https://cuterwrite.top/p/rdma-element/" >ã€â€œ3. RDMA åŸºæœ¬å…ƒç´ â€ã€‘
&lt;/a>
ä¸€æ–‡ä¸­ç®€å•çš„ä»‹ç»äº† QP çš„æ¦‚å¿µï¼Œæœ¬æ–‡å°†æ›´æ·±å…¥çš„è®²è§£ä¸€äº›å…³äº QP çš„ç»†èŠ‚ã€‚&lt;/p>
&lt;h2 id="åŸºæœ¬æ¦‚å¿µå›é¡¾">
&lt;a href="#%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5%e5%9b%9e%e9%a1%be" class="header-anchor">#&lt;/a>
åŸºæœ¬æ¦‚å¿µå›é¡¾
&lt;/h2>
&lt;p>é¦–å…ˆæˆ‘ä»¬æ¥ç®€å•å›é¡¾ä¸‹å…³äº QP çš„åŸºç¡€çŸ¥è¯†ï¼š&lt;/p>
&lt;p>æ ¹æ® IB åè®®ä¸­çš„æè¿°ï¼ŒQP æ˜¯ç¡¬ä»¶å’Œè½¯ä»¶ä¹‹é—´çš„ä¸€ä¸ªè™šæ‹Ÿæ¥å£ã€‚QP æ˜¯é˜Ÿåˆ—ç»“æ„ï¼ŒæŒ‰é¡ºåºå­˜å‚¨ç€è½¯ä»¶ç»™ç¡¬ä»¶ä¸‹å‘çš„ä»»åŠ¡ï¼ˆWQEï¼‰ï¼ŒWQE ä¸­åŒ…å«ä»å“ªé‡Œå–å‡ºå¤šé•¿çš„æ•°æ®ï¼Œå¹¶ä¸”å‘é€ç»™å“ªä¸ªç›®çš„åœ°ç­‰ç­‰ä¿¡æ¯ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-26_9_1.webp"
alt="2024-06-26_9_1" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>QP çš„æ¦‚å¿µ&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>æ¯ä¸ª QP é—´éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå½¼æ­¤é€šè¿‡ PD éš”ç¦»ï¼Œå› æ­¤ä¸€ä¸ª QP å¯ä»¥è¢«è§†ä¸ºæŸä¸ªç”¨æˆ·ç‹¬å çš„ä¸€ç§èµ„æºï¼Œä¸€ä¸ªç”¨æˆ·ä¹Ÿå¯ä»¥åŒæ—¶ä½¿ç”¨å¤šä¸ª QPã€‚&lt;/p>
&lt;p>QP æœ‰å¾ˆå¤šç§æœåŠ¡ç±»å‹ï¼ŒåŒ…æ‹¬ RCã€UDã€RD å’Œ UC ç­‰ï¼Œæ‰€æœ‰çš„æº QP å’Œç›®çš„ QP å¿…é¡»ä¸ºåŒä¸€ç§ç±»å‹æ‰èƒ½è¿›è¡Œæ•°æ®äº¤äº’ã€‚&lt;/p>
&lt;p>è™½ç„¶ IB åè®®å°† QP ç§°ä¸ºâ€œè™šæ‹Ÿæ¥å£â€ï¼Œä½†æ˜¯å®ƒæ˜¯æœ‰å®ä½“çš„ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ç¡¬ä»¶ä¸Šï¼ŒQP æ˜¯ä¸€æ®µåŒ…å«ç€è‹¥å¹²ä¸ª WQE çš„å­˜å‚¨ç©ºé—´ï¼ŒIB ç½‘å¡ä¼šä»è¿™æ®µç©ºé—´ä¸­è¯»å– WQE çš„å†…å®¹ï¼Œå¹¶æŒ‰ç…§ç”¨æˆ·çš„æœŸæœ›å»å†…å­˜ä¸­å­˜å–æ•°æ®ã€‚è‡³äºè¿™ä¸ªå­˜å‚¨ç©ºé—´æ˜¯å†…å­˜ç©ºé—´è¿˜æ˜¯ IB ç½‘å¡çš„ç‰‡å†…å­˜å‚¨ç©ºé—´ï¼ŒIB åè®®å¹¶æœªåšå‡ºé™åˆ¶ï¼Œæ¯ä¸ªå‚å•†æœ‰å„è‡ªçš„å®ç°&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è½¯ä»¶ä¸Šï¼ŒQP æ˜¯ä¸€ä¸ªç”± IB ç½‘å¡çš„é©±åŠ¨ç¨‹åºæ‰€ç»´æŠ¤çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­åŒ…å« QP çš„åœ°å€æŒ‡é’ˆä»¥åŠä¸€äº›ç›¸å…³çš„è½¯ä»¶å±æ€§ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="qpc">
&lt;a href="#qpc" class="header-anchor">#&lt;/a>
QPC
&lt;/h3>
&lt;p>&lt;a class="link" href="https://cuterwrite.top/p/rdma-service-types/" >ã€â€œ5. RDMA åŸºæœ¬æœåŠ¡ç±»å‹â€ã€‘
&lt;/a>
ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬æ›¾ç»æåˆ°è¿‡ QPC å…¨ç§°æ˜¯ Queue Pair Contextï¼Œç”¨äºå­˜å‚¨ QP ç›¸å…³å±æ€§ã€‚é©±åŠ¨ç¨‹åºé‡Œé¢æ˜¯æœ‰å‚¨å­˜ QP çš„è½¯ä»¶å±æ€§çš„ï¼Œæ—¢ç„¶æˆ‘ä»¬å¯ä»¥åœ¨è½¯ä»¶é‡Œå‚¨å­˜ QP çš„å±æ€§ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ç”¨ä½¿ç”¨ QPC å‘¢ï¼Ÿ&lt;/p>
&lt;p>è¿™æ˜¯å› ä¸º&lt;strong>QPC ä¸»è¦æ˜¯ç»™ç¡¬ä»¶çœ‹çš„ï¼Œä¹Ÿä¼šç”¨æ¥åœ¨è½¯ç¡¬ä»¶ä¹‹é—´åŒæ­¥ QP çš„ä¿¡æ¯ã€‚&lt;/strong>&lt;/p>
&lt;p>æˆ‘ä»¬è¯´è¿‡ QP åœ¨ç¡¬ä»¶ä¸Šçš„å®ä½“åªæ˜¯ä¸€æ®µå­˜å‚¨ç©ºé—´è€Œå·²ï¼Œç¡¬ä»¶é™¤äº†çŸ¥é“è¿™æ®µç©ºé—´çš„èµ·å§‹åœ°å€å’Œå¤§å°ä¹‹å¤–ä¸€æ— æ‰€çŸ¥ï¼Œç”šè‡³è¿è¿™ä¸ª QP æœåŠ¡ç±»å‹éƒ½ä¸çŸ¥é“ã€‚è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„é‡è¦ä¿¡æ¯ï¼Œæ¯”å¦‚æŸä¸ª QP ä¸­åŒ…å«äº†è‹¥å¹²ä¸ª WQEï¼Œç¡¬ä»¶æ€ä¹ˆçŸ¥é“æœ‰å¤šå°‘ä¸ªï¼Œå½“å‰åº”è¯¥å¤„ç†ç¬¬å‡ ä¸ªå‘¢ï¼Ÿ&lt;/p>
&lt;p>æ‰€æœ‰ä¸Šè¿°çš„è¿™äº›ä¿¡æ¯ï¼Œè½¯ä»¶æ˜¯å¯ä»¥è®¾è®¡ä¸€å®šçš„æ•°æ®ç»“æ„å¹¶ä¸ºå…¶ç”³è¯·å†…å­˜ç©ºé—´çš„ï¼Œä½†æ˜¯è½¯ä»¶çœ‹åˆ°çš„éƒ½æ˜¯è™šæ‹Ÿåœ°å€ï¼Œè¿™äº›å†…å­˜ç©ºé—´åœ¨ç‰©ç†ä¸Šæ˜¯ç¦»æ•£çš„ï¼Œç¡¬ä»¶å¹¶ä¸çŸ¥é“è¿™äº›æ•°æ®å­˜æ”¾åˆ°äº†å“ªé‡Œã€‚æ‰€ä»¥å°±éœ€è¦è½¯ä»¶é€šè¿‡æ“ä½œç³»ç»Ÿæå‰ç”³è¯·å¥½ä¸€å¤§ç‰‡è¿ç»­çš„ç©ºé—´ï¼Œå³ QPC æ¥æ‰¿è½½è¿™äº›ä¿¡æ¯ç»™ç¡¬ä»¶çœ‹ã€‚ç½‘å¡åŠå…¶é…å¥—çš„é©±åŠ¨ç¨‹åºæå‰çº¦å®šå¥½äº† QPC ä¸­éƒ½æœ‰å“ªäº›å†…å®¹ï¼Œè¿™äº›å†…å®¹åˆ†åˆ«å æ®å¤šå°‘ç©ºé—´ï¼ŒæŒ‰ç…§ä»€ä¹ˆé¡ºåºå­˜æ”¾ã€‚è¿™æ ·é©±åŠ¨å’Œç¡¬ä»¶å°±å¯ä»¥é€šè¿‡é€šè¿‡ QPC è¿™æ®µç©ºé—´æ¥è¯»å†™ QP çš„çŠ¶æ€ç­‰ç­‰ä¿¡æ¯ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-26_9_2_QPC.webp"
alt="2024-06-26_9_2" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>QPC çš„æ¦‚å¿µ&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œç¡¬ä»¶å…¶å®åªéœ€è¦çŸ¥é“ QPC çš„åœ°å€ 0x12350000 å°±å¯ä»¥äº†ï¼Œå› ä¸ºå®ƒå¯ä»¥è§£æ QPC çš„å†…å®¹ï¼Œä»è€Œå¾—çŸ¥ QP çš„ä½ç½®ï¼ŒQP åºå·ï¼ŒQP å¤§å°ç­‰ç­‰ä¿¡æ¯ã€‚è¿›è€Œå°±èƒ½æ‰¾åˆ° QPï¼ŒçŸ¥é“åº”è¯¥å–ç¬¬å‡ ä¸ª WQE å»å¤„ç†ã€‚ä¸åŒçš„å‚å•†å¯èƒ½å®ç°æœ‰äº›å·®å¼‚ï¼Œä½†æ˜¯å¤§è‡´çš„åŸç†å°±æ˜¯è¿™æ ·ã€‚&lt;/p>
&lt;p>IB è½¯ä»¶æ ˆä¸­è¿˜æœ‰å¾ˆå¤š Context çš„æ¦‚å¿µï¼Œé™¤äº† QPC ä¹‹å¤–ï¼Œè¿˜æœ‰ Device Contextï¼ŒSRQCï¼ŒCQCï¼ŒEQCï¼ˆEvent Queue Contextï¼Œäº‹ä»¶é˜Ÿåˆ—ä¸Šä¸‹æ–‡ï¼‰ç­‰ï¼Œå®ƒä»¬çš„ä½œç”¨ä¸ QPC ç±»ä¼¼ï¼Œéƒ½æ˜¯ç”¨æ¥åœ¨è®°å½•å’ŒåŒæ­¥æŸç§èµ„æºçš„ç›¸å…³å±æ€§ã€‚&lt;/p>
&lt;h3 id="qp-number">
&lt;a href="#qp-number" class="header-anchor">#&lt;/a>
QP Number
&lt;/h3>
&lt;p>ç®€ç§°ä¸º QPNï¼Œå°±æ˜¯æ¯ä¸ª QP çš„ç¼–å·ã€‚IB åè®®ä¸­è§„å®šç”¨ $2^{24}$ ä¸ª bit æ¥è¡¨ç¤º QPNï¼Œå³æ¯ä¸ªèŠ‚ç‚¹æœ€å¤§å¯ä»¥åŒæ—¶ä½¿ç”¨ $2^{24}$ ä¸ª QPï¼Œè¿™å·²ç»æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ•°é‡äº†ï¼Œå‡ ä¹ä¸å¯èƒ½ç”¨å®Œã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½å„è‡ªç»´æŠ¤ç€ QPN çš„é›†åˆï¼Œç›¸äº’ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼Œå³ä¸åŒçš„èŠ‚ç‚¹ä¸Šå¯ä»¥å­˜åœ¨ç¼–å·ç›¸åŒçš„ QPã€‚&lt;/p>
&lt;p>QPN çš„æ¦‚å¿µæœ¬èº«éå¸¸ç®€å•ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„ä¿ç•™ç¼–å·éœ€è¦é¢å¤–æ³¨æ„ä¸€ä¸‹ï¼š&lt;/p>
&lt;h4 id="qp0">
&lt;a href="#qp0" class="header-anchor">#&lt;/a>
QP0
&lt;/h4>
&lt;p>ç¼–å·ä¸º 0 çš„ QP ç”¨äºå­ç½‘ç®¡ç†æ¥å£ SMIï¼ˆSubnet Management Interfaceï¼‰ï¼Œç”¨äºç®¡ç†å­ç½‘ä¸­çš„å…¨éƒ¨èŠ‚ç‚¹ï¼Œè¯´å®è¯æˆ‘ä¹Ÿè¿˜æ²¡ææ¸…æ¥šè¿™ä¸ªæ¥å£çš„ä½œç”¨ï¼Œæš‚ä¸”æŒ‰ä¸‹ä¸è¡¨ã€‚&lt;/p>
&lt;h4 id="qp1">
&lt;a href="#qp1" class="header-anchor">#&lt;/a>
QP1
&lt;/h4>
&lt;p>ç¼–å·ä¸º 1 çš„ QP ç”¨äºé€šç”¨æœåŠ¡æ¥å£ GSIï¼ˆGeneral Service Interfaceï¼‰ï¼ŒGSI æ˜¯ä¸€ç»„ç®¡ç†æœåŠ¡ï¼Œå…¶ä¸­æœ€å‡ºåçš„å°±æ˜¯ CMï¼ˆCommunication Managementï¼‰ï¼Œæ˜¯ä¸€ç§åœ¨é€šä¿¡åŒæ–¹èŠ‚ç‚¹æ­£å¼å»ºç«‹è¿æ¥ä¹‹å‰ç”¨æ¥äº¤æ¢å¿…é¡»ä¿¡æ¯çš„ä¸€ç§æ–¹å¼ã€‚å…¶ç»†èŠ‚å°†åœ¨åé¢çš„æ–‡ç« ä¸­ä¸“é—¨å±•å¼€ä»‹ç»ã€‚&lt;/p>
&lt;p>è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰çš„æ–‡ç« ç”»çš„å…³äº QP çš„å›¾ä¸­ï¼Œæ²¡æœ‰å‡ºç°è¿‡ QP0 å’Œ QP1 çš„åŸå› äº†ã€‚è¿™ä¸¤ä¸ª QP ä¹‹å¤–çš„å…¶ä»– QP å°±éƒ½æ˜¯æ™®é€š QP äº†ã€‚ç”¨æˆ·åœ¨åˆ›å»º QP çš„æ—¶å€™ï¼Œé©±åŠ¨æˆ–è€…ç¡¬ä»¶ä¼šç»™è¿™ä¸ªæ–° QP åˆ†é…ä¸€ä¸ª QPNï¼Œä¸€èˆ¬çš„ QPN éƒ½æ˜¯ 2ã€3ã€4 è¿™æ ·æŒ‰é¡ºåºåˆ†é…çš„ã€‚å½“ QP è¢«é”€æ¯ä¹‹åï¼Œå®ƒçš„ QPN ä¹Ÿä¼šè¢«é‡æ–°å›æ”¶ï¼Œå¹¶åœ¨åˆé€‚çš„æ—¶å€™åˆ†é…ç»™å…¶ä»–æ–°åˆ›å»ºçš„ QPã€‚&lt;/p>
&lt;h2 id="ç”¨æˆ·æ¥å£">
&lt;a href="#%e7%94%a8%e6%88%b7%e6%8e%a5%e5%8f%a3" class="header-anchor">#&lt;/a>
ç”¨æˆ·æ¥å£
&lt;/h2>
&lt;p>æˆ‘ä»¬ä»æ§åˆ¶å±‚é¢å’Œæ•°æ®å±‚é¢æ¥åˆ†ç±»ä»‹ç»ç”¨æˆ·æ¥å£ï¼Œæ§åˆ¶é¢å³ç”¨æˆ·å¯¹æŸç§èµ„æºè¿›è¡ŒæŸç§è®¾ç½®ï¼Œä¸€èˆ¬éƒ½æ˜¯åœ¨æ­£å¼æ”¶å‘æ•°æ®ä¹‹å‰è¿›è¡Œï¼›è€Œæ•°æ®é¢è‡ªç„¶å°±æ˜¯çœŸæ­£çš„æ•°æ®æ”¶å‘è¿‡ç¨‹ä¸­è¿›è¡Œçš„æ“ä½œã€‚&lt;/p>
&lt;h3 id="æ§åˆ¶é¢">
&lt;a href="#%e6%8e%a7%e5%88%b6%e9%9d%a2" class="header-anchor">#&lt;/a>
æ§åˆ¶é¢
&lt;/h3>
&lt;p>æ¥è§¦è¿‡ç®—æ³•çš„è¯»è€…åº”è¯¥éƒ½äº†è§£ï¼Œé“¾è¡¨çš„èŠ‚ç‚¹æ¶‰åŠåˆ°â€œå¢ã€åˆ ã€æ”¹ã€æŸ¥â€å››ä¸ªæ“ä½œï¼Œé“¾è¡¨çš„èŠ‚ç‚¹æ˜¯ä¸€ç‰‡å†…å­˜åŒºåŸŸï¼Œæ˜¯ä¸€ç§è½¯ä»¶èµ„æºã€‚&lt;/p>
&lt;p>â€œå¢â€å³å‘æ“ä½œç³»ç»Ÿç”³è¯·ä¸€ç‰‡å†…å­˜ç”¨æ¥å­˜æ”¾æ•°æ®ï¼Œç³»ç»Ÿå°†åœ¨å†…å­˜ä¸­åˆ’åˆ†ä¸€å—ç©ºé—´ï¼Œå¹¶å°†å…¶æ ‡è®°ä¸ºâ€œå·²è¢«è¿›ç¨‹ XX ä½¿ç”¨â€ï¼Œå…¶ä»–æ²¡æœ‰æƒé™çš„è¿›ç¨‹å°†æ— æ³•è¦†ç›–ç”šè‡³è¯»å–è¿™ç‰‡å†…å­˜ç©ºé—´ã€‚&lt;/p>
&lt;p>â€œåˆ â€å³é€šçŸ¥æ“ä½œç³»ç»Ÿï¼Œè¿™ç‰‡ç©ºé—´æˆ‘ä¸ä½¿ç”¨äº†ï¼Œå¯ä»¥æ ‡è®°æˆâ€œæœªä½¿ç”¨â€å¹¶ç»™å…¶å®ƒè¿›ç¨‹ä½¿ç”¨äº†ã€‚&lt;/p>
&lt;p>â€œæ”¹â€å°±æ˜¯å†™ï¼Œå³ä¿®æ”¹è¿™ç‰‡å†…å­˜åŒºåŸŸçš„å†…å®¹ã€‚&lt;/p>
&lt;p>&amp;ldquo;æŸ¥&amp;quot;å°±æ˜¯è¯»ï¼Œå³è·å–è¿™ç‰‡å†…å­˜åŒºåŸŸçš„å†…å®¹ã€‚&lt;/p>
&lt;p>QP ä½œä¸º RDMA æŠ€æœ¯ä¸­æœ€é‡è¦çš„ä¸€ç§èµ„æºï¼Œåœ¨ç”Ÿå‘½å‘¨æœŸä¸Šä¸é“¾è¡¨å¹¶æ— äºŒè‡´ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align: left">æ“ä½œ&lt;/th>
&lt;th style="text-align: left">é“¾è¡¨èŠ‚ç‚¹&lt;/th>
&lt;th style="text-align: left">QP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align: left">å¢&lt;/td>
&lt;td style="text-align: left">struct ListNode *node = malloc(sizeof(struct ListNode *));&lt;/td>
&lt;td style="text-align: left">Create QP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">åˆ &lt;/td>
&lt;td style="text-align: left">free(node);&lt;/td>
&lt;td style="text-align: left">Destroy QP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">æ”¹&lt;/td>
&lt;td style="text-align: left">node-&amp;gt;val = xxx;&lt;/td>
&lt;td style="text-align: left">Modify QP&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align: left">æŸ¥&lt;/td>
&lt;td style="text-align: left">xxx = node-&amp;gt;val;&lt;/td>
&lt;td style="text-align: left">Query QP&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>è¿™å››ç§æ“ä½œï¼Œå…¶å®å°±æ˜¯ Verbsï¼ˆRDMA å¯¹ä¸Šå±‚åº”ç”¨çš„ APIï¼‰åœ¨æ§åˆ¶é¢ä¸Šå¯¹ä¸Šå±‚ç”¨æˆ·æä¾›ç»™ç”¨æˆ·çš„å‡ ä¸ªæ¥å£ï¼š&lt;/p>
&lt;h4 id="create-qp">
&lt;a href="#create-qp" class="header-anchor">#&lt;/a>
Create QP
&lt;/h4>
&lt;p>åˆ›å»ºä¸€ä¸ª QP çš„è½¯ç¡¬ä»¶èµ„æºï¼ŒåŒ…å« QP æœ¬èº«ä»¥åŠ QPCã€‚ç”¨æˆ·åˆ›å»ºæ—¶ä¼šå†™ä¼ å…¥ä¸€ç³»åˆ—çš„åˆå§‹åŒ–å±æ€§ï¼ŒåŒ…å«è¯¥ QP çš„æœåŠ¡ç±»å‹ï¼Œå¯ä»¥å‚¨å­˜çš„ WQE æ•°é‡ç­‰ä¿¡æ¯&lt;/p>
&lt;h4 id="destroy-qp">
&lt;a href="#destroy-qp" class="header-anchor">#&lt;/a>
Destroy QP
&lt;/h4>
&lt;p>é‡Šæ”¾ä¸€ä¸ª QP çš„å…¨éƒ¨è½¯ç¡¬ä»¶èµ„æºï¼ŒåŒ…å« QP æœ¬èº«åŠ QPCã€‚é”€æ¯ QP åï¼Œç”¨æˆ·å°†æ— æ³•é€šè¿‡ QPN ç´¢å¼•åˆ°è¿™ä¸ª QPã€‚&lt;/p>
&lt;h4 id="modify-qp">
&lt;a href="#modify-qp" class="header-anchor">#&lt;/a>
Modify QP
&lt;/h4>
&lt;p>ä¿®æ”¹ä¸€ä¸ª QP çš„æŸäº›å±æ€§ï¼Œæ¯”å¦‚ QP çš„çŠ¶æ€ï¼Œè·¯å¾„çš„ MTU ç­‰ç­‰ã€‚è¿™ä¸ªä¿®æ”¹è¿‡ç¨‹æ—¢åŒ…æ‹¬è½¯ä»¶æ•°æ®ç»“æ„çš„ä¿®æ”¹ï¼Œä¹ŸåŒ…æ‹¬å¯¹ QPC çš„ä¿®æ”¹ã€‚&lt;/p>
&lt;h4 id="query-qp">
&lt;a href="#query-qp" class="header-anchor">#&lt;/a>
Query QP
&lt;/h4>
&lt;p>æŸ¥è¯¢ä¸€ä¸ª QP å½“å‰çš„çŠ¶æ€å’Œä¸€äº›å±æ€§ï¼ŒæŸ¥è¯¢åˆ°çš„æ•°æ®æ¥æºäºé©±åŠ¨ä»¥åŠ QPC çš„å†…å®¹ã€‚&lt;/p>
&lt;p>è¿™å››ç§æ“ä½œéƒ½æœ‰é…å¥—çš„ Verbs æ¥å£ï¼Œç±»ä¼¼äº &lt;code>ibv_create_qp()&lt;/code> è¿™ç§å½¢å¼ï¼Œæˆ‘ä»¬ç¼–å†™ APP æ—¶ç›´æ¥è°ƒç”¨å°±å¯ä»¥äº†ã€‚æ›´å¤šå…³äºå¯¹ä¸Šå±‚çš„ API çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬å°†åœ¨åé¢ä¸“é—¨è¿›è¡Œä»‹ç»ã€‚&lt;/p>
&lt;h2 id="æ•°æ®é¢">
&lt;a href="#%e6%95%b0%e6%8d%ae%e9%9d%a2" class="header-anchor">#&lt;/a>
æ•°æ®é¢
&lt;/h2>
&lt;p>æ•°æ®é¢ä¸Šï¼Œä¸€ä¸ª QP å¯¹ä¸Šå±‚çš„æ¥å£å…¶å®åªæœ‰ä¸¤ç§ï¼Œåˆ†åˆ«ç”¨äºå‘ QP ä¸­å¡«å†™å‘é€å’Œæ¥æ”¶è¯·æ±‚ã€‚&lt;strong>è¿™é‡Œçš„â€œå‘é€â€å’Œâ€œæ¥æ”¶â€å¹¶ä¸æ˜¯æŒ‡çš„å‘é€å’Œæ¥æ”¶æ•°æ®ï¼Œè€Œæ˜¯æŒ‡çš„æ˜¯ä¸€æ¬¡é€šä¿¡è¿‡ç¨‹çš„â€œå‘èµ·æ–¹â€ï¼ˆRequestorï¼‰å’Œâ€œæ¥æ”¶æ–¹â€ï¼ˆResponserï¼‰&lt;/strong>ã€‚&lt;/p>
&lt;p>åœ¨è¡Œä¸ºä¸Šéƒ½æ˜¯è½¯ä»¶å‘ QP ä¸­å¡«å†™ä¸€ä¸ª WQEï¼ˆå¯¹åº”ç”¨å±‚æ¥è¯´å« WRï¼‰ï¼Œè¯·æ±‚ç¡¬ä»¶æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œã€‚æ‰€ä»¥è¿™ä¸¤ç§è¡Œä¸ºéƒ½å«åšâ€œPost XXX Requestâ€çš„å½¢å¼ï¼Œå³ä¸‹å‘ XXX è¯·æ±‚ã€‚&lt;/p>
&lt;h3 id="post-send-request">
&lt;a href="#post-send-request" class="header-anchor">#&lt;/a>
Post Send Request
&lt;/h3>
&lt;p>å†å¼ºè°ƒä¸€ä¸‹ï¼ŒPost Send æœ¬èº«ä¸æ˜¯æŒ‡è¿™ä¸ª WQE çš„æ“ä½œç±»å‹æ˜¯ Sendï¼Œè€Œæ˜¯è¡¨ç¤ºè¿™ä¸ª WQE å±äºé€šä¿¡å‘èµ·æ–¹ã€‚è¿™ä¸ªæµç¨‹ä¸­å¡«å†™åˆ° QP ä¸­çš„ WQE/WR å¯ä»¥æ˜¯ Send æ“ä½œï¼ŒRDMA Write æ“ä½œä»¥åŠ RDMA Read æ“ä½œç­‰ã€‚&lt;/p>
&lt;p>ç”¨æˆ·éœ€è¦æå‰å‡†å¤‡å¥½æ•°æ®ç¼“å†²åŒºã€ç›®çš„åœ°å€ç­‰ä¿¡æ¯ï¼Œç„¶åè°ƒç”¨æ¥å£å°† WR ä¼ ç»™é©±åŠ¨ï¼Œé©±åŠ¨å†æŠŠ WQE å¡«å†™åˆ° QP ä¸­ã€‚&lt;/p>
&lt;h3 id="post-receive-request">
&lt;a href="#post-receive-request" class="header-anchor">#&lt;/a>
Post Receive Request
&lt;/h3>
&lt;p>Post Recv çš„ä½¿ç”¨åœºæ™¯å°±ç›¸å¯¹æ¯”è¾ƒå°‘äº†ï¼Œä¸€èˆ¬åªåœ¨ Send-Recv æ“ä½œçš„æ¥æ”¶ç«¯æ‰§è¡Œï¼Œæ¥æ”¶ç«¯éœ€è¦æå‰å‡†å¤‡å¥½æ¥æ”¶æ•°æ®çš„ç¼“å†²åŒºï¼Œå¹¶å°†ç¼“å†²åŒºåœ°å€ç­‰ä¿¡æ¯ä»¥ WQE çš„å½¢å¼å‘ŠçŸ¥ç¡¬ä»¶ã€‚&lt;/p>
&lt;h2 id="qp-çŠ¶æ€æœº">
&lt;a href="#qp-%e7%8a%b6%e6%80%81%e6%9c%ba" class="header-anchor">#&lt;/a>
QP çŠ¶æ€æœº
&lt;/h2>
&lt;p>è¯´åˆ° QP çš„çŠ¶æ€ï¼Œå°±ä¸å¾—ä¸ç¥­å‡ºä¸‹é¢è¿™å¼ å›¾ï¼ˆå–è‡ª IB åè®® 10.3.1 èŠ‚ï¼‰ï¼š&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-26_9_3.webp"
alt="2024-06-26_9_3" width="auto" loading="lazy">&lt;figcaption>
&lt;h4>QP çŠ¶æ€æœº&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>æ‰€è°“çŠ¶æ€æœºï¼Œå°±æ˜¯æè¿°ä¸€ä¸ªå¯¹è±¡çš„ä¸åŒçŠ¶æ€ï¼Œä»¥åŠè§¦å‘çŠ¶æ€é—´è·³è½¬çš„æ¡ä»¶ã€‚ä¸ºä¸€ä¸ªå¯¹è±¡è®¾è®¡çŠ¶æ€æœºå¯ä»¥ä½¿è¿™ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå˜å¾—éå¸¸æ˜ç¡®ï¼Œå®ç°ä¸Šä¹Ÿä¼šä½¿å¾—é€»è¾‘æ›´åŠ æ¸…æ™°ã€‚&lt;/p>
&lt;p>å¯¹äº QP æ¥è¯´ï¼ŒIB è§„èŒƒä¹Ÿä¸ºå…¶è®¾è®¡äº†å‡ ç§çŠ¶æ€ï¼Œå¤„äºä¸åŒçŠ¶æ€çš„ QP çš„åŠŸèƒ½æ˜¯æœ‰å·®å¼‚çš„ï¼Œæ¯”å¦‚åªæœ‰è¿›å…¥åˆ° Ready to Send çŠ¶æ€ä¹‹åï¼ŒQP æ‰èƒ½å¤Ÿè¿›è¡Œ Post Send æ•°æ®æ“ä½œã€‚æ­£å¸¸çŠ¶æ€ï¼ˆç»¿è‰²çš„ï¼‰ä¹‹é—´çš„çŠ¶æ€è½¬æ¢éƒ½æ˜¯ç”±ç”¨æˆ·é€šè¿‡ä¸Šæ–‡ä»‹ç»çš„ Modify QP çš„ç”¨æˆ·æ¥å£æ¥ä¸»åŠ¨è§¦å‘çš„ï¼›è€Œé”™è¯¯çŠ¶æ€ï¼ˆçº¢è‰²çš„ï¼‰å¾€å¾€æ˜¯å‡ºé”™ä¹‹åè‡ªåŠ¨è·³è½¬çš„ï¼Œå½“ä¸€ä¸ª QP å¤„äºé”™è¯¯çŠ¶æ€ä¹‹åå°±æ— æ³•æ‰§è¡Œæ­£å¸¸çš„ä¸šåŠ¡äº†ï¼Œå°±éœ€è¦ä¸Šå±‚é€šè¿‡ Modify QP å°†å…¶é‡æ–°é…ç½®åˆ°æ­£å¸¸çŠ¶æ€ä¸Šã€‚&lt;/p>
&lt;p>ä¸Šå›¾ä¸­æˆ‘ä»¬åªå…³æ³¨ QP çš„éƒ¨åˆ†ï¼ŒEEï¼ˆEnd-to-End Contextï¼‰æ˜¯ä¸“é—¨ç»™ RD æœåŠ¡ç±»å‹ä½¿ç”¨çš„ä¸€ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬æš‚ä¸æ¶‰åŠã€‚æˆ‘ä»¬é€šè¿‡ Create QP æ¥å£æ¥è¿›å…¥è¿™ä¸ªçŠ¶æ€å›¾ï¼Œé€šè¿‡ Destroy QP æ¥å£æ¥ç¦»å¼€è¿™ä¸ªçŠ¶æ€å›¾ã€‚&lt;/p>
&lt;p>QP æœ‰ä»¥ä¸‹å‡ ç§çŠ¶æ€ï¼Œæˆ‘ä»¬ä»…ä»‹ç»ä¸€ä¸‹æ¯”è¾ƒé‡è¦çš„ç‚¹ï¼š&lt;/p>
&lt;h3 id="rstreset">
&lt;a href="#rstreset" class="header-anchor">#&lt;/a>
RSTï¼ˆResetï¼‰
&lt;/h3>
&lt;p>å¤ä½çŠ¶æ€ã€‚å½“ä¸€ä¸ª QP é€šè¿‡ Create QP åˆ›å»ºå¥½ä¹‹åå°±å¤„äºè¿™ä¸ªçŠ¶æ€ï¼Œç›¸å…³çš„èµ„æºéƒ½å·²ç»ç”³è¯·å¥½äº†ï¼Œä½†æ˜¯è¿™ä¸ª QP ç›®å‰ä»€ä¹ˆéƒ½åšä¸äº†ï¼Œå…¶æ— æ³•æ¥æ”¶ç”¨æˆ·ä¸‹å‘çš„ WQEï¼Œä¹Ÿæ— æ³•æ¥å—å¯¹ç«¯æŸä¸ª QP çš„æ¶ˆæ¯ã€‚&lt;/p>
&lt;h3 id="initinitialized">
&lt;a href="#initinitialized" class="header-anchor">#&lt;/a>
INITï¼ˆInitializedï¼‰
&lt;/h3>
&lt;p>å·²åˆå§‹åŒ–çŠ¶æ€ã€‚è¿™ä¸ªçŠ¶æ€ä¸‹ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ Post Receive ç»™è¿™ä¸ª QP ä¸‹å‘ Receive WRï¼Œä½†æ˜¯æ¥æ”¶åˆ°çš„æ¶ˆæ¯å¹¶ä¸ä¼šè¢«å¤„ç†ï¼Œä¼šè¢«é™é»˜ä¸¢å¼ƒï¼›å¦‚æœç”¨æˆ·ä¸‹å‘äº†ä¸€ä¸ª Post Send çš„ WRï¼Œåˆ™ä¼šæŠ¥é”™ã€‚&lt;/p>
&lt;h3 id="rtrready-to-receive">
&lt;a href="#rtrready-to-receive" class="header-anchor">#&lt;/a>
RTRï¼ˆReady to Receiveï¼‰
&lt;/h3>
&lt;p>å‡†å¤‡æ¥æ”¶çŠ¶æ€ã€‚åœ¨ INIT çŠ¶æ€çš„åŸºç¡€ä¸Šï¼ŒRQ å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œå³å¯¹äºæ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œå¯ä»¥æŒ‰ç…§å…¶ä¸­ WQE çš„æŒ‡ç¤ºæ¬ç§»æ•°æ®åˆ°æŒ‡å®šå†…å­˜ä½ç½®ã€‚æ­¤çŠ¶æ€ä¸‹ SQ ä»ç„¶ä¸èƒ½å·¥ä½œã€‚&lt;/p>
&lt;h3 id="rtsready-to-send">
&lt;a href="#rtsready-to-send" class="header-anchor">#&lt;/a>
RTSï¼ˆReady to Sendï¼‰
&lt;/h3>
&lt;p>å‡†å¤‡å‘é€çŠ¶æ€ã€‚åœ¨ RTR åŸºç¡€ä¸Šï¼ŒSQ å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œå³ç”¨æˆ·å¯ä»¥è¿›è¡Œ Post Sendï¼Œå¹¶ä¸”ç¡¬ä»¶ä¹Ÿä¼šæ ¹æ® SQ çš„å†…å®¹å°†æ•°æ®å‘é€å‡ºå»ã€‚è¿›å…¥è¯¥çŠ¶æ€å‰ï¼ŒQP å¿…é¡»å·²äºå¯¹ç«¯å»ºç«‹å¥½é“¾æ¥ã€‚&lt;/p>
&lt;h3 id="sqdsend-queue-drain">
&lt;a href="#sqdsend-queue-drain" class="header-anchor">#&lt;/a>
SQDï¼ˆSend Queue Drainï¼‰
&lt;/h3>
&lt;p>SQ æ’ç©ºçŠ¶æ€ã€‚é¡¾åæ€ä¹‰ï¼Œè¯¥çŠ¶æ€ä¼šå°† SQ é˜Ÿåˆ—ä¸­ç°å­˜çš„æœªå¤„ç†çš„ WQE å…¨éƒ¨å¤„ç†æ‰ï¼Œè¿™ä¸ªæ—¶å€™ç”¨æˆ·è¿˜å¯ä»¥ä¸‹å‘æ–°çš„ WQE ä¸‹æ¥ï¼Œä½†æ˜¯è¿™äº› WQE è¦ç­‰åˆ°æ—§çš„ WQE å…¨å¤„ç†ä¹‹åæ‰ä¼šè¢«å¤„ç†ã€‚&lt;/p>
&lt;h3 id="sqersend-queue-error">
&lt;a href="#sqersend-queue-error" class="header-anchor">#&lt;/a>
SQErï¼ˆSend Queue Errorï¼‰
&lt;/h3>
&lt;p>SQ é”™è¯¯çŠ¶æ€ã€‚å½“æŸä¸ª Send WR å‘ç”Ÿå®Œæˆé”™è¯¯ï¼ˆå³ç¡¬ä»¶é€šè¿‡ CQE å‘ŠçŸ¥é©±åŠ¨å‘ç”Ÿçš„é”™è¯¯ï¼‰æ—¶ï¼Œä¼šå¯¼è‡´ QP è¿›å…¥æ­¤çŠ¶æ€ã€‚&lt;/p>
&lt;h3 id="errerror">
&lt;a href="#errerror" class="header-anchor">#&lt;/a>
ERRï¼ˆErrorï¼‰
&lt;/h3>
&lt;p>å³é”™è¯¯çŠ¶æ€ã€‚å…¶ä»–çŠ¶æ€å¦‚æœå‘ç”Ÿäº†é”™è¯¯ï¼Œéƒ½å¯èƒ½è¿›å…¥è¯¥çŠ¶æ€ã€‚Error çŠ¶æ€æ—¶ï¼ŒQP ä¼šåœæ­¢å¤„ç† WQEï¼Œå·²ç»å¤„ç†åˆ°ä¸€åŠçš„ WQE ä¹Ÿä¼šåœæ­¢ã€‚ä¸Šå±‚éœ€è¦åœ¨ä¿®å¤é”™è¯¯åå†å°† QP é‡æ–°åˆ‡æ¢åˆ° RST çš„åˆå§‹çŠ¶æ€ã€‚&lt;/p>
&lt;h2 id="æ€»ç»“">
&lt;a href="#%e6%80%bb%e7%bb%93" class="header-anchor">#&lt;/a>
æ€»ç»“
&lt;/h2>
&lt;p>æœ¬æ–‡å…ˆå›é¡¾äº† QP çš„ä¸€äº›é‡è¦åŸºæœ¬æ¦‚å¿µï¼Œç„¶åè®²è§£äº† QPCã€QPN ç­‰ QP å¼ºç›¸å…³çš„æ¦‚å¿µï¼Œæœ€åä»‹ç»äº†ç”¨æˆ·æ“ä½œ QP å¸¸ç”¨çš„æ¥å£ä»¥åŠ QP çŠ¶æ€æœºï¼Œç›¸ä¿¡æœ¬æ–‡è¿‡åè¯»è€…ä¸€å®šå¯¹ QP æœ‰äº†æ›´æ·±çš„äº†è§£ã€‚&lt;/p>
&lt;p>å…¶å®ä½œä¸º RDMA çš„æ ¸å¿ƒæ¦‚å¿µï¼ŒQP çš„å†…å®¹å¾ˆå¤šï¼Œæœ¬æ–‡éš¾ä»¥å…¨éƒ¨å›Šæ‹¬ã€‚æˆ‘å°†åœ¨åé¢çš„æ–‡ç« ä¸­é€æ¸æŠŠç›¸å…³çš„å†…å®¹è¡¥å…¨ï¼Œæ¯”å¦‚ QKey çš„æ¦‚å¿µå°†åœ¨åç»­ä¸“é—¨ä»‹ç»å„ç§ Key çš„æ–‡ç« ä¸­è®²è§£ã€‚&lt;/p>
&lt;p>å¥½äº†ï¼Œæœ¬æ–‡å°±åˆ°è¿™äº†ï¼Œæ„Ÿè°¢é˜…è¯»ã€‚é¢„å‘Šä¸‹ä¸€ç¯‡æ–‡ç« å°†è¯¦ç»†è®²è§£ CQã€‚&lt;/p>
&lt;h2 id="åè®®ç›¸å…³ç« èŠ‚">
&lt;a href="#%e5%8d%8f%e8%ae%ae%e7%9b%b8%e5%85%b3%e7%ab%a0%e8%8a%82" class="header-anchor">#&lt;/a>
åè®®ç›¸å…³ç« èŠ‚
&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>3.5.1 10.2.4 QP çš„åŸºæœ¬æ¦‚å¿µ&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.3 QP çŠ¶æ€æœº&lt;/p>
&lt;/li>
&lt;li>
&lt;p>10.2.5 QP ç›¸å…³çš„è½¯ä»¶æ¥å£&lt;/p>
&lt;/li>
&lt;li>
&lt;p>11.4 Post Send Post Recv&lt;/p>
&lt;/li>
&lt;/ul></description></item><item><title>åŸºäº Workbox å®ç° Hugo æ¸è¿›å¼ Web åº”ç”¨</title><link>https://cuterwrite.top/p/hugo-pwa/</link><pubDate>Tue, 18 Jun 2024 22:28:00 +0000</pubDate><guid>https://cuterwrite.top/p/hugo-pwa/</guid><description>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-16_116406967_p0_master1200.webp" alt="Featured image of post åŸºäº Workbox å®ç° Hugo æ¸è¿›å¼ Web åº”ç”¨" />&lt;h1 id="åŸºäº-workbox-å®ç°-hugo-pwa">
&lt;a href="#%e5%9f%ba%e4%ba%8e-workbox-%e5%ae%9e%e7%8e%b0-hugo-pwa" class="header-anchor">#&lt;/a>
åŸºäº Workbox å®ç° Hugo PWA
&lt;/h1>
&lt;p>æœ€è¿‘ç»™åŸºäº &lt;a class="link" href="https://gohugo.io/" target="_blank" rel="noopener" >Hugo
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æ­å»ºçš„åšå®¢æ·»åŠ äº† PWA åŠŸèƒ½ï¼Œæ˜¾è‘—æå‡äº†åŠ è½½é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒï¼Œç”šè‡³å®ç°äº†ç¦»çº¿è®¿é—®ã€‚è‡³äºå¦‚ä½•å®ç°ï¼Œé‚£ä¹ˆä½ éœ€è¦äº†è§£ &lt;strong>Progressive Web Apps (PWA)&lt;/strong>ã€‚&lt;/p>
&lt;h2 id="ä»€ä¹ˆæ˜¯-pwa">
&lt;a href="#%e4%bb%80%e4%b9%88%e6%98%af-pwa" class="header-anchor">#&lt;/a>
ä»€ä¹ˆæ˜¯ PWA
&lt;/h2>
&lt;p>æ¸è¿›å¼ Web åº”ç”¨ï¼ˆProgressive Web Appsï¼Œç®€ç§° PWAï¼‰åˆ©ç”¨ç°ä»£ Web API å’Œä¼ ç»Ÿçš„æ¸è¿›å¼å¢å¼ºç­–ç•¥ï¼Œæ‰“é€ å‡ºè·¨å¹³å°çš„ Web åº”ç”¨ç¨‹åºã€‚è¿™äº›åº”ç”¨æ— å¤„ä¸åœ¨ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼Œä¸ºç”¨æˆ·å¸¦æ¥åª²ç¾åŸç”Ÿåº”ç”¨çš„ä½“éªŒã€‚&lt;/p>
&lt;p>&lt;strong>PWA çš„ä¼˜åŠ¿ï¼š&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>âš¡ï¸ &lt;strong>æ›´å¿«çš„åŠ è½½é€Ÿåº¦&lt;/strong>: PWA å¯ä»¥ç¼“å­˜é‡è¦èµ„æºï¼Œå³ä½¿ç½‘ç»œçŠ¶å†µä¸ä½³ä¹Ÿèƒ½å¿«é€ŸåŠ è½½ã€‚&lt;/li>
&lt;li>âœˆï¸ &lt;strong>ç¦»çº¿è®¿é—®&lt;/strong>: PWA å¯ä»¥ç¼“å­˜å†…å®¹ï¼Œè®©ç”¨æˆ·å³ä½¿ç¦»çº¿ä¹Ÿèƒ½è®¿é—®å†…å®¹ã€‚&lt;/li>
&lt;li>ğŸ”” &lt;strong>æ¨é€é€šçŸ¥&lt;/strong>: åƒåŸç”Ÿåº”ç”¨ä¸€æ ·ï¼ŒPWA å¯ä»¥å‘ç”¨æˆ·å‘é€æ¨é€é€šçŸ¥ï¼Œæé«˜ç”¨æˆ·å‚ä¸åº¦ã€‚&lt;/li>
&lt;li>ğŸ“± &lt;strong>å®‰è£…åˆ°ä¸»å±å¹•&lt;/strong>: ç”¨æˆ·å¯ä»¥å°†ä½ çš„åº”ç”¨æ·»åŠ åˆ°ç”µè„‘æˆ–æ‰‹æœºæ¡Œé¢ï¼ŒåƒåŸç”Ÿåº”ç”¨ä¸€æ ·æµè§ˆä½ çš„ Web åº”ç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>PWA çš„å®ç°åŸç†æ˜¯ &lt;strong>Service Worker&lt;/strong>ã€‚&lt;strong>Service Worker æ˜¯ä¸€ç§ç‰¹æ®Šçš„ JavaScript èµ„æºï¼Œåœ¨æµè§ˆå™¨åå°ç‹¬ç«‹è¿è¡Œï¼Œå……å½“ç€ç½‘ç»œæµè§ˆå™¨å’Œ Web æœåŠ¡å™¨ä¹‹é—´çš„ä»£ç†ã€‚å®ƒå¯ä»¥æ‹¦æˆªå’Œå¤„ç†ç½‘ç»œè¯·æ±‚ã€ç¼“å­˜èµ„æºä»¥åŠæ¨é€é€šçŸ¥&lt;/strong>ã€‚&lt;/p>
&lt;p>ä¸»æµçš„å‰ç«¯æ¡†æ¶ Vueã€Reactã€Angular éƒ½æä¾›äº†ç›¸åº”çš„ PWA æ’ä»¶ã€‚è€Œå¯¹äº Hugo è¿™æ ·çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰‹åŠ¨æ·»åŠ  &lt;a class="link" href="https://developer.chrome.com/docs/workbox" target="_blank" rel="noopener" >Workbox
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æ¥å®ç° PWA åŠŸèƒ½ã€‚&lt;/p>
&lt;h2 id="workbox">
&lt;a href="#workbox" class="header-anchor">#&lt;/a>
Workbox
&lt;/h2>
&lt;p>&lt;a class="link" href="https://developer.chrome.com/docs/workbox" target="_blank" rel="noopener" >Workbox
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
æ˜¯ç”± Google Chrome å›¢é˜Ÿå¼€å‘çš„ä¸€å¥—æ¨¡å—ï¼Œæ—¨åœ¨ç®€åŒ–å¸¸è§çš„ Service Worker è·¯ç”±å’Œç¼“å­˜æ“ä½œã€‚æ¯ä¸ªæ¨¡å—éƒ½é’ˆå¯¹ Service Worker å¼€å‘çš„ç‰¹å®šæ–¹é¢è¿›è¡Œäº†ä¼˜åŒ–ã€‚Workbox çš„ç›®æ ‡æ˜¯å°½å¯èƒ½ç®€åŒ– Service Worker çš„ä½¿ç”¨ï¼ŒåŒæ—¶åœ¨éœ€è¦æ—¶çµæ´»åœ°æ»¡è¶³å¤æ‚åº”ç”¨çš„éœ€æ±‚ã€‚&lt;/p>
&lt;p>å¦‚æœæ²¡æœ‰ Workboxï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç¼–å†™ Service Worker æ¥ç›‘å¬ fetch äº‹ä»¶ã€ç¼“å­˜èµ„æºå¹¶å®ç°ç¦»çº¿è®¿é—®ç­‰åŠŸèƒ½ã€‚è€Œ Workbox æä¾›äº†ä¸€å¥—å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆ Service Workerï¼Œå¹¶ä¸”å†…ç½®äº†ä¸€äº›å¸¸ç”¨çš„ç¼“å­˜ç­–ç•¥ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚&lt;/p>
&lt;h2 id="é…ç½®-pwa">
&lt;a href="#%e9%85%8d%e7%bd%ae-pwa" class="header-anchor">#&lt;/a>
é…ç½® PWA
&lt;/h2>
&lt;p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† PWA çš„æ¦‚å¿µå’Œä¼˜åŠ¿ï¼Œä»¥åŠ Workbox å¦‚ä½•ç®€åŒ– Service Worker çš„å¼€å‘ã€‚æ¥ä¸‹æ¥å°†ä¸€æ­¥æ­¥åœ°ç»™ Hugo åšå®¢é…ç½® PWA åŠŸèƒ½ã€‚&lt;/p>
&lt;h3 id="æ³¨å†Œ-service-worker">
&lt;a href="#%e6%b3%a8%e5%86%8c-service-worker" class="header-anchor">#&lt;/a>
æ³¨å†Œ Service Worker
&lt;/h3>
&lt;p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨é¡µé¢ä¸­æ³¨å†Œ Service Workerã€‚å°†ä»¥ä¸‹ä»£ç æ®µæ·»åŠ åˆ°ä½ çš„ Hugo ä¸»é¢˜çš„ &lt;code>layouts/partials/footer/custom.html&lt;/code> æ–‡ä»¶ä¸­ï¼ˆå…¶ä»–ä¸»é¢˜å¯èƒ½éœ€è¦æ ¹æ®æ–‡ä»¶ç»“æ„è¿›è¡Œè°ƒæ•´ï¼‰ï¼š&lt;/p>
&lt;pre>&lt;code class="language-javascript">&amp;lt;script&amp;gt;
// Check that service workers are registered
if ('serviceWorker' in navigator) {
// Use the window load event to keep the page load performant
window.addEventListener('load', () =&amp;gt; {
navigator.serviceWorker.register('/sw.js').then(reg =&amp;gt; {
console.log('Service worker registered with scope: ', reg.scope);
}, err =&amp;gt; {
console.log('Service worker registration failed: ', err);
});
});
}
&amp;lt;/script&amp;gt;
&lt;/code>&lt;/pre>
&lt;blockquote class="alert-blockquote alert-note">
&lt;p class="alert-heading">
&lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
&lt;path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z">&lt;/path>
&lt;/svg>
&lt;span>æ³¨é‡Š&lt;/span>
&lt;/p>
&lt;p>æ³¨æ„ï¼š åœ¨æ³¨å†Œ Service Worker ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆåˆ›å»º &lt;code>sw.js&lt;/code> æ–‡ä»¶ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€å°èŠ‚ä¸­å®Œæˆè¿™ä¸€æ­¥éª¤ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>å®Œæˆæ³¨å†Œåï¼Œä½ å¯ä»¥åœ¨æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…· (F12) ä¸­çš„ &lt;strong>&amp;ldquo;Application&amp;rdquo; -&amp;gt; &amp;ldquo;Service Workers&amp;rdquo;&lt;/strong> é¢æ¿ä¸­æŸ¥çœ‹ Service Worker çš„æ³¨å†ŒçŠ¶æ€ã€‚&lt;/p>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-19_service-worker.webp"
alt="Service Worker" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>Service Worker&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;h3 id="å¯¼å…¥-workbox">
&lt;a href="#%e5%af%bc%e5%85%a5-workbox" class="header-anchor">#&lt;/a>
å¯¼å…¥ Workbox
&lt;/h3>
&lt;p>åœ¨ä½ çš„ Hugo ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„ &lt;code>static&lt;/code> æ–‡ä»¶å¤¹ä¸­åˆ›å»º &lt;code>sw.js&lt;/code> æ–‡ä»¶ã€‚ç„¶åï¼Œåœ¨ &lt;code>sw.js&lt;/code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œä½¿ç”¨ CDN å¯¼å…¥ Workboxï¼š&lt;/p>
&lt;pre>&lt;code class="language-javascript">importScripts('https://cdn.bootcdn.net/ajax/libs/workbox-sw/7.1.0/workbox-sw.js');
&lt;/code>&lt;/pre>
&lt;h3 id="ç¼“å­˜ç­–ç•¥">
&lt;a href="#%e7%bc%93%e5%ad%98%e7%ad%96%e7%95%a5" class="header-anchor">#&lt;/a>
ç¼“å­˜ç­–ç•¥
&lt;/h3>
&lt;p>Workbox æä¾›äº†ä¸€äº›å¸¸ç”¨çš„ç¼“å­˜ç­–ç•¥ï¼Œå¦‚ &lt;code>CacheFirst&lt;/code>ã€&lt;code>NetworkFirst&lt;/code>ã€&lt;code>StaleWhileRevalidate&lt;/code> ç­‰ã€‚è¿™é‡Œå…ˆä»‹ç»å‡ ç§å¸¸ç”¨çš„ç­–ç•¥ã€‚&lt;/p>
&lt;h4 id="cacheonly-ä»…ç¼“å­˜">
&lt;a href="#cacheonly-%e4%bb%85%e7%bc%93%e5%ad%98" class="header-anchor">#&lt;/a>
CacheOnly ä»…ç¼“å­˜
&lt;/h4>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-19_cache-6850d07d742bf_1440.webp"
alt="CacheOnly" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>CacheOnly&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>å¼ºåˆ¶å“åº”æ¥è‡ªç¼“å­˜ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.CacheOnly()
);
&lt;/code>&lt;/pre>
&lt;h4 id="networkonly-ä»…ç½‘ç»œ">
&lt;a href="#networkonly-%e4%bb%85%e7%bd%91%e7%bb%9c" class="header-anchor">#&lt;/a>
NetworkOnly ä»…ç½‘ç»œ
&lt;/h4>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-19_network-48f46158a5575_1440.webp"
alt="NetworkOnly" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>NetworkOnly&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>è¿™ç§ç¼“å­˜ç­–ç•¥å¼ºåˆ¶è¦æ±‚æ‰€æœ‰è¯·æ±‚éƒ½ä»ç½‘ç»œè·å–æœ€æ–°æ•°æ®ï¼Œå®Œå…¨ç»•è¿‡ç¼“å­˜ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.NetworkOnly()
);
&lt;/code>&lt;/pre>
&lt;h4 id="cachefirst-ä¼˜å…ˆç¼“å­˜">
&lt;a href="#cachefirst-%e4%bc%98%e5%85%88%e7%bc%93%e5%ad%98" class="header-anchor">#&lt;/a>
CacheFirst ä¼˜å…ˆç¼“å­˜
&lt;/h4>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-19_cache-falling-to-networ-f4c1aa5570621_1440.webp"
alt="CacheFirst" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>CacheFirst&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>è¿™ç§ç¼“å­˜ç­–ç•¥ä»¥é€Ÿåº¦ä¸ºä¼˜å…ˆï¼Œä¼šé¦–å…ˆå°è¯•ä»ç¼“å­˜ä¸­è·å–å“åº”ï¼Œä»¥å°½å¿«å‘ç”¨æˆ·æ˜¾ç¤ºå†…å®¹ã€‚å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰æ‰€éœ€æ•°æ®ï¼Œå®ƒæ‰ä¼šå‘ç½‘ç»œå‘èµ·è¯·æ±‚è·å–æ•°æ®ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.CacheFirst()
);
&lt;/code>&lt;/pre>
&lt;h4 id="networkfirst-ä¼˜å…ˆç½‘ç»œ">
&lt;a href="#networkfirst-%e4%bc%98%e5%85%88%e7%bd%91%e7%bb%9c" class="header-anchor">#&lt;/a>
NetworkFirst ä¼˜å…ˆç½‘ç»œ
&lt;/h4>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-19_network-falling-to-cache-39d267a044b35_1440.webp"
alt="NetworkFirst" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>NetworkFirst&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>è¿™ç§ç¼“å­˜ç­–ç•¥ä¼˜å…ˆä½¿ç”¨æœ€æ–°æ•°æ®ï¼Œå› æ­¤ä¼šé¦–å…ˆå°è¯•ä»ç½‘ç»œè·å–å“åº”ã€‚å¦‚æœç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œä¾‹å¦‚ç”¨æˆ·ç¦»çº¿æˆ–ç½‘ç»œè¿æ¥ä¸ç¨³å®šï¼Œå®ƒä¼šå›é€€ä½¿ç”¨ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œç¡®ä¿ç”¨æˆ·ä»ç„¶å¯ä»¥è®¿é—®å†…å®¹ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.NetworkFirst()
);
&lt;/code>&lt;/pre>
&lt;h4 id="stalewhilerevalidate-è¯»å–ç¼“å­˜åŒæ—¶å‘èµ·ç½‘ç»œè¯·æ±‚">
&lt;a href="#stalewhilerevalidate-%e8%af%bb%e5%8f%96%e7%bc%93%e5%ad%98%e5%90%8c%e6%97%b6%e5%8f%91%e8%b5%b7%e7%bd%91%e7%bb%9c%e8%af%b7%e6%b1%82" class="header-anchor">#&lt;/a>
StaleWhileRevalidate è¯»å–ç¼“å­˜ï¼ŒåŒæ—¶å‘èµ·ç½‘ç»œè¯·æ±‚
&lt;/h4>
&lt;figure>&lt;img src="https://cloud.cuterwrite.fun/img/2024-06-19_cache-network-873b1ec5f25cc_1440.webp"
alt="StaleWhileRevalidate" width="90%" loading="lazy">&lt;figcaption>
&lt;h4>StaleWhileRevalidate&lt;/h4>
&lt;/figcaption>
&lt;/figure>
&lt;p>è¿™ç§ç¼“å­˜ç­–ç•¥ä¼˜å…ˆè¿”å›ç¼“å­˜å†…å®¹ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚å³ä½¿ç¼“å­˜å†…å®¹æœ‰æ•ˆï¼Œå®ƒä¹Ÿä¼šåœ¨åå°å‘èµ·ç½‘ç»œè¯·æ±‚ä»¥è·å–æœ€æ–°æ•°æ®ï¼Œä¿è¯ç”¨æˆ·æœ€ç»ˆèƒ½çœ‹åˆ°æœ€æ–°å†…å®¹ã€‚è™½ç„¶è¿™ç§ç­–ç•¥èƒ½ç¡®ä¿ç”¨æˆ·å®šæœŸæ›´æ–°ç¼“å­˜ï¼Œä½†ä¹Ÿæ„å‘³ç€æ¯æ¬¡è¯·æ±‚éƒ½ä¼šäº§ç”Ÿç½‘ç»œæµé‡ï¼Œå³ä½¿æ•°æ®æ²¡æœ‰å˜åŒ–ï¼Œä¹Ÿæ¯”è¾ƒæµªè´¹å¸¦å®½ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.StaleWhileRevalidate()
);
&lt;/code>&lt;/pre>
&lt;h4 id="ç­–ç•¥é…ç½®">
&lt;a href="#%e7%ad%96%e7%95%a5%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
ç­–ç•¥é…ç½®
&lt;/h4>
&lt;p>Workbox ä¸ä»…æä¾›ä¸Šè¿°ç­–ç•¥ï¼Œè¿˜å…è®¸é€šè¿‡ cacheNameã€plugins å’Œ expiration ç­‰é…ç½®é¡¹è¿›è¡Œè‡ªå®šä¹‰ã€‚ä½ å¯ä»¥é€šè¿‡å®šä¹‰è¦ä½¿ç”¨çš„æ’ä»¶æ¥è‡ªå®šä¹‰è·¯ç”±è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥é…ç½®ç¼“å­˜åç§°ã€ç¼“å­˜æœ‰æ•ˆæœŸä»¥åŠå¯ç¼“å­˜çš„å“åº”çŠ¶æ€ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp(regex),
new workbox.strategies.CacheFirst({
cacheName: 'my-cache',
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: 60,
maxAgeSeconds: 30 * 24 * 60 * 60, // 30 Days
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h3 id="æœ¬ç«™é…ç½®">
&lt;a href="#%e6%9c%ac%e7%ab%99%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
æœ¬ç«™é…ç½®
&lt;/h3>
&lt;h4 id="å…¨å±€é…ç½®">
&lt;a href="#%e5%85%a8%e5%b1%80%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
å…¨å±€é…ç½®
&lt;/h4>
&lt;p>ä»¥ä¸‹æ˜¯å…¨å±€ç¼“å­˜é…ç½®ï¼š&lt;/p>
&lt;pre>&lt;code class="language-javascript">// ç¼“å­˜ç‰ˆæœ¬å·
let cacheVersion = '-240619';
// æœ€å¤§æ¡ç›®æ•°
const maxEntries = 100;
&lt;/code>&lt;/pre>
&lt;h4 id="twitto-é…ç½®">
&lt;a href="#twitto-%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
Twitto é…ç½®
&lt;/h4>
&lt;p>ä¸ºäº†ç¡®ä¿ç”¨æˆ·å³ä½¿åœ¨ç¦»çº¿çŠ¶æ€ä¸‹ä¹Ÿèƒ½æŸ¥çœ‹è¯„è®ºï¼ŒTwitto è¯„è®º API é‡‡ç”¨äº† &lt;code>NetworkFirst&lt;/code> ç¼“å­˜ç­–ç•¥ã€‚è¿™æ„å‘³ç€æµè§ˆå™¨ä¼šä¼˜å…ˆå°è¯•ä»ç½‘ç»œè·å–æœ€æ–°æ•°æ®ï¼Œå¦‚æœç½‘ç»œä¸å¯ç”¨ï¼Œåˆ™ä½¿ç”¨ç¼“å­˜ä¸­çš„æ•°æ®ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('^https://comment\.cuterwrite\.top'),
new workbox.strategies.NetworkFirst({
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="rss-ä¸-sitemap-é…ç½®">
&lt;a href="#rss-%e4%b8%8e-sitemap-%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
RSS ä¸ Sitemap é…ç½®
&lt;/h4>
&lt;p>ä¸ºäº†ç¡®ä¿ç”¨æˆ·å§‹ç»ˆè·å–æœ€æ–°çš„ RSS å’Œ Sitemap æ•°æ®ï¼Œè¿™äº›é¡µé¢é…ç½®ä¸ºä»…ä½¿ç”¨ç½‘ç»œç­–ç•¥ (&lt;code>NetworkOnly&lt;/code>)ï¼Œä¸è¿›è¡Œç¼“å­˜ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('^https://cuterwrite\.top/(index|sitemap)\.xml'),
new workbox.strategies.NetworkOnly()
);
&lt;/code>&lt;/pre>
&lt;h4 id="html-é…ç½®">
&lt;a href="#html-%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
HTML é…ç½®
&lt;/h4>
&lt;p>ä¸ºäº†åœ¨ä¿è¯ç”¨æˆ·å¿«é€ŸåŠ è½½é¡µé¢çš„åŒæ—¶ï¼Œä¹Ÿèƒ½è·å–åˆ°æœ€æ–°å†…å®¹ï¼Œç½‘ç«™å¯¹ HTML é¡µé¢é‡‡ç”¨äº† &lt;code>StaleWhileRevalidate&lt;/code> ç¼“å­˜ç­–ç•¥ã€‚è¿™æ„å‘³ç€æµè§ˆå™¨ä¼šä¼˜å…ˆä½¿ç”¨ç¼“å­˜ä¸­çš„é¡µé¢è¿›è¡Œå±•ç¤ºï¼ŒåŒæ—¶åœ¨åå°å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œè·å–æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶åœ¨ä¸‹æ¬¡è¯·æ±‚æ—¶ä½¿ç”¨ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('.*\.html'),
new workbox.strategies.StaleWhileRevalidate({
cacheName: 'html-cache' + cacheVersion,
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="google-fonts-é…ç½®">
&lt;a href="#google-fonts-%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
Google Fonts é…ç½®
&lt;/h4>
&lt;p>ä¸ºäº†åœ¨ä¿è¯å­—ä½“æ–‡ä»¶æ›´æ–°çš„åŒæ—¶ï¼Œä¹Ÿèƒ½åˆ©ç”¨ç¼“å­˜åŠ é€Ÿé¡µé¢åŠ è½½é€Ÿåº¦ï¼Œç½‘ç«™å¯¹ Google Fonts èµ„æºé‡‡ç”¨äº† &lt;code>CacheFirst&lt;/code> ç¼“å­˜ç­–ç•¥ï¼Œå¹¶è®¾ç½®äº†è¾ƒé•¿çš„ç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('.*\.(?:woff|woff2|ttf|otf|eot)'),
new workbox.strategies.StaleWhileRevalidate({
cacheName: 'google-fonts' + cacheVersion,
plugins: [
// ä½¿ç”¨ expiration æ’ä»¶å®ç°ç¼“å­˜æ¡ç›®æ•°ç›®å’Œæ—¶é—´æ§åˆ¶
new workbox.expiration.ExpirationPlugin({
// æœ€å¤§ç¼“å­˜æ¡ç›®æ•°
maxEntries: maxEntries,
// æœ€é•¿ç¼“å­˜æ—¶é—´ 30 å¤©
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
// ä½¿ç”¨ cacheableResponse æ’ä»¶ç¼“å­˜çŠ¶æ€ç ä¸º 0 çš„è¯·æ±‚
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="cdn-é…ç½®">
&lt;a href="#cdn-%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
CDN é…ç½®
&lt;/h4>
&lt;p>ä¸ºäº†æœ€å¤§ç¨‹åº¦åœ°åˆ©ç”¨ç¼“å­˜åŠ é€Ÿé¡µé¢åŠ è½½é€Ÿåº¦ï¼Œç½‘ç«™å¯¹æ¥è‡ªå¸¸ç”¨ CDN çš„èµ„æºé‡‡ç”¨äº† &lt;code>CacheFirst&lt;/code> ç¼“å­˜ç­–ç•¥ï¼Œå¹¶è®¾ç½®äº†è¾ƒé•¿çš„ç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('^https://(?:cdn\.bootcdn\.net|unpkg\.com|cdn\.jsdelivr\.net)'),
new workbox.strategies.CacheFirst({
cacheName: 'cdn' + cacheVersion,
fetchOptions: {
mode: 'cors',
credentials: 'omit',
},
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="umani-ç½‘ç«™ç»Ÿè®¡é…ç½®">
&lt;a href="#umani-%e7%bd%91%e7%ab%99%e7%bb%9f%e8%ae%a1%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
Umani ç½‘ç«™ç»Ÿè®¡é…ç½®
&lt;/h4>
&lt;p>ä¸ºäº†ç¡®ä¿ç½‘ç«™ç»Ÿè®¡æ•°æ®çš„å‡†ç¡®æ€§ï¼Œç½‘ç«™å¯¹ Umani ç½‘ç«™ç»Ÿè®¡è¯·æ±‚é‡‡ç”¨äº† &lt;code>NetworkOnly&lt;/code> ç­–ç•¥ï¼Œå¹¶ä½¿ç”¨ &lt;code>BackgroundSyncPlugin&lt;/code> æ’ä»¶æ¥å®ç°å³ä½¿åœ¨ç½‘ç»œç¦»çº¿çš„æƒ…å†µä¸‹ä¹Ÿèƒ½ä¿è¯æ•°æ®æœ€ç»ˆå‘é€æˆåŠŸã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('^https://analytics\.cuterwrite\.top/uma'),
new workbox.strategies.NetworkOnly({
plugins: [
// ä½¿ç”¨ background sync æ’ä»¶å®ç°åå°åŒæ­¥
new workbox.backgroundSync.BackgroundSyncPlugin('Optical_Collect', {
maxRetentionTime: 12 * 60,
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="å›¾ç‰‡é…ç½®">
&lt;a href="#%e5%9b%be%e7%89%87%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
å›¾ç‰‡é…ç½®
&lt;/h4>
&lt;p>ä¸ºäº†åŠ é€Ÿå›¾ç‰‡åŠ è½½é€Ÿåº¦ï¼Œå¹¶å‡å°‘ç½‘ç»œè¯·æ±‚æ¬¡æ•°ï¼Œç½‘ç«™å¯¹å›¾ç‰‡èµ„æºé‡‡ç”¨äº† &lt;code>CacheFirst&lt;/code> ç¼“å­˜ç­–ç•¥ï¼Œå¹¶è®¾ç½®äº†è¾ƒé•¿çš„ç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('^(https://cuterwrite-1302252842\.file\.myqcloud\.com|https://s2\.loli\.net)'),
new workbox.strategies.CacheFirst({
cacheName: 'image-cache' + cacheVersion,
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
&lt;/code>&lt;/pre>
&lt;h4 id="åç¼€åŒ¹é…é…ç½®">
&lt;a href="#%e5%90%8e%e7%bc%80%e5%8c%b9%e9%85%8d%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
åç¼€åŒ¹é…é…ç½®
&lt;/h4>
&lt;p>ä¸ºäº†å…¼é¡¾åŠ è½½é€Ÿåº¦å’Œå†…å®¹æ›´æ–°ï¼Œç½‘ç«™å¯¹æœªè¢«åŸŸååŒ¹é…åˆ°çš„é™æ€æ–‡ä»¶ï¼ˆä¾‹å¦‚å›¾ç‰‡ã€CSS å’Œ JavaScript æ–‡ä»¶ï¼‰é‡‡ç”¨äº† &lt;code>StaleWhileRevalidate&lt;/code> ç¼“å­˜ç­–ç•¥ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.registerRoute(
new RegExp('.*\.(?:png|jpg|jpeg|svg|gif|webp|ico)'),
new workbox.strategies.StaleWhileRevalidate()
);
workbox.routing.registerRoute(
new RegExp('.*\.(css|js)'),
new workbox.strategies.StaleWhileRevalidate()
);
&lt;/code>&lt;/pre>
&lt;h4 id="é»˜è®¤è¡Œä¸ºé…ç½®">
&lt;a href="#%e9%bb%98%e8%ae%a4%e8%a1%8c%e4%b8%ba%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
é»˜è®¤è¡Œä¸ºé…ç½®
&lt;/h4>
&lt;p>ä¸ºäº†å¤„ç†æœªè¢«ä»»ä½•è‡ªå®šä¹‰è·¯ç”±è§„åˆ™åŒ¹é…åˆ°çš„è¯·æ±‚ï¼Œç½‘ç«™é…ç½®äº†é»˜è®¤ç¼“å­˜è¡Œä¸ºï¼Œä½¿ç”¨ &lt;code>NetworkFirst&lt;/code> ç­–ç•¥å¹¶è®¾ç½®äº†ç½‘ç»œè¶…æ—¶æ—¶é—´ï¼Œä»¥å…¼é¡¾èµ„æºè·å–é€Ÿåº¦å’Œç¦»çº¿å¯ç”¨æ€§ã€‚&lt;/p>
&lt;pre>&lt;code class="language-javascript">workbox.routing.setDefaultHandler(
// ä¼˜å…ˆä½¿ç”¨ç¼“å­˜ï¼Œç¼“å­˜æ²¡æœ‰åˆ™ä½¿ç”¨ç½‘ç»œè¯·æ±‚
new workbox.strategies.NetworkFirst({
networkTimeoutSeconds: 3,
})
);
&lt;/code>&lt;/pre>
&lt;h3 id="å®Œæ•´é…ç½®">
&lt;a href="#%e5%ae%8c%e6%95%b4%e9%85%8d%e7%bd%ae" class="header-anchor">#&lt;/a>
å®Œæ•´é…ç½®
&lt;/h3>
&lt;details>
&lt;summary>sw.js&lt;/summary>
&lt;pre>&lt;code class="language-javascript">importScripts('https://cdn.bootcdn.net/ajax/libs/workbox-sw/7.1.0/workbox-sw.js');
// ç¼“å­˜ç‰ˆæœ¬å·
let cacheVersion = '-240619';
// æœ€å¤§æ¡ç›®æ•°
const maxEntries = 100;
if (workbox) {
console.log(`Yay! Workbox is loaded ğŸ‰`);
// è¯„è®ºç¼“å­˜
workbox.routing.registerRoute(
new RegExp('^https://comment\.cuterwrite\.top'),
new workbox.strategies.NetworkFirst({
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
// rss ã€sitemap ä¸ç¼“å­˜
workbox.routing.registerRoute(
new RegExp('^https://cuterwrite\.top/(index|sitemap)\.xml'),
new workbox.strategies.NetworkOnly()
);
// ç¼“å­˜ HTML
workbox.routing.registerRoute(
new RegExp('.*\.html'),
new workbox.strategies.StaleWhileRevalidate({
cacheName: 'html-cache' + cacheVersion,
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
// ç¼“å­˜ Google Fonts
workbox.routing.registerRoute(
new RegExp('.*\.(?:woff|woff2|ttf|otf|eot)'),
new workbox.strategies.StaleWhileRevalidate({
cacheName: 'google-fonts' + cacheVersion,
plugins: [
// ä½¿ç”¨ expiration æ’ä»¶å®ç°ç¼“å­˜æ¡ç›®æ•°ç›®å’Œæ—¶é—´æ§åˆ¶
new workbox.expiration.ExpirationPlugin({
// æœ€å¤§ç¼“å­˜æ¡ç›®æ•°
maxEntries: maxEntries,
// æœ€é•¿ç¼“å­˜æ—¶é—´ 30 å¤©
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
// ä½¿ç”¨ cacheableResponse æ’ä»¶ç¼“å­˜çŠ¶æ€ç ä¸º 0 çš„è¯·æ±‚
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
// ç¼“å­˜ bootcdnã€unpkgã€jsdelivr ç­‰å…¬å…±åº“ï¼Œç”¨æ­£åˆ™åŒ¹é…
workbox.routing.registerRoute(
new RegExp('^https://(?:cdn\.bootcdn\.net|unpkg\.com|cdn\.jsdelivr\.net)'),
new workbox.strategies.CacheFirst({
cacheName: 'cdn' + cacheVersion,
fetchOptions: {
mode: 'cors',
credentials: 'omit',
},
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
],
})
);
// è‡ªå»º UMA ç»Ÿè®¡è„šæœ¬: https://analytics.cuterwrite.top/uma
workbox.routing.registerRoute(
new RegExp('^https://analytics\.cuterwrite\.top/uma'),
new workbox.strategies.NetworkOnly({
plugins: [
// ä½¿ç”¨ background sync æ’ä»¶å®ç°åå°åŒæ­¥
new workbox.backgroundSync.BackgroundSyncPlugin('Optical_Collect', {
maxRetentionTime: 12 * 60,
}),
],
})
);
// ç¼“å­˜å­˜å‚¨æ¡¶å›¾ç‰‡ https://cloud.cuterwrite.fun/
workbox.routing.registerRoute(
new RegExp('^(https://cuterwrite-1302252842\.file\.myqcloud\.com|https://s2\.loli\.net)'),
new workbox.strategies.CacheFirst({
cacheName: 'image-cache' + cacheVersion,
plugins: [
new workbox.expiration.ExpirationPlugin({
maxEntries: maxEntries,
maxAgeSeconds: 30 * 24 * 60 * 60,
}),
new workbox.cacheableResponse.CacheableResponsePlugin({
statuses: [0, 200],
}),
],
})
);
// åç¼€åŒ¹é…ï¼Œé’ˆå¯¹å…¶ä½™æ²¡æœ‰è¢«åŸŸååŒ¹é…åˆ°çš„é™æ€æ–‡ä»¶
workbox.routing.registerRoute(
new RegExp('.*\.(?:png|jpg|jpeg|svg|gif|webp|ico)'),
new workbox.strategies.StaleWhileRevalidate()
);
workbox.routing.registerRoute(
new RegExp('.*\.(css|js)'),
new workbox.strategies.StaleWhileRevalidate()
);
// é»˜è®¤åŒ¹é…å‰©ä¸‹çš„è¯·æ±‚
workbox.routing.setDefaultHandler(
// ä¼˜å…ˆä½¿ç”¨ç¼“å­˜ï¼Œç¼“å­˜æ²¡æœ‰åˆ™ä½¿ç”¨ç½‘ç»œè¯·æ±‚
new workbox.strategies.NetworkFirst({
networkTimeoutSeconds: 3,
})
);
} else {
console.log(`Boo! Workbox didn't load ğŸ˜¬`);
}
&lt;/code>&lt;/pre>
&lt;/details>
&lt;h3 id="manifestjson">
&lt;a href="#manifestjson" class="header-anchor">#&lt;/a>
manifest.json
&lt;/h3>
&lt;ol>
&lt;li>&lt;strong>åˆ›å»º manifest.json æ–‡ä»¶&lt;/strong>&lt;/li>
&lt;/ol>
&lt;p>åœ¨ä½ çš„ Hugo åšå®¢çš„æ ¹ç›®å½• &lt;code>static&lt;/code> æ–‡ä»¶å¤¹ä¸‹åˆ›å»º &lt;code>manifest.json&lt;/code> æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«äº†å…³äºä½ çš„åšå®¢çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚åç§°ã€å›¾æ ‡å’Œæ˜¾ç¤ºé€‰é¡¹ã€‚&lt;/p>
&lt;pre>&lt;code class="language-json">{
&amp;quot;name&amp;quot;: &amp;quot;ä½ çš„åšå®¢åç§°&amp;quot;,
&amp;quot;short_name&amp;quot;: &amp;quot;åšå®¢ç®€ç§°&amp;quot;,
&amp;quot;start_url&amp;quot;: &amp;quot;/&amp;quot;,
&amp;quot;display&amp;quot;: &amp;quot;standalone&amp;quot;,
&amp;quot;background_color&amp;quot;: &amp;quot;#ffffff&amp;quot;,
&amp;quot;theme_color&amp;quot;: &amp;quot;#000000&amp;quot;,
&amp;quot;icons&amp;quot;: [{
&amp;quot;src&amp;quot;: &amp;quot;/icon-192x192.png&amp;quot;,
&amp;quot;sizes&amp;quot;: &amp;quot;192x192&amp;quot;,
&amp;quot;type&amp;quot;: &amp;quot;image/png&amp;quot;
},
{
&amp;quot;src&amp;quot;: &amp;quot;/icon-512x512.png&amp;quot;,
&amp;quot;sizes&amp;quot;: &amp;quot;512x512&amp;quot;,
&amp;quot;type&amp;quot;: &amp;quot;image/png&amp;quot;
}
]
}
&lt;/code>&lt;/pre>
&lt;blockquote class="alert-blockquote alert-note">
&lt;p class="alert-heading">
&lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16">
&lt;path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z">&lt;/path>
&lt;/svg>
&lt;span>æ³¨é‡Š&lt;/span>
&lt;/p>
&lt;p>æ³¨æ„ï¼šå°† icon-192x192.png å’Œ icon-512x512.png æ›¿æ¢ä¸ºä½ è‡ªå·±çš„å›¾æ ‡æ–‡ä»¶åã€‚å¹¶ç¡®ä¿å°†è¿™ä¸¤ä¸ªå›¾æ ‡æ–‡ä»¶æ”¾ç½®åœ¨ Hugo åšå®¢çš„ &lt;code>static&lt;/code> æ–‡ä»¶å¤¹ä¸­ã€‚å¦‚æœä½ æƒ³ä¿®æ”¹ä¸»é¢˜é¢œè‰²å’ŒèƒŒæ™¯é¢œè‰²ï¼Œå¯ä»¥ä¿®æ”¹ theme_color å’Œ background_color å­—æ®µã€‚&lt;/p>
&lt;/blockquote>
&lt;ol start="2">
&lt;li>&lt;strong>é“¾æ¥ manifest.json æ–‡ä»¶&lt;/strong>&lt;/li>
&lt;/ol>
&lt;p>åœ¨ä½ çš„ Hugo åšå®¢çš„ &lt;code>layouts/partials/head/custom.html&lt;/code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œå°† &lt;code>manifest.json&lt;/code> æ–‡ä»¶é“¾æ¥åˆ°ä½ çš„ç½‘ç«™ï¼š&lt;/p>
&lt;pre>&lt;code class="language-html">&amp;lt;link rel=&amp;quot;manifest&amp;quot; href=&amp;quot;/manifest.json&amp;quot;&amp;gt;
&lt;/code>&lt;/pre>
&lt;p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œä½ çš„ Hugo åšå®¢å°±å…·å¤‡äº† PWA åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥åƒä½¿ç”¨åŸç”Ÿåº”ç”¨ç¨‹åºä¸€æ ·è®¿é—®ä½ çš„ç½‘ç«™ã€‚&lt;/p>
&lt;h2 id="å‚è€ƒèµ„æ–™">
&lt;a href="#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99" class="header-anchor">#&lt;/a>
å‚è€ƒèµ„æ–™
&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>&lt;a class="link" href="https://web.dev/articles/offline-cookbook?hl=zh-cn" target="_blank" rel="noopener" >ç¦»çº¿å®æˆ˜å®å…¸
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a class="link" href="https://developers.google.com/web/tools/workbox" target="_blank" rel="noopener" >Workbox
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a class="link" href="https://github.com/GoogleChrome/workbox" target="_blank" rel="noopener" >Workbox Github
&lt;span style="white-space: nowrap;">&lt;svg width=".8em" height=".8em" viewBox="0 0 21 21"
xmlns="http://www.w3.org/2000/svg">
&lt;path d="m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z" fill="currentColor" />
&lt;path d="M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z"
fill="currentColor">
&lt;/svg>&lt;/span>
&lt;/a>
&lt;/p>
&lt;/li>
&lt;/ul></description></item></channel></rss>