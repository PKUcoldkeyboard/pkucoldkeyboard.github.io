<!DOCTYPE html>
<html lang="zh-cn">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='hadoop haé›†ç¾¤'><title>Hadoop3 HAæ¨¡å¼ä¸‰èŠ‚ç‚¹é«˜å¯ç”¨é›†ç¾¤æ­å»ºå®éªŒ</title>

<link rel='canonical' href='https://cuterwrite.top/p/hadoop-ha/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='Hadoop3 HAæ¨¡å¼ä¸‰èŠ‚ç‚¹é«˜å¯ç”¨é›†ç¾¤æ­å»ºå®éªŒ'>
<meta property='og:description' content='hadoop haé›†ç¾¤'>
<meta property='og:url' content='https://cuterwrite.top/p/hadoop-ha/'>
<meta property='og:site_name' content='cuterwrite'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Hadoop' /><meta property='article:published_time' content='2022-09-22T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2022-09-22T00:00:00&#43;00:00'/><meta property='og:image' content='https://cuterwrite-1302252842.file.myqcloud.com/typora/32756284e8854b9ba653bd3632af435d.jpg' />
<meta name="twitter:title" content="Hadoop3 HAæ¨¡å¼ä¸‰èŠ‚ç‚¹é«˜å¯ç”¨é›†ç¾¤æ­å»ºå®éªŒ">
<meta name="twitter:description" content="hadoop haé›†ç¾¤"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://cuterwrite-1302252842.file.myqcloud.com/typora/32756284e8854b9ba653bd3632af435d.jpg' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.body.dataset.scheme = 'dark';
        } else {
            document.body.dataset.scheme = 'light';
        }
    })();
</script><div class="container main-container flex on-phone--column extended article-page with-toolbar">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hue4d14694a57c01a222a16c47db12c89c_369633_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                

                
                    <span class="emoji">ğŸ˜‰</span>
                
            </figure>
        
        <h1 class="site-name"><a href="https://cuterwrite.top">cuterwrite</a></h1>
        <h2 class="site-description">æ¬¢è¿æ¥åˆ°æˆ‘çš„ä¸ªäººåšå®¢ã€‚æˆ‘æ˜¯cuterwriteï¼Œä¸€ä¸ªçƒ­çˆ±ç”Ÿæ´»ã€ä¸æ–­æ¢ç´¢çš„äººã€‚åœ¨è¿™é‡Œï¼Œæˆ‘åˆ†äº«æˆ‘çš„æƒ³æ³•ã€ç»éªŒå’Œå­¦ä¹ ï¼Œå¸Œæœ›å¯ä»¥å¸®åŠ©åˆ°ä½ ï¼Œä¹Ÿæ¬¢è¿ä½ ä¸æˆ‘åˆ†äº«ä½ çš„çœ‹æ³•ã€‚</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>é¦–é¡µ</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>ä¸ªäºº</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>æ–‡ç« </span>
            </a>
        </li>
        
        

        <li >
            <a href='/tags'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11 3L20 12a1.5 1.5 0 0 1 0 2L14 20a1.5 1.5 0 0 1 -2 0L3 11v-4a4 4 0 0 1 4 -4h4" />
  <circle cx="9" cy="9" r="2" />
</svg>



                
                <span>æ ‡ç­¾</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        

        
            <li id="dark-mode-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                <span>æš—è‰²æ¨¡å¼</span>
            </li>
        
    </ol>
</aside>

            <main class="main full-width">
    <div id="article-toolbar">
        <a href="https://cuterwrite.top" class="back-home">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



            <span>Back</span>
        </a>
    </div>

    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/hadoop-ha/">
                
                    <img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/32756284e8854b9ba653bd3632af435d.jpg" loading="lazy" alt="Featured image of post Hadoop3 HAæ¨¡å¼ä¸‰èŠ‚ç‚¹é«˜å¯ç”¨é›†ç¾¤æ­å»ºå®éªŒ" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF/" style="background-color: #f0945d; color: #fff;">
                å¤§æ•°æ®æŠ€æœ¯
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/p/hadoop-ha/">Hadoop3 HAæ¨¡å¼ä¸‰èŠ‚ç‚¹é«˜å¯ç”¨é›†ç¾¤æ­å»ºå®éªŒ</a>
    </h2>

    
    <h3 class="article-subtitle">
        hadoop haé›†ç¾¤
    </h3>
    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">2022-09-22</time>
    </footer></div>
</header>

    <section class="article-content">
    <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><strong>Table of Contents</strong>  <em>generated with <a class="link" href="https://github.com/thlorenz/doctoc"  target="_blank" rel="noopener"
    >DocToc</a></em></p>
<ul>
<li><a class="link" href="#hadoop3-ha%E6%A8%A1%E5%BC%8F%E4%B8%89%E8%8A%82%E7%82%B9%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E5%AE%9E%E9%AA%8C" >Hadoop3 HAæ¨¡å¼ä¸‰èŠ‚ç‚¹é«˜å¯ç”¨é›†ç¾¤æ­å»ºå®éªŒ</a></li>
<li><a class="link" href="#%E5%85%B3%E4%BA%8Ehadoop3-ha%E6%A8%A1%E5%BC%8F" >å…³äºHadoop3 HAæ¨¡å¼</a>
<ul>
<li><a class="link" href="#%E5%8D%95%E7%82%B9%E6%95%85%E9%9A%9Cspof" >å•ç‚¹æ•…éšœï¼ˆSPOFï¼‰</a></li>
<li><a class="link" href="#zookeeper" >Zookeeper</a></li>
</ul>
</li>
<li><a class="link" href="#%E5%AE%9E%E9%AA%8C%E8%BF%87%E7%A8%8B%E5%92%8C%E7%BB%93%E6%9E%9C" >å®éªŒè¿‡ç¨‹å’Œç»“æœ</a>
<ul>
<li><a class="link" href="#%E7%8E%AF%E5%A2%83" >ç¯å¢ƒ</a></li>
<li><a class="link" href="#%E9%9B%86%E7%BE%A4%E8%A7%84%E5%88%92" >é›†ç¾¤è§„åˆ’</a></li>
<li><a class="link" href="#%E5%88%9B%E5%BB%BAhadoop%E7%94%A8%E6%88%B7" >åˆ›å»ºhadoopç”¨æˆ·</a></li>
<li><a class="link" href="#%E4%B8%BB%E6%9C%BA%E5%90%8D%E5%92%8C%E7%BD%91%E7%BB%9C%E6%98%A0%E5%B0%84%E9%85%8D%E7%BD%AE" >ä¸»æœºåå’Œç½‘ç»œæ˜ å°„é…ç½®</a></li>
<li><a class="link" href="#%E5%AE%89%E8%A3%85ssh%E5%B9%B6%E9%85%8D%E7%BD%AEssh%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95" >å®‰è£…SSHå¹¶é…ç½®SSHå…å¯†ç™»å½•</a></li>
<li><a class="link" href="#%E5%AE%89%E8%A3%85java%E7%8E%AF%E5%A2%83" >å®‰è£…Javaç¯å¢ƒ</a></li>
<li><a class="link" href="#%E5%AE%89%E8%A3%85hadoop3" >å®‰è£…hadoop3</a></li>
<li><a class="link" href="#%E5%AE%89%E8%A3%85zookeeper" >å®‰è£…Zookeeper</a></li>
<li><a class="link" href="#%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F" >é…ç½®ç¯å¢ƒå˜é‡</a></li>
<li><a class="link" href="#%E9%85%8D%E7%BD%AEha%E6%A8%A1%E5%BC%8F%E9%9B%86%E7%BE%A4%E5%88%86%E5%B8%83%E5%BC%8F%E7%8E%AF%E5%A2%83" >é…ç½®HAæ¨¡å¼é›†ç¾¤åˆ†å¸ƒå¼ç¯å¢ƒ</a>
<ul>
<li><a class="link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6workers" >ä¿®æ”¹æ–‡ä»¶workers</a></li>
<li><a class="link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6core-sitexml" >ä¿®æ”¹æ–‡ä»¶core-site.xml</a></li>
<li><a class="link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6hdfs-sitexml" >ä¿®æ”¹æ–‡ä»¶hdfs-site.xml</a></li>
<li><a class="link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6hadoop-envsh" >ä¿®æ”¹æ–‡ä»¶hadoop-env.sh</a></li>
<li><a class="link" href="#%E5%9C%A8%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%E4%B8%8A%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E5%A4%B9%E5%92%8C%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%A4%B9" >åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šåˆ›å»ºæ•°æ®æ–‡ä»¶å¤¹å’Œæ—¥å¿—æ–‡ä»¶å¤¹</a></li>
<li><a class="link" href="#%E5%9C%A8%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%E4%B8%8A%E5%88%86%E5%88%AB%E5%90%AF%E5%8A%A8journalnode" >åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šåˆ†åˆ«å¯åŠ¨journalnode</a></li>
<li><a class="link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96namenode%E8%8A%82%E7%82%B9" >æ ¼å¼åŒ–namenodeèŠ‚ç‚¹</a></li>
<li><a class="link" href="#%E5%88%86%E5%88%AB%E5%9C%A8namenode%E8%8A%82%E7%82%B9%E4%B8%8A%E5%90%AF%E5%8A%A8zkfc" >åˆ†åˆ«åœ¨namenodeèŠ‚ç‚¹ä¸Šå¯åŠ¨zkfc</a></li>
<li><a class="link" href="#%E5%9C%A8%E4%B8%BB%E8%8A%82%E7%82%B9%E4%B8%8A%E5%90%AF%E5%8A%A8%E6%89%80%E6%9C%89datanode%E8%8A%82%E7%82%B9" >åœ¨ä¸»èŠ‚ç‚¹ä¸Šå¯åŠ¨æ‰€æœ‰datanodeèŠ‚ç‚¹</a></li>
</ul>
</li>
<li><a class="link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C" >å®éªŒç»“æœ</a></li>
<li><a class="link" href="#%E5%AE%9E%E4%BE%8B%E8%BF%90%E8%A1%8C" >å®ä¾‹è¿è¡Œ</a></li>
</ul>
</li>
<li><a class="link" href="#%E8%A1%A5%E5%85%85%E5%8F%AF%E9%80%89%E9%85%8D%E7%BD%AE" >è¡¥å……ï¼šå¯é€‰é…ç½®</a>
<ul>
<li><a class="link" href="#hdfs-web-ui%E9%85%8D%E7%BD%AE%E8%AE%A4%E8%AF%81" >HDFS Web UIé…ç½®è®¤è¯</a></li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<hr>
<h1 id="hadoop3-haæ¨¡å¼ä¸‰èŠ‚ç‚¹é«˜å¯ç”¨é›†ç¾¤æ­å»ºå®éªŒ">Hadoop3 HAæ¨¡å¼ä¸‰èŠ‚ç‚¹é«˜å¯ç”¨é›†ç¾¤æ­å»ºå®éªŒ</h1>
<h1 id="å…³äºhadoop3-haæ¨¡å¼">å…³äºHadoop3 HAæ¨¡å¼</h1>
<h3 id="å•ç‚¹æ•…éšœspof">å•ç‚¹æ•…éšœï¼ˆSPOFï¼‰</h3>
<p>ç®€å•æ¥è¯´ï¼Œå•ç‚¹æ•…éšœæŒ‡çš„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿè¿‡åº¦ä¾èµ–äºæŸä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»¥è‡³äºåªè¦è¯¥èŠ‚ç‚¹å®•æ‰ï¼Œå°±ç®—æ•´ä¸ªé›†ç¾¤çš„å…¶å®ƒèŠ‚ç‚¹æ˜¯å®Œå¥½çš„ï¼Œé›†ç¾¤ä¹Ÿæ— æ³•æ­£å¸¸å·¥ä½œã€‚è€Œå•ç‚¹æ•…éšœé—®é¢˜ä¸€èˆ¬å‡ºç°åœ¨é›†ç¾¤çš„å…ƒæ•°æ®å­˜å‚¨èŠ‚ç‚¹ä¸Šï¼Œè¿™ç§èŠ‚ç‚¹ä¸€èˆ¬ä¸€ä¸ªé›†ç¾¤å°±ä¸€ä¸ªï¼Œä¸€æ—¦åäº†æ•´ä¸ªç³»ç»Ÿå°±ä¸èƒ½æ­£å¸¸ä½¿ç”¨ã€‚Hadoopçš„å•ç‚¹æ•…éšœå‡ºç°åœ¨namenodeä¸Šï¼Œå½±å“é›†ç¾¤ä¸å¯ç”¨ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼šä¸€æ˜¯namenodeèŠ‚ç‚¹å®•æœºï¼Œå°†å¯¼è‡´é›†ç¾¤ä¸å¯ç”¨ï¼Œé‡å¯namenodeä¹‹åæ‰å¯ä½¿ç”¨ï¼›äºŒæ˜¯è®¡åˆ’å†…çš„namenodeèŠ‚ç‚¹è½¯ä»¶æˆ–ç¡¬ä»¶å‡çº§ï¼Œå¯¼è‡´é›†ç¾¤çŸ­æ—¶é—´å†…ä¸å¯ç”¨ã€‚</p>
<p>ä¸ºäº†é¿å…å‡ºç°å•ç‚¹æ•…éšœï¼ŒHadoopå®˜æ–¹ç»™å‡ºäº†é«˜å¯ç”¨HAæ–¹æ¡ˆï¼šå¯ä»¥é‡‡å–åŒæ—¶å¯åŠ¨ä¸¤ä¸ªnamenodeï¼šå…¶ä¸­ä¸€ä¸ªå·¥ä½œï¼ˆactiveï¼‰ï¼Œå¦ä¸€ä¸ªæ€»æ˜¯å¤„äºåå¤‡æœºï¼ˆstandbyï¼‰çš„çŠ¶æ€ï¼Œè®©å®ƒåªæ˜¯å•çº¯åœ°åŒæ­¥æ´»è·ƒæœºçš„æ•°æ®ï¼Œå½“æ´»è·ƒæœºå®•æ‰çš„æ—¶å€™å°±å¯ä»¥è‡ªåŠ¨åˆ‡æ¢è¿‡å»ã€‚è¿™ç§æ¨¡å¼ç§°ä¸º<strong>HAæ¨¡å¼</strong>ã€‚HAæ¨¡å¼ä¸‹ä¸èƒ½ç”¨[namenodeä¸»æœº:ç«¯å£]çš„æ¨¡å¼æ¥è®¿é—®Hadoopé›†ç¾¤ï¼Œå› ä¸ºnamenodeä¸»æœºå·²ç»ä¸å†æ˜¯ä¸€ä¸ªå›ºå®šçš„IPäº†ï¼Œè€Œæ˜¯é‡‡ç”¨serviceidçš„æ–¹å¼æ¥è®¿é—®ï¼Œè¿™ä¸ªserviceidå­˜å‚¨åœ¨ZooKeeperä¸Šã€‚</p>
<h3 id="zookeeper">Zookeeper</h3>
<p>Zookeeperæ˜¯ä¸€ä¸ªè½»é‡çº§çš„åˆ†å¸ƒå¼æ¶æ„é›†ç¾¤ï¼Œä¸ºåˆ†å¸ƒå¼åº”ç”¨æä¾›ä¸€è‡´æ€§æœåŠ¡ï¼Œæä¾›çš„åŠŸèƒ½åŒ…æ‹¬ï¼šé…ç½®ç»´æŠ¤ã€åŸŸåæœåŠ¡ã€åˆ†å¸ƒå¼åŒæ­¥å’Œç»„æœåŠ¡ç­‰ã€‚åœ¨HAæ¨¡å¼ä¸­ï¼ŒZookeeperæœ€å¤§çš„åŠŸèƒ½ä¹‹ä¸€æ˜¯çŸ¥é“æŸä¸ªèŠ‚ç‚¹æ˜¯å¦å®•æœºäº†ã€‚å…¶åŸç†æ˜¯ï¼šæ¯ä¸€ä¸ªæœºå™¨åœ¨Zookeeperä¸­éƒ½æœ‰ä¸€ä¸ªä¼šè¯ï¼Œå¦‚æœæŸä¸ªæœºå™¨å®•æœºäº†ï¼Œè¿™ä¸ªä¼šè¯å°±ä¼šè¿‡æœŸï¼ŒZookeeperå°±èƒ½å‘ç°è¯¥èŠ‚ç‚¹å·²å®•æœºã€‚</p>
<h2 id="å®éªŒè¿‡ç¨‹å’Œç»“æœ">å®éªŒè¿‡ç¨‹å’Œç»“æœ</h2>
<h3 id="ç¯å¢ƒ">ç¯å¢ƒ</h3>
<p>æœ¬å®éªŒä½¿ç”¨Ubuntu 18.04 64ä½ä½œä¸ºç³»ç»Ÿç¯å¢ƒï¼Œé‡‡ç”¨3å°2æ ¸16GBï¼ˆÂ MA3.MEDIUM16å‹å·ï¼‰çš„è…¾è®¯äº‘æœåŠ¡å™¨ä½œä¸ºé›†ç¾¤éƒ¨ç½²æœºå™¨ã€‚</p>
<p>ä½¿ç”¨çš„è½¯ä»¶å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>ç‰ˆæœ¬</th>
</tr>
</thead>
<tbody>
<tr>
<td>Hadoop</td>
<td>3.2.3</td>
</tr>
<tr>
<td>Zookeeper</td>
<td>3.6.3</td>
</tr>
<tr>
<td>JDK</td>
<td>11.0.2</td>
</tr>
</tbody>
</table>
<p><!-- raw HTML omitted -->å»ºè®®ï¼šåœ¨ä»¥ä¸‹çš„éƒ¨ç½²è¿‡ç¨‹ä¸­ä½¿ç”¨rootç”¨æˆ·å¯ä»¥é¿å…å¾ˆå¤šæƒé™é—®é¢˜ã€‚<!-- raw HTML omitted --></p>
<h3 id="é›†ç¾¤è§„åˆ’">é›†ç¾¤è§„åˆ’</h3>
<table>
<thead>
<tr>
<th>ä¸»æœºå</th>
<th>IP</th>
<th>Namenode</th>
<th>Datanode</th>
<th>Zookeeper</th>
<th>JournalNode</th>
</tr>
</thead>
<tbody>
<tr>
<td>master</td>
<td>172.31.0.12</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>slave1</td>
<td>172.31.0.16</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>slave2</td>
<td>172.31.0.10</td>
<td>å¦</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
<td>æ˜¯</td>
</tr>
</tbody>
</table>
<h3 id="åˆ›å»ºhadoopç”¨æˆ·">åˆ›å»ºhadoopç”¨æˆ·</h3>
<p>åœ¨ç»ˆç«¯è¾“å‡ºå¦‚ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªåä¸ºhadoopçš„ç”¨æˆ·ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo useradd -m hadoop -s /bin/bash
</span></span></code></pre></div><p>æ¥ç€ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è®¾ç½®å¯†ç ï¼ŒæŒ‰æç¤ºè¾“å…¥ä¸¤æ¬¡å¯†ç ï¼Œè¿™é‡Œç®€å•è®¾ç½®ä¸ºhadoop</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo passwd hadoop
</span></span></code></pre></div><p>æ­¤å¤–ï¼Œå¯ä»¥ä¸ºhadoopç”¨æˆ·æ·»åŠ ç®¡ç†å‘˜æƒé™ï¼Œæ–¹ä¾¿åç»­çš„éƒ¨ç½²ï¼Œé¿å…ä¸€äº›æƒé™é—®é¢˜çš„å‡ºç°ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo adduser hadoop sudo
</span></span></code></pre></div><h3 id="ä¸»æœºåå’Œç½‘ç»œæ˜ å°„é…ç½®">ä¸»æœºåå’Œç½‘ç»œæ˜ å°„é…ç½®</h3>
<p>ä¸ºäº†ä¾¿äºåŒºåˆ†masterèŠ‚ç‚¹å’ŒslaveèŠ‚ç‚¹ï¼Œå¯ä»¥ä¿®æ”¹å„ä¸ªèŠ‚ç‚¹çš„ä¸»æœºåã€‚åœ¨Ubuntuç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥ä¿®æ”¹ä¸»æœºåã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo vim /etc/hostname
</span></span></code></pre></div><p>æ‰§è¡Œä¸Šé¢å‘½ä»¤åï¼Œå°±æ‰“å¼€äº†/etc/hostnameè¿™ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶è®°å½•äº†ä¸»æœºåã€‚æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ä¹‹åï¼Œé‡Œé¢åªæœ‰å½“å‰çš„ä¸»æœºåè¿™ä¸€è¡Œå†…å®¹ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤ï¼Œå¹¶ä¿®æ”¹ä¸ºmasteræˆ–slave1ã€slave2ï¼Œç„¶åä¿å­˜é€€å‡ºvimç¼–è¾‘å™¨ï¼Œè¿™æ ·å°±å®Œæˆäº†ä¸»æœºåçš„ä¿®æ”¹ï¼Œéœ€è¦é‡å¯ç³»ç»Ÿåæ‰èƒ½çœ‹åˆ°ä¸»æœºåçš„å˜åŒ–ã€‚</p>
<p>ç„¶åï¼Œåœ¨masterèŠ‚ç‚¹ä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æ‰“å¼€å¹¶ä¿®æ”¹masterèŠ‚ç‚¹çš„/etc/hostsæ–‡ä»¶</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo vim /etc/hosts
</span></span></code></pre></div><p>åœ¨hostsæ–‡ä»¶ä¸­å¢åŠ å¦‚ä¸‹ä¸‰æ¡IPï¼ˆå±€åŸŸç½‘IPï¼‰å’Œä¸»æœºåæ˜ å°„å…³ç³»ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">172.31.0.12 master
</span></span><span class="line"><span class="cl">172.31.0.16 slave1
</span></span><span class="line"><span class="cl">172.31.0.10 slave2
</span></span></code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€èˆ¬hostsæ–‡ä»¶ä¸­åªèƒ½æœ‰ä¸€ä¸ª127.0.0.1ï¼Œå…¶å¯¹åº”ä¸»æœºåä¸ºlocalhostï¼Œå¦‚æœæœ‰å¤šä½™127.0.0.1æ˜ å°„ï¼Œåº”åˆ é™¤ï¼Œç‰¹åˆ«æ˜¯ä¸èƒ½å­˜åœ¨â€œ127.0.0.1 Masterâ€è¿™æ ·çš„æ˜ å°„è®°å½•ã€‚ä¿®æ”¹åéœ€è¦é‡å¯Linuxç³»ç»Ÿã€‚</p>
<p>ä¸Šé¢å®Œæˆäº†masterèŠ‚ç‚¹çš„é…ç½®ï¼Œæ¥ä¸‹æ¥è¦ç»§ç»­å®Œæˆå¯¹å…¶ä»–slaveèŠ‚ç‚¹çš„é…ç½®ä¿®æ”¹ã€‚è¯·å‚ç…§ä¸Šé¢çš„æ–¹æ³•ï¼ŒæŠŠslave1èŠ‚ç‚¹ä¸Šçš„â€œ/etc/hostnameâ€æ–‡ä»¶ä¸­çš„ä¸»æœºåä¿®æ”¹ä¸ºâ€œslave1â€ï¼ŒæŠŠslave1èŠ‚ç‚¹ä¸Šçš„â€œ/etc/hostnameâ€æ–‡ä»¶ä¸­çš„ä¸»æœºåä¿®æ”¹ä¸ºâ€œslave2â€åŒæ—¶ï¼Œä¿®æ”¹â€œ/etc/hostsâ€çš„å†…å®¹ï¼Œåœ¨hostsæ–‡ä»¶ä¸­å¢åŠ å¦‚ä¸‹ä¸‰æ¡IPå’Œä¸»æœºåæ˜ å°„å…³ç³»ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">172.31.0.12 master
</span></span><span class="line"><span class="cl">172.31.0.16 slave1
</span></span><span class="line"><span class="cl">172.31.0.10 slave2
</span></span></code></pre></div><p>ä¿®æ”¹å®Œæˆä»¥åï¼Œé‡æ–°å¯åŠ¨slaveèŠ‚ç‚¹çš„Linuxç³»ç»Ÿã€‚</p>
<p>è¿™æ ·å°±å®Œæˆäº†masterèŠ‚ç‚¹å’ŒslaveèŠ‚ç‚¹çš„é…ç½®ï¼Œç„¶åï¼Œéœ€è¦åœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šéƒ½æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œæµ‹è¯•æ˜¯å¦ç›¸äº’pingå¾—é€šï¼Œå¦‚æœpingä¸é€šï¼Œåé¢å°±æ— æ³•é¡ºåˆ©é…ç½®æˆåŠŸï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ping master -c <span class="m">3</span>
</span></span><span class="line"><span class="cl">ping slave1 -c <span class="m">3</span>
</span></span><span class="line"><span class="cl">ping slave2 -c <span class="m">3</span>
</span></span></code></pre></div><p>ä¾‹å¦‚ï¼Œåœ¨masterèŠ‚ç‚¹ä¸Šping slave1ï¼Œå¦‚æœpingé€šçš„è¯ï¼Œä¼šæ˜¾ç¤ºå¦‚ä¸‹å›¾æ‰€ç¤ºçš„ç»“æœï¼š</p>
<p><img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/2022-09-20-22-51-51-image.png" alt=""  /></p>
<h3 id="å®‰è£…sshå¹¶é…ç½®sshå…å¯†ç™»å½•">å®‰è£…SSHå¹¶é…ç½®SSHå…å¯†ç™»å½•</h3>
<p>é›†ç¾¤æ¨¡å¼éœ€è¦ç”¨åˆ°SSHç™»é™†ï¼ŒUbuntué»˜è®¤å·²ç»å®‰è£…SSH clientï¼Œæ­¤å¤–è¿˜éœ€è¦å®‰è£…SSH server</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo apt-get install openssh-server
</span></span></code></pre></div><p>å®‰è£…åï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç™»é™†æœ¬æœº</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ssh localhost
</span></span></code></pre></div><p>åœ¨é›†ç¾¤æ¨¡å¼ä¸­ï¼Œå¿…é¡»è¦è®©masterèŠ‚ç‚¹å¯ä»¥SSHå…å¯†ç™»å½•åˆ°å„ä¸ªslaveèŠ‚ç‚¹ä¸Šã€‚é¦–å…ˆï¼Œç”ŸæˆmasterèŠ‚ç‚¹çš„å…¬é’¥ï¼Œå¦‚æœä¹‹å‰å·²ç»ç”Ÿæˆè¿‡å…¬é’¥ï¼Œå¿…é¡»è¦åˆ é™¤åŸæ¥ç”Ÿæˆçš„å…¬é’¥ï¼Œé‡æ–°ç”Ÿæˆä¸€æ¬¡ã€‚å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> ~/.ssh <span class="c1">#å¦‚æœæ²¡æœ‰è¯¥ç›®å½•ï¼Œå…ˆæ‰§è¡Œä¸€æ¬¡ssh localhost</span>
</span></span><span class="line"><span class="cl">rm ./id_rsa* <span class="c1">#åˆ é™¤ä¹‹å‰ç”Ÿæˆçš„å…¬é’¥</span>
</span></span><span class="line"><span class="cl">ssh-keygen -t rsa <span class="c1">#æ‰§è¡Œè¯¥å‘½ä»¤åä¸€ç›´æŒ‰å›è½¦å°±å¯ä»¥</span>
</span></span></code></pre></div><p>ä¸ºäº†è®©masterèŠ‚ç‚¹èƒ½å¤ŸSSHå…å¯†ç™»å½•æœ¬æœºï¼Œéœ€è¦åœ¨masterèŠ‚ç‚¹ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat ./id_rsa.pub &gt;&gt; ./authorized_keys
</span></span></code></pre></div><p>å®Œæˆåå¯ä»¥æ‰§è¡Œâ€œssh masterâ€æ¥éªŒè¯ä¸€ä¸‹ï¼Œå¯èƒ½ä¼šé‡åˆ°æç¤ºä¿¡æ¯ï¼Œè¾“å…¥yeså³å¯ï¼Œæµ‹è¯•æˆåŠŸåæ‰§è¡Œexitå‘½ä»¤è¿”å›åŸæ¥çš„ç»ˆç«¯ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œåœ¨masterèŠ‚ç‚¹ä¸Šå°†å…¬é’¥ä¼ è¾“åˆ°slave1å’Œslave2èŠ‚ç‚¹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">scp ~/.ssh/id_rsa.pub hadoop@slave1:/home/hadoop/
</span></span><span class="line"><span class="cl">scp ~/.ssh/id_rsa.pub hadoop@slave2:/home/hadoop/
</span></span></code></pre></div><p>æ¥ç€åœ¨slave1ï¼ˆslave2ï¼‰èŠ‚ç‚¹ä¸Šå°†SSHå…¬é’¥åŠ å…¥æˆæƒ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkdir ~/.ssh
</span></span><span class="line"><span class="cl">cat ~/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys
</span></span><span class="line"><span class="cl">rm ~/id_rsa.pub <span class="c1">#ç”¨å®Œä¹‹åå¯ä»¥åˆ é™¤æ‰</span>
</span></span></code></pre></div><p>è¿™æ ·ï¼ŒmasterèŠ‚ç‚¹å°±å¯ä»¥å…å¯†ç™»å½•åˆ°å„ä¸ªslaveèŠ‚ç‚¹ä¸Šäº†ï¼Œä¾‹å¦‚æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">ssh slave1
</span></span></code></pre></div><p>ä¼šæ˜¾ç¤ºå¦‚ä¸‹ç»“æœï¼Œæ˜¾ç¤ºå·²ç»ç™»å½•åˆ°slave1èŠ‚ç‚¹ä¸Šã€‚</p>
<p><img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/2022-09-20-22-52-30-image.png" alt=""  /></p>
<h3 id="å®‰è£…javaç¯å¢ƒ">å®‰è£…Javaç¯å¢ƒ</h3>
<p>Hadoop3éœ€è¦JDKç‰ˆæœ¬åœ¨1.8ä»¥ä¸Šï¼Œè¿™é‡Œæˆ‘é€‰æ‹©11ç‰ˆæœ¬JDKä½œä¸ºJavaç¯å¢ƒï¼Œå…ˆæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¸‹è½½å‹ç¼©åŒ…ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> /usr/local/softwares<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo wget https://repo.huaweicloud.com/openjdk/11.0.2/openjdk-11.0.2_linux-x64_bin.tar.gz
</span></span></code></pre></div><p>ç„¶åï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è§£å‹ç¼©ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo tar -xzf openjdk-11.0.2_linux-x64_bin.tar.gz<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo mv jdk-11.0.2 openjdk<span class="p">;</span>
</span></span></code></pre></div><p>è¿™æ—¶ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> openjdk<span class="p">;</span>
</span></span><span class="line"><span class="cl">./bin/java --version<span class="p">;</span>
</span></span></code></pre></div><p>å¦‚æœè¿”å›å¦‚ä¸‹ä¿¡æ¯ï¼Œåˆ™è¯´æ˜å®‰è£…æˆåŠŸï¼š</p>
<p><img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/2022-09-20-22-52-51-image.png" alt=""  /></p>
<h3 id="å®‰è£…hadoop3">å®‰è£…hadoop3</h3>
<p>å…ˆæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¸‹è½½å‹ç¼©åŒ…ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> /usr/local/softwares<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo wget https://mirrors.pku.edu.cn/apache/hadoop/common/hadoop-3.2.3/hadoop-3.2.3.tar.gz
</span></span></code></pre></div><p>ç„¶åï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è§£å‹ç¼©ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo tar -xzf hadoop-3.2.3.tar.gz<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo mv hadoop-3.2.3 hadoop
</span></span></code></pre></div><p>è¿™æ—¶ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> hadoop<span class="p">;</span>
</span></span><span class="line"><span class="cl">./bin/hadoop version
</span></span></code></pre></div><p>å¦‚æœè¿”å›å¦‚ä¸‹ä¿¡æ¯ï¼Œåˆ™è¯´æ˜å®‰è£…æˆåŠŸï¼š</p>
<p><img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/2022-09-20-22-53-11-image.png" alt=""  /></p>
<h3 id="å®‰è£…zookeeper">å®‰è£…Zookeeper</h3>
<p>å…ˆæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¸‹è½½å‹ç¼©åŒ…ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> /usr/local/softwares<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo wget https://mirrors.pku.edu.cn/apache/zookeeper/stable/apache-zookeeper-3.6.3-bin.tar.gz<span class="p">;</span>
</span></span></code></pre></div><p>ç„¶åï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è§£å‹ç¼©ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo tar -xzf apache-zookeeper-3.6.3-bin.tar.gz<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo mv apache-zookeeper-3.6.3-bin zookeeper<span class="p">;</span>
</span></span></code></pre></div><p>æ¥ä¸‹æ¥ï¼Œå°†Zookeeperä¸­çš„confæ–‡ä»¶å¤¹é‡Œçš„zoo_sample.cfgæ–‡ä»¶å¤åˆ¶ä¸€ä»½ï¼Œæ”¹åä¸ºzoo.cfgï¼Œç„¶åç¼–è¾‘è¿™ä¸ªæ–‡ä»¶ï¼Œå…¶ä»–çš„éƒ¨åˆ†ä¸ç”¨åŠ¨ï¼Œéœ€è¦ä¿®æ”¹dataDirè¿™ä¸€è¡Œã€‚dataDiræ˜¯ZooKeeperçš„æ•°æ®æ–‡ä»¶å¤¹çš„ä½ç½®ï¼Œåœ¨æˆ‘çš„æœºå™¨ä¸Šæˆ‘ç”¨çš„æ˜¯/data/zookeeperï¼Œä½ ä»¬å¯ä»¥è®¾ç½®æˆä½ ä»¬çš„ç›®å½•ã€‚æ­¤å¤–ï¼Œéœ€è¦åœ¨æœ«å°¾åŠ ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„ä¿¡æ¯ï¼ˆæ•°å­—ä¸myidè¦å¯¹åº”ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-properties" data-lang="properties"><span class="line"><span class="cl"><span class="na">server.1</span><span class="o">=</span><span class="s">master:2888:3888</span>
</span></span><span class="line"><span class="cl"><span class="na">server.2</span><span class="o">=</span><span class="s">slave1:2888:3888</span>
</span></span><span class="line"><span class="cl"><span class="na">server.3</span><span class="o">=</span><span class="s">slave2:2888:3888</span>
</span></span></code></pre></div><p>ç„¶åå†ä¿®æ”¹bin/zkEnv.shï¼Œæ·»åŠ ä»¥ä¸‹æ—¥å¿—è¾“å‡ºæ–‡ä»¶å¤¹é…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nv">ZOO_LOG_DIR</span><span class="o">=</span>/data/logs/zookeeper
</span></span></code></pre></div><p>æœ€åï¼Œéœ€è¦åœ¨æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„dataDirç›®å½•ä¸‹æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå‘½åä¸ºmyidï¼Œå¹¶å†™å…¥è¿™å°æœåŠ¡å™¨çš„Zookeeper IDã€‚è¿™ä¸ªIDæ•°å­—å¯ä»¥è‡ªå·±éšä¾¿å†™ï¼Œå–å€¼èŒƒå›´æ˜¯1~255ï¼Œåœ¨è¿™é‡Œæˆ‘å°†masterã€slave1å’Œslave2åˆ†åˆ«å–å€¼ä¸º1ï¼Œ2ï¼Œ3ã€‚é…ç½®å®Œæˆä»¥ä¸Šå…¨éƒ¨åï¼Œåˆ†åˆ«ä½¿ç”¨zkServer.sh startå‘½ä»¤å¯åŠ¨é›†ç¾¤ï¼ŒZooKeeperä¼šè‡ªåŠ¨æ ¹æ®é…ç½®æŠŠæ‰€æœ‰çš„èŠ‚ç‚¹è¿æ¥æˆä¸€ä¸ªé›†ç¾¤ã€‚å¯åŠ¨åä½¿ç”¨jpså‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°QuorumPeerMainè¿›ç¨‹å·²ç»å¯åŠ¨æˆåŠŸã€‚</p>
<h3 id="é…ç½®ç¯å¢ƒå˜é‡">é…ç½®ç¯å¢ƒå˜é‡</h3>
<p>é…ç½®ç¯å¢ƒå˜é‡åå¯ä»¥åœ¨ä»»æ„ç›®å½•ä¸­ç›´æ¥ä½¿ç”¨hadoopã€hdfsç­‰å‘½ä»¤ã€‚é…ç½®æ–¹æ³•ä¹Ÿæ¯”è¾ƒç®€å•ã€‚é¦–å…ˆæ‰§è¡Œå‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo vim ~/.bashrc
</span></span></code></pre></div><p>ç„¶åï¼Œåœ¨è¯¥æ–‡ä»¶æœ€ä¸Šé¢çš„ä½ç½®åŠ å…¥ä¸‹é¢å†…å®¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">JAVA_HOME</span><span class="o">=</span>/usr/local/softwares/openjdk                                                                                    
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HADOOP_HOME</span><span class="o">=</span>/usr/local/softwares/hadoop
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HADOOP_PREFIX</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HADOOP_MAPRED_HOME</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HADOOP_COMMON_HOME</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HADOOP_HDFS_HOME</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">YARN_HOME</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HADOOP_COMMON_LIB_NATIVE_DIR</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>/lib/natvie
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HADOOP_INSTALL</span><span class="o">=</span><span class="nv">$HADOOP_HOME</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">ZK_HOME</span><span class="o">=</span>/usr/local/softwares/zookeeper
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$JAVA_HOME</span>/bin:<span class="nv">$HADOOP_HOME</span>/bin:<span class="nv">$HADOOP_HOME</span>/sbin:<span class="nv">$ZK_HOME</span>/bin
</span></span></code></pre></div><p>ä¿å­˜åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ä½¿é…ç½®ç”Ÿæ•ˆï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">source</span> ~/.bashrc
</span></span></code></pre></div><h3 id="é…ç½®haæ¨¡å¼é›†ç¾¤åˆ†å¸ƒå¼ç¯å¢ƒ">é…ç½®HAæ¨¡å¼é›†ç¾¤åˆ†å¸ƒå¼ç¯å¢ƒ</h3>
<h4 id="ä¿®æ”¹æ–‡ä»¶workers">ä¿®æ”¹æ–‡ä»¶workers</h4>
<p>éœ€è¦æŠŠæ‰€æœ‰æ•°æ®èŠ‚ç‚¹çš„ä¸»æœºåå†™å…¥è¯¥æ–‡ä»¶ï¼Œæ¯è¡Œä¸€ä¸ªï¼Œé»˜è®¤ä¸ºlocalhostï¼ˆå³æŠŠæœ¬æœºä½œä¸ºæ•°æ®èŠ‚ç‚¹ï¼‰ï¼Œåœ¨æœ¬å®éªŒä¸­ï¼Œmasterå’Œslave1ã€slave2éƒ½å……å½“datanodeï¼Œæ‰€ä»¥è¯¥æ–‡ä»¶å†…å®¹é…ç½®å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">master
</span></span><span class="line"><span class="cl">slave1
</span></span><span class="line"><span class="cl">slave2
</span></span></code></pre></div><h4 id="ä¿®æ”¹æ–‡ä»¶core-sitexml">ä¿®æ”¹æ–‡ä»¶core-site.xml</h4>
<p>åœ¨ä¸€èˆ¬é›†ç¾¤æ¨¡å¼ä¸­ï¼Œ<code>fs.defaultFS</code>é…ç½®ä¸ºhdfs://master:9000ï¼Œå³åç§°èŠ‚ç‚¹æ‰€åœ¨çš„ä¸»æœºååŠ ä¸Šç«¯å£å·ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨HAæ¨¡å¼ä¸‹åˆ†åˆ«æœ‰ä¸€ä¸ªactiveå’Œstandbyçš„åç§°èŠ‚ç‚¹ï¼Œéœ€è¦å°†è¯¥å±æ€§è®¾ç½®ä¸ºé›†ç¾¤idï¼Œè¿™é‡Œå†™çš„ha-clusteréœ€è¦ä¸hdfs-site.xmlä¸­çš„é…ç½®ä¸€è‡´ï¼Œæ‰€ä»¥å°†è¯¥æ–‡ä»¶ä¿®æ”¹ä¸ºå¦‚ä¸‹å†…å®¹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>fs.defaultFS<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>hdfs://ha-cluster<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&lt;name&gt;</span>ha.zookeeper.quorum<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&lt;value&gt;</span>master:2181,slave1:2181,slave2:2181<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&lt;name&gt;</span>ha.zookeeper.session-timeout.ms<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&lt;value&gt;</span>30000<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></div><h4 id="ä¿®æ”¹æ–‡ä»¶hdfs-sitexml">ä¿®æ”¹æ–‡ä»¶hdfs-site.xml</h4>
<p>å¯¹ä»¥ä¸‹å±æ€§è¿›è¡Œé…ç½®ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- æœåŠ¡ID--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.nameservices<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>ha-cluster<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.ha.namenodes.ha-cluster<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>master,slave1<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- rpcåœ°å€--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.namenode.rpc-address.ha-cluster.master<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>master:8020<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.namenode.rpc-address.ha-cluster.slave1<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>slave1:8020<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- httpåœ°å€--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.namenode.http-address.ha-cluster.master<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>master:9870<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.namenode.http-address.ha-cluster.slave1<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>slave1:9870<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- journalnodeé›†ç¾¤è®¿é—®åœ°å€--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.namenode.shared.edits.dir<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>qjournal://master:8485;slave1:8485;slave2:8485/ha-cluster<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- dfså®¢æˆ·ç«¯--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.client.failover.proxy.provider.ha-cluster<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- é…ç½®killæ–¹å¼--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.ha.fencing.methods<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>sshfence<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.ha.fencing.ssh.private-key-files<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>/home/hadoop/.ssh/id_rsa<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- è‡ªåŠ¨failoveræœºåˆ¶--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.ha.automatic-failover.enabled<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>true<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>ha.zookeeper.quorum<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>master:2181,slave1:2181,slave2:2181<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- å†—ä½™å› å­ï¼Œdatanodeæœ‰3ä¸ªï¼Œæ‰€ä»¥è®¾ç½®ä¸º3--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.replication<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>3<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.namenode.name.dir<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>file:/data/hadoop/hdfs/nn<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.datanode.data.dir<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>file:/data/hadoop/hdfs/dn<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- ä¸è¦åŠ fileå‰ç¼€--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;name&gt;</span>dfs.journalnode.edits.dir<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;value&gt;</span>/data/hadoop/hdfs/jn<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></div><h4 id="ä¿®æ”¹æ–‡ä»¶hadoop-envsh">ä¿®æ”¹æ–‡ä»¶hadoop-env.sh</h4>
<p>åœ¨æ–‡ä»¶å¼€å¤´æ·»åŠ ä»¥ä¸‹å˜é‡</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HADOOP_NAMENODE_OPS</span><span class="o">=</span><span class="s2">&#34; -Xms1024m -Xmx1024m -XX:+UseParallelGC&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HADOOP_DATANODE_OPS</span><span class="o">=</span><span class="s2">&#34; -Xms1024m -Xmx1024m&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">HADOOP_LOG_DIR</span><span class="o">=</span>/data/logs/hadoop
</span></span></code></pre></div><h4 id="åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šåˆ›å»ºæ•°æ®æ–‡ä»¶å¤¹å’Œæ—¥å¿—æ–‡ä»¶å¤¹">åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šåˆ›å»ºæ•°æ®æ–‡ä»¶å¤¹å’Œæ—¥å¿—æ–‡ä»¶å¤¹</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo mkdir -p /data/hadoop/hdfs/nn<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo mkdir -p /data/hadoop/hdfs/dn<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo mkdir -p /data/hadoop/hdfs/jn<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo mkdir -p /data/zookeeper<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo chown -R hadoop.hadoop /data/hadoop<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo chown -R hadoop.hadoop /data/zookeeper<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo mkdir /data/logs<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo mkdir /data/logs/hadoop<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo mkdir /data/logs/zookeeper<span class="p">;</span>
</span></span><span class="line"><span class="cl">sudo chown -R hadoop.hadoop /data/logs
</span></span></code></pre></div><h4 id="åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šåˆ†åˆ«å¯åŠ¨journalnode">åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šåˆ†åˆ«å¯åŠ¨journalnode</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">hdfs --daemon start journalnode
</span></span></code></pre></div><h4 id="æ ¼å¼åŒ–namenodeèŠ‚ç‚¹">æ ¼å¼åŒ–namenodeèŠ‚ç‚¹</h4>
<ul>
<li>
<p>åœ¨ç¬¬ä¸€ä¸ªnamenodeä¸Šè¿›è¡Œæ ¼å¼åŒ–å¹¶å¯åŠ¨hdfsï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">hdfs namenode -format<span class="p">;</span>
</span></span><span class="line"><span class="cl">hdfs --daemon start namenode
</span></span></code></pre></div></li>
<li>
<p>åœ¨ç¬¬äºŒä¸ªnamenodeä¸Šè¿›è¡Œå¤‡ç”¨åˆå§‹åŒ–</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">hdfs namenode -bootstrapStandby
</span></span></code></pre></div></li>
<li>
<p>åœ¨ç¬¬ä¸€ä¸ªnamenodeä¸Šè¿›è¡Œjournalnodeçš„åˆå§‹åŒ–</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">hdfs namenode -initializeSharedEdits
</span></span></code></pre></div></li>
</ul>
<h4 id="åˆ†åˆ«åœ¨namenodeèŠ‚ç‚¹ä¸Šå¯åŠ¨zkfc">åˆ†åˆ«åœ¨namenodeèŠ‚ç‚¹ä¸Šå¯åŠ¨zkfc</h4>
<pre tabindex="0"><code class="language-shel" data-lang="shel">hdfs zkfc -formatZK
</code></pre><h4 id="åœ¨ä¸»èŠ‚ç‚¹ä¸Šå¯åŠ¨æ‰€æœ‰datanodeèŠ‚ç‚¹">åœ¨ä¸»èŠ‚ç‚¹ä¸Šå¯åŠ¨æ‰€æœ‰datanodeèŠ‚ç‚¹</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">start-dfs.sh
</span></span></code></pre></div><h3 id="å®éªŒç»“æœ">å®éªŒç»“æœ</h3>
<p><img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/2022-09-20-23-03-13-image.png" alt=""  /></p>
<p><img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/2022-09-20-23-03-26-image.png" alt=""  /></p>
<p><img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/2022-09-20-23-03-33-image.png" alt=""  /></p>
<p><img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/2022-09-20-23-03-42-image.png" alt=""  /></p>
<h3 id="å®ä¾‹è¿è¡Œ">å®ä¾‹è¿è¡Œ</h3>
<p>é¦–å…ˆåˆ›å»ºHDFSä¸Šçš„ç”¨æˆ·ç›®å½•ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">hdfs dfs -mkdir -p /user/hadoop
</span></span></code></pre></div><p>ç„¶åï¼Œåœ¨HDFSä¸­åˆ›å»ºä¸€ä¸ªinputç›®å½•ï¼Œå¹¶å°†â€œ/usr/local/softwares/hadoop/etc/hadoopâ€ç›®å½•ä¸­çš„é…ç½®æ–‡ä»¶ä½œä¸ºè¾“å…¥æ–‡ä»¶å¤åˆ¶åˆ°inputç›®å½•ä¸­ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">hdfs dfs -mkdir input<span class="p">;</span>
</span></span><span class="line"><span class="cl">hdfs dfs -put /usr/local/softwares/hadoop/etc/hadoop/*.xml input
</span></span></code></pre></div><p>æ¥ç€å°±å¯ä»¥è¿è¡ŒMapReduceä½œä¸šäº†ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">hadoop jar /usr/local/softwares/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.3.jar grep input output <span class="s1">&#39;dfs[a-z.]+&#39;</span>
</span></span></code></pre></div><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/2022-09-20-23-16-35-image.png" alt=""  /></p>
<p><img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/2022-09-20-23-17-58-image.png" alt=""  /></p>
<h2 id="è¡¥å……å¯é€‰é…ç½®">è¡¥å……ï¼šå¯é€‰é…ç½®</h2>
<h3 id="hdfs-web-uié…ç½®è®¤è¯">HDFS Web UIé…ç½®è®¤è¯</h3>
<p>HDFSå¸¦æœ‰ä¸€ä¸ªå¯è§†åŒ–çš„ç«¯å£å·é»˜è®¤ä¸º9870çš„Web UIç•Œé¢ï¼Œè¿™ä¸ªç•Œé¢å¦‚æœæ²¡æœ‰åšé˜²ç«å¢™é™åˆ¶çš„è¯ä¼šæš´éœ²åœ¨å…¬ç½‘ä¸Šã€‚è€Œè¯¥ç•Œé¢åˆå­˜åœ¨ç€å¤§é‡çš„æ—¥å¿—å’Œé…ç½®ä¿¡æ¯ï¼Œç›´æ¥æš´éœ²åœ¨å…¬ç½‘ä¸Šä¸åˆ©äºç³»ç»Ÿçš„å®‰å…¨ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œå¯ä»¥é…ç½®ä¸€ä¸ªç®€å•çš„ç³»ç»Ÿè®¤è¯åŠŸèƒ½ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p>å®‰è£…httpdæˆ–å®‰è£…httpd-tools</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo apt-get install httpd
</span></span></code></pre></div></li>
<li>
<p>å®‰è£…nginxï¼šè¿™éƒ¨åˆ†å†…å®¹è¾ƒå¤šï¼Œä¸æ˜¯é‡ç‚¹ï¼Œç½‘ä¸Šæœ‰å¤§é‡çš„æ•™ç¨‹ï¼Œè·Ÿç€å…¶ä¸­ä¸€ä¸ªè¿›è¡Œå°±è¡Œã€‚</p>
</li>
<li>
<p>é€šè¿‡htpasswdå‘½ä»¤ç”Ÿæˆç”¨æˆ·åå’Œå¯†ç æ•°æ®åº“æ–‡ä»¶</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">htpasswd -c passwd.db <span class="o">[</span>username<span class="o">]</span>
</span></span></code></pre></div></li>
<li>
<p>æŸ¥çœ‹ç”Ÿæˆçš„dbæ–‡ä»¶å†…å®¹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">cat passwd.db
</span></span></code></pre></div></li>
<li>
<p>é€šè¿‡nginxä»£ç†å¹¶è®¾ç½®è®¿é—®èº«ä»½éªŒè¯</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="c1"># nginxé…ç½®æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">vim nginx.conf
</span></span></code></pre></div><pre tabindex="0"><code class="language-textile" data-lang="textile">server {
    # ä½¿ç”¨9871ç«¯å£æ›¿ä»£åŸæœ‰çš„9870ç«¯å£
    listen 9871;
    server_name localhost;

    location / {
        auth_basic &#34;hadoop authentication&#34;;
        auth_basic_user_file /home/hadoop/hadoop/passwd.db
        proxy_pass http://127.0.0.1:9870
    }
}
</code></pre></li>
<li>
<p>é‡æ–°åŠ è½½nginxé…ç½®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> /usr/local/lighthouse/softwares/nginx/sbin
</span></span><span class="line"><span class="cl">./nginx -s reload
</span></span></code></pre></div></li>
<li>
<p>å¯åŠ¨nginx</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">systemctl start nginx
</span></span></code></pre></div></li>
<li>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼ŒHDFS Web UIç•Œé¢è®¤è¯è®¾ç½®å®Œæˆï¼Œæ•ˆæœå¦‚ä¸‹ï¼š.</p>
<p><img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/2022-09-26-20-15-41-image.png" alt=""  /></p>
</li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/hadoop/">Hadoop</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
    integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"
    integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4"
    crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"
    integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
    onload="StackLaTeX()"></script>

<script>
    function StackLaTeX() {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });
    }
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/p/matrix-factorization/">
        
        
            <div class="article-image">
                
                    <img src="https://cuterwrite-1302252842.file.myqcloud.com/img/65cf6588fa725014c7cd617ccbeb997f27742e49.jpg@1256w_1880h_!web-article-pic.jpg" loading="lazy" data-key="matrix-factorization" data-hash="https://cuterwrite-1302252842.file.myqcloud.com/img/65cf6588fa725014c7cd617ccbeb997f27742e49.jpg@1256w_1880h_!web-article-pic.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">SVDä¸NMFï¼šçŸ©é˜µåˆ†è§£çš„ä¸¤ç§æ–¹æ³•</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/flink-native-k8s/">
        
        
            <div class="article-image">
                
                    <img src="https://cuterwrite-1302252842.file.myqcloud.com/img/YSFD_P2_50.png" loading="lazy" data-key="flink-native-k8s" data-hash="https://cuterwrite-1302252842.file.myqcloud.com/img/YSFD_P2_50.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">åŸºäºFlink Native Kubernetesçš„è¯é¢‘ç»Ÿè®¡å®éªŒ</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/spark-on-k8s/">
        
        
            <div class="article-image">
                
                    <img src="https://cuterwrite-1302252842.file.myqcloud.com/img/92.png" loading="lazy" data-key="spark-on-k8s" data-hash="https://cuterwrite-1302252842.file.myqcloud.com/img/92.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">åŸºäºSpark on k8sçš„è¯é¢‘ç»Ÿè®¡å®éªŒ</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/mapreduce/">
        
        
            <div class="article-image">
                
                    <img src="https://cuterwrite-1302252842.file.myqcloud.com/img/202210221658.png" loading="lazy" data-key="mapreduce" data-hash="https://cuterwrite-1302252842.file.myqcloud.com/img/202210221658.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MapReduceå®éªŒ</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/p/zookeeper-on-k8s/">
        
        
            <div class="article-image">
                
                    <img src="https://cuterwrite-1302252842.file.myqcloud.com/typora/202210172323.png" loading="lazy" data-key="zookeeper-on-k8s" data-hash="https://cuterwrite-1302252842.file.myqcloud.com/typora/202210172323.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Zookeeper on k8séƒ¨ç½²å®éªŒ</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>


    
        
    <script src="https://utteranc.es/client.js" 
        repo="PKUcoldkeyboard/pkucoldkeyboard.github.io"
        issue-term="title"
        theme="preferred-color-scheme" 
        
        crossorigin="anonymous" 
        async>
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${e.detail}`
                },
                'https://utteranc.es'
            );
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2021 - 
        
        2023 cuterwrite
    </section>
    
    <section class="powerby">
        
            æ¬¢è¿æ¥åˆ°Cuterwriteçš„åšå®¢ç½‘ç«™ <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="2.0.1">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"><script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>
      
      Array.from(document.getElementsByClassName("language-mermaid")).forEach(
        (el) => {
          el.parentElement.outerHTML = `<div class="mermaid">${el.innerText}</div>`;
        }
      );
    </script>
    <style>
       
      .mermaid svg {
        display: block;
        margin: auto;
      }
    </style>


            </main>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"
    integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin="anonymous"></script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
